{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","node_modules/browserify/node_modules/process/browser.js","platforms/common/application/assignments/index.js","platforms/common/application/changelog/index.js","platforms/common/application/configurations/dropdown-edit.js","platforms/common/application/configurations/index.js","platforms/common/application/fields/index.js","platforms/common/application/fields/multicheckbox.js","platforms/common/application/fields/submit.js","platforms/common/application/lm/blocks/atom.js","platforms/common/application/lm/blocks/atoms.js","platforms/common/application/lm/blocks/base.js","platforms/common/application/lm/blocks/block.js","platforms/common/application/lm/blocks/container.js","platforms/common/application/lm/blocks/grid.js","platforms/common/application/lm/blocks/index.js","platforms/common/application/lm/blocks/offcanvas.js","platforms/common/application/lm/blocks/particle.js","platforms/common/application/lm/blocks/position.js","platforms/common/application/lm/blocks/section.js","platforms/common/application/lm/blocks/spacer.js","platforms/common/application/lm/blocks/system.js","platforms/common/application/lm/blocks/wrapper.js","platforms/common/application/lm/builder.js","platforms/common/application/lm/drag.resizer.js","platforms/common/application/lm/history.js","platforms/common/application/lm/id.js","platforms/common/application/lm/index.js","platforms/common/application/lm/inheritance/index.js","platforms/common/application/lm/layoutmanager.js","platforms/common/application/lm/particles-sidebar.js","platforms/common/application/main.js","platforms/common/application/menu/drag.resizer.js","platforms/common/application/menu/extra-items.js","platforms/common/application/menu/index.js","platforms/common/application/menu/menumanager.js","platforms/common/application/pagesettings/index.js","platforms/common/application/particles/collections/index.js","platforms/common/application/particles/colorpicker/index.js","platforms/common/application/particles/filepicker/index.js","platforms/common/application/particles/fonts/index.js","platforms/common/application/particles/icons/index.js","platforms/common/application/particles/index.js","platforms/common/application/particles/instancepicker/index.js","platforms/common/application/particles/keyvalue/index.js","platforms/common/application/particles/menu/index.js","platforms/common/application/positions/cards.js","platforms/common/application/positions/index.js","platforms/common/application/styles/index.js","platforms/common/application/ui/collapse.js","platforms/common/application/ui/drag.drop.js","platforms/common/application/ui/drag.events.js","platforms/common/application/ui/eraser.js","platforms/common/application/ui/index.js","platforms/common/application/ui/modal.js","platforms/common/application/ui/popover.js","platforms/common/application/ui/progresser.js","platforms/common/application/ui/selectize.js","platforms/common/application/ui/toastr.js","platforms/common/application/ui/togglers.js","platforms/common/application/ui/tooltips.js","platforms/common/application/utils/ajaxify-links.js","platforms/common/application/utils/async-foreach.js","platforms/common/application/utils/decouple.js","platforms/common/application/utils/elements.utils.js","platforms/common/application/utils/elements.viewport.js","platforms/common/application/utils/field-validation.js","platforms/common/application/utils/flags-state.js","platforms/common/application/utils/get-ajax-suffix.js","platforms/common/application/utils/get-ajax-url.js","platforms/common/application/utils/get-outline.js","platforms/common/application/utils/get-scrollbar-width.js","platforms/common/application/utils/history-adapter.js","platforms/common/application/utils/history.js","platforms/common/application/utils/rAF-polyfill.js","platforms/common/application/utils/save-state.js","platforms/common/application/utils/translate.js","platforms/common/application/utils/wp-widgets-customizer.js","platforms/common/node_modules/agent/index.js","platforms/common/node_modules/agent/node_modules/mout/array/forEach.js","platforms/common/node_modules/agent/node_modules/mout/array/indexOf.js","platforms/common/node_modules/agent/node_modules/mout/array/remove.js","platforms/common/node_modules/agent/node_modules/mout/lang/createObject.js","platforms/common/node_modules/agent/node_modules/mout/lang/isArray.js","platforms/common/node_modules/agent/node_modules/mout/lang/isFunction.js","platforms/common/node_modules/agent/node_modules/mout/lang/isKind.js","platforms/common/node_modules/agent/node_modules/mout/lang/isObject.js","platforms/common/node_modules/agent/node_modules/mout/lang/isString.js","platforms/common/node_modules/agent/node_modules/mout/lang/kindOf.js","platforms/common/node_modules/agent/node_modules/mout/lang/toString.js","platforms/common/node_modules/agent/node_modules/mout/object/forIn.js","platforms/common/node_modules/agent/node_modules/mout/object/forOwn.js","platforms/common/node_modules/agent/node_modules/mout/object/hasOwn.js","platforms/common/node_modules/agent/node_modules/mout/object/mixIn.js","platforms/common/node_modules/agent/node_modules/mout/string/WHITE_SPACES.js","platforms/common/node_modules/agent/node_modules/mout/string/ltrim.js","platforms/common/node_modules/agent/node_modules/mout/string/rtrim.js","platforms/common/node_modules/agent/node_modules/mout/string/trim.js","platforms/common/node_modules/agent/node_modules/mout/string/upperCase.js","platforms/common/node_modules/agent/node_modules/mout/time/now.js","platforms/common/node_modules/agent/node_modules/prime/defer.js","platforms/common/node_modules/agent/node_modules/prime/emitter.js","platforms/common/node_modules/agent/node_modules/prime/index.js","platforms/common/node_modules/deep-diff/index.js","platforms/common/node_modules/dropzone/dist/dropzone.js","platforms/common/node_modules/elements/attributes.js","platforms/common/node_modules/elements/base.js","platforms/common/node_modules/elements/delegation.js","platforms/common/node_modules/elements/domready.js","platforms/common/node_modules/elements/events.js","platforms/common/node_modules/elements/index.js","platforms/common/node_modules/elements/insertion.js","platforms/common/node_modules/elements/node_modules/mout/array/every.js","platforms/common/node_modules/elements/node_modules/mout/array/filter.js","platforms/common/node_modules/elements/node_modules/mout/array/map.js","platforms/common/node_modules/elements/node_modules/mout/array/some.js","platforms/common/node_modules/elements/node_modules/mout/function/identity.js","platforms/common/node_modules/elements/node_modules/mout/function/makeIterator_.js","platforms/common/node_modules/elements/node_modules/mout/function/prop.js","platforms/common/node_modules/elements/node_modules/mout/object/deepMatches.js","platforms/common/node_modules/elements/traversal.js","platforms/common/node_modules/elements/zen.js","platforms/common/node_modules/moofx/index.js","platforms/common/node_modules/moofx/lib/browser.js","platforms/common/node_modules/moofx/lib/color.js","platforms/common/node_modules/moofx/lib/frame.js","platforms/common/node_modules/moofx/lib/fx.js","platforms/common/node_modules/moofx/lib/unmatrix2d.js","platforms/common/node_modules/moofx/node_modules/cubic-bezier/index.js","platforms/common/node_modules/moofx/node_modules/elements/index.js","platforms/common/node_modules/moofx/node_modules/prime/array/every.js","platforms/common/node_modules/moofx/node_modules/prime/array/filter.js","platforms/common/node_modules/moofx/node_modules/prime/array/forEach.js","platforms/common/node_modules/moofx/node_modules/prime/array/indexOf.js","platforms/common/node_modules/moofx/node_modules/prime/array/map.js","platforms/common/node_modules/moofx/node_modules/prime/array/some.js","platforms/common/node_modules/moofx/node_modules/prime/index.js","platforms/common/node_modules/moofx/node_modules/prime/object/create.js","platforms/common/node_modules/moofx/node_modules/prime/object/filter.js","platforms/common/node_modules/moofx/node_modules/prime/object/forIn.js","platforms/common/node_modules/moofx/node_modules/prime/object/forOwn.js","platforms/common/node_modules/moofx/node_modules/prime/object/hasOwn.js","platforms/common/node_modules/moofx/node_modules/prime/object/mixIn.js","platforms/common/node_modules/moofx/node_modules/prime/string/camelize.js","platforms/common/node_modules/moofx/node_modules/prime/string/capitalize.js","platforms/common/node_modules/moofx/node_modules/prime/string/clean.js","platforms/common/node_modules/moofx/node_modules/prime/string/hyphenate.js","platforms/common/node_modules/moofx/node_modules/prime/string/trim.js","platforms/common/node_modules/moofx/node_modules/prime/type.js","platforms/common/node_modules/mout/array/append.js","platforms/common/node_modules/mout/array/combine.js","platforms/common/node_modules/mout/array/contains.js","platforms/common/node_modules/mout/array/difference.js","platforms/common/node_modules/mout/array/equals.js","platforms/common/node_modules/mout/array/find.js","platforms/common/node_modules/mout/array/findIndex.js","platforms/common/node_modules/mout/array/flatten.js","platforms/common/node_modules/mout/array/insert.js","platforms/common/node_modules/mout/array/intersection.js","platforms/common/node_modules/mout/array/invoke.js","platforms/common/node_modules/mout/array/last.js","platforms/common/node_modules/mout/array/removeAll.js","platforms/common/node_modules/mout/array/slice.js","platforms/common/node_modules/mout/array/split.js","platforms/common/node_modules/mout/array/unique.js","platforms/common/node_modules/mout/collection/contains.js","platforms/common/node_modules/mout/collection/find.js","platforms/common/node_modules/mout/collection/forEach.js","platforms/common/node_modules/mout/collection/make_.js","platforms/common/node_modules/mout/collection/size.js","platforms/common/node_modules/mout/function/bind.js","platforms/common/node_modules/mout/function/debounce.js","platforms/common/node_modules/mout/function/series.js","platforms/common/node_modules/mout/lang/GLOBAL.js","platforms/common/node_modules/mout/lang/clone.js","platforms/common/node_modules/mout/lang/deepClone.js","platforms/common/node_modules/mout/lang/deepEquals.js","platforms/common/node_modules/mout/lang/is.js","platforms/common/node_modules/mout/lang/isBoolean.js","platforms/common/node_modules/mout/lang/isNumber.js","platforms/common/node_modules/mout/lang/isPlainObject.js","platforms/common/node_modules/mout/lang/isPrimitive.js","platforms/common/node_modules/mout/lang/toArray.js","platforms/common/node_modules/mout/lang/toNumber.js","platforms/common/node_modules/mout/math/clamp.js","platforms/common/node_modules/mout/math/lerp.js","platforms/common/node_modules/mout/math/map.js","platforms/common/node_modules/mout/math/norm.js","platforms/common/node_modules/mout/number/MAX_INT.js","platforms/common/node_modules/mout/number/MIN_INT.js","platforms/common/node_modules/mout/number/enforcePrecision.js","platforms/common/node_modules/mout/number/toInt.js","platforms/common/node_modules/mout/object/contains.js","platforms/common/node_modules/mout/object/deepFillIn.js","platforms/common/node_modules/mout/object/deepMatches.js","platforms/common/node_modules/mout/object/equals.js","platforms/common/node_modules/mout/object/every.js","platforms/common/node_modules/mout/object/filter.js","platforms/common/node_modules/mout/object/find.js","platforms/common/node_modules/mout/object/get.js","platforms/common/node_modules/mout/object/has.js","platforms/common/node_modules/mout/object/keys.js","platforms/common/node_modules/mout/object/merge.js","platforms/common/node_modules/mout/object/namespace.js","platforms/common/node_modules/mout/object/omit.js","platforms/common/node_modules/mout/object/set.js","platforms/common/node_modules/mout/object/size.js","platforms/common/node_modules/mout/object/some.js","platforms/common/node_modules/mout/object/unset.js","platforms/common/node_modules/mout/object/values.js","platforms/common/node_modules/mout/queryString/encode.js","platforms/common/node_modules/mout/queryString/getParam.js","platforms/common/node_modules/mout/queryString/getQuery.js","platforms/common/node_modules/mout/queryString/setParam.js","platforms/common/node_modules/mout/random/choice.js","platforms/common/node_modules/mout/random/guid.js","platforms/common/node_modules/mout/random/rand.js","platforms/common/node_modules/mout/random/randHex.js","platforms/common/node_modules/mout/random/randInt.js","platforms/common/node_modules/mout/random/random.js","platforms/common/node_modules/mout/string/contains.js","platforms/common/node_modules/mout/string/endsWith.js","platforms/common/node_modules/mout/string/escapeHtml.js","platforms/common/node_modules/mout/string/escapeUnicode.js","platforms/common/node_modules/mout/string/interpolate.js","platforms/common/node_modules/mout/string/lowerCase.js","platforms/common/node_modules/mout/string/properCase.js","platforms/common/node_modules/mout/string/removeNonWord.js","platforms/common/node_modules/mout/string/repeat.js","platforms/common/node_modules/mout/string/replace.js","platforms/common/node_modules/mout/string/replaceAccents.js","platforms/common/node_modules/mout/string/rpad.js","platforms/common/node_modules/mout/string/slugify.js","platforms/common/node_modules/mout/string/typecast.js","platforms/common/node_modules/mout/string/unescapeHtml.js","platforms/common/node_modules/mout/string/unhyphenate.js","platforms/common/node_modules/prime-util/node_modules/mout/lang/clone.js","platforms/common/node_modules/prime-util/prime/bound.js","platforms/common/node_modules/prime-util/prime/options.js","platforms/common/node_modules/prime/defer.js","platforms/common/node_modules/prime/emitter.js","platforms/common/node_modules/prime/index.js","platforms/common/node_modules/prime/map.js","platforms/common/node_modules/sifter/sifter.js","platforms/common/node_modules/slick/finder.js","platforms/common/node_modules/slick/index.js","platforms/common/node_modules/slick/parser.js","platforms/common/node_modules/sortablejs/Sortable.js","platforms/common/node_modules/webfontloader/webfontloader.js","platforms/common/js/tooltips.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC3KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChlBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACtgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC/QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACjuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC1cA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3uBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5ZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7nBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChwEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/bA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACv/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC1FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACtaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvuDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACr6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC7HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACxHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC7zBA;AACA;AACA;AACA;AACA;AACA;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1vCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","\"use strict\";\n\nvar ready        = require('elements/domready'),\n    map          = require('prime/map')(),\n    merge        = require('mout/object/merge'),\n    forEach      = require('mout/array/forEach'),\n    trim         = require('mout/string/trim'),\n    $            = require('../utils/elements.utils'),\n    decouple     = require('../utils/decouple'),\n    asyncForEach = require('../utils/async-foreach');\n\nvar Map         = map,\n    Assignments = {\n        toggleSection: function(e, element, index, array) {\n            if (e.type.match(/^touch/)) { e.preventDefault(); }\n            if (element.siblings('[data-g-global-filter]') || element.parent('[data-g-global-filter]')) { return Assignments.globalToggleSection(e, element); }\n            if (element.matches('label')) { return Assignments.treatLabel(e, element); }\n\n            var card    = element.parent('.card'),\n                toggles = Map.get(card),\n                save    = $('[data-save]'),\n                mode    = element.data('g-assignments-check') == null ? 0 : 1;\n\n            if (!toggles || !toggles.inputs) {\n                var inputs = card.search('.enabler input[type=hidden]');\n\n                if (!toggles) { toggles = Map.set(card, { inputs: inputs }).get(card); }\n                if (!toggles.inputs) { toggles = Map.set(card, merge(Map.get(card), { inputs: inputs })).get(card); }\n            }\n\n            // if necessary we should move to asyncForEach for an asynchronous loop, else forEach\n            asyncForEach(toggles.inputs, function(item) {\n                item = $(item);\n\n                if (item.parent('label').compute('display') == 'none') { return; }\n\n                item.value(mode).emit('change');\n                $('body').emit('change', { target: item });\n            }, function() {\n                if (typeof index !== 'undefined' && typeof array !== 'undefined' && (index + 1 == array.length)) {\n                    save.disabled(false);\n                }\n            });\n        },\n\n        filterSection: function(e, element, value, global) {\n            if (element.siblings('[data-g-global-filter]') || element.parent('[data-g-global-filter]')) { return Assignments.globalFilterSection(e, element); }\n\n            var card        = element.parent('.card'),\n                onlyEnabled = $('[data-assignments-enabledonly]'),\n                items       = Map.get(card) || Map.set(card, { labels: card.search('label .settings-param-title') }).get(card);\n\n            value = value || element.value();\n\n            if (!items || !items.labels) {\n                var labels = card.search('label .settings-param-title');\n\n                if (!items) { items = Map.set(card, { labels: labels }).get(card); }\n                if (!items.labels) { items = Map.set(card, merge(Map.get(card), { labels: labels })).get(card); }\n            }\n\n            items = $(items.labels);\n\n            if (!value && !onlyEnabled.checked()) {\n                card.style('display', 'inline-block');\n                return items ? items.search('!> label').style('display', 'block') : items;\n            }\n\n            var count = 0, off = 0, on = 0, text, match;\n\n            if (!items) {\n                element.parent('.card').style('display', onlyEnabled.checked() || value ? 'none' : 'inline-block');\n            }\n\n            asyncForEach(items, function(item, i) {\n                item = $(item);\n                text = trim(item.text());\n                match = text.match(new RegExp(\"^\" + value + '|\\\\s' + value, 'gi'));\n\n                if (onlyEnabled.checked()) {\n                    match = Number(!!match) & Number(item.parent('label').find('.enabler input[type=\"hidden\"]').value());\n                }\n\n                if (match) {\n                    var group = item.parent('[data-g-assignments-parent]');\n                    if (group && (group = group.data('g-assignments-parent'))) {\n                        var parentGroup = item.parent('.card').find('[data-g-assignments-group=\"' + group + '\"]');\n                        if (parentGroup) { parentGroup.style('display', 'block'); }\n                    }\n\n                    item.parent('label').style('display', 'block');\n                    on++;\n                } else {\n                    item.parent('label').style('display', 'none');\n                    off++;\n                }\n\n                count++;\n                if (count == items.length && global) {\n                    card.style('display', !on ? 'none' : 'inline-block');\n                }\n            });\n        },\n\n        filterEnabledOnly: function(e, element) {\n            var global = $('[data-g-global-filter] input[type=\"text\"]');\n            Assignments.globalFilterSection(e, global, element);\n        },\n\n        treatLabel: function(event, element) {\n            if (event && event.stopPropagation && event.preventDefault) {\n                event.stopPropagation();\n                event.preventDefault();\n            }\n\n            if ($(event.target).matches('.knob, .toggle')) { return; }\n            var input = element.find('input[type=\"hidden\"]:not([disabled])');\n            if (!input) { return; }\n\n            var value = input.value();\n            value = !!+value;\n            input.value(Number(!value)).emit('change');\n            $('body').emit('change', { target: input });\n\n            return false;\n        },\n\n        globalToggleSection: function(e, element) {\n            var mode   = element.data('g-assignments-check') == null ? '[data-g-assignments-uncheck]' : '[data-g-assignments-check]',\n                save   = $('[data-save]'),\n                search = $('#assignments .card ' + mode + ', ' + '.settings-assignments .card ' + mode);\n\n            if (!search) { return; }\n\n            save.disabled(true);\n            // if necessary we should move to asyncForEach for an asynchronous loop\n            asyncForEach(search, function(item, index, array) {\n                Assignments.toggleSection(e, $(item), index, array);\n            });\n        },\n\n        globalFilterSection: function(e, element) {\n            var value       = element.value(),\n                onlyEnabled = $('[data-assignments-enabledonly]'),\n                search      = $('#assignments .card .search input[type=\"text\"], .settings-assignments .card .search input[type=\"text\"]');\n\n            if (!search && !onlyEnabled.checked()) { return; }\n\n            asyncForEach(search, function(item) {\n                Assignments.filterSection(e, $(item), value, 'global');\n            });\n        },\n\n        toggleStateDelegation: function(event, element) {\n            var enabled = element.value() == '1';\n            element.attribute('disabled', !enabled);\n        },\n\n        // chrome workaround for overflow and columns\n        chromeFix: function() {\n            if (!Assignments.isChrome()) { return; }\n            var panels = $('#assignments .settings-param-wrapper, .settings-assignments .settings-param-wrapper'), height, maxHeight;\n            if (!panels) { return; }\n\n            panels.forEach(function(panel){\n                panel = $(panel);\n                maxHeight = parseInt(panel.compute('max-height'), 10);\n                height = panel[0].getBoundingClientRect().height;\n                panel.style({overflow: height >= maxHeight ? 'auto' : 'visible'});\n\n                if (height >= maxHeight) {\n                    var alt = 100;\n                    decouple(panel, 'scroll', function() {\n                        alt = alt == 100 ? 100.01 : 100;\n                        panel.parent('.card').style('width', alt + '%');\n                    });\n                }\n            });\n        },\n\n        isChrome: function() {\n            return navigator.userAgent.toLowerCase().indexOf('chrome') > -1;\n        }\n    };\n\nready(function() {\n    var body = $('body');\n\n    body.delegate('input', '#assignments .search input[type=\"text\"], .settings-assignments .search input[type=\"text\"]', Assignments.filterSection);\n    body.delegate('click', '#assignments .card label, #assignments [data-g-assignments-check], #assignments [data-g-assignments-uncheck], .settings-assignments .card label, .settings-assignments [data-g-assignments-check], .settings-assignments [data-g-assignments-uncheck]', Assignments.toggleSection);\n    body.delegate('touchend', '#assignments .card label, #assignments [data-g-assignments-check], #assignments [data-g-assignments-uncheck], .settings-assignments .card label, .settings-assignments [data-g-assignments-check], .settings-assignments [data-g-assignments-uncheck]', Assignments.toggleSection);\n    body.delegate('change', '[data-assignments-enabledonly]', Assignments.filterEnabledOnly);\n    body.delegate('change', '#assignments input[type=\"hidden\"][name], .settings-assignments input[type=\"hidden\"][name]', Assignments.toggleStateDelegation);\n\n    // chrome workaround for overflow and columns\n    //if (Assignments.isChrome()) Assignments.chromeFix();\n});\n\nmodule.exports = Assignments;\n","\"use strict\";\nvar $             = require('elements'),\n    zen           = require('elements/zen'),\n    ready         = require('elements/domready'),\n    ui            = require('../ui'),\n    interpolate   = require('mout/string/interpolate'),\n    modal         = ui.modal,\n    trim          = require('mout/string/trim'),\n\n    parseAjaxURI  = require('../utils/get-ajax-url').parse,\n    getAjaxURL    = require('../utils/get-ajax-url').global,\n    getAjaxSuffix = require('../utils/get-ajax-suffix');\n\nready(function() {\n    // Changelog links\n    $('body').delegate('click', '[data-changelog]', function(event, element) {\n        event.preventDefault();\n\n        modal.open({\n            content: 'Loading',\n            method: 'post',\n            className: 'g5-dialog-theme-default g5-modal-changelog',\n            data: { version: element.data('changelog') },\n            remote: parseAjaxURI(getAjaxURL('changelog') + getAjaxSuffix()),\n            remoteLoaded: function(response, content) {\n                if (!response.body.success) { return; }\n\n                var wrapper  = content.elements.content,\n                    sections = wrapper.search('#g-changelog > ol > li > a');\n\n                sections.forEach(function(section, i) {\n                    section = $(section);\n                    var href      = section.href(),\n                        re        = new RegExp('#(common|' + GANTRY_PLATFORM + ')$', \"gi\"),\n                        collapsed = !href.match(re),\n                        status    = 'chevron-' + (!collapsed ? 'up' : 'down');\n\n                    if (!trim(section.text())) {\n                        // no platforms\n                        return;\n                    }\n\n                    // if it's not common but the current platform, move it after common\n                    if (i && !collapsed) {\n                        section.parent('li').after(section.parent('ol').find('> li'));\n                    }\n\n                    zen('i[class=\"fa g-changelog-toggle fa-fw fa-' + status + '\"]').bottom(section);\n\n                    if (collapsed) {\n                        section.nextSibling().style({\n                            overflow: 'hidden',\n                            height: 0\n                        });\n                    }\n\n                    section.on('click', function(e) {\n                        e.preventDefault();\n                        var icon      = section.find('i[class*=\"fa-chevron-\"]'),\n                            collapsed = icon.hasClass('fa-chevron-down');\n\n                        if (collapsed) {\n                            icon.removeClass('fa-chevron-down').addClass('fa-chevron-up');\n                            section.nextSibling().slideDown();\n                        } else {\n                            icon.removeClass('fa-chevron-up').addClass('fa-chevron-down');\n                            section.nextSibling().slideUp();\n                        }\n                    });\n                });\n            }\n        });\n    });\n});\n","\"use strict\";\n\nvar $             = require('elements'),\n    ready         = require('elements/domready'),\n    request       = require('agent'),\n\n    modal         = require('../ui').modal,\n    guid          = require('mout/random/guid'),\n    trim          = require('mout/string/trim'),\n\n    getAjaxSuffix = require('../utils/get-ajax-suffix'),\n    parseAjaxURI  = require('../utils/get-ajax-url').parse,\n    getAjaxURL    = require('../utils/get-ajax-url').global,\n\n    History       = require('../utils/history'),\n    getParam      = require('mout/queryString/getParam'),\n    setParam      = require('mout/queryString/setParam');\n\n\nvar refreshWordpressLinks = function (title, value) {\n    if (GANTRY_PLATFORM == 'wordpress') {\n        // refresh URIs with new configuration name\n        var replace = title.replace(/[^a-z\\d_-\\s]/i, '_').toLowerCase(),\n            find = $('[href*=\"/' + value + '/\"]'),\n            currentURI = History.getPageUrl(),\n            currentView = getParam(currentURI, 'view');\n\n        if (find) {\n            find.forEach(function(lnk){\n                lnk = $(lnk);\n                var href = lnk.href().replace('/' + value + '/', '/' + replace + '/');\n                lnk.href(href);\n            });\n        }\n\n        currentView = currentView.replace('/' + value + '/', '/' + replace + '/');\n        currentURI = setParam(currentURI, 'view', currentView);\n        History.replaceState({ uuid: guid(), doNothing: true }, window.document.title, currentURI);\n    }\n};\n\nready(function() {\n    var body = $('body');\n\n    var selectized, select, editable, href;\n    body.delegate('keydown', '.config-select-wrap [data-title-edit]', function(event, element) {\n        var key = (event.which ? event.which : event.keyCode);\n        if (key == 32 || key == 13) { // ARIA support: Space / Enter toggle\n            event.preventDefault();\n            body.emit('mousedown', event);\n        }\n    });\n\n    body.delegate('mousedown', '.config-select-wrap [data-title-edit]', function(event, element) {\n        selectized = element.siblings('.g-selectize-control');\n        select = element.siblings('select');\n        editable = element.siblings('[data-title-editable]');\n\n        if (!editable.gConfEditAttached) {\n            editable.gConfEditAttached = true;\n            editable.on('title-edit-end', function(title, original, canceled) {\n                title = trim(title);\n                if (canceled || title == original) {\n                    selectized.style('display', 'inline-block');\n                    editable.style('display', 'none').attribute('contenteditable', null);\n\n                    return;\n                }\n\n                element.addClass('disabled');\n                element.removeClass('fa-pencil').addClass('fa-spin-fast fa-spinner');\n                href = editable.data('g-config-href');\n\n                request('post', parseAjaxURI(href + getAjaxSuffix()), { title: title }, function(error, response) {\n                    if (!response.body.success) {\n                        modal.open({\n                            content: response.body.html || response.body,\n                            afterOpen: function(container) {\n                                if (!response.body.html) { container.style({ width: '90%' }); }\n                            }\n                        });\n\n                        editable.data('title-editable', original).text(original);\n                    } else {\n                        var selectize = select.selectizeInstance,\n                            value = select.value(),\n                            data = selectize.Options[value];\n\n                        data[selectize.options.labelField] = title;\n                        selectize.updateOption(value, data);\n\n                        selectized.style('display', 'inline-block');\n                        editable.style('display', 'none')\n                    }\n\n                    // fix Wordpress non unique IDs by refreshing all hrefs\n                    refreshWordpressLinks(title, value);\n\n                    element.removeClass('disabled');\n                    element.removeClass('fa-spin-fast fa-spinner').addClass('fa-pencil');\n                });\n            });\n        }\n\n        editable.style({\n            width: selectized.compute('width'),\n            display: 'inline-block'\n        });\n        selectized.style('display', 'none');\n    });\n});\n\nmodule.exports = {};\n","\"use strict\";\n\nvar $             = require('elements'),\n    zen           = require('elements/zen'),\n    ready         = require('elements/domready'),\n    trim          = require('mout/string/trim'),\n    keys          = require('mout/object/keys'),\n    modal         = require('../ui').modal,\n    toastr        = require('../ui').toastr,\n    request       = require('agent'),\n    getAjaxSuffix = require('../utils/get-ajax-suffix'),\n    parseAjaxURI  = require('../utils/get-ajax-url').parse,\n    getAjaxURL    = require('../utils/get-ajax-url').global,\n\n    flags         = require('../utils/flags-state');\n\nrequire('./dropdown-edit');\n\nready(function() {\n    var body = $('body');\n\n    // Handles Creating new Configurations\n    body.delegate('click', '[data-g5-outline-create], [data-g5-outline-duplicate]', function(event, element) {\n        if (event) { event.preventDefault(); }\n\n        modal.open({\n            content: 'Loading',\n            method: 'post',\n            overlayClickToClose: false,\n            remote: parseAjaxURI(element.href() + getAjaxSuffix()),\n            remoteLoaded: function(response, content) {\n                if (!response.body.success) {\n                    modal.enableCloseByOverlay();\n                    return;\n                }\n\n                var title   = content.elements.content.find('[name=\"title\"]'),\n                    confirm = content.elements.content.find('[data-g-outline-create-confirm]');\n\n                title.on('keyup', function(event) {\n                    var code = event.which;\n                    if (code === 13) {\n                        confirm.emit('click');\n                    }\n                });\n\n                confirm.on('click', function() {\n                    confirm.hideIndicator();\n                    confirm.showIndicator();\n\n                    var URI  = parseAjaxURI(confirm.data('g-outline-create-confirm') + getAjaxSuffix()),\n                        from    = content.elements.content.find('[name=\"from\"]:checked'),\n                        preset  = content.elements.content.find('[name=\"preset\"]'),\n                        outline = content.elements.content.find('[name=\"outline\"]'),\n                        inherit = content.elements.content.find('[name=\"inherit\"]'),\n                        data = {\n                            title: title.value(),\n                            from: from ? from.value() : null,\n                            preset: preset ? preset.value() : null,\n                            outline: outline ? outline.value() : null,\n                            inherit: inherit.checked() ? 1 : 0\n                        };\n\n                    ['title', 'from', 'preset', 'outline'].forEach(function(key) {\n                        if (!data[key]) { delete data[key]; }\n                    });\n\n                    request('post', URI, data, function(error, response) {\n                        confirm.hideIndicator();\n\n                        if (!response.body.success) {\n                            modal.open({\n                                content: response.body.html || response.body,\n                                afterOpen: function(container) {\n                                    if (!response.body.html) { container.style({ width: '90%' }); }\n                                }\n                            });\n                        } else {\n                            var base    = $('#configurations').find('ul').find('li'),\n                                outline = zen('li').attribute('class', base.attribute('class'));\n\n                            outline.after(base).html(response.body.outline);\n\n                            toastr.success(response.body.html || 'Action successfully completed.', response.body.title || '');\n\n                            attachEditables(outline.find('[data-title-editable]'));\n                            modal.close();\n                        }\n\n                    });\n                });\n\n                setTimeout(function() {\n                    title[0].focus();\n                }, 5);\n            }\n        });\n    });\n\n    // Handles Preset / Outline switcher in Outline creation\n    body.delegate('change', 'input[type=\"radio\"]#from-preset, input[type=\"radio\"]#from-outline', function(event, element) {\n        element = $(element);\n        var value    = element.value(),\n            elements = element.parent('.card').search('.g-create-from');\n\n        var filtered = elements.style('display', 'none').filter(function(block) {\n            block = $(block);\n            return block.hasClass('g-create-from-' + value);\n        });\n\n        if (filtered) {\n            $(filtered).style('display', 'block');\n        }\n    });\n\n    // Handles Configurations Duplicate / Remove\n    body.delegate('click', '#configurations [data-g-config]', function(event, element) {\n        var mode        = element.data('g-config'),\n            href        = element.data('g-config-href'),\n            hrefConfirm = element.data('g-config-href-confirm'),\n            encode      = window.btoa(href),//.substr(-20, 20), // in case the strings gets too long\n            method      = (element.data('g-config-method') || 'post').toLowerCase();\n\n        if (event && event.preventDefault) { event.preventDefault(); }\n\n        if (mode == 'delete' && !flags.get('free:to:delete:' + encode, false)) {\n            // confirm before proceeding\n            flags.warning({\n                url: parseAjaxURI(href + getAjaxSuffix()),\n                callback: function(response, content) {\n                    var confirm = content.find('[data-g-delete-confirm]'),\n                        cancel  = content.find('[data-g-delete-cancel]');\n\n                    if (!confirm) { return; }\n\n                    confirm.on('click', function(e) {\n                        e.preventDefault();\n                        if (this.attribute('disabled')) { return false; }\n\n                        flags.get('free:to:delete:' + encode, true);\n                        $([confirm, cancel]).attribute('disabled');\n                        body.emit('click', { target: element });\n\n                        modal.close();\n                    });\n\n                    cancel.on('click', function(e) {\n                        e.preventDefault();\n                        if (this.attribute('disabled')) { return false; }\n\n                        $([confirm, cancel]).attribute('disabled');\n                        flags.get('free:to:delete:' + encode, false);\n\n                        modal.close();\n                    });\n                }\n            });\n\n            return false;\n        }\n\n        element.hideIndicator();\n        element.showIndicator();\n\n        request(method, parseAjaxURI((hrefConfirm || href) + getAjaxSuffix()), {}, function(error, response) {\n            if (!response.body.success) {\n                modal.open({\n                    content: response.body.html || response.body,\n                    afterOpen: function(container) {\n                        if (!response.body.html) { container.style({ width: '90%' }); }\n                    }\n                });\n            } else {\n                var confSelector   = $('#configuration-selector'),\n                    currentOutline = confSelector.value(),\n                    outlineDeleted = response.body.outline,\n                    reload         = $('[href=\"' + getAjaxURL('configurations') + '\"]');\n\n                // if the current outline is the one that's been deleted,\n                // fallback to default\n                if (outlineDeleted && currentOutline == outlineDeleted) {\n                    var ids = keys(confSelector.selectizeInstance.Options);\n                    if (ids.length) {\n                        reload.href(reload.href().replace('style=' + outlineDeleted, 'style=' + ids.shift()));\n                    }\n                }\n\n                if (!reload) { window.location = window.location; }\n                else {\n                    body.emit('click', { target: reload });\n                }\n\n                toastr.success(response.body.html || 'Action successfully completed.', response.body.title || '');\n                if (outlineDeleted) {\n                    body.outlineDeleted = outlineDeleted;\n                }\n            }\n\n            element.hideIndicator();\n        });\n\n    });\n\n    // Handles Configurations Titles Rename\n    var updateTitle     = function(title, original, wasCanceled) {\n            this.style('text-overflow', 'ellipsis');\n            if (wasCanceled || title == original) { return; }\n            var element = this,\n                href    = element.data('g-config-href'),\n                method  = (element.data('g-config-method') || 'post').toLowerCase(),\n                parent  = element.parent();\n\n            parent.showIndicator();\n            parent.find('[data-title-edit]').addClass('disabled');\n\n            request(method, parseAjaxURI(href + getAjaxSuffix()), { title: trim(title) }, function(error, response) {\n                if (!response.body.success) {\n                    modal.open({\n                        content: response.body.html || response.body,\n                        afterOpen: function(container) {\n                            if (!response.body.html) { container.style({ width: '90%' }); }\n                        }\n                    });\n\n                    element.data('title-editable', original).text(original);\n                } else {\n                    element.data('title', title).data('tip', title);\n\n                    // refresh ID label and actions buttons\n                    var dummy   = zen('div').html(response.body.outline),\n                        id      = dummy.find('h4 span:last-child'),\n                        actions = dummy.find('.outline-actions');\n\n                    element.parent('.card').find('h4 span:last-child').html(id.html());\n                    element.parent('.card').find('.outline-actions').html(actions.html());\n                }\n\n                parent.hideIndicator();\n                parent.find('[data-title-edit]').removeClass('disabled');\n            });\n        },\n\n        attachEditables = function(editables) {\n            if (!editables || !editables.length) { return; }\n            editables.forEach(function(editable) {\n                editable = $(editable);\n                editable.confWasAttached = true;\n                editable.on('title-edit-start', function() {\n                    editable.style('text-overflow', 'inherit');\n                });\n                editable.on('title-edit-end', updateTitle);\n            });\n        };\n\n    body.on('statechangeAfter', function(event, element) {\n        var editables = $('#configurations [data-title-editable]');\n        if (!editables) { return true; }\n\n        editables = editables.filter(function(editable) {\n            return (typeof $(editable).confWasAttached) === 'undefined';\n        });\n\n        attachEditables(editables);\n    });\n\n    attachEditables($('#configurations [data-title-editable]'));\n});\n\nmodule.exports = {};\n","\"use strict\";\nvar ready         = require('elements/domready'),\n    $             = require('elements/attributes'),\n    storage       = require('prime/map'),\n    deepEquals    = require('mout/lang/deepEquals'),\n    is            = require('mout/lang/is'),\n    isString      = require('mout/lang/isString'),\n    hasOwn        = require('mout/object/has'),\n    forEach       = require('mout/collection/forEach'),\n    invoke        = require('mout/array/invoke'),\n    History       = require('../utils/history'),\n    flags         = require('../utils/flags-state'),\n    submit        = require('./submit');\n\nrequire('./multicheckbox');\n\nvar originals,\n    collectFieldsValues = function(keys) {\n        var map      = new storage(),\n            defaults = $('[data-g-styles-defaults]'),\n            overridables = $('input[type=\"checkbox\"].settings-param-toggle');\n\n        defaults = defaults ? JSON.parse(defaults.data('g-styles-defaults')) : {};\n\n        // keep track of overrides getting enabled / disabled\n        // in order to detect if has changed\n        if (overridables) {\n            var overrides = {};\n\n            overridables.forEach(function(override) {\n                override = $(override);\n                overrides[override.id()] = override.checked();\n            });\n\n            map.set('__js__overrides', JSON.stringify(overrides));\n        }\n\n        if (keys) {\n            var field;\n            keys.forEach(function(key) {\n                field = $('[name=\"' + key + '\"]');\n                if (field) {\n                    map.set(key, field.value());\n                }\n            });\n\n            return map;\n        }\n\n        var fields = $('.settings-block [name]');\n        if (!fields) { return false; }\n\n        fields.forEach(function(field) {\n            field = $(field);\n            var key     = field.attribute('name'),\n                isInput = !hasOwn(defaults, key);\n\n            if (field.type() == 'checkbox' && !field.value().length) { field.value('0'); }\n            map.set(key, isInput ? field.value() : defaults[key]);\n        }, this);\n\n        return map;\n    },\n    createMapFrom       = function(data) {\n        var map = new storage();\n\n        forEach(data, function(value, key) {\n            map.set(key, value);\n        });\n\n        return map;\n    };\n\nvar compare = {\n    single: function() {},\n    whole: function() {},\n    blanks: function() {},\n    presets: function() {}\n};\n\nready(function() {\n    var body = $('body'), presetsCache;\n\n    originals = collectFieldsValues();\n\n    compare.single = function(event, element) {\n        var parent      = element.parent('.settings-param') || element.parent('h4') || element.parent('.input-group'),\n            target      = parent ? (parent.matches('h4') ? parent : parent.find('.settings-param-title, .g-instancepicker-title')) : null,\n            isOverride  = parent ? parent.find('.settings-param-toggle') : false,\n            isNewWidget = false,\n            isOverrideToggle = element.hasClass('settings-param-toggle');\n\n        if (!parent) { return; }\n\n        if (isOverrideToggle) {\n            return compare.whole('force');\n        }\n\n        if (element.type() == 'checkbox') {\n            element.value(Number(element.checked()).toString());\n        }\n\n        if (originals && originals.get(element.attribute('name')) == null) {\n            originals.set(element.attribute('name'), element.value());\n            isNewWidget = true;\n        }\n\n        if (!target || !originals || originals.get(element.attribute('name')) == null) { return; }\n        if (originals.get(element.attribute('name')) !== element.value() || isNewWidget) {\n            if (isOverride && event.forceOverride && !isOverride.checked()) { isOverride[0].click(); }\n            target.showIndicator('changes-indicator font-small fa fa-circle-o fa-fw');\n        } else {\n            if (isOverride && event.forceOverride && isOverride.checked()) { isOverride[0].click(); }\n            target.hideIndicator();\n        }\n\n        compare.blanks(event, parent.find('.settings-param-field'));\n        compare.whole('force');\n        compare.presets();\n    };\n\n    compare.whole = function(force) {\n        if (!originals) { return; }\n        var equals = deepEquals(originals, collectFieldsValues(force ? originals.keys() : null), function(a, b) {\n                if (isString(a) && isString(b) && a.substr(0, 1) == '#' && b.substr(0, 1) == '#') {\n                    return a.toLowerCase() == b.toLowerCase();\n                } else {\n                    return is(a, b);\n                }\n            }),\n            save   = $('[data-save]');\n\n        if (!save) { return; }\n\n        flags.set('pending', !equals);\n        save[equals ? 'hideIndicator' : 'showIndicator']('changes-indicator fa fa-circle-o fa-fw');\n    };\n\n    compare.blanks = function(event, element) {\n        if (!element) { return; }\n        var field = element.find('[name]'),\n            reset = element.find('.g-reset-field');\n        if (!field || !reset) { return true; }\n\n        var value = field.value();\n        if (!value || field.disabled()) { reset.style('display', 'none'); }\n        else { reset.removeAttribute('style'); }\n    };\n\n    compare.presets = function() {\n        var presets = $('[data-g-styles]'), store;\n        if (!presets) { return; }\n\n        if (!presetsCache) {\n            presetsCache = new storage();\n            forEach(presets, function(preset, index) {\n                preset = $(preset);\n                store = {\n                    index: index,\n                    map: createMapFrom(JSON.parse(preset.data('g-styles')))\n                };\n                presetsCache.set(preset, store);\n            });\n        }\n\n        var fields, equals;\n        presetsCache.forEach(function(data, element) {\n            fields = collectFieldsValues(data.map.keys());\n\n            // Do not consider __js__overrides when comparing for equality\n            fields.unset('__js__overrides');\n\n            equals = deepEquals(fields, data.map, function(a, b) { return a == b; });\n            $($('[data-g-styles]')[data.index]).parent()[equals ? 'addClass' : 'removeClass']('g-preset-match');\n        });\n    };\n\n    body.delegate('input', '.settings-block input[name][type=\"text\"], .settings-block textarea[name]', compare.single);\n    body.delegate('change', '.settings-block input[name][type=\"hidden\"], .settings-block input[name][type=\"checkbox\"], .settings-block select[name], .settings-block .selectized[name], .settings-block input[id][type=\"checkbox\"].settings-param-toggle', compare.single);\n\n    body.delegate('input', '.g-urltemplate', function(event, element) {\n        var previous = element.parent('.settings-param').siblings();\n        if (!previous) { return; }\n\n        previous = previous.find('[data-g-urltemplate]');\n\n        if (previous) {\n            var template = previous.data('g-urltemplate');\n            previous.attribute('href', template.replace(/#ID#/g, element.value()));\n        }\n    });\n\n    // fields resets\n    body.delegate('mouseenter', '.settings-param-field', compare.blanks, true);\n    body.delegate('click', '.g-reset-field', function(e, element) {\n        var parent = element.parent('.settings-param-field'), field;\n        if (!parent) { return; }\n\n        field = parent.find('[name]');\n        if (field && !field.disabled()) {\n            var selectize = field.selectizeInstance;\n            if (selectize) { selectize.setValue(''); }\n            else { field.value(''); }\n\n            field.emit('change');\n            body.emit('input', { target: field });\n            body.emit('keyup', { target: field });\n        }\n    });\n\n    body.on('statechangeEnd', function() {\n        var State = History.getState();\n        body.emit('updateOriginalFields');\n    });\n\n    body.on('updateOriginalFields', function() {\n        originals = collectFieldsValues();\n        compare.presets();\n    });\n\n    // force a presets comparison check\n    compare.presets();\n});\n\nmodule.exports = {\n    compare: compare,\n    collect: collectFieldsValues,\n    submit: submit\n};\n","\"use strict\";\nvar $        = require('elements/attributes'),\n    ready    = require('elements/domready'),\n    remove   = require('mout/array/remove'),\n    insert   = require('mout/array/insert'),\n    contains = require('mout/array/contains');\n\n\nready(function() {\n    var body = $('body');\n\n    body.delegate('change', '.input-multicheckbox .input-group input[name][type=\"hidden\"]', function(event, element) {\n        var name = element.attribute('name'),\n            values = element.value().split(','),\n            fields = $('[data-multicheckbox-field=\"' + name +'\"]');\n\n        if (fields) {\n            fields.forEach(function(field) {\n                field = $(field);\n                if (field.checked()) { insert(values, field.value()); }\n                if (!field.checked()) { remove(values, field.value()); }\n            });\n        }\n\n        element.value(values.filter(String).join(','));\n    });\n\n    body.delegate('change', '.input-multicheckbox .input-group input[data-multicheckbox-field][type=\"checkbox\"]', function(event, element) {\n        var field     = $('[name=\"' + element.data('multicheckbox-field') + '\"]'),\n            value     = element.value(),\n            values    = field.value().split(','),\n            isChecked = element.checked();\n\n        if (isChecked) { insert(values, value); }\n        if (!isChecked) { remove(values, value); }\n\n        field.value(values.filter(String).join(','));\n\n        body.emit('change', {target: field});\n    });\n});\n\n","'use strict';\n\nvar $             = require('elements'),\n    isArray       = require('mout/lang/isArray'),\n    contains      = require('mout/array/contains'),\n    trim          = require('mout/string/trim'),\n    validateField = require('../utils/field-validation');\n\nvar submit = function(elements, container, options) {\n    var valid   = [],\n        invalid = [];\n\n    elements = $(elements);\n    container = $(container);\n    options = options || {};\n\n    $(elements).forEach(function(input) {\n        input = $(input);\n        var name = input.attribute('name'),\n            type = input.attribute('type');\n        if (!name || input.disabled() || (type == 'radio' && !input.checked())) { return; }\n\n        input = container.find('[name=\"' + name + '\"]' + (type == 'radio' ? ':checked' : ''));\n\n        // workaround for checkboxes trick that has both a hidden and checkbox field\n        if (type === 'checkbox' && container.find('[type=\"hidden\"][name=\"' + name + '\"]')) {\n            input = container.find('[name=\"' + name + '\"][type=\"checkbox\"]');\n        }\n\n        if (input) {\n            var value    = input.type() == 'checkbox' ? Number(input.checked()) : input.value(),\n                parent   = input.parent('.settings-param'),\n                override = parent ? parent.find('> input[type=\"checkbox\"]') : null;\n\n            override = override || $(input.data('override-target'));\n\n            if (contains(['select', 'select-multiple'], input.type()) && input.attribute('multiple')) {\n                value = (input.search('option[selected]') || []).map(function(selection) {\n                    return $(selection).value();\n                });\n            }\n\n            if (override && !override.checked()) { return; }\n            if (!validateField(input)) { invalid.push(input); }\n\n            if (isArray(value)) {\n                value.forEach(function(selection) {\n                    valid.push(name + '[]=' + encodeURIComponent(selection));\n                });\n            } else {\n                if (!options.submitUnchecked || (input.type() != 'checkbox' || (input.type() == 'checkbox' && !!value))) {\n                    valid.push(name + '=' + encodeURIComponent(value));\n                }\n            }\n        }\n    });\n\n    var titles = container.search('h4 [data-title-editable]'), key;\n    if (titles) {\n        titles.forEach(function(title) {\n            title = $(title);\n            if (title.parent('[data-collection-template]')) { return; }\n\n            key = title.data('collection-key') || (options.isRoot ? 'settings[title]' : 'title');\n            valid.push(key + '=' + encodeURIComponent(trim(title.data('title-editable'))));\n        });\n    }\n\n    return { valid: valid, invalid: invalid };\n};\n\nmodule.exports = submit;","\"use strict\";\n// deprecated (5.2.0)\nvar prime      = require('prime'),\n    $          = require('elements'),\n    Base       = require('./base'),\n    zen        = require('elements/zen'),\n    getAjaxURL = require('../../utils/get-ajax-url').config;\n\nvar Atom = new prime({\n    inherits: Base,\n    options: {\n        type: 'atom'\n    },\n\n    constructor: function(options) {\n        Base.call(this, options);\n\n        this.on('changed', this.hasChanged);\n    },\n\n    updateTitle: function(title) {\n        this.block.find('.title').text(title);\n        this.setTitle(title);\n        return this;\n    },\n\n    layout: function() {\n        var settings_uri = getAjaxURL(this.getPageId() + '/layout/' + this.getType() + '/' + this.getId()),\n            subtype      = this.getSubType() ? 'data-lm-blocksubtype=\"' + this.getSubType() + '\"' : '';\n        return '<div class=\"' + this.getType() + '\" data-lm-id=\"' + this.getId() + '\" data-lm-blocktype=\"' + this.getType() + '\" ' + subtype + '><span><span class=\"title\">' + this.getTitle() + '</span><span class=\"font-small\">' + (this.getSubType() || this.getKey() || this.getType()) + '</span></span><div class=\"float-right\"><i aria-label=\"Configure Atom Settings\" class=\"fa fa-cog\" data-lm-nodrag data-lm-nodrag data-lm-settings=\"' + settings_uri + '\"></i></div></div>';\n    },\n\n    hasChanged: function(state, parent) {\n        var icon = this.block.find('span > i.changes-indicator:first-child');\n\n        // if the particle has changes but the parent block doesn't, we want to keep the indicator showing\n        if (icon && parent && !parent.changeState) { return; }\n\n        this.block[state ? 'addClass' : 'removeClass']('block-has-changes');\n\n        if (!state && icon) { icon.remove(); }\n        if (state && !icon) { zen('i.fa.fa-circle-o.changes-indicator').before(this.block.find('.icon')); }\n    },\n\n    onRendered: function(element, parent) {\n        var globally_disabled = $('[data-lm-disabled][data-lm-subtype=\"' + this.getSubType() + '\"]');\n\n        if (globally_disabled || this.getAttribute('enabled') === 0) { this.disable(); }\n    }\n});\n\nmodule.exports = Atom;\n","\"use strict\";\n// deprecated (5.2.0)\nvar prime   = require('prime'),\n    $       = require('elements'),\n    zen     = require('elements/zen'),\n    bind    = require('mout/function/bind'),\n    Section = require('./section');\n\nvar Atoms = new prime({\n    inherits: Section,\n    options: {\n        type: 'atoms',\n        attributes: {\n            name: \"Atoms Section\"\n        }\n    },\n\n    layout: function() {\n        this.deprecated = '<div class=\"atoms-notice\">Looking for Atoms? To make it easier we moved them in the <a href=\"#\"><i class=\"fa fa-fw fa-list-alt\"></i> Page Settings</a>.</div>';\n\n        return '<div class=\"atoms-section\" style=\"display: none;\" data-lm-id=\"' + this.getId() + '\" data-lm-blocktype=\"' + this.getType() + '\"><div class=\"section-header clearfix\"><h4 class=\"float-left\">' + (this.getAttribute('name')) + '</h4></div></div>';\n    },\n\n    getId: function() {\n        return this.id || (this.id = this.options.type);\n    },\n\n    onDone: function(event) {\n        // Gantry 5.2.0: Remove atoms section if empty to keep the layout clear\n        if (!this.block.search('[data-lm-blocktype=\"atom\"]')) {\n            var ids = [this.getId()], segments = this.block.search('[data-lm-id]');\n            if (segments) {\n                segments.forEach(function(element) {\n                    ids.push($(element).data('lm-id'));\n                });\n            }\n\n            ids.reverse().forEach(bind(function(id) {\n                this.options.builder.remove(id);\n            }, this));\n\n            this.block.empty()[0].outerHTML = this.deprecated;\n            this._attachRedirect();\n\n            return;\n        }\n\n        if (!this.block.search('[data-lm-id]')) {\n            this.grid.insert(this.block, 'bottom');\n            this.options.builder.add(this.grid);\n        }\n\n        zen('div').html(this.deprecated).firstChild().after(this.block);\n\n        this._attachRedirect();\n    },\n\n    _attachRedirect: function() {\n        var item = $('[data-g5-nav=\"page\"]');\n        if (!item) { return; }\n\n        $('.atoms-notice a').on('click', function(event) {\n            event.preventDefault();\n            $('body').emit('click', { target: item });\n        });\n    }\n});\n\nmodule.exports = Atoms;\n","\"use strict\";\nvar prime     = require('prime'),\n    Options   = require('prime-util/prime/options'),\n    Bound     = require('prime-util/prime/bound'),\n    Emitter   = require('prime/emitter'),\n    zen       = require('elements/zen'),\n    trim      = require('mout/string/trim'),\n    $         = require('elements'),\n    ID        = require('../id'),\n\n    size      = require('mout/object/size'),\n    get       = require('mout/object/get'),\n    has       = require('mout/object/has'),\n    set       = require('mout/object/set'),\n    translate = require('../../utils/translate'),\n    getCurrentOutline  = require('../../utils/get-outline').getCurrentOutline;\n\nrequire('elements/traversal');\n\nvar Base = new prime({\n    mixin: [Bound, Options],\n    inherits: Emitter,\n    options: {\n        subtype: false,\n        attributes: {},\n        inherit: {}\n    },\n    constructor: function(options) {\n        this.setOptions(options);\n\n        this.fresh = !this.options.id;\n        this.id = this.options.id || ID(this.options);\n        this.attributes = this.options.attributes || {};\n        this.inherit = this.options.inherit || {};\n\n        this.block = zen('div').html(this.layout()).firstChild();\n\n        this.on('rendered', this.bound('onRendered'));\n\n        return this;\n    },\n\n    guid: function() {\n        return guid();\n    },\n\n    getId: function() {\n        return this.id || (this.id = ID(this.options));\n    },\n\n    getType: function() {\n        return this.options.type || '';\n    },\n\n    getSubType: function() {\n        return this.options.subtype || '';\n    },\n\n    getTitle: function() {\n        return trim(this.options.title || 'Untitled');\n    },\n\n    setTitle: function(title) {\n        this.options.title = trim(title || 'Untitled');\n        return this;\n    },\n\n    getKey: function() {\n        return '';\n    },\n\n    getPageId: function() {\n        var root = $('[data-lm-root]');\n        if (!root) return 'data-root-not-found';\n\n        return root.data('lm-page');\n    },\n\n    getAttribute: function(key) {\n        return get(this.attributes, key);\n    },\n\n    getAttributes: function() {\n        return this.attributes || {};\n    },\n\n    getInheritance: function() {\n        return this.inherit || {};\n    },\n\n    updateTitle: function() {\n        return this;\n    },\n\n    setAttribute: function(key, value) {\n        set(this.attributes, key, value);\n        return this;\n    },\n\n    setAttributes: function(attributes) {\n        this.attributes = attributes;\n\n        return this;\n    },\n\n    setInheritance: function(inheritance) {\n        this.inherit = inheritance;\n\n        return this;\n    },\n\n    hasAttribute: function(key) {\n        return has(this.attributes, key);\n    },\n\n    enableInheritance: function() {},\n\n    disableInheritance: function() {},\n\n    refreshInheritance: function() {},\n\n    hasInheritance: function() {\n        return size(this.inherit) && this.inherit.outline != getCurrentOutline();\n    },\n\n    disable: function() {\n        this.block.title(translate('GANTRY5_PLATFORM_JS_LM_DISABLED_PARTICLE', 'particle'));\n        this.block.addClass('particle-disabled');\n    },\n\n    enable: function() {\n        this.block.removeAttribute('title');\n        this.block.removeClass('particle-disabled');\n    },\n\n    insert: function(target, location) {\n        this.block[location || 'after'](target);\n        return this;\n    },\n\n    adopt: function(element) {\n        element.insert(this.block);\n        return this;\n    },\n\n    isNew: function(fresh) {\n        if (typeof fresh !== 'undefined') {\n            this.fresh = !!fresh;\n        }\n        return this.fresh;\n    },\n\n    dropzone: function() {\n        return 'data-lm-dropzone';\n    },\n\n    addDropzone: function() {\n        this.block.data('lm-dropzone', true);\n    },\n\n    removeDropzone: function() {\n        this.block.data('lm-dropzone', null);\n    },\n\n    layout: function() {},\n\n    onRendered: function() {},\n\n    setLayout: function(layout) {\n        this.block = layout;\n        return this;\n    },\n\n    getLimits: function() {\n        return false;\n    }\n});\n\nmodule.exports = Base;\n","\"use strict\";\nvar prime     = require('prime'),\n    Base      = require('./base'),\n    $         = require('../../utils/elements.utils'),\n    zen       = require('elements/zen'),\n    precision = require('mout/number/enforcePrecision'),\n    bind      = require('mout/function/bind');\n\nvar Block = new prime({\n    inherits: Base,\n    options: {\n        type: 'block',\n        attributes: {\n            size: 100\n        }\n    },\n\n    constructor: function(options) {\n        Base.call(this, options);\n        if (options.attributes && options.attributes.size) this.setAttribute('size', precision(options.attributes.size, 1));\n\n        this.on('changed', this.hasChanged);\n    },\n\n    getSize: function() {\n        return precision(this.getAttribute('size'), 1);\n    },\n\n    setSize: function(size, store) {\n        size = typeof size === 'undefined' ? this.getSize() : Math.max(0, Math.min(100, parseFloat(size)));\n        size = precision(size, 1);\n        if (store) {\n            this.setAttribute('size', size);\n        }\n\n        $(this.block).style({\n            flex: '0 1 ' + size + '%',\n            '-webkit-flex': '0 1 ' + size + '%',\n            '-ms-flex': '0 1 ' + size + '%'\n        });\n\n        this.emit('resized', size, this);\n    },\n\n    setAnimatedSize: function(size, store) {\n        size = typeof size === 'undefined' ? this.getSize() : Math.max(0, Math.min(100, parseFloat(size)));\n        size = precision(size, 1);\n        if (store) {\n            this.setAttribute('size', size);\n        }\n        $(this.block).animate({\n            flex: '0 1 ' + size + '%',\n            '-webkit-flex': '0 1 ' + size + '%',\n            '-ms-flex': '0 1 ' + size + '%'\n        }, bind(function() {\n            this.block.attribute('style', null);\n            this.setSize(size);\n        }, this));\n\n        this.emit('resized', size, this);\n    },\n\n    setLabelSize: function(size) {\n        var label = this.block.find('> .particle-size');\n        if (!label) { return false; }\n\n        label.text(precision(size, 1) + '%');\n    },\n\n    layout: function() {\n        return '<div class=\"g-block\" data-lm-id=\"' + this.getId() + '\"' + this.dropzone() + ' data-lm-blocktype=\"block\"></div>';\n    },\n\n    onRendered: function(element, parent) {\n        if (element.block.find('> [data-lm-blocktype=\"section\"]')) {\n            this.removeDropzone();\n        }\n\n        if (!parent) { return; }\n\n        var grandpa = parent.block.parent();\n        if (grandpa.data('lm-root') || (grandpa.data('lm-blocktype') == 'container' && (grandpa.parent().data('lm-root') || grandpa.parent().data('lm-blocktype') == 'wrapper'))) {\n            zen('span.particle-size').text(this.getSize() + '%').top(element.block);\n            element.on('resized', this.bound('onResize'));\n        }\n    },\n\n    onResize: function(resize) {\n        this.setLabelSize(resize);\n    },\n\n    hasChanged: function(state) {\n        var icon,\n            child = this.block.find('> [data-lm-id]:not([data-lm-blocktype=\"section\"]):not([data-lm-blocktype=\"container\"])');\n\n        this.changeState = state;\n\n        if (!child) {\n            child = this.block.find('> .particle-size') || this.block.parent('[data-lm-blocktype=\"block\"]').find('> .particle-size');\n            icon = child.find('i:first-child');\n\n            if (!state && icon) { icon.remove(); }\n            if (state && !icon) { zen('i.fa.fa-circle-o.changes-indicator').top(child); }\n\n            return;\n        }\n\n        var mapped = this.options.builder.get(child.data('lm-id'));\n        if (mapped) { mapped.emit('changed', state, this); }\n    }\n});\n\nmodule.exports = Block;\n","\"use strict\";\nvar prime      = require('prime'),\n    Base       = require('./base'),\n    zen        = require('elements/zen'),\n    $          = require('elements'),\n    getAjaxURL = require('../../utils/get-ajax-url').config,\n    translate  = require('../../utils/translate');\n\nvar Container = new prime({\n    inherits: Base,\n    options: {\n        type: 'container'\n    },\n\n    constructor: function(options) {\n        Base.call(this, options);\n        this.on('changed', this.hasChanged);\n    },\n\n    layout: function() {\n        return '<div class=\"g-lm-container\" data-lm-id=\"' + this.getId() + '\" data-lm-blocktype=\"container\"></div>';\n    },\n\n    onRendered: function(element, parent) {\n        if (!parent) {\n            this.addSettings(element);\n        }\n    },\n\n    hasChanged: function(state, child) {\n        var icon = this.block.find('span.title > i:first-child');\n\n        // if the the event is triggered from a grid we need to be cautious not to override the proper state\n        if (icon && child && !child.changeState) { return; }\n\n        this.block[state ? 'addClass' : 'removeClass']('block-has-changes');\n\n        if (!state && icon) { icon.remove(); }\n        if (state && !icon) {\n            var title = this.block.find('span.title');\n            if (title) { zen('i.fa.fa-circle-o.changes-indicator').top(title); }\n        }\n    },\n\n    addSettings: function(container) {\n        var settings_uri = getAjaxURL(this.getPageId() + '/layout/' + this.getType() + '/' + this.getId()),\n            wrapper      = zen('div.container-wrapper.clearfix').top(container.block),\n            title        = zen('div.container-title').bottom(wrapper),\n            actions      = zen('div.container-actions').bottom(wrapper);\n\n        title.html('<span class=\"title\">' + this.getType() + '</span>');\n        actions.html('<span data-tip=\"' + translate('GANTRY5_PLATFORM_JS_LM_SETTINGS', 'Container') + '\" data-tip-place=\"top-left\"><i aria-label=\"' + translate('GANTRY5_PLATFORM_JS_LM_CONFIGURE_SETTINGS', 'Container') + '\" class=\"fa fa-cog\" data-lm-settings=\"' + settings_uri + '\"></i></span>');\n    }\n});\n\nmodule.exports = Container;\n","\"use strict\";\nvar prime      = require('prime'),\n    Base       = require('./base'),\n    $          = require('elements'),\n    getAjaxURL = require('../../utils/get-ajax-url').config;\n\nvar Grid = new prime({\n    inherits: Base,\n    options: {\n        type: 'grid'\n    },\n\n    constructor: function(options) {\n        Base.call(this, options);\n\n        this.on('changed', this.hasChanged);\n    },\n\n    layout: function() {\n        return '<div class=\"g-grid nowrap\" data-lm-id=\"' + this.getId() + '\" ' + this.dropzone() + '  data-lm-samewidth data-lm-blocktype=\"grid\"></div>';\n    },\n\n    onRendered: function() {\n        var parent = this.block.parent();\n        if (parent && parent.data('lm-blocktype') == 'atoms') {\n            this.block.removeClass('nowrap');\n        }\n\n        if (parent && parent.data('lm-root') || (parent.data('lm-blocktype') == 'container' && parent.parent().data('lm-root'))) {\n            this.removeDropzone();\n        }\n    },\n\n    hasChanged: function(state) {\n        // Grids don't have room for an indicator so we forward it to the parent Section\n        var parent = this.block.parent('[data-lm-blocktype=\"section\"]'),\n            id = parent ? parent.data('lm-id') : false;\n\n        this.changeState = state;\n\n        if (!parent || !id) { return; }\n\n        if (this.options.builder) { this.options.builder.get(id).emit('changed', state, this); }\n    }\n});\n\nmodule.exports = Grid;\n","module.exports = {\n    base: require('./base'),\n    atom: require('./atom'),\n    section: require('./section'),\n    offcanvas: require('./offcanvas'),\n    wrapper: require('./wrapper'),\n    atoms: require('./atoms'),\n    grid: require('./grid'),\n    container: require('./container'),\n    block: require('./block'),\n    particle: require('./particle'),\n    position: require('./position'),\n    system: require('./system'),\n    spacer: require('./spacer')\n};\n","\"use strict\";\nvar prime              = require('prime'),\n    Section            = require('./section'),\n\n    getAjaxURL         = require('../../utils/get-ajax-url').config,\n    getOutlineNameById = require('../../utils/get-outline').getOutlineNameById,\n    translate          = require('../../utils/translate');\n\nvar Offcanvas = new prime({\n    inherits: Section,\n    options: {\n        type: 'offcanvas',\n        attributes: {\n            name: \"Offcanvas Section\"\n        }\n    },\n\n    layout: function() {\n        var settings_uri = getAjaxURL(this.getPageId() + '/layout/' + this.getType() + '/' + this.getId()),\n            inheritance  = '',\n            klass        = '';\n\n        if (this.hasInheritance()) {\n            var outline = getOutlineNameById(this.inherit.outline);\n            inheritance = '<div class=\"g-inherit g-section-inherit\"><div class=\"g-inherit-content\">' + translate('GANTRY5_PLATFORM_INHERITING_FROM_X', '<strong>' + outline + '</strong>') + '</div></div>';\n            klass = ' g-inheriting g-inheriting-' + this.inherit.include.join(' g-inheriting-');\n        }\n\n        return '<div class=\"offcanvas-section' + klass + '\" data-lm-id=\"' + this.getId() + '\" data-lm-blocktype=\"' + this.getType() + '\"><div class=\"section-header clearfix\"><h4 class=\"float-left\" title=\"' + this.getAttribute('name') + '\">' + this.getAttribute('name') + '</h4><div class=\"section-actions float-right\"><span data-tip=\"' + translate('GANTRY5_PLATFORM_JS_LM_ADD_ROW', 'Offcanvas') + '\" data-tip-place=\"top-right\"><i aria-label=\"' + translate('GANTRY5_PLATFORM_JS_LM_ADD_ROW', 'Offcanvas') + '\" class=\"fa fa-plus\"></i></span> <span class=\"section-settings\" data-tip=\"' + translate('GANTRY5_PLATFORM_JS_LM_SETTINGS', 'Offcanvas') + '\" data-tip-place=\"top-right\"><i aria-label=\"' + translate('GANTRY5_PLATFORM_JS_LM_CONFIGURE_SETTINGS', 'Offcanvas') + '\" class=\"fa fa-cog\" data-lm-settings=\"' + settings_uri + '\"></i></span></div></div>' + inheritance + '</div>';\n    },\n\n    getId: function() {\n        return this.id || (this.id = this.options.type);\n    }\n});\n\nmodule.exports = Offcanvas;\n","\"use strict\";\nvar prime              = require('prime'),\n    $                  = require('elements'),\n    Atom               = require('./atom'),\n    bind               = require('mout/function/bind'),\n    precision          = require('mout/number/enforcePrecision'),\n    forOwn             = require('mout/object/forOwn'),\n    getAjaxURL         = require('../../utils/get-ajax-url').config,\n    getOutlineNameById = require('../../utils/get-outline').getOutlineNameById,\n    translate          = require('../../utils/translate');\n\nvar UID = 0;\n\nvar Particle = new prime({\n    inherits: Atom,\n    options: {\n        type: 'particle'\n    },\n\n    constructor: function(options) {\n        ++UID;\n        Atom.call(this, options);\n    },\n\n    layout: function() {\n        var settings_uri = getAjaxURL(this.getPageId() + '/layout/' + this.getType() + '/' + this.getId()),\n            subtype      = this.getSubType() ? 'data-lm-blocksubtype=\"' + this.getSubType() + '\"' : '',\n            klass        = '';\n\n        if (this.hasInheritance()) {\n            klass = ' g-inheriting';\n            if (this.inherit.include.length) {\n                klass += ' g-inheriting-' + this.inherit.include.join(' g-inheriting-');\n            }\n        }\n\n        return '<div class=\"' + this.getType() + klass + '\" data-lm-id=\"' + this.getId() + '\" data-lm-blocktype=\"' + this.getType() + '\" ' + subtype + '><span><span class=\"icon\" ' + this.addInheritanceTip(true) + '><i class=\"fa ' + this.getIcon() + '\"></i></span><span class=\"title\">' + this.getTitle() + '</span><span class=\"font-small\">' + (this.getKey() || this.getSubType() || this.getType()) + '</span></span><div class=\"float-right\"><span class=\"particle-size\"></span> <i aria-label=\"' + translate('GANTRY5_PLATFORM_JS_LM_CONFIGURE_SETTINGS', 'Particle') + '\" class=\"fa fa-cog\" data-lm-nodrag data-lm-settings=\"' + settings_uri + '\"></i></div></div>';\n    },\n\n    enableInheritance: function() {\n        this.block.attribute('class', this.cleanKlass(this.block.attribute('class')));\n        if (this.hasInheritance()) {\n            var outline = getOutlineNameById(this.inherit.outline),\n                icon    = this.block.find('.icon');\n\n            this.block.addClass('g-inheriting');\n            if (this.inherit.include.length) {\n                this.block.addClass('g-inheriting-' + this.inherit.include.join(' g-inheriting-'));\n            }\n\n            this.block.find('.icon .fa').attribute('class', 'fa ' + this.getIcon());\n\n            forOwn(this.getInheritanceTip(), function(value, key) {\n                icon.data(key, value);\n            });\n\n            global.G5.tips.reload();\n        }\n    },\n\n    disableInheritance: function() {\n        var icon    = this.block.find('.icon');\n\n        this.block.attribute('class', this.cleanKlass(this.block.attribute('class')));\n        this.block.removeClass('g-inheriting');\n        this.block.find('.icon .fa').attribute('class', 'fa ' + this.getIcon());\n\n        forOwn(this.getInheritanceTip(), function(value, key) {\n            icon.data(key, null);\n        });\n\n        global.G5.tips.reload();\n    },\n\n    refreshInheritance: function() {\n        this.block[this.hasInheritance() ? 'removeClass' : 'addClass']('g-inheritance');\n        if (this.hasInheritance()) {\n            this.block.attribute('class', this.cleanKlass(this.block.attribute('class')));\n        }\n    },\n\n    addInheritanceTip: function(html) {\n        var tooltip = this.getInheritanceTip();\n\n        if (html) {\n            var tooltipHTML = '';\n            forOwn(tooltip, function(value, key) {\n                tooltipHTML += 'data-' + key + '=\"' + value + '\" ';\n            });\n\n            tooltip = tooltipHTML;\n        }\n\n        return this.hasInheritance() ? tooltip : '';\n    },\n\n    getInheritanceTip: function() {\n        var outline = getOutlineNameById(this.inherit ? this.inherit.outline : null),\n            particle = this.inherit.particle || '',\n            include = (this.inherit.include || []).join(', ');\n\n        return {\n            'tip': translate('GANTRY5_PLATFORM_INHERITING_FROM_X', '<strong>' + outline + '</strong>') + '<br />ID: ' + particle + '<br />Replace: ' + include,\n            'tip-offset': -10,\n            'tip-place': 'top-right'\n        };\n    },\n\n    cleanKlass: function(klass) {\n        klass = (klass || '').split(' ');\n\n        return klass.filter(function(item) { return !item.match(/^g-inheriting-/); }).join(' ');\n    },\n\n    setLabelSize: function(size) {\n        var label = this.block.find('.particle-size');\n        if (!label) { return false; }\n\n        label.text(precision(size, 1) + '%');\n    },\n\n    onRendered: function(element, parent) {\n        var size              = parent.getSize() || 100,\n            globally_disabled = $('[data-lm-disabled][data-lm-subtype=\"' + this.getSubType() + '\"]');\n\n        if (globally_disabled || this.getAttribute('enabled') === 0) { this.disable(); }\n\n        this.setLabelSize(size);\n        parent.on('resized', this.bound('onParentResize'));\n    },\n\n    getParent: function() {\n        var parent = this.block.parent('[data-lm-id]');\n\n        return this.options.builder.get(parent.data('lm-id'));\n    },\n\n    onParentResize: function(resize) {\n        this.setLabelSize(resize);\n    },\n\n    getIcon: function() {\n        if (this.hasInheritance()) {\n            return 'fa-lock';\n        }\n\n        var type     = this.getType(),\n            subtype  = this.getSubType(),\n            template = $('.particles-container [data-lm-blocktype=\"' + type + '\"][data-lm-subtype=\"' + subtype + '\"]');\n\n        return template ? template.data('lm-icon') : 'fa-cube';\n    },\n\n    getLimits: function(parent) {\n        if (!parent) { return false; }\n\n        var sibling = parent.block.nextSibling() || parent.block.previousSibling() || false;\n\n        if (!sibling) { return [100, 100]; }\n\n        var siblingBlock = this.options.builder.get(sibling.data('lm-id')),\n            sizes        = {\n                current: this.getParent().getSize(),\n                sibling: siblingBlock.getSize()\n            };\n\n        return [5, (sizes.current + sizes.sibling) - 5];\n    }\n});\n\nmodule.exports = Particle;\n","\"use strict\";\nvar prime    = require('prime'),\n    trim     = require('mout/string/trim'),\n    Particle = require('./particle');\n\nvar UID = 0;\n\nvar Position = new prime({\n    inherits: Particle,\n    options: {\n        type: 'position'\n    },\n\n    constructor: function(options) {\n        ++UID;\n        Particle.call(this, options);\n        this.setAttribute('title', this.getTitle());\n        this.setAttribute('key', this.getKey());\n\n        if (this.isNew()) { --UID; }\n    },\n\n    getTitle: function() {\n        return trim(this.options.title || 'Position ' + UID);\n    },\n\n    getKey: function() {\n        return (this.getAttribute('key') || trim(this.getTitle()).replace(/\\s/g, '-').toLowerCase());\n    },\n\n    updateKey: function(key) {\n        this.options.key = key || this.getKey();\n        this.block.find('.font-small').text(this.getKey());\n        return this;\n    },\n});\n\nmodule.exports = Position;\n","\"use strict\";\nvar prime              = require('prime'),\n    Base               = require('./base'),\n    Bound              = require('prime-util/prime/bound'),\n    Grid               = require('./grid'),\n    $                  = require('elements'),\n    zen                = require('elements/zen'),\n\n    bind               = require('mout/function/bind'),\n    forOwn             = require('mout/object/forOwn'),\n    getAjaxURL         = require('../../utils/get-ajax-url').config,\n    getOutlineNameById = require('../../utils/get-outline').getOutlineNameById,\n    translate          = require('../../utils/translate');\n\nrequire('elements/insertion');\n\nvar UID = 0;\n\nvar Section = new prime({\n    inherits: Base,\n    options: {},\n\n    constructor: function(options) {\n        ++UID;\n        this.grid = new Grid();\n        Base.call(this, options);\n\n        this.on('done', this.bound('onDone'));\n        this.on('changed', this.hasChanged);\n    },\n\n    layout: function() {\n        var settings_uri     = getAjaxURL(this.getPageId() + '/layout/' + this.getType() + '/' + this.getId()),\n            inheritanceLabel = '',\n            klass            = '';\n\n        if (this.hasInheritance()) {\n            var outline = getOutlineNameById(this.inherit.outline);\n            inheritanceLabel = this.renderInheritanceLabel(outline);\n            klass = ' g-inheriting';\n\n            if (this.inherit.include.length) {\n                klass += ' g-inheriting-' + this.inherit.include.join(' g-inheriting-');\n            }\n        }\n\n        return '<div class=\"section' + klass + '\" data-lm-id=\"' + this.getId() + '\" data-lm-blocktype=\"' + this.getType() + '\" data-lm-blocksubtype=\"' + this.getSubType() + '\"><div class=\"section-header clearfix\"><h4 class=\"float-left\" title=\"' + this.getTitle() + '\">' + this.getTitle() + '</h4><div class=\"section-actions float-right\"><span class=\"section-addrow\" data-tip=\"' + translate('GANTRY5_PLATFORM_JS_LM_ADD_ROW', 'Section') + '\" data-tip-place=\"top-right\"><i aria-label=\"' + translate('GANTRY5_PLATFORM_JS_LM_ADD_ROW', 'Section') + '\" class=\"fa fa-plus\"></i></span> <span class=\"section-settings\" data-tip=\"' + translate('GANTRY5_PLATFORM_JS_LM_SETTINGS', 'Section') + '\" data-tip-place=\"top-right\"><i aria-label=\"' + translate('GANTRY5_PLATFORM_JS_LM_CONFIGURE_SETTINGS', 'Section') + '\" class=\"fa fa-cog\" data-lm-settings=\"' + settings_uri + '\"></i></span></div></div>' + inheritanceLabel + '</div>';\n    },\n\n    adopt: function(child) {\n        $(child).insert(this.block.find('.g-grid'));\n    },\n\n    renderInheritanceLabel: function(outline) {\n        var content = translate('GANTRY5_PLATFORM_INHERITING_FROM_X', '<strong>' + outline + '</strong>');\n\n        if (this.block && this.getParent()) {\n            content = '';\n        }\n\n        return '<div class=\"g-inherit g-section-inherit\"><div class=\"g-inherit-content\" ' + this.addInheritanceTip(true) + '><i class=\"fa fa-lock\"></i> ' + content + '</div></div>';\n    },\n\n    enableInheritance: function() {\n        if (this.hasInheritance()) {\n            this.block.attribute('class', this.cleanKlass(this.block.attribute('class')));\n            this.block.addClass('g-inheriting');\n            if (this.inherit.include.length) {\n                this.block.addClass('g-inheriting-' + this.inherit.include.join(' g-inheriting-'));\n            }\n\n            if (!this.block.find('> .g-inherit')) {\n                var inherit = zen('div'),\n                    outline = getOutlineNameById(this.inherit.outline),\n                    html    = this.renderInheritanceLabel(outline);\n\n                inherit.html(html).children().after(this.block.find('> .section-header'));\n            }\n        }\n    },\n\n    disableInheritance: function() {\n        if (this.block.find('> .g-inherit')) {\n            var inherit = this.block.find('> .g-inherit.g-section-inherit');\n            if (inherit) {\n                inherit.remove();\n            }\n        }\n\n        this.block.attribute('class', this.cleanKlass(this.block.attribute('class')));\n        this.block.removeClass('g-inheriting');\n    },\n\n    refreshInheritance: function() {\n        this.block.attribute('class', this.cleanKlass(this.block.attribute('class')));\n        if (this.hasInheritance()) {\n            this.enableInheritance();\n            var overlay = this.block.find('> .g-inherit');\n            if (overlay) {\n                var outline = getOutlineNameById(this.inherit.outline),\n                    content = zen('div').html(this.renderInheritanceLabel(outline));\n\n                if (overlay && content) { overlay.html(content.children().html()); }\n            }\n        }\n    },\n\n    addInheritanceTip: function(html) {\n        var tooltip = this.getInheritanceTip();\n\n        if (html) {\n            var tooltipHTML = '';\n            forOwn(tooltip, function(value, key) {\n                tooltipHTML += 'data-' + key + '=\"' + value + '\" ';\n            });\n\n            tooltip = tooltipHTML;\n        }\n\n        return this.hasInheritance() ? tooltip : '';\n    },\n\n    getInheritanceTip: function() {\n        var outline = this.inherit ? this.inherit.outline : null,\n            name    = getOutlineNameById(outline),\n            include = (this.inherit.include || []).join(', ');\n\n        return {\n            'tip': translate('GANTRY5_PLATFORM_INHERITING_FROM_X', '<strong>' + name + '</strong>') + '<br />Outline ID: ' + outline + '<br />Replace: ' + include,\n            'tip-offset': -2,\n            'tip-place': 'top-right'\n        };\n    },\n\n    cleanKlass: function(klass) {\n        klass = (klass || '').split(' ');\n\n        return klass.filter(function(item) { return !item.match(/^g-inheriting-/); }).join(' ');\n    },\n\n    hasChanged: function(state, child) {\n        var icon = this.block.find('h4 > i:first-child');\n\n        // if the the event is triggered from a grid we need to be cautious not to override the proper state\n        if (icon && child && !child.changeState) { return; }\n\n        this.block[state ? 'addClass' : 'removeClass']('block-has-changes');\n\n        if (!state && icon) { icon.remove(); }\n        if (state && !icon) { zen('i.fa.fa-circle-o.changes-indicator').top(this.block.find('h4')); }\n    },\n\n    onDone: function(event) {\n        if (!this.block.search('[data-lm-id]')) {\n            this.grid.insert(this.block, 'bottom');\n            this.options.builder.add(this.grid);\n        }\n\n        var plus = this.block.find('.fa-plus');\n        if (plus) {\n            plus.on('click', bind(function(e) {\n                if (e) { e.preventDefault(); }\n\n                if (this.block.find('.g-grid:last-child:empty')) { return false; }\n\n                this.grid = new Grid();\n                this.grid.insert(this.block.find('[data-lm-blocktype=\"container\"]') ? this.block.find('[data-lm-blocktype=\"container\"]') : this.block, 'bottom');\n                this.options.builder.add(this.grid);\n            }, this));\n        }\n\n        this.refreshInheritance();\n    },\n\n    getParent: function() {\n        var parent = this.block.parent('[data-lm-id]');\n\n        return parent ? this.options.builder.get(parent.data('lm-id')) : null;\n    },\n\n    getLimits: function(parent) {\n        if (!parent) { return false; }\n\n        var sibling = parent.block.nextSibling() || parent.block.previousSibling() || false;\n\n        if (!sibling) { return [100, 100]; }\n\n        var siblingBlock = this.options.builder.get(sibling.data('lm-id'));\n        if (siblingBlock.getType() !== 'block') { return false; }\n\n        var sizes = {\n            current: this.getParent().getSize(),\n            sibling: siblingBlock.getSize()\n        };\n\n        return [5, (sizes.current + sizes.sibling) - 5];\n    }\n});\n\nmodule.exports = Section;\n","\"use strict\";\nvar prime    = require('prime'),\n    Particle = require('./particle');\n\nvar UID = 0;\n\nvar Spacer = new prime({\n    inherits: Particle,\n    options: {\n        type: 'spacer',\n        title: 'Spacer',\n        attributes: {}\n    }\n});\n\nmodule.exports = Spacer;\n","\"use strict\";\nvar prime    = require('prime'),\n    Particle = require('./particle');\n\nvar System = new prime({\n    inherits: Particle,\n    options: {\n        type: 'system',\n        attributes: {}\n    }\n});\n\nmodule.exports = System;\n","\"use strict\";\nvar prime      = require('prime'),\n    Section    = require('./section'),\n\n    getAjaxURL = require('../../utils/get-ajax-url').config;\n\nvar Wrapper = new prime({\n    inherits: Section,\n    options: {\n        type: 'wrapper',\n        attributes: {\n            name: \"Wrapper\"\n        }\n    },\n\n    layout: function() {\n        var settings_uri = getAjaxURL(this.getPageId() + '/layout/' + this.getType() + '/' + this.getId());\n        return '<div class=\"wrapper-section\" data-lm-id=\"' + this.getId() + '\" data-lm-blocktype=\"' + this.getType() + '\" data-lm-blocksubtype=\"' + this.getSubType() + '\"></div>';\n    },\n\n    hasChanged: function() {},\n\n    getSize: function() {\n        return false;\n    },\n\n    getId: function() {\n        return this.id || (this.id = this.options.type);\n    }\n});\n\nmodule.exports = Wrapper;\n","\"use strict\";\nvar prime   = require('prime'),\n    $       = require('elements'),\n    Emitter = require('prime/emitter');\n\nvar Blocks = require('./blocks/');\n\nvar forOwn     = require('mout/object/forOwn'),\n    forEach    = require('mout/collection/forEach'),\n    size       = require('mout/collection/size'),\n    isArray    = require('mout/lang/isArray'),\n    flatten    = require('mout/array/flatten'),\n    ID         = require('./id'),\n\n    set        = require('mout/object/set'),\n    unset      = require('mout/object/unset'),\n    get        = require('mout/object/get'),\n    deepFillIn = require('mout/object/deepFillIn'),\n    omit       = require('mout/object/omit');\n\nrequire('elements/attributes');\nrequire('elements/traversal');\n\n\n// start Debug\nvar DEBUG  = false,\n    rpad   = require('mout/string/rpad'),\n    repeat = require('mout/string/repeat');\n// end   Debug\n\n$.implement({\n    empty: function() {\n        return this.forEach(function(node) {\n            var first;\n            while ((first = node.firstChild)) {\n                node.removeChild(first);\n            }\n        });\n    }\n});\n\nvar Builder = new prime({\n\n    inherits: Emitter,\n\n    constructor: function(structure) {\n        if (structure) {\n            this.setStructure(structure);\n        }\n        this.map = {};\n\n        return this;\n    },\n\n    setStructure: function(structure) {\n        try {\n            this.structure = (typeof structure === 'object') ? structure : JSON.parse(structure);\n        }\n        catch (e) {\n            console.error(\"Parsing error:\", e);\n        }\n    },\n\n    add: function(block) {\n        var id = typeof block === 'string' ? block : block.id;\n        set(this.map, id, block);\n        block.isNew(false);\n    },\n\n    remove: function(block) {\n        block = typeof block === 'string' ? block : block.id;\n        unset(this.map, block);\n    },\n\n    get: function(block) {\n        var id = typeof block === 'string' ? block : block.id;\n        return get(this.map, id, block);\n    },\n\n    load: function(data) {\n        this.recursiveLoad(data);\n        this.emit('loaded', data);\n\n        return this;\n    },\n\n    serialize: function(root, flat) {\n        var serieChildren = [];\n        root = root || $('[data-lm-root]');\n\n        if (!root) { return; }\n\n        var blocks = root.search((!flat ? '> ' : '') + '[data-lm-id]'),\n            id, type, subtype, serial, hasChildren, children;\n\n        forEach(blocks, function(element) {\n            element = $(element);\n            id = element.data('lm-id');\n            type = element.data('lm-blocktype');\n            subtype = element.data('lm-blocksubtype') || false;\n            hasChildren = element.search('> [data-lm-id]');\n\n            if (flat) {\n                children = hasChildren ? hasChildren.map(function(element){ return $(element).data('lm-id'); }) : false;\n            } else {\n                children = hasChildren ? this.serialize(element) : [];\n            }\n\n            serial = {\n                id: id,\n                type: type,\n                subtype: subtype,\n                title: get(this.map, id) ? get(this.map, id).getTitle() : 'Untitled',\n                attributes: get(this.map, id) ? get(this.map, id).getAttributes() : {},\n                inherit: get(this.map, id) ? get(this.map, id).getInheritance() : {},\n                children: children\n            };\n\n            if (flat) {\n                var obj = {}; obj[id] = serial;\n                serial = obj;\n            }\n\n            serieChildren.push(serial);\n        }, this);\n\n        return serieChildren;\n    },\n\n    insert: function(key, value, parent/*, object*/) {\n        var root = $('[data-lm-root]');\n        if (!root) {\n            return;\n        }\n\n        if (!Blocks[value.type]) {\n            console[console.error ? 'error' : 'log'](value.type + ' does not exist');\n        }\n\n        var Element = new (Blocks[value.type] || Blocks['section'])(deepFillIn({\n            id: key,\n            attributes: {},\n            inherit: {},\n            subtype: value.subtype || false,\n            builder: this\n        }, omit(value, 'children')));\n\n        if (!parent) {\n            Element.block.insert(root);\n        }\n        else {\n            Element.block.insert($('[data-lm-id=\"' + parent + '\"]'));\n        }\n\n        if (Element.getType() === 'block') {\n            Element.setSize();\n        }\n\n        this.add(Element);\n        Element.emit('rendered', Element, parent ? get(this.map, parent) : null);\n\n        return Element;\n    },\n\n    reset: function(data) {\n        this.map = {};\n        this.setStructure(data || {});\n        $('[data-lm-root]').empty();\n        this.load();\n    },\n\n    cleanupLonely: function() {\n        var ghosts = [],\n            parent, children = $('[data-lm-root] > .g-section > .g-grid > .g-block .g-grid > .g-block, [data-lm-root] > .g-section > .g-grid > .g-block > .g-block');\n\n        if (!children) {\n            return;\n        }\n\n\n        var isGrid;\n        children.forEach(function(child) {\n            child = $(child);\n            parent = null;\n            isGrid = child.parent().hasClass('g-grid');\n\n            if (isGrid && child.siblings()) {\n                return false;\n            }\n\n            if (isGrid) {\n                ghosts.push(child.data('lm-id'));\n                parent = child.parent();\n            }\n\n            ghosts.push(child.data('lm-id'));\n            child.children().before(parent ? parent : child);\n            (parent ? parent : child).remove();\n        });\n\n        return ghosts;\n    },\n\n    recursiveLoad: function(data, callback, depth, parent) {\n        data = data || this.structure;\n        depth = depth || 0;\n        parent = parent || false;\n        callback = callback || this.insert;\n\n        forEach(data, function(value/*, key, object*/) {\n\n            if (!value.id) {\n                value.id = ID({ builder: { map: this.map }, type: value.type, subtype: value.subtype });\n            }\n\n            // debug (flat view of the structure)\n            if (console && console.log && DEBUG) {\n                console.log(rpad(repeat('    ', depth) + '' + value.type, 35) + ' (' + rpad(value.id, 36) + ') parent: ' + parent);\n            }\n\n            this.emit('loading', callback.call(this, value.id, value, parent, depth));\n            if (value.children && size(value.children)) {\n                depth++;\n\n                forEach(value.children, function(childValue/*, childKey, array*/) {\n                    this.recursiveLoad([childValue], callback, depth, value.id);\n                }, this);\n            }\n\n            this.get(value.id).emit('done', this.get(value.id));\n\n            depth--;\n        }, this);\n    }\n});\n\nmodule.exports = Builder;\n","\"use strict\";\nvar DragEvents = require('../ui/drag.events'),\n    prime      = require('prime'),\n    Emitter    = require('prime/emitter'),\n    Bound      = require('prime-util/prime/bound'),\n    Options    = require('prime-util/prime/options'),\n    bind       = require('mout/function/bind'),\n    isString   = require('mout/lang/isString'),\n    nMap       = require('mout/math/map'),\n    clamp      = require('mout/math/clamp'),\n    precision  = require('mout/number/enforcePrecision'),\n    get        = require('mout/object/get'),\n    $          = require('../utils/elements.utils');\n\nrequire('elements/events');\nrequire('elements/delegation');\n\nvar Resizer = new prime({\n    mixin: [Bound, Options],\n    DRAG_EVENTS: DragEvents,\n    options: {\n        minSize: 5\n    },\n    constructor: function(container, options) {\n        this.setOptions(options);\n        this.history = this.options.history || {};\n        this.builder = this.options.builder || {};\n        this.origin = {\n            x: 0,\n            y: 0,\n            transform: null,\n            offset: {\n                x: 0,\n                y: 0\n            }\n        };\n    },\n\n    getBlock: function(element) {\n        return get(this.builder.map, isString(element) ? element : $(element).data('lm-id') || '');\n    },\n\n    getAttribute: function(element, prop) {\n        return this.getBlock(element).getAttribute(prop);\n    },\n\n    getSize: function(element) {\n        return this.getAttribute($(element), 'size');\n    },\n\n    start: function(event, element, siblings, offset) {\n        if (event && event.type.match(/^touch/i)) { event.preventDefault(); }\n\n        window.G5.tips.hide(element[0]);\n        if (event.which && event.which !== 1) { return true; }\n\n        // Stops text selection\n        event.preventDefault();\n\n        this.element = $(element);\n        this.siblings = {\n            occupied: 0,\n            elements: siblings,\n            next: this.element.nextSibling(),\n            prevs: this.element.previousSiblings(),\n            sizeBefore: 0\n        };\n\n        if (this.siblings.elements.length > 1) {\n            this.siblings.occupied -= this.getSize(this.siblings.next);\n            this.siblings.elements.forEach(function(sibling) {\n                this.siblings.occupied += this.getSize(sibling);\n            }, this);\n        }\n\n        if (this.siblings.prevs) {\n            this.siblings.prevs.forEach(function(sibling) {\n                this.siblings.sizeBefore += this.getSize(sibling);\n            }, this);\n        }\n\n        this.origin = {\n            size: this.getSize(this.element),\n            maxSize: this.getSize(this.element) + this.getSize(this.siblings.next),\n            x: event.changedTouches ? event.changedTouches[0].pageX : event.pageX + 6,\n            y: event.changedTouches ? event.changedTouches[0].pageY : event.pageY\n        };\n\n        var clientRect = this.element[0].getBoundingClientRect(),\n            parentRect = this.element.parent()[0].getBoundingClientRect();\n\n        this.origin.offset = {\n            clientRect: clientRect,\n            parentRect: {left: parentRect.left, right: parentRect.right},\n            x: this.origin.x - clientRect.right,\n            y: clientRect.top - this.origin.y,\n            down: offset\n        };\n\n        this.origin.offset.parentRect.left = this.element.parent().find('> [data-lm-id]:first-child')[0].getBoundingClientRect().left;\n        this.origin.offset.parentRect.right = this.element.parent().find('> [data-lm-id]:last-child')[0].getBoundingClientRect().right;\n\n        this.DRAG_EVENTS.EVENTS.MOVE.forEach(bind(function(event) {\n            $(document).on(event, this.bound('move'));\n        }, this));\n\n        this.DRAG_EVENTS.EVENTS.STOP.forEach(bind(function(event) {\n            $(document).on(event, this.bound('stop'));\n        }, this));\n    },\n\n    move: function(event) {\n        if (event && event.type.match(/^touch/i)) { event.preventDefault(); }\n\n        var clientX = event.clientX || event.touches[0].clientX || 0,\n            clientY = event.clientY || event.touches[0].clientY || 0,\n            parentRect = this.origin.offset.parentRect;\n\n        var deltaX = (this.lastX || clientX) - clientX,\n            deltaY = (this.lastY || clientY) - clientY;\n\n        this.direction =\n            Math.abs(deltaX) > Math.abs(deltaY) && deltaX > 0 && 'left' ||\n            Math.abs(deltaX) > Math.abs(deltaY) && deltaX < 0 && 'right' ||\n            Math.abs(deltaY) > Math.abs(deltaX) && deltaY > 0 && 'up' ||\n                                                                 'down';\n        var size,\n            diff = 100 - this.siblings.occupied,\n            value = clientX + (!this.siblings.prevs ? this.origin.offset.x - this.origin.offset.down : this.siblings.prevs.length),\n            normalized = clamp(value, parentRect.left, parentRect.right);\n\n        size = nMap(normalized, parentRect.left, parentRect.right, 0, 100);\n        size = size - this.siblings.sizeBefore;\n        size = precision(clamp(size, this.options.minSize, this.origin.maxSize - this.options.minSize), 0);\n\n        //grids?\n        //console.log((size / 12) * (100 / 12));\n\n        diff = precision(diff - size, 0);\n\n        this.getBlock(this.element).setSize(size, true);\n        this.getBlock(this.siblings.next).setSize(diff, true);\n\n        // Hack to handle cases where size is not an integer\n        var siblings = this.element.siblings(),\n            amount = siblings ? siblings.length + 1 : 1;\n        if (amount == 3 || amount == 6 || amount == 7 || amount == 8 || amount == 9 || amount == 11 || amount == 12) {\n            var total = 0, blocks;\n\n            blocks = $([siblings, this.element]);\n            blocks.forEach(function(block, index){\n                block = this.getBlock(block);\n                size = block.getSize();\n                if (size % 1) {\n                    size = precision(100 / amount, 0);\n                    block.setSize(size, true);\n                }\n\n                total += size;\n\n                if (blocks.length == index + 1 && total != 100) {\n                    diff = 100 - total;\n                    block.setSize(size + diff, true);\n                }\n\n            }, this);\n        }\n\n        this.lastX = clientX;\n        this.lastY = clientY;\n    },\n\n    stop: function(event) {\n        if (event && event.type.match(/^touch/i)) { event.preventDefault(); }\n\n        this.DRAG_EVENTS.EVENTS.MOVE.forEach(bind(function(event) {\n            $(document).off(event, this.bound('move'));\n        }, this));\n\n        this.DRAG_EVENTS.EVENTS.STOP.forEach(bind(function(event) {\n            $(document).off(event, this.bound('stop'));\n        }, this));\n\n        if (event.target.matches('[data-lm-back], [data-lm-forward]')) { return; }\n        if (this.origin.size !== this.getSize(this.element)) { this.history.push(this.builder.serialize(), this.history.get().preset); }\n    },\n\n    evenResize: function(elements, animated) {\n        var total = elements.length,\n            size = precision(100 / total, 4),\n            block;\n\n        if (typeof animated === 'undefined') { animated = true; }\n\n        elements.forEach(function(element) {\n            element = $(element);\n            block = this.getBlock(element);\n            if (block && block.hasAttribute('size') && typeof block.getSize === 'function') {\n                block[animated ? 'setAnimatedSize' : 'setSize'](size, size !== block.getSize());\n            } else {\n                if (element) { element[animated ? 'animate' : 'style']({ flex: '0 1 ' + size + '%' }); }\n            }\n        }, this);\n    }\n});\n\nmodule.exports = Resizer;\n","var prime      = require('prime'),\n    Emitter    = require('prime/emitter'),\n    slice      = require('mout/array/slice'),\n    merge      = require('mout/object/merge'),\n    deepEquals = require('mout/lang/deepEquals'),\n    deepDiff   = require('deep-diff').diff;\n\nvar History = new prime({\n\n    inherits: Emitter,\n\n    constructor: function(session, preset) {\n        this.index = 0;\n        session = merge({}, session);\n        preset = merge({}, preset);\n        this.setSession(session, preset);\n    },\n\n    undo: function() {\n        if (!this.index) return;\n        this.index--;\n\n        var session = this.get();\n        this.emit('undo', session, this.index);\n        return session;\n    },\n\n    redo: function() {\n        if (this.index == this.session.length - 1) return;\n        this.index++;\n\n        var session = this.get();\n        this.emit('redo', session, this.index);\n        return session;\n    },\n\n    reset: function() {\n        this.index = 0;\n\n        var session = this.get();\n        this.emit('reset', session, this.index);\n        return session;\n    },\n\n    push: function(session, preset) {\n        session = merge({}, session);\n        preset = merge({}, preset);\n        var sliced = this.index < this.session.length - 1;\n        if (this.index < this.session.length - 1) this.session = slice(this.session, 0, -(this.session.length - 1 - this.index));\n        session = {\n            time: +(new Date()),\n            data: session,\n            preset: preset\n        };\n\n        if (this.equals(session.data)) { return session; }\n\n        this.session.push(session);\n        this.index = this.session.length - 1;\n\n        this.emit('push', session, this.index, sliced);\n        return session;\n    },\n\n    get: function(index) {\n        return this.session[typeof index !== 'undefined' ? index : this.index] || false;\n    },\n\n    equals: function(session, compare) {\n        if (!compare) { compare = this.get().data; }\n\n        return deepEquals(session, compare);\n    },\n\n    diff: function(obj1, obj2) {\n        if (!obj1 && !obj2 && this.session.length <= 1) { return 'Not enough sessions to diff'; }\n        if (!obj2) { obj2 = this.get(); }\n        if (!obj1) { obj1 = this.get(this.index - 1); }\n\n        return deepDiff(obj1, obj2);\n    },\n\n    setSession: function(session, preset) {\n        session = !session ? []\n            : [{\n            time: +(new Date()),\n            data: merge({}, session),\n            preset: preset\n        }];\n\n        this.session = session;\n        this.index = 0;\n        return this.session;\n    },\n\n    import: function() {},\n    export: function() {}\n});\n\nmodule.exports = History;\n","'use strict';\n\nvar keys     = require('mout/object/keys'),\n    contains = require('mout/array/contains'),\n    rand     = require('mout/random/randInt');\n\nvar ID = function(options) {\n    var map     = options.builder ? keys(options.builder.map) : {},\n        type    = options.type,\n        subtype = options.subtype,\n\n        result  = [], key, id;\n\n    if (type != 'particle') result.push(type);\n    if (subtype)  result.push(subtype);\n\n    key = result.join('-');\n\n    while (id = rand(1000, 9999)) {\n        if (!contains(map, key + '-' + id)) {\n            break;\n        }\n    }\n\n    return key + '-' + id;\n};\n\nmodule.exports = ID;","\"use strict\";\nvar ready          = require('elements/domready'),\n    $              = require('elements/attributes'),\n    Submit         = require('../fields/submit'),\n    modal          = require('../ui').modal,\n    toastr         = require('../ui').toastr,\n    sidebar        = require('./particles-sidebar'),\n    request        = require('agent'),\n    zen            = require('elements/zen'),\n    contains       = require('mout/array/contains'),\n    size           = require('mout/collection/size'),\n    trim           = require('mout/string/trim'),\n    strReplace     = require('mout/string/replace'),\n    properCase     = require('mout/string/properCase'),\n    precision      = require('mout/number/enforcePrecision'),\n\n    getAjaxSuffix = require('../utils/get-ajax-suffix'),\n    parseAjaxURI  = require('../utils/get-ajax-url').parse,\n    getAjaxURL    = require('../utils/get-ajax-url').global,\n\n    flags         = require('../utils/flags-state'),\n    Builder        = require('./builder'),\n    History        = require('../utils/history'),\n    validateField  = require('../utils/field-validation'),\n    LMHistory      = require('./history'),\n    LayoutManager  = require('./layoutmanager'),\n    SaveState      = require('../utils/save-state'),\n    translate      = require('../utils/translate');\n\nrequire('../ui/popover');\nrequire('./inheritance');\n\nvar builder, layoutmanager, lmhistory, savestate, Tips;\n\nbuilder = new Builder();\nlmhistory = new LMHistory();\nsavestate = new SaveState();\n\nready(function() {\n    var body = $('body');\n\n    body.delegate('click', '[data-lm-back]', function(e, element) {\n        if (e) { e.preventDefault(); }\n        if ($(element).hasClass('disabled')) return false;\n        lmhistory.undo();\n    });\n\n    body.delegate('click', '[data-lm-forward]', function(e, element) {\n        if (e) { e.preventDefault(); }\n        if ($(element).hasClass('disabled')) return false;\n        lmhistory.redo();\n    });\n\n    /* lmhistory events */\n    lmhistory.on('push', function(session, index, reset) {\n        var HM = {\n            back: $('[data-lm-back]'),\n            forward: $('[data-lm-forward]')\n        };\n\n        if (index && HM.back && HM.back.hasClass('disabled')) HM.back.removeClass('disabled');\n        if (reset && HM.forward && !HM.forward.hasClass('disabled')) HM.forward.addClass('disabled');\n        layoutmanager.updatePendingChanges();\n    });\n\n    lmhistory.on('undo', function(session, index) {\n        var notice = $('#lm-no-layout'),\n            title = $('.layout-title .title small'),\n            preset_name = session.preset.name || 'Default',\n            HM = {\n                back: $('[data-lm-back]'),\n                forward: $('[data-lm-forward]')\n            };\n\n        if (notice) { notice.style({ display: !size(session.data) ? 'block' : 'none' }); }\n        if (title) { title.text('(' + properCase(trim(strReplace(preset_name, [/_/g, /\\//g], [' ', ' / ']))) + ')'); }\n\n        builder.reset(session.data);\n        HM.forward.removeClass('disabled');\n        if (!index) HM.back.addClass('disabled');\n        layoutmanager.singles('disable');\n        layoutmanager.updatePendingChanges();\n    });\n    lmhistory.on('redo', function(session, index) {\n        var notice = $('#lm-no-layout'),\n            title = $('.layout-title .title small'),\n            preset_name = session.preset.name || 'Default',\n            HM = {\n                back: $('[data-lm-back]'),\n                forward: $('[data-lm-forward]')\n            };\n\n        if (notice) { notice.style({ display: !size(session.data) ? 'block' : 'none' }); }\n        if (title) { title.text('(' + properCase(trim(strReplace(preset_name, [/_/g, /\\//g], [' ', ' / ']))) + ')'); }\n\n        builder.reset(session.data);\n        HM.back.removeClass('disabled');\n        if (index == this.session.length - 1) HM.forward.addClass('disabled');\n        layoutmanager.singles('disable');\n        layoutmanager.updatePendingChanges();\n    });\n\n});\n\nready(function() {\n    var body = $('body'), root = $('[data-lm-root]'), data;\n\n    // Layout Manager\n    layoutmanager = new LayoutManager('[data-lm-container]', {\n        delegate: '[data-lm-root] .g-grid > .g-block > [data-lm-blocktype]:not([data-lm-nodrag]) !> .g-block, .g5-lm-particles-picker [data-lm-blocktype], [data-lm-root] [data-lm-blocktype=\"section\"] > [data-lm-blocktype=\"grid\"]:not(:empty):not(.no-move):not([data-lm-nodrag]), [data-lm-root] [data-lm-blocktype=\"section\"] > [data-lm-blocktype=\"container\"] > [data-lm-blocktype=\"grid\"]:not(:empty):not(.no-move):not([data-lm-nodrag]), [data-lm-root] [data-lm-blocktype=\"offcanvas\"] > [data-lm-blocktype=\"grid\"]:not(:empty):not(.no-move):not([data-lm-nodrag]), [data-lm-root] [data-lm-blocktype=\"offcanvas\"] > [data-lm-blocktype=\"container\"] > [data-lm-blocktype=\"grid\"]:not(:empty):not(.no-move):not([data-lm-nodrag])',\n        droppables: '[data-lm-dropzone]',\n        exclude: '.section-header .button, .section-header .fa, .lm-newblocks .float-right .button, [data-lm-nodrag], [data-lm-disabled]',\n        resize_handles: '[data-lm-root] .g-grid > .g-block:not(:last-child)',\n        builder: builder,\n        history: lmhistory,\n        savestate: savestate\n    });\n\n    module.exports.layoutmanager = layoutmanager;\n\n    // load builder data\n    if (root) {\n        data = JSON.parse(root.data('lm-root'));\n        if (data.name) { data = data.layout; }\n        builder.setStructure(data);\n        builder.load();\n\n        layoutmanager.history.setSession(builder.serialize(), JSON.parse(root.data('lm-preset')));\n        layoutmanager.savestate.setSession(builder.serialize(null, true));\n    }\n\n    // attach events\n    // Modal Tabs\n    body.delegate('click', '.g-tabs a', function(event, element) {\n        event.preventDefault();\n        return false;\n    });\n    body.delegate('keydown', '.g-tabs a', function(event, element) {\n        var key = (event.which ? event.which : event.keyCode);\n        if (key == 32 || key == 13) { // ARIA support: Space / Enter toggle\n            event.preventDefault();\n            body.emit('mouseup', event);\n            return false;\n        }\n    });\n    body.delegate('mouseup', '.g-tabs a', function(event, element) {\n        element = $(element);\n        event.preventDefault();\n\n        var index = 0,\n            parent = element.parent('.g-tabs'),\n            panes = parent.siblings('.g-panes'),\n            links = parent.search('a');\n\n        links.forEach(function(link, i) {\n            if (link == element[0]) { index = i + 1; }\n        });\n\n        panes.find('> .active').removeClass('active');\n        parent.find('> ul > .active').removeClass('active');\n        panes.find('> .g-pane:nth-child(' + index + ')').addClass('active');\n        parent.find('> ul > li:nth-child(' + index + ')').addClass('active');\n\n        // ARIA\n        if (panes.search('> [aria-expanded]')) { panes.search('> [aria-expanded]').attribute('aria-expanded', 'false'); }\n        if (parent.search('> [aria-expanded]')) { parent.search('> [aria-expanded]').attribute('aria-expanded', 'false'); }\n\n        panes.find('> .g-pane:nth-child(' + index + ')').attribute('aria-expanded', 'true');\n        if (parent.find('> ul >li:nth-child(' + index + ') [aria-expanded]')) { parent.find('> ul > li:nth-child(' + index + ') > [aria-expanded]').attribute('aria-expanded', 'true'); }\n    });\n\n    // Picker\n    body.delegate('statechangeBefore', '[data-g5-lm-picker]', function() {\n        modal.close();\n    });\n\n    // Sub-navigation links\n    body.on('statechangeAfter', function(event, element) {\n        root = $('[data-lm-root]');\n        if (!root) { return true; }\n        data = JSON.parse(root.data('lm-root'));\n        builder.setStructure(data);\n        builder.load();\n\n        layoutmanager.refresh();\n        layoutmanager.history.setSession(builder.serialize(), JSON.parse(root.data('lm-preset')));\n        layoutmanager.savestate.setSession(builder.serialize(null, true));\n\n        // refresh LM eraser\n        layoutmanager.eraser.element = $('[data-lm-eraseblock]');\n        layoutmanager.eraser.hide(true);\n    });\n\n    // Particles filtering\n    body.delegate('input', '.sidebar-block .search input', function(event, element) {\n        var value = $(element).value().toLowerCase(),\n            list = $('.sidebar-block [data-lm-blocktype]'),\n            text, type;\n        if (!list) { return false; }\n\n        list.style({ display: 'none' }).forEach(function(blocktype) {\n            blocktype = $(blocktype);\n            type = blocktype.data('lm-blocktype').toLowerCase();\n            text = trim(blocktype.text()).toLowerCase();\n            if (type.substr(0, value.length) == value || text.match(value)) {\n                blocktype.style({ display: 'block' });\n            }\n        }, this);\n    });\n\n    // Grid same widths button (evenize, equalize)\n    ['click', 'touchend'].forEach(function(evt){\n        body.delegate(evt, '[data-lm-samewidth]:not(:empty)', function(event, element) {\n            window.G5.tips.hide(element[0]);\n            var clientRect = element[0].getBoundingClientRect();\n            if ((event.clientX || event.pageX || event.changedTouches[0].pageX || 0) < clientRect.width + clientRect.left) { return; }\n\n            var blocks = element.search('> [data-lm-blocktype=\"block\"]'), id;\n            if (!blocks || blocks.length == 1) { return; }\n\n            blocks.forEach(function(block) {\n                id = $(block).data('lm-id');\n                builder.get(id).setSize(100 / blocks.length, true);\n            });\n\n            lmhistory.push(builder.serialize(), lmhistory.get().preset);\n        });\n    });\n\n    body.delegate('mouseover', '[data-lm-samewidth]:not(:empty)', function(event, element) {\n        var clientRect = element[0].getBoundingClientRect(),\n            clientX = event.clientX || (event.touches && event.touches[0].clientX) || 0,\n            tooltips = {\n                equalize: clientX + 5 > clientRect.width + clientRect.left,\n                move: clientX - 5 < clientRect.left\n            };\n\n        if (!tooltips.equalize && !tooltips.move) { return; }\n\n        var msg = tooltips.equalize ? translate('GANTRY5_PLATFORM_JS_LM_GRID_EQUALIZE') : translate('GANTRY5_PLATFORM_JS_LM_GRID_SORT_MOVE');\n\n        element.data('tip', msg).data('tip-offset', -30);\n\n        window.G5.tips\n            .get(element[0])\n            .content(msg)\n            .place(tooltips.equalize ? 'top-left' : 'top-right')\n            .show();\n    });\n\n    body.delegate('mouseout', '[data-lm-samewidth]:not(:empty)', function(event, element) {\n        window.G5.tips.hide(element[0]);\n    });\n\n    // Clear Layout\n    body.delegate('click', '[data-lm-clear]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n\n        var mode = element.data('lm-clear'),\n            options = {};\n\n        switch (mode) {\n            case 'keep-inheritance':\n                options = { save: true, dropLastGrid: false, emptyInherits: false };\n                break;\n            case 'full':\n            default:\n                options = { save: true, dropLastGrid: false, emptyInherits: true };\n        }\n\n        layoutmanager.clear(null, options);\n    });\n\n    // Switcher\n    var SWITCHER_HIT = false;\n    body.delegate('mouseover', '[data-lm-switcher]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n\n        SWITCHER_HIT = element;\n        if (!element.PopoverDefined) {\n            element.getPopover({\n                type: 'async',\n                width: '500',\n                url: parseAjaxURI(element.data('lm-switcher') + getAjaxSuffix()),\n                allowElementsClick: '.g-tabs a'\n            });\n        }\n    });\n\n    // Switch Layout\n    body.delegate('keydown', '[data-switch]', function(event, element){\n        var key = (event.which ? event.which : event.keyCode);\n        if (key == 32 || key == 13) { // ARIA support: Space toggle\n            event.preventDefault();\n            body.emit('mousedown', event);\n        }\n    });\n\n    // Disable keeping particles if inherit option is selected\n    body.delegate('change', '[data-g-inherit=\"outline\"]', function(event, element) {\n        var keeper = element.parent('.g-pane').find('input[type=\"checkbox\"][data-g-preserve=\"outline\"]');\n        if (keeper) { keeper.checked(false); }\n    });\n\n    // Disable inheriting section/particles if keep option is selected\n    body.delegate('change', '[data-g-preserve=\"outline\"]', function(event, element) {\n        var inherit = element.parent('.g-pane').find('input[type=\"checkbox\"][data-g-inherit=\"outline\"]');\n        if (inherit) { inherit.checked(false); }\n    });\n\n    body.delegate('mousedown', '[data-switch]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n\n        // it's already loading something.\n        if (element.parent('.g5-popover-content').find('[data-switch] i')) {\n            return false;\n        }\n\n        element.showIndicator();\n\n        var preset = $('[data-lm-preset]'),\n            preserve = element.parent('.g-pane').find('input[type=\"checkbox\"][data-g-preserve]'),\n            inherit = element.parent('.g-pane').find('input[type=\"checkbox\"][data-g-inherit]'),\n            method = !preserve ? 'get' : 'post',\n            data = {};\n\n        preserve = preserve && preserve.checked();\n        inherit = inherit && inherit.checked();\n\n        if (preserve) {\n            var lm = layoutmanager;\n            lm.singles('cleanup', lm.builder, true);\n            lm.savestate.setSession(lm.builder.serialize(null, true));\n\n            data.preset = preset && preset.data('lm-preset') ? preset.data('lm-preset') : 'default';\n            data.layout = JSON.stringify(lm.builder.serialize());\n        }\n\n        if (inherit) {\n            data.inherit = 1;\n        }\n\n        var uri = parseAjaxURI(element.data('switch') + getAjaxSuffix());\n        request(method, uri, data, function(error, response) {\n            element.hideIndicator();\n\n            if (!response.body.success) {\n                modal.open({\n                    content: response.body.html || response.body,\n                    afterOpen: function(container) {\n                        if (!response.body.html) { container.style({ width: '90%' }); }\n                    }\n                });\n                return;\n            }\n\n            if (response.body.message && !flags.get('lm:switcher:' + window.btoa(uri), false)) {\n                // confirm before proceeding\n                flags.warning({\n                    message: response.body.message,\n                    callback: function(response, content) {\n                        var confirm = content.find('[data-g-delete-confirm]'),\n                            cancel  = content.find('[data-g-delete-cancel]');\n\n                        if (!confirm) { return; }\n\n                        confirm.on('click', function(e) {\n                            e.preventDefault();\n                            if (this.attribute('disabled')) { return false; }\n\n                            flags.get('lm:switcher:' + window.btoa(uri), true);\n                            $([confirm, cancel]).attribute('disabled');\n                            body.emit('mousedown', { target: element });\n\n                            modal.close();\n                        });\n\n                        cancel.on('click', function(e) {\n                            e.preventDefault();\n                            if (this.attribute('disabled')) { return false; }\n\n                            $([confirm, cancel]).attribute('disabled');\n                            flags.get('lm:switcher:' + window.btoa(uri), false);\n\n                            modal.close();\n                            if (SWITCHER_HIT) {\n                                setTimeout(function(){\n                                    SWITCHER_HIT.getPopover().show();\n                                }, 5);\n                            }\n                        });\n                    }\n                });\n\n                return false;\n            }\n\n            var preset = response.body.preset || { name: 'default' },\n                preset_name = response.body.title || 'Default',\n                structure = response.body.data,\n                notice = $('#lm-no-layout'),\n                title = $('.layout-title .title small');\n\n            root.data('lm-root', JSON.stringify(structure)).empty();\n            root.data('lm-preset', preset);\n            if (notice) { notice.style({ display: 'none' }); }\n            if (title) { title.text('(' + preset_name + ')'); }\n            builder.setStructure(structure);\n            builder.load();\n\n            lmhistory.push(builder.serialize(), JSON.parse(preset));\n\n            $('[data-lm-switcher]').getPopover().hideAll().destroy();\n        });\n    });\n\n    // Particles settings\n    body.delegate('click', '[data-lm-settings]', function(event, element) {\n        element = $(element);\n\n        var blocktype = element.data('lm-blocktype'),\n            settingsURL = element.data('lm-settings'),\n            data = null, parent, section;\n\n        // grid is a special case, since relies on pseudo elements for sorting and same width (evenize)\n        // we need to check where the user clicked.\n        if (blocktype === 'grid') {\n            var clientX = event.clientX || (event.touches && event.touches[0].clientX) || 0,\n                boundings = element[0].getBoundingClientRect();\n\n            if (clientX + 4 - boundings.left < boundings.width) {\n                return false;\n            }\n        }\n\n        element = element.parent('[data-lm-blocktype]');\n        parent = element.parent('[data-lm-blocktype]');\n        section = element.parent('[data-lm-blocktype=\"section\"]');\n        blocktype = element.data('lm-blocktype');\n\n        var ID = element.data('lm-id'),\n            parentID = parent ? parent.data('lm-id') : false,\n            parentType = parent ? parent.data('lm-blocktype') : false;\n\n        if (!contains(['block', 'grid'], blocktype)) {\n            data = {};\n            data.id = builder.get(element.data('lm-id')).getId() || null;\n            data.type = builder.get(element.data('lm-id')).getType() || element.data('lm-blocktype') || false;\n            data.subtype = builder.get(element.data('lm-id')).getSubType() || element.data('lm-blocksubtype') || false;\n            data.title = (element.find('h4') || element.find('.title')).text() || data.type || 'Untitled';\n            data.options = builder.get(element.data('lm-id')).getAttributes() || {};\n            data.inherit = builder.get(element.data('lm-id')).getInheritance() || {};\n            data.block = parent && parentType !== 'wrapper' ? builder.get(parent.data('lm-id')).getAttributes() || {} : {};\n            data.size_limits = builder.get(element.data('lm-id')).getLimits(!parent ? false : builder.get(parent.data('lm-id')));\n            data.parent = section ? section.data('lm-id') : null;\n\n            if (!data.type) { delete data.type; }\n            if (!data.subtype) { delete data.subtype; }\n            if (!size(data.options)) { delete data.options; }\n            if (!size(data.inherit)) { delete data.inherit; }\n            if (!size(data.block)) { delete data.block; }\n        }\n\n        modal.open({\n            content: 'Loading',\n            method: 'post',\n            data: data,\n            overlayClickToClose: false,\n            remote: parseAjaxURI(settingsURL + getAjaxSuffix()),\n            remoteLoaded: function(response, content) {\n                if (!response.body.success) {\n                    modal.enableCloseByOverlay();\n                    return;\n                }\n\n                var form = content.elements.content.find('form'),\n                    fakeDOM = zen('div').html(response.body.html).find('form'),\n                    submit = content.elements.content.search('input[type=\"submit\"], button[type=\"submit\"], [data-apply-and-save]');\n\n                if ((!form && !fakeDOM) || !submit) { return true; }\n\n                var urlTemplate = content.elements.content.find('.g-urltemplate');\n                if (urlTemplate) { body.emit('input', { target: urlTemplate }); }\n\n                var blockSize = content.elements.content.find('[name=\"block[size]\"]');\n\n                // logic for limits\n                if (blockSize && data.size_limits) {\n                    var note = content.elements.content.find('.blocksize-note'),\n                        min = precision(data.size_limits[0], 1),\n                        max = precision(data.size_limits[1], 1);\n\n                    blockSize.attribute('min', min);\n                    blockSize.attribute('max', max);\n\n                    if (note) {\n                        var noteHTML = note.html();\n                        noteHTML = noteHTML.replace(/#min#/g, min);\n                        noteHTML = noteHTML.replace(/#max#/g, max);\n\n                        note.html(noteHTML);\n                        note.find('.blocksize-' + (min == max ? 'range' : 'fixed')).addClass('hidden');\n                    }\n\n                    var isValid = function() {\n                        return parseFloat(blockSize.value()) >= min && parseFloat(blockSize.value()) <= max ? '' : translate('GANTRY5_PLATFORM_JS_LM_SIZE_LIMITS_RANGE');\n                    };\n\n                    blockSize.on('input', function(){\n                        blockSize[0].setCustomValidity(isValid());\n                    });\n                }\n\n                // Particle Settings apply\n                submit.on('click', function(e) {\n                    e.preventDefault();\n\n                    var target = $(e.currentTarget);\n                    target.disabled(true);\n\n                    target.hideIndicator();\n                    target.showIndicator();\n\n                    // Refresh the form to collect fresh and dynamic fields\n                    var formElements = content.elements.content.find('form')[0].elements;\n                    var post = Submit(formElements, content.elements.content);\n\n                    if (post.invalid.length) {\n                        target.disabled(false);\n                        target.hideIndicator();\n                        target.showIndicator('fa fa-fw fa-exclamation-triangle');\n                        toastr.error(translate('GANTRY5_PLATFORM_JS_REVIEW_FIELDS'), translate('GANTRY5_PLATFORM_JS_INVALID_FIELDS'));\n                        return;\n                    }\n\n                    request(fakeDOM.attribute('method'), parseAjaxURI(fakeDOM.attribute('action') + getAjaxSuffix()), post.valid.join('&') || {}, function(error, response) {\n                        if (!response.body.success) {\n                            modal.open({\n                                content: response.body.html || response.body,\n                                afterOpen: function(container) {\n                                    if (!response.body.html) { container.style({ width: '90%' }); }\n                                }\n                            });\n                        } else {\n                            var particle = builder.get(ID),\n                                block = null;\n\n                            // particle attributes\n                            particle.setAttributes(response.body.data.options);\n\n                            if (particle.hasAttribute('enabled')) { particle[particle.getAttribute('enabled') ? 'enable' : 'disable'](); }\n\n                            if (particle.getType() != 'section') {\n                                particle.setTitle(response.body.data.title || 'Untitled');\n                                particle.updateTitle(particle.getTitle());\n                            }\n\n                            if (particle.getType() == 'position') {\n                                particle.updateKey();\n                            }\n\n                            // parent block attributes\n                            if (response.body.data.block && size(response.body.data.block)) {\n                                block = builder.get(parentID);\n\n                                var sibling = block.block.nextSibling() || block.block.previousSibling(),\n                                    currentSize = block.getSize(),\n                                    diffSize;\n\n                                block.setAttributes(response.body.data.block);\n\n                                diffSize = currentSize - block.getSize();\n\n                                block.setAnimatedSize(block.getSize());\n\n                                if (sibling) {\n                                    sibling = builder.get(sibling.data('lm-id'));\n                                    sibling.setAnimatedSize(parseFloat(sibling.getSize()) + diffSize, true);\n                                }\n                            }\n\n                            // particle inheritance\n                            if (response.body.data.inherit) {\n                                delete response.body.data.inherit.section;\n                                particle.setInheritance(response.body.data.inherit);\n\n                                particle.enableInheritance();\n                                particle.refreshInheritance();\n                            }\n\n                            if (response.body.data.children) {\n                                layoutmanager.clear(particle.block, { save: false, dropLastGrid: !!response.body.data.children.length, emptyInherits: true });\n                                builder.recursiveLoad(response.body.data.children, builder.insert, 0, particle.getId());\n                            }\n\n                            if (particle.hasInheritance() && !response.body.data.inherit) {\n                                particle.setInheritance({});\n                                particle.disableInheritance();\n                            }\n\n                            lmhistory.push(builder.serialize(), lmhistory.get().preset);\n\n                            // if it's apply and save we also save the panel\n                            if (target.data('apply-and-save') !== null) {\n                                var save = $('body').find('.button-save');\n                                if (save) { body.emit('click', { target: save }); }\n                            }\n\n                            modal.close();\n\n                            toastr.success(translate('GANTRY5_PLATFORM_JS_PARTICLE_SETTINGS_APPLIED', particle.getTitle()), translate('GANTRY5_PLATFORM_JS_SETTINGS_APPLIED'));\n                        }\n\n                        target.hideIndicator();\n                    });\n                });\n            }\n        });\n\n    });\n\n});\n\nmodule.exports = {\n    $: $,\n    builder: builder,\n    layoutmanager: layoutmanager,\n    history: lmhistory,\n    savestate: savestate\n};\n","\"use strict\";\n\nvar $                  = require('elements'),\n    ready              = require('elements/domready'),\n    request            = require('agent'),\n    modal              = require('../../ui').modal,\n\n    isArray            = require('mout/lang/isArray'),\n    forEach            = require('mout/collection/forEach'),\n    filter             = require('mout/object/filter'),\n    keys               = require('mout/object/keys'),\n    contains           = require('mout/collection/contains'),\n\n    getAjaxSuffix      = require('../../utils/get-ajax-suffix'),\n    parseAjaxURI       = require('../../utils/get-ajax-url').parse,\n    getAjaxURL         = require('../../utils/get-ajax-url').global,\n    getOutlineNameById = require('../../utils/get-outline').getOutlineNameById,\n    getCurrentOutline  = require('../../utils/get-outline').getCurrentOutline;\n\n\nvar IDsMap = {\n    attributes: ['g-settings-particle', 'g-settings-atom'],\n    block: { panel: 'g-settings-block-attributes', tab: 'g-settings-block' },\n    particles: 'g-inherit-particle',\n    atoms: 'g-inherit-atom'\n};\n\nready(function() {\n    var body             = $('body'),\n        currentSelection = {},\n        currentMode      = {};\n\n    body.delegate('change', '[name=\"inherit[outline]\"]', function(event, element) {\n        var label          = element.parent('.settings-param').find('.settings-param-title'),\n            value          = element.value(),\n            name           = $('[name=\"inherit[section]\"]') ? $('[name=\"inherit[section]\"]').value() : '',\n            form           = element.parent('[data-g-inheritance-settings]'),\n            includesFields = $('[data-multicheckbox-field=\"inherit[include]\"]:checked') || [],\n            particle       = {\n                list: $('#g-inherit-particle, #g-inherit-atom'),\n                mode: $('[name=\"inherit[mode]\"]:checked'),\n                radios: $('[name=\"inherit[particle]\"], [name=\"inherit[atom]\"]'),\n                checked: $('[name=\"inherit[particle]\"]:checked, [name=\"inherit[atom]\"]:checked')\n            };\n\n        var hasChanged = currentSelection[name] !== value || currentMode[name] !== particle.mode.value();\n\n        if (hasChanged && !value) {\n            includesFields.forEach(function(include) {\n                $(include).checked(false);\n                body.emit('change', { target: include });\n            });\n        }\n\n        var formData = JSON.parse(form.data('g-inheritance-settings')),\n            data     = {\n                outline: value || getCurrentOutline(),\n                type: formData.type || '',\n                subtype: formData.subtype || '',\n                mode: particle.mode.value(),\n                inherit: !!value && particle.mode.value() === 'inherit' ? '1' : '0'\n            };\n\n        data.id = formData.id;\n\n        label.showIndicator();\n        element.selectizeInstance.blur();\n\n        if (particle.radios && particle.checked) {\n            if (!hasChanged) {\n                data.selected = particle.checked.value();\n                data.id = particle.checked.value();\n                particle.list = false;\n            }\n        }\n\n        var URI_mode = data.type === 'atom' ? 'atoms' : 'layouts',\n            URI      = particle.list ? URI_mode + '/list' : URI_mode;\n\n        request('POST', parseAjaxURI(getAjaxURL(URI) + getAjaxSuffix()), data, function(error, response) {\n            label.hideIndicator();\n\n            if (!response.body.success) {\n                modal.open({\n                    content: response.body.html || response.body,\n                    afterOpen: function(container) {\n                        if (!response.body.html) { container.style({ width: '90%' }); }\n                    }\n                });\n\n                return;\n            }\n\n            var data      = response.body,\n                includes  = form.find('[name=\"inherit[include]\"]').value().split(','),\n                available = form.search('[data-multicheckbox-field=\"inherit[include]\"]').map(function(item) { return $(item).value(); }),\n                container = modal.getByID(modal.getLast()),\n                element;\n\n            // refresh field values based on settings and ajax response\n            forEach(IDsMap, function(id, option) {\n                id = id.panel || id;\n                id = !isArray(id) ? [id] : id;\n\n                id.forEach(function(currentID) {\n                    var shouldRefresh = contains(includes, option),\n                        isAvailable   = contains(available, option);\n\n                    if ((shouldRefresh || !isAvailable) && data.html[currentID] && (element = container.find('#' + currentID))) {\n                        element.html(data.html[currentID]);\n                        var selects = element.search('[data-selectize]');\n                        if (selects) { selects.selectize(); }\n                    }\n                });\n            });\n\n            if (hasChanged && includesFields && currentSelection[name] === '') {\n                includesFields.forEach(function(include) { body.emit('change', { target: include }); });\n            }\n\n            currentSelection[name] = value;\n            currentMode[name] = particle.mode.value();\n        });\n    });\n\n    body.delegate('change', '#g-settings-inheritance [data-multicheckbox-field]', function(event, element) {\n        var outline = $('[name=\"inherit[outline]\"]');\n        if (!outline) { return true; }\n\n        outline   = outline.value();\n\n        var value     = element.value(),\n            isChecked = element.checked(),\n            noRefresh = event.noRefresh,\n            particle  = {\n                mode: $('[name=\"inherit[mode]\"]:checked'),\n                radios: $('[name=\"inherit[particle]\"], [name=\"inherit[atom]\"]'),\n                checked: $('[name=\"inherit[particle]\"]:checked, [name=\"inherit[atom]\"]:checked')\n            };\n\n        var IDs = {\n            panel: (IDsMap[value] && IDsMap[value].panel || IDsMap[value]),\n            tab: (IDsMap[value] && IDsMap[value].tab || IDsMap[value])\n        };\n\n        if (!isArray(IDs.panel)) {\n            IDs.panel = [IDs.panel];\n            IDs.tab = [IDs.tab];\n        }\n\n        IDs.panel.forEach(function(currentPanel, index) {\n            var panel = $('#' + currentPanel),\n                tab   = $('#' + IDs.tab[index] + '-tab');\n\n            if (!panel || !tab) { return true; }\n\n            var inherit = panel.find('.g-inherit'),\n                isClone = particle.mode.value() === 'clone',\n                refresh = function(noRefresh) {\n                    if (!noRefresh) {\n                        body.emit('change', { target: element.parent('.settings-block').find('[name=\"inherit[outline]\"]') });\n                    }\n                };\n\n            if (!isChecked || !outline || isClone) {\n                var lock = tab.find('.fa-lock');\n\n                if (lock) { lock.removeClass('fa-lock').addClass('fa-unlock'); }\n                if (inherit) { inherit.hide(); }\n                if (isClone) { refresh(noRefresh); }\n            } else {\n                var unlock = tab.find('.fa-unlock');\n\n                if (unlock) { unlock.removeClass('fa-unlock').addClass('fa-lock'); }\n                if (inherit) { inherit.show(); }\n\n                refresh(noRefresh);\n            }\n        });\n    });\n\n\n    body.delegate('change', '[name=\"inherit[mode]\"], [name=\"inherit[particle]\"], [name=\"inherit[atom]\"]', function(event, element) {\n        var container  = modal.getByID(modal.getLast()),\n            outline    = container.find('[name=\"inherit[outline]\"]'),\n            checkboxes = container.search('[data-multicheckbox-field]') || [],\n            noRefresh  = false;\n\n        if (element.attribute('name') === 'inherit[mode]') {\n            noRefresh = true;\n        }\n\n        body.emit('change', { target: outline, noRefresh: noRefresh });\n        checkboxes.forEach(function(checkbox) {\n            body.emit('change', { target: checkbox, noRefresh: noRefresh });\n        });\n    });\n\n    body.delegate('click', '#g-inherit-particle .fa-info-circle, #g-inherit-atom .fa-info-circle', function(event, element) {\n        event.preventDefault();\n\n        var container = modal.getByID(modal.getLast()),\n            outline   = container.find('[name=\"inherit[outline]\"]'),\n            id        = element.siblings('input[name=\"inherit[particle]\"], input[name=\"inherit[atom]\"]');\n\n        if (!id || !outline) { return false; }\n\n        var URI = id.name() === 'inherit[atom]' ? 'atoms/instance' : 'layouts/particle';\n        modal.open({\n            content: 'Loading',\n            method: 'post',\n            data: { id: id.value(), outline: outline.value() || getCurrentOutline() },\n            remote: parseAjaxURI(getAjaxURL(URI) + getAjaxSuffix()),\n            remoteLoaded: function(response, content) {\n                if (!response.body.success) {\n                    modal.enableCloseByOverlay();\n                    return;\n                }\n            }\n        });\n\n        return false;\n    });\n\n    body.delegate('mouseup', '.g-tabs .fa-lock, .g-tabs .fa-unlock', function(event, element) {\n        if (!element.parent('li').hasClass('active')) { return false; }\n\n        var container = modal.getByID(modal.getLast()),\n            isLocked  = element.hasClass('fa-lock'),\n            id        = element.parent('a').id().replace(/\\-tab$/, ''),\n            prop      = keys(filter(IDsMap, function(value) { return value === id || value.tab === id || contains(value, id); }) || []).shift(),\n            input     = container.find('[data-multicheckbox-field][value=\"' + prop + '\"]'),\n            particle  = {\n                mode: $('[name=\"inherit[mode]\"]:checked'),\n                radios: $('[name=\"inherit[particle]\"], [name=\"inherit[atom]\"]'),\n                checked: $('[name=\"inherit[particle]\"]:checked, [name=\"inherit[atom]\"]:checked')\n            };\n\n        if (input) {\n            // do not try to refresh attributes/block inheritance when there's no particle selected\n            // or if we are in clone mode\n            if (particle.mode.value() === 'clone' || (particle.radios && !particle.checked)) {\n                return false;\n            }\n\n            input.checked(!isLocked);\n            body.emit('change', { target: input });\n        }\n    });\n});","\"use strict\";\nvar prime      = require('prime'),\n    $          = require('../utils/elements.utils'),\n    bind       = require('mout/function/bind'),\n    zen        = require('elements/zen'),\n    Emitter    = require('prime/emitter'),\n    Bound      = require('prime-util/prime/bound'),\n    Options    = require('prime-util/prime/options'),\n    Blocks     = require('./blocks'),\n    DragDrop   = require('../ui/drag.drop'),\n    Eraser     = require('../ui/eraser'),\n    flags      = require('../utils/flags-state'),\n    Resizer    = require('./drag.resizer'),\n    get        = require('mout/object/get'),\n    keys       = require('mout/object/keys'),\n\n    every      = require('mout/array/every'),\n    precision  = require('mout/number/enforcePrecision'),\n    isArray    = require('mout/lang/isArray'),\n    deepEquals = require('mout/lang/deepEquals'),\n    find       = require('mout/collection/find'),\n    isObject   = require('mout/lang/isObject'),\n\n    contains   = require('mout/array/contains'),\n    forEach    = require('mout/collection/forEach');\n\nvar singles = {\n    disable: function() {\n        var grids = $('[data-lm-root] [data-lm-blocktype=\"grid\"]');\n        if (grids) { grids.removeClass('no-hover'); }\n    },\n    enable: function() {\n        var grids = $('[data-lm-root] [data-lm-blocktype=\"grid\"]');\n        if (grids) { grids.addClass('no-hover'); }\n    },\n    cleanup: function(builder, dropLast, start) {\n        var emptyGrids = start ? start.search('> .g-grid:empty') : $('[data-lm-blocktype=\"section\"] > .g-grid:empty, [data-lm-blocktype=\"container\"] > .g-grid:empty, [data-lm-blocktype=\"offcanvas\"] > .g-grid:empty');\n\n        if (emptyGrids) {\n            emptyGrids.forEach(function(grid) {\n                grid = $(grid);\n                // empty grids should go away unless they are last and/or dropLast is true\n                if (grid.nextSibling('[data-lm-id]') || dropLast) {\n                    builder.remove(grid.data('lm-id'));\n                    grid.remove();\n                }\n            });\n        }\n    }\n\n};\n\nvar LayoutManager = new prime({\n\n    mixin: [Bound, Options],\n    inherits: Emitter,\n\n    options: {},\n\n    constructor: function(element, options) {\n        this.setOptions(options);\n        this.refElement = element;\n\n        if (!element || !$(element)) { return; }\n\n        this.init(element);\n    },\n\n    init: function() {\n        this.dragdrop = new DragDrop(this.refElement, this.options);\n        this.resizer = new Resizer(this.refElement, this.options);\n        this.eraser = new Eraser('[data-lm-eraseblock]', this.options);\n        this.dragdrop\n            .on('dragdrop:start', this.bound('start'))\n            .on('dragdrop:location', this.bound('location'))\n            .on('dragdrop:nolocation', this.bound('nolocation'))\n            .on('dragdrop:resize', this.bound('resize'))\n            .on('dragdrop:stop:erase', this.bound('removeElement'))\n            .on('dragdrop:stop', this.bound('stop'))\n            .on('dragdrop:stop:animation', this.bound('stopAnimation'));\n\n        this.builder = this.options.builder;\n        this.history = this.options.history;\n        this.savestate = this.options.savestate || null;\n\n        singles.disable();\n    },\n\n    refresh: function() {\n        if (!this.refElement || !$(this.refElement)) { return; }\n        this.init();\n    },\n\n    singles: function(mode, builder, dropLast, start) {\n        singles[mode](builder, dropLast, start);\n    },\n\n    clear: function(parent, options) {\n        var type, child,\n            filter = !parent ? [] : (parent.search('[data-lm-id]') || []).map(function(element) { return $(element).data('lm-id'); });\n\n        options = options || { save: true, dropLastGrid: false, emptyInherits: false };\n\n        forEach(this.builder.map, function(obj, id) {\n            if (filter.length && !contains(filter, id)) { return; }\n            if (!options.emptyInherits && obj.block.parent('.g-inheriting')) { return; }\n\n            type = obj.getType();\n            child = obj.block.find('> [data-lm-id]');\n            if (child) { child = child.data('lm-blocktype'); }\n            if (contains(['particle', 'spacer', 'position', 'widget', 'system', 'block'], type) && (type == 'block' && (child && (child !== 'section' && child !== 'container')))) {\n                this.builder.remove(id);\n                obj.block.remove();\n            } else if (options.emptyInherits && (type == 'section' || type == 'offcanvas' || type == 'container')) {\n                if (obj.hasInheritance) {\n                    obj.inherit = {};\n                    obj.disableInheritance();\n                }\n            }\n        }, this);\n\n        this.singles('cleanup', this.builder, options.dropLastGrid, parent);\n        if (options.save) { this.history.push(this.builder.serialize(), this.history.get().preset); }\n    },\n\n    updatePendingChanges: function() {\n        var saveData   = this.savestate.getData(),\n            serialData = this.builder.serialize(null, true),\n            different  = false,\n\n            equals     = deepEquals(saveData, serialData),\n            save       = $('[data-save=\"Layout\"]'),\n            icon       = save.find('i'),\n            indicator  = save.find('.changes-indicator');\n\n        if (equals && indicator) { save.hideIndicator(); }\n        if (!equals && !indicator) { save.showIndicator('changes-indicator fa fa-fw fa-circle-o') }\n        flags.set('pending', !equals);\n\n        // Emits the changed event for all particles\n        // Used for UI to show particles where there have been differences applied\n        // After a saved state\n        var saved, current, id;\n        serialData.forEach(function(block) {\n            id = keys(block)[0];\n            saved = find(saveData, function(data) { return data[id]; });\n            current = find(serialData, function(data) { return data[id]; });\n            different = !deepEquals(saved, current);\n\n            id = this.builder.get(id);\n            if (id) { id.emit('changed', different); }\n        }, this);\n    },\n\n    start: function(event, element) {\n        var root = $('[data-lm-root]'),\n            size = $(element).position(),\n            coords = $(element)[0].getBoundingClientRect();\n\n        this.block = null;\n        this.mode = root.data('lm-root') || 'page';\n\n        root.addClass('moving');\n\n        var type  = $(element).data('lm-blocktype'),\n            clone = element[0].cloneNode(true);\n\n        if (!this.placeholder) { this.placeholder = zen('div.block.placeholder[data-lm-placeholder]'); }\n        this.placeholder.style({ display: 'none' });\n\n        clone = $(clone);\n        this.original = clone.after(element).style({\n            display: clone.hasClass('g-grid') ? 'flex' : 'block',\n            opacity: 0.5\n        }).addClass('original-placeholder').data('lm-dropzone', null);\n\n        if (type === 'grid') { this.original.style({ display: 'flex' }); }\n\n        this.originalType = type;\n\n        this.block = get(this.builder.map, element.data('lm-id') || '') || new Blocks[type]({\n                builder: this.builder,\n                subtype: element.data('lm-subtype'),\n                title: element.text()\n            });\n\n        if (!this.block.isNew()) {\n            element.style({\n                position: 'fixed',\n                zIndex: 2500,\n                opacity: 0.5,\n                margin: 0,\n                width: Math.ceil(size.width),\n                height: Math.ceil(size.height),\n                left: coords.left,\n                top: coords.top\n            }).find('[data-lm-blocktype]');\n\n            if (this.block.getType() === 'grid') {\n                var siblings = this.block.block.siblings(':not(.original-placeholder):not(.section-header):not(.g-inherit):not(:empty)');\n                if (siblings) {\n                    siblings.search('[data-lm-id]').style({ 'pointer-events': 'none' });\n                }\n            }\n\n            this.placeholder.before(element);\n            this.eraser.show();\n        } else {\n            var position = element.position();\n            this.original.style({\n                position: 'fixed',\n                opacity: 0.5\n            }).style({\n                left: coords.left,\n                top: coords.top,\n                width: position.width,\n                height: position.height\n            });\n            this.element = this.dragdrop.element;\n            this.dragdrop.element = this.original;\n        }\n\n        var blocks;\n        if (type === 'grid' && (blocks = root.search('[data-lm-dropzone]:not([data-lm-blocktype=\"grid\"])'))) {\n            blocks.style({ 'pointer-events': 'none' });\n        }\n\n        singles.enable();\n    },\n\n    location: function(event, location, target/*, element*/) {\n        target = $(target);\n        (!this.block.isNew() ? this.original : this.element).style({ transform: 'translate(0, 0)' });\n        if (!this.placeholder) { this.placeholder = zen('div.block.placeholder[data-lm-placeholder]').style({ display: 'none' }); }\n\n        var position,\n            dataType     = target.data('lm-blocktype'),\n            originalType = this.block.getType();\n\n        if (!dataType && target.data('lm-root')) { dataType = 'root'; }\n        if (this.mode !== 'page' && dataType === 'section') { return; }\n        if (dataType === 'grid' && (target.parent().data('lm-root') || (target.parent().data('lm-blocktype') === 'container' && target.parent().parent().data('lm-root')))) { return; }\n\n        // Check for adjacents and avoid inserting any placeholder since it would be the same position\n        var exclude   = ':not(.placeholder):not([data-lm-id=\"' + this.original.data('lm-id') + '\"])',\n            adjacents = {\n                before: this.original.previousSiblings(exclude),\n                after: this.original.nextSiblings(exclude)\n            };\n\n        if (adjacents.before) { adjacents.before = $(adjacents.before[0]); }\n        if (adjacents.after) { adjacents.after = $(adjacents.after[0]); }\n\n        if (dataType === 'block' && ((adjacents.before === target && location.x === 'after') || (adjacents.after === target && location.x === 'before'))) {\n            return;\n        }\n        if (dataType === 'grid' && ((adjacents.before === target && location.y === 'below') || (adjacents.after === target && location.y === 'above'))) {\n            return;\n        }\n\n        var nonVisible = target.parent('[data-lm-blocktype=\"atoms\"]'),\n            child      = this.block.block.find('[data-lm-id]');\n\n        if ((child ? child.data('lm-blocktype') : originalType) == 'atom') {\n            if (!nonVisible) { return; }\n        } else {\n            if (nonVisible) { return; }\n        }\n\n        // handles the types cases and normalizes the locations (x and y)\n        var grid, block, method;\n\n        switch (dataType) {\n            case 'root':\n            case 'section':\n                break;\n            case 'grid':\n                var empty = !target.children(':not(.placeholder)');\n                // new particles cannot be dropped in existing grids, only empty ones\n                if (originalType !== 'grid' && !empty) { return; }\n\n\n                if (empty) {\n                    if (originalType === 'grid') {\n                        this.placeholder.before(target);\n                    } else {\n                        // we are dropping a new particle into an empty grid, placeholder goes inside\n                        this.placeholder.bottom(target);\n                    }\n                } else {\n                    // we are sorting grids ordering, placeholder goes above/below\n                    method = (location.y === 'above' ? 'before' : 'after');\n                    this.placeholder[method](target);\n                }\n\n                break;\n            case 'block':\n                method = (location.y === 'above' ? 'top' : 'bottom');\n                position = (location.x === 'other') ? method : location.x;\n                this.placeholder[position](target);\n\n                break;\n        }\n\n        // If it's not a block we don't want a small version of the placeholder\n        this.placeholder.removeClass('in-between').removeClass('in-between-grids').removeClass('in-between-grids-first').removeClass('in-between-grids-last');\n        this.placeholder.style({ display: 'block' })[dataType !== 'block' ? 'removeClass' : 'addClass']('in-between');\n\n        if (originalType === 'grid' && dataType === 'grid') {\n            var next     = this.placeholder.nextSibling(),\n                previous = this.placeholder.previousSibling();\n\n            this.placeholder.addClass('in-between-grids');\n            if (previous && !previous.data('lm-blocktype')) { this.placeholder.addClass('in-between-grids-first'); }\n            if (!next || !next.data('lm-blocktype')) { this.placeholder.addClass('in-between-grids-last'); }\n        }\n    },\n\n    nolocation: function(event) {\n        (!this.block.isNew() ? this.original : this.element).style({ transform: 'translate(0, 0)' });\n        if (this.placeholder) { this.placeholder.remove(); }\n        if (!this.block) { return; }\n\n        var target = event.type.match(/^touch/i) ? document.elementFromPoint(event.touches.item(0).clientX, event.touches.item(0).clientY) : event.target;\n\n        if (!this.block.isNew()) {\n            target = $(target);\n            if (target.matches(this.eraser.element) || this.eraser.element.find(target)) {\n                this.dragdrop.removeElement = true;\n                this.eraser.over();\n            } else {\n                this.dragdrop.removeElement = false;\n                this.eraser.out();\n            }\n        }\n    },\n\n    resize: function(event, element, siblings, offset) {\n        this.resizer.start(event, element, siblings, offset);\n    },\n\n    removeElement: function(event, element) {\n        this.dragdrop.removeElement = false;\n\n        var transition = {\n            opacity: 0\n        };\n\n        element.animate(transition, {\n            duration: '150ms'\n        });\n\n        var root = $('[data-lm-root]'), blocks;\n        if (this.block.getType() === 'grid' && (blocks = root.search('[data-lm-dropzone]:not([data-lm-blocktype=\"grid\"])'))) {\n            blocks.style({ 'pointer-events': 'inherit' });\n        }\n\n        var siblings = this.block.block.siblings(':not(.original-placeholder)');\n\n        if (siblings && this.block.getType() == 'block') {\n            var size                  = this.block.getSize(),\n                diff                  = size / siblings.length,\n                newSize, block, total = 0, last;\n            siblings.forEach(function(sibling, index) {\n                sibling = $(sibling);\n                block = get(this.builder.map, sibling.data('lm-id'));\n                if (index + 1 == siblings.length) { last = block; }\n                newSize = precision(block.getSize() + diff, 0);\n                total += newSize;\n                block.setSize(newSize, true);\n            }, this);\n\n            // ensuring it's always 100%\n            if (total != 100 && last) {\n                size = last.getSize();\n                diff = 100 - total;\n                last.setSize(size + diff, true);\n            }\n        }\n\n        this.eraser.hide();\n\n        this.dragdrop.DRAG_EVENTS.EVENTS.MOVE.forEach(bind(function(event) {\n            $('body').off(event, this.dragdrop.bound('move'));\n        }, this));\n\n        this.dragdrop.DRAG_EVENTS.EVENTS.STOP.forEach(bind(function(event) {\n            $('body').off(event, this.dragdrop.bound('deferStop'));\n        }, this));\n\n        this.builder.remove(this.block.getId());\n\n        var children = this.block.block.search('[data-lm-id]');\n        if (children && children.length) {\n            children.forEach(function(child) {\n                this.builder.remove($(child).data('lm-id'));\n            }, this);\n        }\n\n        this.block.block.remove();\n\n        if (this.placeholder) { this.placeholder.remove(); }\n        if (this.original) { this.original.remove(); }\n        this.element = this.block = null;\n\n        singles.disable();\n        singles.cleanup(this.builder);\n\n        this.history.push(this.builder.serialize(), this.history.get().preset);\n        root.removeClass('moving');\n\n    },\n\n    stop: function(event, target/*, element*/) {\n        // we are removing the block\n        var lastOvered = $(this.dragdrop.lastOvered);\n        if (lastOvered && lastOvered.matches(this.eraser.element.find('.trash-zone'))) {\n            this.eraser.hide();\n            return;\n        }\n\n        if (this.block.getType() === 'grid') {\n            var siblings = this.block.block.siblings(':not(.original-placeholder):not(.section-header):not(.g-inherit):not(:empty)');\n            if (siblings) {\n                siblings.search('[data-lm-id]').style({ 'pointer-events': 'inherit' });\n            }\n        }\n\n        if (!this.block.isNew()) { this.eraser.hide(); }\n        if (!this.dragdrop.matched) {\n            if (this.placeholder) { this.placeholder.remove(); }\n\n            return;\n        }\n\n        target = $(target);\n\n        var wrapper, insider,\n            multiLocationResize = false,\n            blockWasNew         = this.block.isNew(),\n            type                = this.block.getType(),\n            targetId            = target.data('lm-id'),\n            targetType          = !targetId ? false : get(this.builder.map, targetId) ? get(this.builder.map, targetId).getType() : target.data('lm-blocktype'),\n            placeholderParent   = this.placeholder.parent();\n\n        if (!placeholderParent) { return; }\n\n        var parentId   = placeholderParent.data('lm-id'),\n            parentType = get(this.builder.map, parentId || '') ? get(this.builder.map, parentId).getType() : false,\n            resizeCase = false;\n\n        this.original.remove();\n\n        // case 1: it's a new particle dropped in the LM, we need to wrap it inside a block\n        if (type !== 'block' && type !== 'grid' && ((targetType === 'section' || targetType === 'grid') || (targetType === 'block' && parentType !== 'block'))) {\n            wrapper = new Blocks.block({\n                builder: this.builder\n            }).adopt(this.block.block);\n\n            insider = new Blocks[type]({\n                id: this.block.block.data('lm-id'),\n                type: type,\n                subtype: this.element.data('lm-blocksubtype'),\n                title: this.element.text(),\n                builder: this.builder\n            }).setLayout(this.block.block);\n\n            wrapper.setSize();\n\n            this.block = wrapper;\n            this.builder.add(wrapper);\n            this.builder.add(insider);\n\n            insider.emit('rendered', insider, wrapper);\n            wrapper.emit('rendered', wrapper, null);\n\n            resizeCase = { case: 1 };\n        }\n\n        // case 2: moving a block around, need to fix sizes if it's a multi location resize\n        if (this.originalType === 'block' && this.block.getType() === 'block') {\n            resizeCase = { case: 3 };\n            var previous            = this.block.block.parent('[data-lm-blocktype=\"grid\"]'),\n                placeholderPrevious = this.placeholder.parent('[data-lm-blocktype=\"grid\"]');\n            //if (previous.find('!> [data-lm-blocktype=\"container\"]')) { previous = previous.parent(); }\n            //if (placeholderPrevious.find('!> [data-lm-blocktype=\"container\"]')) { placeholderPrevious = placeholderPrevious.parent(); }\n            if (placeholderPrevious !== previous) {\n                multiLocationResize = {\n                    from: this.block.block.siblings(':not(.placeholder)'),\n                    to: this.placeholder.siblings(':not(.placeholder)')\n                };\n            }\n\n            if (previous.find('!> [data-lm-blocktype=\"container\"]')) { previous = previous.parent(); }\n            previous = previous.siblings(':not(.original-placeholder)');\n            if (!this.block.isNew() && previous.length) { this.resizer.evenResize(previous); }\n\n            this.block.block.attribute('style', null);\n            this.block.setSize();\n        }\n\n        if (type === 'grid' && !siblings) {\n            var plus = this.block.block.parent('[data-lm-blocktype=\"section\"]').find('.fa-plus');\n            if (plus) { plus.emit('click'); }\n        }\n\n        if (this.block.hasAttribute('size') && typeof this.block.getSize === 'function') { this.block.setSize(this.placeholder.compute('flex')); }\n\n        this.block.insert(this.placeholder);\n        this.placeholder.remove();\n\n        if (blockWasNew) {\n            if (resizeCase) { this.resizer.evenResize($([this.block.block, this.block.block.siblings()])); }\n\n            this.element.attribute('style', null);\n        }\n\n\n        if (multiLocationResize.from || (multiLocationResize.to && multiLocationResize.to != this.block.block)) {\n            // if !from / !to means it's empty grid, should we remove it?\n            var size = this.block.getSize(), diff, block;\n\n            // we are moving the particle to an empty grid, resetting the size to 100%\n            if (!multiLocationResize.to) { this.block.setSize(100, true); }\n\n            // we need to compensate the remaining blocks on the FROM with the leaving particle size\n            if (multiLocationResize.from) {\n                diff = size / multiLocationResize.from.length;\n                var total = 0, curSize;\n                multiLocationResize.from.forEach(function(sibling) {\n                    sibling = $(sibling);\n                    block = get(this.builder.map, sibling.data('lm-id'));\n                    curSize = block.getSize() + diff;\n                    block.setSize(curSize, true);\n                    total += curSize;\n                }, this);\n\n                if (total !== 100) {\n                    diff = (100 - total) / multiLocationResize.from.length;\n                    multiLocationResize.from.forEach(function(sibling) {\n                        sibling = $(sibling);\n                        block = get(this.builder.map, sibling.data('lm-id'));\n                        curSize = block.getSize() + diff;\n                        block.setSize(curSize, true);\n                    }, this);\n                }\n            }\n\n            // the TO is receiving a new block so we are going to evenize\n            if (multiLocationResize.to) {\n                size = 100 / (multiLocationResize.to.length + 1);\n                multiLocationResize.to.forEach(function(sibling) {\n                    sibling = $(sibling);\n                    block = get(this.builder.map, sibling.data('lm-id'));\n                    block.setSize(size, true);\n                }, this);\n                this.block.setSize(size, true);\n            }\n        }\n\n        singles.disable();\n        singles.cleanup(this.builder);\n\n        this.history.push(this.builder.serialize(), this.history.get().preset);\n    },\n\n    stopAnimation: function(element) {\n        var root = $('[data-lm-root]');\n        root.removeClass('moving');\n\n        if (this.original) { this.original.remove(); }\n        singles.disable();\n\n        if (!this.block) { this.block = get(this.builder.map, element.data('lm-id')); }\n        if (this.block && this.block.getType() === 'block') { this.block.setSize(); }\n        if (this.block && this.block.isNew() && this.element) { this.element.attribute('style', null); }\n\n        if (this.originalType === 'grid') {\n            var blocks, block;\n            if (blocks = root.search('[data-lm-dropzone]:not([data-lm-blocktype=\"grid\"])')) {\n                blocks.forEach(function(element) {\n                    element = $(element);\n                    block = get(this.builder.map, element.data('lm-id'));\n                    element.attribute('style', null);\n                    block.setSize();\n                }, this);\n            }\n        }\n    }\n});\n\nmodule.exports = LayoutManager;\n","\"use strict\";\n\nvar ready          = require('elements/domready'),\n    $              = require('elements'),\n    decouple       = require('../utils/decouple'),\n    scrollbarWidth = require('../utils/get-scrollbar-width');\n\nvar container, sidebar, search, particles, height, heightTop, heightBottom, excludeTop, excludeBottom,\n    initialSidebarCoords, realSidebarTop;\n\nvar initSizes = function() {\n    // fixed and contained particles sidebar\n    container = $('.sidebar-block');\n    if (!container) { return; }\n\n    sidebar = container.find('.g5-lm-particles-picker');\n    if (!sidebar) { return; }\n\n    search = sidebar.find('> .search');\n    particles = sidebar.find('> .particles-container');\n    height = window.innerHeight;\n    heightTop = 0;\n    heightBottom = 0;\n    initialSidebarCoords = sidebar[0].getBoundingClientRect();\n    realSidebarTop = sidebar.position().top;\n    excludeTop = $('body.admin.com_gantry5 nav.navbar-fixed-top, #wpadminbar, #admin-main #titlebar, #admin-main .grav-update.grav');\n    excludeBottom = $('body.admin.com_gantry5 #status');\n\n    if (excludeTop) {\n        $(excludeTop).forEach(function(element) {\n            heightTop += element.offsetHeight;\n        });\n    }\n\n    if (excludeBottom) {\n        $(excludeBottom).forEach(function(element) {\n            heightBottom += element.offsetHeight;\n        });\n    }\n\n    particles.style({\n        'max-height': (height - heightTop - heightBottom - search[0].offsetHeight - 30),\n        overflow: 'auto'\n    });\n\n    if (particles[0].scrollHeight != particles[0].offsetHeight) {\n        particles.addClass('has-scrollbar').style({ 'margin-right': -scrollbarWidth() });\n    }\n};\n\nready(function() {\n    initSizes();\n\n    var scrollElement = $(GANTRY_PLATFORM == 'grav' ? '#admin-main .content-padding' : window) || [window],\n        scroll        = function() {\n            if (!container || !sidebar) { return; }\n\n            var scrollTop       = this.scrollY || this.scrollTop,\n                containerBounds = container[0].getBoundingClientRect(),\n                limit           = containerBounds.top + containerBounds.height,\n                sidebarCoords   = sidebar[0].getBoundingClientRect(),\n                shouldBeFixed   = (scrollTop > (initialSidebarCoords.top - heightTop - 10)) && scrollTop >= realSidebarTop - 10,\n                reachedTheLimit = sidebarCoords.height + 10 + heightTop + parseInt(container.compute('padding-bottom'), 10) >= limit,\n                sidebarTallerThanContainer = containerBounds.height <= sidebarCoords.height;\n\n            sidebar.style('width', sidebarCoords.width);\n            if (shouldBeFixed && !reachedTheLimit) {\n                sidebar.removeClass('particles-absolute').addClass('particles-fixed');\n                sidebar.style({\n                    top: heightTop + 10,\n                    bottom: 'inherit'\n                });\n            } else if (shouldBeFixed && reachedTheLimit) {\n                if (sidebarTallerThanContainer) {\n                    sidebar.removeClass('particles-fixed').addClass('particles-absolute');\n                    sidebar.style({\n                        top: 'inherit',\n                        bottom: parseInt(container.compute('padding-bottom'), 10)\n                    });\n                }\n            } else {\n                sidebar.removeClass('particles-fixed').removeClass('particles-absolute');\n                sidebar.style({\n                    top: 'inherit',\n                    bottom: 'inherit'\n                });\n            }\n        };\n\n    decouple(scrollElement[0], 'scroll', scroll.bind(scrollElement[0]));\n\n    decouple(window, 'resize', function() {\n        if (!particles) { return; }\n\n        // initSizes();\n        scroll.call(scrollElement[0]);\n\n        particles.style({\n            'max-height': (window.innerHeight - heightTop - heightBottom - search[0].offsetHeight - 30)\n        });\n    });\n\n    $('body').on('statechangeEnd', function() {\n        initSizes();\n    });\n});\n\nmodule.exports = initSizes;\n","\"use strict\";\nvar $              = require('elements'),\n    zen            = require('elements/zen'),\n    ready          = require('elements/domready'),\n    request        = require('agent'),\n    ui             = require('./ui'),\n    interpolate    = require('mout/string/interpolate'),\n    trim           = require('mout/string/trim'),\n    setParam       = require('mout/queryString/setParam'),\n    modal          = ui.modal,\n    toastr         = ui.toastr,\n\n    parseAjaxURI   = require('./utils/get-ajax-url').parse,\n    getAjaxURL     = require('./utils/get-ajax-url').global,\n    getAjaxSuffix  = require('./utils/get-ajax-suffix'),\n\n    flags          = require('./utils/flags-state'),\n    validateField  = require('./utils/field-validation'),\n    lm             = require('./lm'),\n    mm             = require('./menu'),\n    pm             = require('./positions/cards'),\n    configurations = require('./configurations'),\n    positions      = require('./positions'),\n    changelog      = require('./changelog'),\n    translate      = require('./utils/translate');\n\nrequire('elements/attributes');\nrequire('elements/events');\nrequire('elements/delegation');\nrequire('elements/insertion');\nrequire('elements/traversal');\nrequire('./fields');\nrequire('./ui/popover');\nrequire('./utils/ajaxify-links');\nrequire('./utils/rAF-polyfill');\n\nvar createHandler = function(divisor, noun, restOfString) {\n    return function(diff) {\n        var n = Math.floor(diff / divisor);\n        var pluralizedNoun = noun + ( n > 1 ? 's' : '' );\n        return \"\" + n + \" \" + pluralizedNoun + \" \" + restOfString;\n    }\n};\n\nvar formatters = [\n    { threshold: -31535999, handler: createHandler(-31536000,\t\"year\",     \"from now\" ) },\n    { threshold: -2591999, \thandler: createHandler(-2592000,  \t\"month\",    \"from now\" ) },\n    { threshold: -604799,  \thandler: createHandler(-604800,   \t\"week\",     \"from now\" ) },\n    { threshold: -172799,   handler: createHandler(-86400,    \t\"day\",      \"from now\" ) },\n    { threshold: -86399,   \thandler: function(){ return      \t\"tomorrow\" } },\n    { threshold: -3599,    \thandler: createHandler(-3600,     \t\"hour\",     \"from now\" ) },\n    { threshold: -59,     \thandler: createHandler(-60,       \t\"minute\",   \"from now\" ) },\n    { threshold: -0.9999,   handler: createHandler(-1,\t\t\t\"second\",   \"from now\" ) },\n    { threshold: 1,        \thandler: function(){ return      \t\"just now\" } },\n    { threshold: 60,       \thandler: createHandler(1,        \t\"second\",\t\"ago\" ) },\n    { threshold: 3600,     \thandler: createHandler(60,       \t\"minute\",\t\"ago\" ) },\n    { threshold: 86400,    \thandler: createHandler(3600,     \t\"hour\",     \"ago\" ) },\n    { threshold: 172800,   \thandler: function(){ return      \t\"yesterday\" } },\n    { threshold: 604800,   \thandler: createHandler(86400,    \t\"day\",      \"ago\" ) },\n    { threshold: 2592000,  \thandler: createHandler(604800,   \t\"week\",     \"ago\" ) },\n    { threshold: 31536000, \thandler: createHandler(2592000,  \t\"month\",    \"ago\" ) },\n    { threshold: Infinity, \thandler: createHandler(31536000, \t\"year\",     \"ago\" ) }\n];\n\nvar prettyDate = {\n    format: function(date) {\n        var diff = (((new Date()).getTime() - date.getTime()) / 1000);\n        for (var i = 0; i < formatters.length; i++) {\n            if (diff < formatters[i].threshold) {\n                return formatters[i].handler(diff);\n            }\n        }\n        throw new Error(\"exhausted all formatter options, none found\"); //should never be reached\n    }\n};\n\nwindow.onbeforeunload = function() {\n    if (flags.get('pending')) {\n        return translate('GANTRY5_PLATFORM_JS_NO_SAVE_DETECTED');\n    }\n};\n\nready(function() {\n    var body     = $('body'),\n        sentence = translate('GANTRY5_PLATFORM_JS_SAVE_SUCCESS');\n\n    // Close notification\n    body.delegate('click', '[data-g-close]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n        var parent = element.data('g-close');\n        parent = parent ? element.parent(parent) : element;\n\n        parent.slideUp(function() {\n            parent.remove();\n        });\n    });\n\n    // Generic Popovers\n    body.delegate('click', '[data-g-popover]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n\n        if (!element.PopoverDefined) {\n            var content = element.find('[data-popover-content]') || element.siblings('[data-popover-content]'),\n                popover = element.getPopover({\n                    style: element.data('g-popover-style') || 'generic',\n                    width: element.data('g-popover-width') || 220,\n                    content: zen('ul').html(content.html())[0].outerHTML,\n                    allowElementsClick: element.data('g-popover-elementsclick') || '.toggle'\n                });\n            element.on('shown.popover', function(popover){\n                var enabler = element.find('.enabler');\n                element.attribute('aria-expanded', true).attribute('aria-hidden', false);\n\n                if (enabler) {\n                    enabler[0].focus();\n                }\n            });\n\n            element.on('hide.popover', function(popover){\n                element.attribute('aria-expanded', false).attribute('aria-hidden', true);\n            });\n\n            element.getPopover().show();\n        }\n    });\n\n    // Platform Settings redirect\n    body.delegate('mousedown', '[data-settings-key]', function(event, element) {\n        var key = element.data('settings-key');\n        if (!key) { return true; }\n\n        var redirect = window.location.search,\n            settings = element.attribute('href'),\n            uri      = window.location.href.split('?');\n        if (uri.length > 1 && uri[0].match(/index.php$/)) { redirect = 'index.php' + redirect; }\n\n        redirect = setParam(settings, key, btoa(redirect));\n        element.href(redirect);\n    });\n\n    // Save Tooltip\n    body.delegate('mouseover', '.button-save', function(event, element) {\n        if (!element.lastSaved) { return true; }\n        var feedback = translate('GANTRY5_PLATFORM_LAST_SAVED') + ': ' + prettyDate.format(element.lastSaved);\n        element\n            .data('tip', feedback)\n            .data('title', feedback);\n    });\n\n    // Save\n    body.delegate('click', '.button-save', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n        var saves = $('.button-save');\n\n        if (saves.disabled()) {\n            return false;\n        }\n\n        saves.disabled(true);\n        saves.hideIndicator();\n        saves.showIndicator();\n\n        var data    = {},\n            invalid = [],\n            type    = element.data('save'),\n            extras  = '',\n            page    = $('[data-lm-root]') ? 'layout' : ($('[data-mm-id]') ? 'menu' : ($('[data-position]') ? 'positions' : 'other')),\n            saveURL = parseAjaxURI(trim(window.location.href, '#') + getAjaxSuffix());\n\n        switch (page) {\n            case 'layout':\n                var preset = $('[data-lm-preset]');\n                lm.layoutmanager.singles('cleanup', lm.builder, false);\n                lm.savestate.setSession(lm.builder.serialize(null, true));\n\n                data.preset = preset && preset.data('lm-preset') ? preset.data('lm-preset') : 'default';\n\n                var layout = JSON.stringify(lm.builder.serialize());\n\n                // base64 encoding doesn't quite work with mod_security\n                // data.layout = btoa ? btoa(encodeURIComponent(layout)) : layout;\n\n                data.layout = layout;\n                break;\n\n            case 'menu':\n                data.menutype = $('select.menu-select-wrap').value();\n                data.settings = JSON.stringify(mm.menumanager.settings);\n                data.ordering = JSON.stringify(mm.menumanager.ordering);\n\n                var items = JSON.stringify(mm.menumanager.items);\n\n                // base64 encoding doesn't quite work with mod_security\n                // data.items = btoa ? btoa(encodeURIComponent(items)) : items;\n\n                data.items = items;\n\n                saveURL = parseAjaxURI(element.parent('form').attribute('action') + getAjaxSuffix());\n                break;\n\n            case 'positions':\n                data.positions = pm.serialize();\n                break;\n\n            case 'other':\n            default:\n                var form = element.parent('form');\n\n                if (form && element.attribute('type') == 'submit') {\n                    $(form[0].elements).forEach(function(input) {\n                        input = $(input);\n                        var name     = input.attribute('name'),\n                            type     = input.attribute('type'),\n                            value    = input.value(),\n                            parent   = input.parent('.settings-param, .card-overrideable'),\n                            override = parent ? parent.find('> input[type=\"checkbox\"]') : null;\n\n                        override = override || $(input.data('override-target'));\n\n                        if (!name || input.disabled() || (override && !override.checked()) || (type == 'radio' && !input.checked())) { return; }\n                        if (!validateField(input)) { invalid.push(input); }\n                        data[name] = value;\n                    });\n                }\n        }\n\n        if (invalid.length) {\n            saves.disabled(false);\n            saves.hideIndicator();\n            saves.showIndicator('fa fa-fw fa-exclamation-triangle');\n            toastr.error(translate('GANTRY5_PLATFORM_JS_REVIEW_FIELDS'), translate('GANTRY5_PLATFORM_JS_INVALID_FIELDS'));\n            return;\n        }\n\n        if (page == 'other') { $('.settings-param-title, .card.settings-block > h4').hideIndicator(); }\n        body.emit('updateOriginalFields');\n\n        request('post', saveURL, data, function(error, response) {\n            if (!response.body.success) {\n                modal.open({\n                    content: response.body.html || response.body,\n                    afterOpen: function(container) {\n                        if (!response.body.html) { container.style({ width: '90%' }); }\n                    }\n                });\n            } else {\n                modal.close();\n\n                if ($('#styles')) {\n                    extras = '<br />' + (response.body.warning ? '<hr />' + response.body.title + '<br />' + response.body.html : translate('GANTRY5_PLATFORM_JS_CSS_COMPILED'));\n                }\n\n                toastr[response.body.warning ? 'warning' : 'success'](interpolate(sentence, {\n                    verb: type.slice(-1) == 's' ? 'have' : 'has',\n                    type: type,\n                    extras: extras\n                }), type + ' ' + translate('GANTRY5_PLATFORM_SAVED'));\n            }\n\n            saves.disabled(false);\n            saves.hideIndicator();\n            saves.forEach(function(save) {\n                $(save).lastSaved = new Date();\n            });\n\n            if (page == 'layout') { lm.layoutmanager.updatePendingChanges(); }\n\n            // all good, disable 'pending' flag\n            flags.set('pending', false);\n            flags.emit('update:pending');\n        });\n    });\n\n    // Editable titles\n    body.delegate('keydown', '[data-title-edit]', function(event, element) {\n        var key = (event.which ? event.which : event.keyCode);\n        if (key == 32 || key == 13) { // ARIA support: Space / Enter toggle\n            event.preventDefault();\n            body.emit('click', event);\n        }\n    });\n\n    body.delegate('click', '[data-title-edit]', function(event, element) {\n        element = $(element);\n        if (element.hasClass('disabled')) { return false; }\n\n        var $title = element.siblings('[data-title-editable]') || element.previousSiblings().find('[data-title-editable]') || element.nextSiblings().find('[data-title-editable]'), title;\n        if (!$title) { return true; }\n\n        title = $title[0];\n        $title.text(trim($title.text()));\n\n        $title.attribute('contenteditable', true);\n        title.focus();\n\n        var range = document.createRange(), selection;\n        range.selectNodeContents(title);\n        selection = window.getSelection();\n        selection.removeAllRanges();\n        selection.addRange(range);\n\n        $title.storedTitle = trim($title.text());\n        $title.titleEditCanceled = false;\n        $title.emit('title-edit-start', $title.storedTitle);\n    });\n\n    body.delegate('keydown', '[data-title-editable]', function(event, element) {\n        element = $(element);\n        switch (event.keyCode) {\n            case 13: // return\n            case 27: // esc\n                event.stopPropagation();\n\n                if (event.keyCode == 27) {\n                    if (typeof element.storedTitle !== 'undefined') {\n                        element.text(element.storedTitle);\n                        element.titleEditCanceled = true;\n                    }\n                }\n\n                element.attribute('contenteditable', null);\n                element[0].blur();\n\n                element.emit('title-edit-exit', element.data('title-editable'), event.keyCode == 13 ? 'enter' : 'esc');\n                return false;\n            default:\n                return true;\n        }\n    });\n\n    body.delegate('blur', '[data-title-editable]', function(event, element) {\n        element = $(element);\n        element[0].scrollLeft = 0;\n        element.attribute('contenteditable', null);\n        element.data('title-editable', trim(element.text()));\n        window.getSelection().removeAllRanges();\n        element.emit('title-edit-end', element.data('title-editable'), element.storedTitle, element.titleEditCanceled);\n    }, true);\n\n    // Quick Ajax Calls [data-ajax-action]\n    body.delegate('click', '[data-ajax-action]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n\n        var href      = element.attribute('href') || element.data('ajax-action'),\n            method    = element.data('ajax-action-method') || 'post',\n            indicator = $(element.data('ajax-action-indicator')) || element;\n\n        if (!href) { return false; }\n\n        indicator.showIndicator();\n        request(method, parseAjaxURI(href + getAjaxSuffix()), function(error, response) {\n            if (!response.body.success) {\n                modal.open({\n                    content: response.body.html || response.body,\n                    afterOpen: function(container) {\n                        if (!response.body.html) { container.style({ width: '90%' }); }\n                    }\n                });\n\n                indicator.hideIndicator();\n                return false;\n            } else {\n                toastr[response.body.warning ? 'warning' : 'success'](response.body.html || 'Action successfully completed.', response.body.title || '');\n            }\n\n            indicator.hideIndicator();\n        })\n    });\n});\n\nvar modules = {\n    /*mout    : require('mout'),\n     prime   : require('prime'),\n     \"$\"     : elements,\n     zen     : zen,\n     domready: domready,\n     agent   : require('agent'),*/\n    lm: lm,\n    mm: mm,\n    assingments: require('./assignments'),\n    ui: require('./ui'),\n    styles: require('./styles'),\n    \"$\": $,\n    domready: require('elements/domready'),\n    particles: require('./particles'),\n    zen: require('elements/zen'),\n    moofx: require('moofx'),\n    atoms: require('./pagesettings'),\n    tips: require('./ui/tooltips')\n};\n\nwindow.G5 = modules;\nmodule.exports = modules;\n","\"use strict\";\nvar DragEvents = require('../ui/drag.events'),\n    prime      = require('prime'),\n    Emitter    = require('prime/emitter'),\n    Bound      = require('prime-util/prime/bound'),\n    Options    = require('prime-util/prime/options'),\n    bind       = require('mout/function/bind'),\n    isString   = require('mout/lang/isString'),\n    nMap       = require('mout/math/map'),\n    clamp      = require('mout/math/clamp'),\n    precision  = require('mout/number/enforcePrecision'),\n    get        = require('mout/object/get'),\n    $          = require('../utils/elements.utils');\n\nrequire('elements/events');\nrequire('elements/delegation');\n\nvar Resizer = new prime({\n    mixin: [Bound, Options],\n    DRAG_EVENTS: DragEvents,\n    options: {\n        minSize: 5\n    },\n    constructor: function(container, options, menumanager) {\n        this.setOptions(options);\n        this.history = this.options.history || {};\n        this.builder = this.options.builder || {};\n        this.map = this.builder.map;\n        this.menumanager = menumanager;\n        this.origin = {\n            x: 0,\n            y: 0,\n            transform: null,\n            offset: {\n                x: 0,\n                y: 0\n            }\n        };\n    },\n\n    getBlock: function(element) {\n        return get(this.map, isString(element) ? element : $(element).data('lm-id') || '');\n    },\n\n    getAttribute: function(element, prop) {\n        return this.getBlock(element).getAttribute(prop);\n    },\n\n    getSize: function(element) {\n        element = $(element);\n        var parent = element.matches('[data-mm-id]') ? element : element.parent('[data-mm-id]'),\n            size = parent.find('.percentage input');\n\n        return Number(size.value());\n    },\n\n    setSize: function(element, size, animated) {\n        element = $(element);\n        animated = typeof animated === 'undefined' ? false : animated;\n\n        var parent = element.matches('[data-mm-id]') ? element : element.parent('[data-mm-id]'),\n            pc = parent.find('.percentage input');\n\n        parent[animated ? 'animate' : 'style']({'flex': '0 1 '+size+'%'});\n        pc.value(precision(size, 1));\n    },\n\n    start: function(event, element, siblings, offset) {\n        if (event && event.type.match(/^touch/i)) { event.preventDefault(); }\n        if (event.which && event.which !== 1) { return true; }\n\n        // Stops text selection\n        event.preventDefault();\n\n        this.element = $(element);\n\n        var parent = this.element.parent('.submenu-selector');\n        if (!parent) { return false; }\n\n        parent.addClass('moving');\n        \n        this.siblings = {\n            occupied: 0,\n            elements: siblings,\n            next: this.element.parent('[data-mm-id]').nextSibling().find('> .submenu-column'),\n            prevs: this.element.parent('[data-mm-id]').previousSiblings(),\n            sizeBefore: 0\n        };\n\n        if (this.siblings.elements.length > 1) {\n            this.siblings.occupied -= this.getSize(this.siblings.next);\n            this.siblings.elements.forEach(function(sibling) {\n                this.siblings.occupied += this.getSize(sibling);\n            }, this);\n        }\n\n        if (this.siblings.prevs) {\n            this.siblings.prevs.forEach(function(sibling) {\n                this.siblings.sizeBefore += this.getSize(sibling);\n            }, this);\n        }\n\n        this.origin = {\n            size: this.getSize(this.element),\n            maxSize: this.getSize(this.element) + this.getSize(this.siblings.next),\n            x: event.changedTouches ? event.changedTouches[0].pageX : event.pageX + 6,\n            y: event.changedTouches ? event.changedTouches[0].pageY : event.pageY\n        };\n\n        var clientRect = this.element[0].getBoundingClientRect(),\n            parentRect = this.element.parent()[0].getBoundingClientRect();\n\n        this.origin.offset = {\n            clientRect: clientRect,\n            parentRect: {left: parentRect.left, right: parentRect.right},\n            x: this.origin.x - clientRect.right,\n            y: clientRect.top - this.origin.y,\n            down: offset\n        };\n\n        this.origin.offset.parentRect.left = this.element.parent('.submenu-selector').find('> [data-mm-id]:first-child')[0].getBoundingClientRect().left;\n        this.origin.offset.parentRect.right = this.element.parent('.submenu-selector').find('> [data-mm-id]:last-child')[0].getBoundingClientRect().right;\n\n\n        this.DRAG_EVENTS.EVENTS.MOVE.forEach(bind(function(event) {\n            $(document).on(event, this.bound('move'));\n        }, this));\n\n        this.DRAG_EVENTS.EVENTS.STOP.forEach(bind(function(event) {\n            $(document).on(event, this.bound('stop'));\n        }, this));\n    },\n\n    move: function(event) {\n        if (event && event.type.match(/^touch/i)) { event.preventDefault(); }\n\n        var clientX = event.clientX || event.touches[0].clientX || 0,\n            clientY = event.clientY || event.touches[0].clientY || 0,\n            parentRect = this.origin.offset.parentRect;\n\n        var deltaX = (this.lastX || clientX) - clientX,\n            deltaY = (this.lastY || clientY) - clientY;\n\n        this.direction =\n            Math.abs(deltaX) > Math.abs(deltaY) && deltaX > 0 && 'left' ||\n            Math.abs(deltaX) > Math.abs(deltaY) && deltaX < 0 && 'right' ||\n            Math.abs(deltaY) > Math.abs(deltaX) && deltaY > 0 && 'up' ||\n                                                                 'down';\n        var size,\n            diff = 100 - this.siblings.occupied,\n            value = clientX + (!this.siblings.prevs ? this.origin.offset.x - this.origin.offset.down : this.siblings.prevs.length),\n            normalized = clamp(value, parentRect.left, parentRect.right);\n\n        size = nMap(normalized, parentRect.left, parentRect.right, 0, 100);\n        size = size - this.siblings.sizeBefore;\n        size = precision(clamp(size, this.options.minSize, this.origin.maxSize - this.options.minSize), 0);\n\n        diff = precision(diff - size, 0);\n\n        this.setSize(this.element, size);\n        this.setSize(this.siblings.next, diff);\n\n        // Hack to handle cases where size is not an integer\n        var siblings = this.siblings.elements,\n            amount = siblings ? siblings.length + 1 : 1;\n        if (amount == 3 || amount == 6 || amount == 7 || amount == 8 || amount == 9 || amount == 11 || amount == 12) {\n            var total = 0, blocks;\n\n            blocks = $([siblings, this.element.parent('[data-mm-id]')]);\n            blocks.forEach(function(block, index){\n                block = $(block);\n                size = this.getSize(block);\n                if (size % 1) {\n                    size = precision(100 / amount, 0);\n                    this.setSize(block, size);\n                }\n\n                total += size;\n\n                if (blocks.length == index + 1 && total != 100) {\n                    diff = 100 - total;\n                    this.setSize(block, (size + diff));\n                }\n\n            }, this);\n        }\n\n        this.lastX = clientX;\n        this.lastY = clientY;\n    },\n\n    stop: function(event) {\n        if (event && event.type.match(/^touch/i)) { event.preventDefault(); }\n\n        this.DRAG_EVENTS.EVENTS.MOVE.forEach(bind(function(event) {\n            $(document).off(event, this.bound('move'));\n        }, this));\n\n        this.DRAG_EVENTS.EVENTS.STOP.forEach(bind(function(event) {\n            $(document).off(event, this.bound('stop'));\n        }, this));\n\n        this.element.parent('.submenu-selector').removeClass('moving');\n\n        this.menumanager.emit('dragEnd', this.menumanager.map, 'resize');\n        //if (this.origin.size !== this.getSize(this.element)) { this.history.push(this.builder.serialize()); }\n    },\n\n    updateItemSizes: function(elements) {\n        var parent = this.element ? this.element.parent('.submenu-selector') : null;\n        if (!parent && !elements) { return false; }\n\n        var blocks = elements || parent.search('> [data-mm-id]'),\n            sizes = [],\n            active = $('.menu-selector .active'),\n            path = active ? active.data('mm-id') : null;\n\n        blocks.forEach(function(block){\n            sizes.push(this.getSize(block));\n        }, this);\n\n        // update active path with new columns sizes\n        this.menumanager.items[path].columns = sizes;\n\n        this.updateMaxValues(elements);\n\n        return sizes;\n    },\n\n    updateMaxValues: function(elements) {\n        var parent = this.element ? this.element.parent('.submenu-selector') : null;\n        if (!parent && !elements) { return false; }\n\n        var blocks = elements || parent.search('> [data-mm-id]'), sizes, inputs;\n\n        blocks.forEach(function(block){\n            block = $(block);\n            var sibling = block.nextSibling() || block.previousSibling();\n            if (!sibling) { return; }\n\n            inputs = {\n                block: block.find('input.column-pc'),\n                sibling: sibling.find('input.column-pc')\n            };\n\n            sizes = {\n                current: this.getSize(block),\n                sibling: this.getSize(sibling)\n            };\n\n            sizes.total = sizes.current + sizes.sibling;\n            inputs.block.attribute('max', sizes.total - Number(inputs.block.attribute('min')));\n            inputs.sibling.attribute('max', sizes.total - Number(inputs.sibling.attribute('min')));\n        }, this);\n    },\n\n    evenResize: function(elements, animated) {\n        var total = elements.length,\n            size = precision(100 / total, 4);\n\n        elements.forEach(function(element) {\n            element = $(element);\n            this.setSize(element, size, (typeof animated == 'undefined' ? false : animated));\n        }, this);\n\n        this.updateItemSizes(elements);\n        this.menumanager.emit('dragEnd', this.menumanager.map, 'evenResize');\n    }\n});\n\nmodule.exports = Resizer;\n","\"use strict\";\nvar $             = require('elements'),\n    zen           = require('elements/zen'),\n    ready         = require('elements/domready'),\n    Submit        = require('../fields/submit'),\n    modal         = require('../ui').modal,\n    toastr        = require('../ui').toastr,\n    request       = require('agent'),\n    indexOf       = require('mout/array/indexOf'),\n    trim          = require('mout/string/trim'),\n    parseAjaxURI  = require('../utils/get-ajax-url').parse,\n    getAjaxURL    = require('../utils/get-ajax-url').global,\n    getAjaxSuffix = require('../utils/get-ajax-suffix'),\n    flags         = require('../utils/flags-state'),\n    deepEquals    = require('mout/lang/deepEquals'),\n    translate     = require('../utils/translate'),\n\n    Cards         = require('../positions/cards'); // required for Positions\n\nvar WordpressWidgetsCustomizer = require('../utils/wp-widgets-customizer');\n\nvar menumanager = null;\n\nvar randomID = function randomString(len, an) {\n    an = an && an.toLowerCase();\n    var str = \"\", i = 0, min = an == 'a' ? 10 : 0, max = an == 'n' ? 10 : 62;\n\n    for (; i++ < len;) {\n        var r = Math.random() * (max - min) + min << 0;\n        str += String.fromCharCode(r += r > 9 ? r < 36 ? 55 : 61 : 48);\n    }\n    return str;\n};\n\nvar StepOne = function(map, mode) { // mode [reorder, resize, evenResize]\n    if (this.isNewParticle && mode !== 'reorder') { return; }\n    this.resizer.updateItemSizes();\n\n    menumanager = this;\n\n    var save = $('[data-save]'),\n        current = {\n            settings: this.settings,\n            ordering: this.ordering,\n            items: this.items\n        };\n\n    if (!this.isNewParticle) {\n        if (!deepEquals(map, current)) {\n            save.showIndicator('fa fa-fw changes-indicator fa-circle-o');\n            flags.set('pending', true);\n        } else {\n            save.hideIndicator();\n            flags.set('pending', false);\n        }\n    }\n\n    if (this.isParticle && this.isNewParticle) {\n        var blocktype = this.block.data('mm-blocktype');\n        this.block.attribute('data-mm-blocktype', null).addClass('g-menu-item-' + blocktype).data('mm-original-type', blocktype);\n        zen('span.menu-item-type.badge').text(blocktype).after(this.block.find('.menu-item .title'));\n\n        modal.open({\n            content: translate('GANTRY5_PLATFORM_JS_LOADING'),\n            method: 'post',\n            //data: data,\n            remote: parseAjaxURI($(this.block).find('.config-cog').attribute('href') + getAjaxSuffix()),\n            remoteLoaded: function(response, modal) {\n                var search = modal.elements.content.find('.search input'),\n                    blocks = modal.elements.content.search('[data-mm-type]'),\n                    filters = modal.elements.content.search('[data-mm-filter]');\n\n                if (!search || !filters || !blocks) { return; }\n\n                search.on('input', function() {\n                    if (!this.value()) {\n                        blocks.removeClass('hidden');\n                        return;\n                    }\n\n                    blocks.addClass('hidden');\n\n                    var found = [], value = this.value().toLowerCase(), text;\n\n                    filters.forEach(function(filter) {\n                        filter = $(filter);\n                        text = trim(filter.data('mm-filter')).toLowerCase();\n                        if (text.match(new RegExp(\"^\" + value + '|\\\\s' + value, 'gi'))) {\n                            found.push(filter.matches('[data-mm-type]') ? filter : filter.parent('[data-mm-type]'));\n                        }\n                    }, this);\n\n                    if (found.length) { $(found).removeClass('hidden'); }\n                });\n\n                setTimeout(function(){\n                    search[0].focus();\n                }, 5);\n            }\n        });\n    }\n\n    this.type = undefined;\n};\n\nvar StepTwo = function(data, content, button) {\n    var uri = content.find('[data-mm-particle-stepone]').data('mm-particle-stepone'),\n        picker = data.instancepicker,\n        moduleType = {\n            wordpress: 'widget',\n            joomla: 'particle'\n        };\n\n    if (picker) {\n        var item = JSON.parse(data.item);\n        picker = JSON.parse(picker);\n        delete(data.instancepicker);\n        //uri = getAjaxURL(item.type + '/' + item[moduleType[GANTRY_PLATFORM]]);\n        uri = getAjaxURL(item.type + '/' + item[item.type]);\n    }\n\n    request('post', parseAjaxURI(uri + getAjaxSuffix()), data, function(error, response) {\n        if (!response.body.success) {\n            modal.open({\n                content: response.body.html || response.body,\n                afterOpen: function(container) {\n                    if (!response.body.html) { container.style({ width: '90%' }); }\n                }\n            });\n\n            button.hideIndicator();\n\n            return;\n        }\n\n        content.html(response.body.html);\n\n        var selects = $('[data-selectize]');\n        if (selects) { selects.selectize(); }\n\n        var urlTemplate = content.find('.g-urltemplate');\n        if (urlTemplate) { $('body').emit('input', { target: urlTemplate }); }\n\n        var form = content.find('form'),\n            submit = content.find('input[type=\"submit\"], button[type=\"submit\"]'),\n            fakeDOM = zen('div').html(response.body.html).find('form');\n\n        if ((!form && !fakeDOM) || !submit) { return true; }\n\n        var applyAndSave = content.search('[data-apply-and-save]');\n        if (applyAndSave) { applyAndSave.remove(); }\n\n        // Module / Particle Settings apply\n        submit.on('click', function(e) {\n            e.preventDefault();\n\n            submit.showIndicator();\n\n            var post = Submit(fakeDOM[0].elements, content, { submitUnchecked: true });\n\n            request(fakeDOM.attribute('method'), parseAjaxURI(fakeDOM.attribute('action') + getAjaxSuffix()), post.valid.join('&') || {}, function(error, response) {\n                if (!response.body.success) {\n                    modal.open({\n                        content: response.body.html || response.body,\n                        afterOpen: function(container) {\n                            if (!response.body.html) { container.style({ width: '90%' }); }\n                        }\n                    });\n                } else {\n                    // it's menu\n                    // FIXME: this is now handling both the Menu and the Positions when inserting a new Particle. Needs to be separated\n                    if (!picker) {\n                        if (menumanager) {\n                            // case for Menu Manager\n                            var element = menumanager.element,\n                                path    = element.data('mm-id') + '-',\n                                id      = randomID(5),\n                                base    = element.parent('[data-mm-base]').data('mm-base'),\n                                col     = (element.parent('[data-mm-id]').data('mm-id').match(/\\d+$/) || [0])[0],\n                                index   = indexOf(element.parent().children('[data-mm-id]'), element[0]);\n\n                            while (menumanager.items[path + id]) { id = randomID(5); }\n\n                            menumanager.items[path + id] = response.body.item;\n                            if (!menumanager.ordering[base]) menumanager.ordering[base] = [];\n                            if (!menumanager.ordering[base][col]) menumanager.ordering[base][col] = [];\n                            menumanager.ordering[base][col].splice(index, 1, path + id);\n                            element.data('mm-id', path + id);\n\n                            if (response.body.html) {\n                                element.html(response.body.html);\n                            }\n\n                            menumanager.isNewParticle = false;\n                            menumanager.emit('dragEnd', menumanager.map);\n                            toastr.success(translate('GANTRY5_PLATFORM_JS_MENU_SETTINGS_APPLIED'), translate('GANTRY5_PLATFORM_JS_SETTINGS_APPLIED'));\n\n                        } else {\n                            // case for Positions\n                            var position = $('[data-position-name=\"' + response.body.position + '\"]'),\n                                dummy = zen('div').html(response.body.html);\n\n                            position.find('> ul').appendChild(dummy.children());\n\n                            Cards.serialize(position);\n\n                            toastr.success(translate('GANTRY5_PLATFORM_JS_POSITIONS_SETTINGS_APPLIED'), translate('GANTRY5_PLATFORM_JS_SETTINGS_APPLIED'));\n                        }\n                    } else { // it's field picker\n                        var field = $('[name=\"' + picker.field + '\"]'),\n                            btnPicker = field.siblings('[data-g-instancepicker]'),\n                            label = field.siblings('.g-instancepicker-title');\n\n                        if (field) {\n                            field.value(JSON.stringify(response.body.item));\n                            $('body').emit('change', { target: field });\n                        }\n                        if (label) { label.text(response.body.item.title); }\n\n                        if (item.type == 'particle') {\n                            btnPicker.text(btnPicker.data('g-instancepicker-alttext'));\n                        }\n                    }\n                }\n\n                modal.close();\n                submit.hideIndicator();\n                WordpressWidgetsCustomizer(field);\n            });\n        });\n    });\n};\n\n\nready(function() {\n    var body = $('body');\n\n    body.delegate('click', '.menu-editor-extras [data-lm-blocktype], .menu-editor-extras [data-mm-module]', function(event, element) {\n        var container = element.parent('.menu-editor-extras'),\n            elements = container.search('[data-lm-blocktype], [data-mm-module]'),\n            selectButton = container.find('[data-mm-select]');\n\n        elements.removeClass('selected');\n        element.addClass('selected');\n\n        selectButton.attribute('disabled', null);\n    });\n\n    // second step\n    body.delegate('click', '.menu-editor-extras [data-mm-select]', function(event, element) {\n        event.preventDefault();\n\n        if (element.hasClass('disabled') || element.attribute('disabled')) { return false; }\n\n        var container = element.parent('.menu-editor-extras'),\n            selected = container.find('[data-lm-blocktype].selected, [data-mm-module].selected'),\n            type = selected.data('mm-type');\n\n        data = { type: type };\n\n        switch (type) {\n            case 'particle':\n                data['particle'] = selected.data('lm-subtype');\n                break;\n\n            case 'widget':\n                data['widget'] = selected.data('lm-subtype');\n                break;\n\n            case 'module':\n                data['particle'] = type;\n                data['title'] = selected.find('[data-mm-title]').data('mm-title');\n                data['options'] = { particle: { module_id: selected.data('mm-module') } };\n                break;\n        }\n\n        element.showIndicator();\n\n\n        var data, instancepicker = element.data('g-instancepicker');\n\n        if (instancepicker && type == 'module') {\n            data = JSON.parse(instancepicker);\n            var field = $('[name=\"' + data.field + '\"]');\n            if (field) {\n                field.value(selected.data('mm-module'));\n                body.emit('input', { target: field });\n            }\n\n            element.hideIndicator();\n            modal.close();\n\n            return false;\n        } else {\n            var ip = instancepicker;\n            element.data('g-instancepicker', null);\n            StepTwo({\n                item: JSON.stringify(data),\n                instancepicker: ip ? ip : null\n            }, element.parent('.g5-content'), element);\n        }\n    });\n});\n\nmodule.exports = StepOne;\n","\"use strict\";\nvar ready         = require('elements/domready'),\n    MenuManager   = require('./menumanager'),\n    Submit        = require('../fields/submit'),\n    $             = require('elements'),\n    zen           = require('elements/zen'),\n    modal         = require('../ui').modal,\n    toastr        = require('../ui').toastr,\n    extraItems    = require('./extra-items'),\n    request       = require('agent'),\n    trim          = require('mout/string/trim'),\n    clamp         = require('mout/math/clamp'),\n    contains      = require('mout/array/contains'),\n    indexOf       = require('mout/array/indexOf'),\n    parseAjaxURI  = require('../utils/get-ajax-url').parse,\n    getAjaxSuffix = require('../utils/get-ajax-suffix'),\n    translate     = require('../utils/translate');\n\nvar menumanager;\n\nvar isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n\nvar FOCUSIN  = isFirefox ? 'focus' : 'focusin',\n    FOCUSOUT = isFirefox ? 'blur' : 'focusout';\n\nready(function() {\n    var body = $('body');\n\n    menumanager = new MenuManager('[data-mm-container]', {\n        delegate: '.g5-mm-particles-picker ul li, #menu-editor > section ul li, .submenu-column, .submenu-column li[data-mm-id], .column-container .g-block',\n        droppables: '#menu-editor [data-mm-id]',\n        exclude: '[data-lm-nodrag], .menu-item-back, .fa-cog, .config-cog',\n        resize_handles: '.submenu-column:not(:last-child)',\n        catchClick: true\n    });\n\n\n    // Handles Modules / Particles items in the Menu\n    menumanager.on('dragEnd', extraItems);\n\n    module.exports.menumanager = menumanager;\n\n    // Menu Manager\n    menumanager.setRoot();\n\n    // Refresh ordering/items on menu type change or Menu navigation link\n    body.delegate('statechangeAfter', '#main-header [data-g5-ajaxify], select.menu-select-wrap', function(/*event, element*/) {\n        menumanager.setRoot();\n        menumanager.refresh();\n\n        // refresh MM eraser\n        if (menumanager.eraser) {\n            menumanager.eraser.element = $('[data-mm-eraseparticle]');\n            menumanager.eraser.hide();\n        }\n    });\n\n    body.delegate(FOCUSIN, '.percentage input', function(event, element) {\n        element = $(element);\n        element.currentSize = Number(element.value());\n\n        element[0].focus();\n        element[0].select();\n    }, true);\n\n    body.delegate('keydown', '.percentage input', function(event/*, element*/) {\n        if (contains([46, 8, 9, 27, 13, 110, 190], event.keyCode) ||\n                // Allow: [Ctrl|Cmd]+A | [Ctrl|Cmd]+R\n            (event.keyCode == 65 && (event.ctrlKey === true || event.ctrlKey === true)) ||\n            (event.keyCode == 82 && (event.ctrlKey === true || event.metaKey === true)) ||\n                // Allow: home, end, left, right, down, up\n            (event.keyCode >= 35 && event.keyCode <= 40)) {\n            // let it happen, don't do anything\n            return;\n        }\n        // Ensure that it is a number and stop the keypress\n        if ((event.shiftKey || (event.keyCode < 48 || event.keyCode > 57)) && (event.keyCode < 96 || event.keyCode > 105)) {\n            event.preventDefault();\n        }\n    });\n\n    body.delegate('keydown', '.percentage input', function(event, element) {\n        element = $(element);\n        var value  = Number(element.value()),\n            min    = Number(element.attribute('min')),\n            max    = Number(element.attribute('max')),\n            upDown = event.keyCode == 38 || event.keyCode == 40;\n\n        if (upDown) {\n            value += event.keyCode == 38 ? +1 : -1;\n            value = clamp(value, min, max);\n            element.value(value);\n            body.emit('keyup', { target: element });\n        }\n    });\n\n    body.delegate('keyup', '.percentage input', function(event, element) {\n        element = $(element);\n        var value = Number(element.value()),\n            min   = Number(element.attribute('min')),\n            max   = Number(element.attribute('max'));\n\n        var resizer = menumanager.resizer,\n            parent  = element.parent('[data-mm-id]'),\n            sibling = parent.nextSibling('[data-mm-id]') || parent.previousSibling('[data-mm-id]');\n\n        if (!value || value < min || value > max) { return; }\n\n        var sizes = {\n            current: Number(element.currentSize),\n            sibling: Number(resizer.getSize(sibling))\n        };\n\n        element.currentSize = value;\n\n        sizes.total = sizes.current + sizes.sibling;\n        sizes.diff = sizes.total - value;\n\n        resizer.setSize(parent, value);\n        resizer.setSize(sibling, sizes.diff);\n\n        menumanager.resizer.updateItemSizes(parent.parent('.submenu-selector').search('> [data-mm-id]'));\n        menumanager.emit('dragEnd', menumanager.map, 'inputChange');\n    });\n\n    body.delegate(FOCUSOUT, '.percentage input', function(event, element) {\n        element = $(element);\n        var value = Number(element.value());\n        if (value < Number(element.attribute('min')) || value > Number(element.attribute('max'))) {\n            element.value(element.currentSize);\n        }\n    }, true);\n\n    // Add new columns\n    body.delegate('click', '.add-column', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n        element = $(element);\n\n        var container = element.parent('[data-g5-menu-columns]').find('.submenu-selector'),\n            children  = container.children(),\n            last      = container.find('> :last-child'),\n            count     = children ? children.length : 0,\n            active    = $('.menu-selector .active'),\n            path      = active ? active.data('mm-id') : null;\n\n        // do not allow to create a new column if there's already one and it's empty\n        if (count == 1 && !children.search('.submenu-items > [data-mm-id]')) { return false; }\n\n        var block = $(last[0].cloneNode(true));\n        block.data('mm-id', 'list-' + count);\n        block.find('.submenu-items').empty();\n        block.find('[data-mm-base-level]').data('mm-base-level', 1);\n        block.find('.submenu-level').text('Level 1');\n        block.after(last);\n\n        if (!menumanager.ordering[path]) {\n            menumanager.ordering[path] = [[]];\n        }\n\n        menumanager.ordering[path].push([]);\n        menumanager.resizer.evenResize($('.submenu-selector > [data-mm-id]'));\n    });\n\n    // Attach events to pseudo (x) for deleting a column\n    ['click', 'touchend'].forEach(function(evt) {\n        body.delegate(evt, '[data-g5-menu-columns] .submenu-items:empty', function(event, element) {\n            var bounding = element[0].getBoundingClientRect(),\n                x        = event.pageX || event.changedTouches[0].pageX || 0, y = event.pageY || event.changedTouches[0].pageY || 0,\n                siblings = $('.submenu-selector > [data-mm-id]'),\n                deleter  = {\n                    width: 36,\n                    height: 36\n                };\n\n            if (siblings.length <= 1) {\n                return false;\n            }\n\n            if (x >= bounding.left + bounding.width - deleter.width && x <= bounding.left + bounding.width &&\n                Math.abs(window.scrollY - y) - bounding.top < deleter.height) {\n                var parent    = element.parent('[data-mm-id]'),\n                    container = parent.parent('.submenu-selector').children('[data-mm-id]'),\n                    index     = indexOf(container, parent),\n                    active    = $('.menu-selector .active'),\n                    path      = active ? active.data('mm-id') : null;\n\n                parent.remove();\n                siblings = $('.submenu-selector > [data-mm-id]');\n                menumanager.ordering[path].splice(index, 1);\n                menumanager.resizer.evenResize(siblings);\n            }\n        });\n    });\n\n    // Menu Items settings\n    body.delegate('click', '#menu-editor .config-cog, #menu-editor .global-menu-settings', function(event, element) {\n        event.preventDefault();\n\n        var data = {}, isRoot = element.hasClass('global-menu-settings');\n\n        if (isRoot) {\n            data.settings = JSON.stringify(menumanager.settings);\n        } else {\n            data.item = JSON.stringify(menumanager.items[element.parent('[data-mm-id]').data('mm-id')]);\n        }\n\n        modal.open({\n            content: translate('GANTRY5_PLATFORM_JS_LOADING'),\n            method: 'post',\n            data: data,\n            overlayClickToClose: false,\n            remote: parseAjaxURI($(element).attribute('href') + getAjaxSuffix()),\n            remoteLoaded: function(response, content) {\n                if (!response.body.success) {\n                    modal.enableCloseByOverlay();\n                    return;\n                }\n                \n                var form       = content.elements.content.find('form'),\n                    fakeDOM    = zen('div').html(response.body.html).find('form'),\n                    submit     = content.elements.content.search('input[type=\"submit\"], button[type=\"submit\"], [data-apply-and-save]'),\n                    path;\n\n                var search      = content.elements.content.find('.search input'),\n                    blocks      = content.elements.content.search('[data-mm-type]'),\n                    filters     = content.elements.content.search('[data-mm-filter]'),\n                    urlTemplate = content.elements.content.find('.g-urltemplate');\n\n                if (urlTemplate) { body.emit('input', { target: urlTemplate }); }\n\n                var editable = content.elements.content.find('[data-title-editable]');\n                if (editable) {\n                    editable.on('title-edit-end', function(title, original/*, canceled*/) {\n                        title = trim(title);\n                        if (!title) {\n                            title = trim(original) || 'Title';\n                            this.text(title).data('title-editable', title);\n\n                            return true;\n                        }\n                    });\n                }\n\n                if (search && filters && blocks) {\n                    search.on('input', function() {\n                        if (!this.value()) {\n                            blocks.removeClass('hidden');\n                            return;\n                        }\n\n                        blocks.addClass('hidden');\n\n                        var found = [], value = this.value().toLowerCase(), text;\n\n                        filters.forEach(function(filter) {\n                            filter = $(filter);\n                            text = trim(filter.data('mm-filter')).toLowerCase();\n                            if (text.match(new RegExp(\"^\" + value + '|\\\\s' + value, 'gi'))) {\n                                found.push(filter.matches('[data-mm-type]') ? filter : filter.parent('[data-mm-type]'));\n                            }\n                        }, this);\n\n                        if (found.length) { $(found).removeClass('hidden'); }\n                    });\n                }\n\n                if (search) {\n                    setTimeout(function() {\n                        search[0].focus();\n                    }, 5);\n                }\n\n                if ((!form && !fakeDOM) || !submit) { return true; }\n\n                // Menuitems Settings apply\n                submit.on('click', function(e) {\n                    e.preventDefault();\n\n                    var target = $(e.currentTarget);\n                    target.disabled(true);\n                    target.hideIndicator();\n                    target.showIndicator();\n\n                    var post = Submit(fakeDOM[0].elements, content.elements.content, {isRoot: isRoot});\n\n                    if (post.invalid.length) {\n                        target.disabled(false);\n                        target.hideIndicator();\n                        target.showIndicator('fa fa-fw fa-exclamation-triangle');\n                        toastr.error(translate('GANTRY5_PLATFORM_JS_REVIEW_FIELDS'), translate('GANTRY5_PLATFORM_JS_INVALID_FIELDS'));\n                        return;\n                    }\n\n                    request(fakeDOM.attribute('method'), parseAjaxURI(fakeDOM.attribute('action') + getAjaxSuffix()), post.valid.join('&'), function(error, response) {\n                        if (!response.body.success) {\n                            modal.open({\n                                content: response.body.html || response.body,\n                                afterOpen: function(container) {\n                                    if (!response.body.html) { container.style({ width: '90%' }); }\n                                }\n                            });\n                        } else {\n                            if (response.body.path || (response.body.item && response.body.item.type == 'particle')) {\n                                path = response.body.path || element.parent('[data-mm-id]').data('mm-id');\n                                menumanager.items[path] = response.body.item;\n                            } else if (response.body.item && response.body.item.type == 'particle') {\n\n                            } else {\n                                menumanager.settings = response.body.settings;\n                            }\n\n                            if (response.body.html) {\n                                var parent = element.parent('[data-mm-id]');\n                                if (parent) {\n                                    var status = response.body.item.enabled || response.body.item.options.particle.enabled;\n                                    parent.html(response.body.html);\n                                    parent[status == '0' ? 'addClass' : 'removeClass']('g-menu-item-disabled');\n                                }\n                            }\n\n                            menumanager.emit('dragEnd', menumanager.map);\n\n                            // if it's apply and save we also save the panel\n                            if (target.data('apply-and-save') !== null) {\n                                var save = $('body').find('.button-save');\n                                if (save) { body.emit('click', { target: save }); }\n                            }\n\n                            modal.close();\n                            toastr.success(translate('GANTRY5_PLATFORM_JS_MENU_SETTINGS_APPLIED'), translate('GANTRY5_PLATFORM_JS_SETTINGS_APPLIED'));\n                        }\n\n                        target.hideIndicator();\n                    });\n                });\n            }\n        });\n    });\n});\n\nmodule.exports = {\n    menumanager: menumanager\n};\n","\"use strict\";\nvar prime     = require('prime'),\n    $         = require('../utils/elements.utils'),\n    bind       = require('mout/function/bind'),\n    zen       = require('elements/zen'),\n    Emitter   = require('prime/emitter'),\n    Bound     = require('prime-util/prime/bound'),\n    Options   = require('prime-util/prime/options'),\n    DragDrop  = require('../ui/drag.drop'),\n    Eraser     = require('../ui/eraser'),\n    Resizer   = require('./drag.resizer'),\n    get       = require('mout/object/get'),\n\n    ltrim     = require('mout/string/ltrim'),\n    every     = require('mout/array/every'),\n    last      = require('mout/array/last'),\n    indexOf   = require('mout/array/indexOf'),\n    isArray   = require('mout/lang/isArray'),\n    isObject  = require('mout/lang/isObject'),\n    deepClone = require('mout/lang/deepClone'),\n    equals    = require('mout/object/equals');\n\n\nvar MenuManager = new prime({\n\n    mixin: [Bound, Options],\n\n    inherits: Emitter,\n\n    options: {},\n\n    constructor: function(element, options) {\n        this.setOptions(options);\n        this.refElement = element;\n        this.map = {};\n\n        if (!element || !$(element)) { return; }\n\n        this.init(element);\n    },\n\n    init: function() {\n        this.setRoot();\n\n        this.dragdrop = new DragDrop(this.refElement, this.options, this);\n        this.resizer = new Resizer(this.refElement, this.options, this);\n        this.eraser = new Eraser('[data-mm-eraseparticle]', this.options);\n        this.dragdrop\n            .on('dragdrop:click', this.bound('click'))\n            .on('dragdrop:start', this.bound('start'))\n            .on('dragdrop:move:once', this.bound('moveOnce'))\n            .on('dragdrop:location', this.bound('location'))\n            .on('dragdrop:nolocation', this.bound('nolocation'))\n            .on('dragdrop:resize', this.bound('resize'))\n            .on('dragdrop:stop:erase', this.bound('removeElement'))\n            .on('dragdrop:stop', this.bound('stop'))\n            .on('dragdrop:stop:animation', this.bound('stopAnimation'));\n    },\n\n    refresh: function() {\n        if (!this.refElement || !$(this.refElement)) { return; }\n        this.init();\n    },\n\n    setRoot: function() {\n        this.root = $('#menu-editor');\n\n        if (this.root) {\n            this.settings = JSON.parse(this.root.data('menu-settings'));\n            this.ordering = JSON.parse(this.root.data('menu-ordering'));\n            this.items = JSON.parse(this.root.data('menu-items'));\n\n            this.map = {\n                settings: deepClone(this.settings),\n                ordering: deepClone(this.ordering),\n                items: deepClone(this.items)\n            };\n\n            var submenus = $('[data-g5-menu-columns] .submenu-selector'), columns;\n            if (this.resizer && submenus && (columns = submenus.search('> [data-mm-id]'))) { this.resizer.updateMaxValues(columns); }\n        }\n    },\n\n    click: function(event, element) {\n        var target = $(event.target);\n        if (target.matches('.g-menu-addblock') || target.parent('.g-menu-addblock')) {\n            return false;\n        }\n\n        if (element.hasClass('g-block')) {\n            this.stopAnimation();\n            return true;\n        }\n\n        if (element.find('[data-g5-ajaxify]')) {\n            var siblings = element.siblings();\n            element.addClass('active');\n            if (siblings) { siblings.removeClass('active'); }\n        }\n\n        element.emit('click');\n\n        var link = element.find('a');\n        if (link) { link[0].click(); }\n    },\n\n    resize: function(event, element, siblings, offset) {\n        this.resizer.start(event, element, siblings, offset);\n    },\n\n    start: function(event, element) {\n        var root = element.parent('.menu-selector') || element.parent('.submenu-column') || element.parent('.submenu-selector') || element.parent('.g5-mm-particles-picker'),\n            size = $(element).position(),\n            coords = $(element)[0].getBoundingClientRect();\n\n        this.block = null;\n        this.targetLevel = undefined;\n        this.addNewItem = false;\n        this.type =  element.parent('.g-toplevel') || element.matches('.g-toplevel') ? 'main' : (element.matches('.g-block') ? 'column' : 'columns_items');\n        this.isParticle = element.matches('[data-mm-blocktype]') || element.matches('[data-mm-original-type]');\n        this.wasActive = element.hasClass('active');\n        this.isNewParticle = element.parent('.g5-mm-particles-picker');\n        this.ParticleIndex = -1;\n        this.root = root;\n\n        this.itemID = element.data('mm-id');\n        this.itemLevel = element.data('mm-level');\n        this.itemFrom = element.parent('[data-mm-id]');\n        this.itemTo = null;\n\n        if (this.isParticle && !this.isNewParticle) {\n            var children = element.parent().children('[data-mm-id]');\n            this.ParticleIndex = indexOf(children, element[0]);\n        }\n\n        root.addClass('moving');\n\n        var type = $(element).data('mm-id'),\n            clone = element[0].cloneNode(true);\n\n        if (!this.placeholder) { this.placeholder = zen((this.type == 'column' ? 'div' : 'li') + '.block.placeholder[data-mm-placeholder]'); }\n        this.placeholder.style({ display: 'none' });\n        this.original = $(clone).after(element).style({\n            display: 'inline-block',\n            opacity: 1\n        }).addClass('original-placeholder').data('lm-dropzone', null);\n        this.originalType = type;\n        this.block = element;\n\n        if (!this.isNewParticle) {\n            element.style({\n                position: 'fixed',\n                zIndex: 1500,\n                width: Math.ceil(size.width),\n                height: Math.ceil(size.height),\n                left: coords.left,\n                top: coords.top\n            }).addClass('active');\n\n            this.placeholder.before(element);\n        } else {\n            var position = element.position();\n            this.original.style({\n                position: 'fixed',\n                opacity: 0.5\n            }).style({\n                left: coords.left,\n                top: coords.top,\n                width: position.width,\n                height: position.height\n            });\n            this.element = this.dragdrop.element;\n            this.block = this.dragdrop.element;\n            this.dragdrop.element = this.original;\n        }\n\n        if (this.type == 'column') {\n            root.search('.g-block > *').style({ 'pointer-events': 'none' });\n        }\n    },\n\n    moveOnce: function(element) {\n        var type = $(element).data('mm-id');\n        if (this.original) { this.original.style({ opacity: 0.5 }); }\n\n        // it's a module or a particle and we allow for them to be deleted\n        if (!this.isNewParticle && (type && type.match(/__(module|particle|widget)(-[a-z0-9]{5,})?$/i))) {\n            this.eraser.show();\n        }\n    },\n\n    location: function(event, location, target/*, element*/) {\n        target = $(target);\n        (!this.isNewParticle ? this.original : this.block).style({transform: 'translate(0, 0)'});\n        if (!this.placeholder) { this.placeholder = zen((this.type == 'column' ? 'div' : 'li') + '.block.placeholder[data-mm-placeholder]').style({ display: 'none' }); }\n\n        var targetType = target.parent('.g-toplevel') || target.matches('.g-toplevel') ? 'main' : (target.matches('.g-block') ? 'column' : 'columns_items'),\n            dataLevel = target.data('mm-level'),\n            originalLevel = this.block.data('mm-level');\n\n        if (this.isParticle && (targetType === 'main' && !dataLevel)) {\n            this.dragdrop.matched = false;\n            return;\n        }\n\n        // Support for nested new particles/modules/widgets\n        if (dataLevel === null && this.type === 'columns_items' && this.isParticle && this.isNewParticle) {\n            var submenu_items = target.find('.submenu-items');\n            if (!submenu_items) {\n                this.dragdrop.matched = false;\n                return;\n            }\n\n            this.placeholder.style({ display: 'block' }).bottom(submenu_items);\n            this.addNewItem = submenu_items;\n            this.targetLevel = 2;\n            this.dragdrop.matched = false;\n            return;\n        }\n\n        // Workaround for layout and style of columns\n        if (dataLevel === null && (this.type === 'columns_items' || this.isParticle)) {\n            var submenu_items = target.find('.submenu-items'),\n                submenu_items_level = submenu_items.data('mm-base-level');\n\n            // extend drop areas and ensure items cannot be dragged between different levels\n            if ((!target.hasClass('g-block') || target.find(this.block)) || (!this.isParticle && originalLevel != submenu_items_level) && (!submenu_items || submenu_items.children() || originalLevel > 2)) {\n                this.dragdrop.matched = false;\n                return;\n            }\n\n            this.placeholder.style({ display: 'block' }).bottom(submenu_items);\n            this.addNewItem = submenu_items;\n            this.targetLevel = 2;\n            this.dragdrop.matched = false;\n            return;\n        }\n\n\n        if (!this.isParticle) {\n\n            // We only allow sorting between same level items\n            if (this.type !== 'column' && originalLevel !== dataLevel) {\n                this.dragdrop.matched = false;\n                return;\n            }\n\n            // Ensuring columns can only be dragged before/after other columns\n            if (this.type == 'column' && dataLevel) {\n                this.dragdrop.matched = false;\n                return;\n            }\n\n            // For levels > 2 we only allow sorting within the same column\n            if (dataLevel > 2 && target.parent('ul') != this.block.parent('ul')) {\n                this.dragdrop.matched = false;\n                return;\n            }\n        }\n\n        // Check for adjacents and avoid inserting any placeholder since it would be the same position\n        var exclude = ':not(.placeholder):not([data-mm-id=\"' + this.original.data('mm-id') + '\"])',\n            adjacents = {\n                before: this.original.previousSiblings(exclude),\n                after: this.original.nextSiblings(exclude)\n            };\n\n        if (adjacents.before) { adjacents.before = $(adjacents.before[0]); }\n        if (adjacents.after) { adjacents.after = $(adjacents.after[0]); }\n\n\n        if (targetType === 'main' && ((adjacents.before === target && location.x === 'after') || (adjacents.after === target && location.x === 'before'))) {\n            return;\n        }\n        if (targetType === 'column' && ((adjacents.before === target && location.x === 'after') || (adjacents.after === target && location.x === 'before'))) {\n            return;\n        }\n        if (targetType === 'columns_items' && ((adjacents.before === target && location.y === 'below') || (adjacents.after === target && location.y === 'above'))) {\n            return;\n        }\n\n        // Handles the types cases and normalizes the locations (x and y)\n        switch (targetType) {\n            case 'main':\n            case 'column':\n                this.placeholder[location.x](target);\n                break;\n            case 'columns_items':\n                this.placeholder[location.y === 'above' ? 'before' : 'after'](target);\n\n                break;\n        }\n\n        this.targetLevel = dataLevel;\n\n        // If it's not a block we don't want a small version of the placeholder\n        this.placeholder.style({ display: 'block' })[targetType !== 'main' ? 'removeClass' : 'addClass']('in-between');\n\n    },\n\n    nolocation: function(event) {\n        (!this.isNewParticle ? this.original : this.block).style({transform: 'translate(0, 0)'});\n        if (this.placeholder) { this.placeholder.remove(); }\n        this.targetLevel = undefined;\n\n        var target = event.type.match(/^touch/i) ? document.elementFromPoint(event.touches.item(0).clientX, event.touches.item(0).clientY) : event.target;\n\n        if (!this.isNewParticle && this.itemID.match(/__(module|particle|widget)(-[a-z0-9]{5})?$/i)) {\n            target = $(target);\n            if (target.matches(this.eraser.element) || this.eraser.element.find(target)) {\n                this.dragdrop.removeElement = true;\n                this.eraser.over();\n            } else {\n                this.dragdrop.removeElement = false;\n                this.eraser.out();\n            }\n        }\n    },\n\n    removeElement: function(event, element) {\n        this.dragdrop.removeElement = false;\n\n        var transition = {\n            opacity: 0\n        };\n\n        element.animate(transition, {\n            duration: '150ms'\n        });\n\n        if (this.type == 'column') {\n            this.root.search('.g-block > *').style({ 'pointer-events': 'none' });\n        }\n\n        this.eraser.hide();\n\n        this.dragdrop.DRAG_EVENTS.EVENTS.MOVE.forEach(bind(function(event) {\n            $('body').off(event, this.dragdrop.bound('move'));\n        }, this));\n\n        this.dragdrop.DRAG_EVENTS.EVENTS.STOP.forEach(bind(function(event) {\n            $('body').off(event, this.dragdrop.bound('deferStop'));\n        }, this));\n\n        var particle = this.block,\n            base = particle.parent('[data-mm-base]').data('mm-base'),\n            col = (particle.parent('[data-mm-id]').data('mm-id').match(/\\d+$/) || [0])[0],\n            index = indexOf(particle.parent().children('[data-mm-id]:not(.original-placeholder)'), particle[0]);\n\n        delete this.items[this.itemID];\n        this.ordering[base][col].splice(index, 1);\n\n        this.block.remove();\n        this.original.remove();\n        this.root.removeClass('moving');\n\n        if (this.root.find('.submenu-items')) {\n            if (!this.root.find('.submenu-items').children()) { this.root.find('.submenu-items').text(''); }\n        }\n\n        this.emit('dragEnd', this.map, 'reorder');\n    },\n\n    stop: function(event, target, element) {\n        target = $(target);\n\n        // we are removing the block\n        var lastOvered = $(this.dragdrop.lastOvered);\n        if (lastOvered && lastOvered.matches(this.eraser.element.find('.trash-zone'))) {\n            this.eraser.hide();\n            return;\n        }\n\n        if (target) { element.removeClass('active'); }\n        if (this.type == 'column') {\n            this.root.search('.g-block > *').attribute('style', null);\n        }\n\n        if (!this.dragdrop.matched && !this.addNewItem) {\n            if (this.placeholder) { this.placeholder.remove(); }\n\n            this.type = undefined;\n            this.targetLevel = false;\n            this.isParticle = undefined;\n            this.eraser.hide();\n            return;\n        }\n\n        var placeholderParent = this.placeholder.parent();\n        if (!placeholderParent) {\n            this.type = undefined;\n            this.targetLevel = false;\n            this.isParticle = undefined;\n            return;\n        }\n\n        if (this.addNewItem) { this.block.attribute('style', null).removeClass('active'); }\n\n        var parent = this.block.parent();\n        this.eraser.hide();\n\n        if (this.original) {\n            if (!this.isNewParticle) { this.original.remove(); }\n            else { this.original.attribute('style', null).removeClass('original-placeholder'); }\n        }\n\n\n        this.block.after(this.placeholder);\n        this.placeholder.remove();\n        this.itemTo = this.block.parent('[data-mm-id]');\n        this.currentLevel = this.itemLevel;\n        if (this.wasActive) { element.addClass('active'); }\n\n        if (this.isParticle) {\n            var id = last(this.itemID.split('/')),\n                targetItem = (target || this.itemTo),\n                base = targetItem[target && !target.hasClass('g-block') ? 'parent' : 'find']('[data-mm-base]').data('mm-base');\n\n            this.itemID = base ? base + '/' + id : id;\n            this.itemLevel = this.targetLevel;\n            this.block.data('mm-id', this.itemID).data('mm-level', this.targetLevel);\n        }\n\n        var path = this.itemID.split('/'),\n            items, column;\n\n        path.splice(this.itemLevel - 1);\n        path = path.join('/');\n\n        // Items reorder for root or sublevels with logic to reorder FROM and TO sublevel column if needed\n        if (this.itemFrom || this.itemTo) {\n            var sources = this.itemFrom == this.itemTo ? [this.itemFrom] : [this.itemFrom, this.itemTo];\n            sources.forEach(function(source) {\n                if (!source) { return; }\n\n                items = source.search('[data-mm-id]');\n                column = Number(this.block.data('mm-level') > 2 ? 0 : (source.data('mm-id').match(/\\d+$/) || [0])[0]);\n\n                if (!items) {\n                    this.ordering[path][column] = [];\n                    return;\n                }\n\n                items = items.map(function(element) {\n                    return $(element).data('mm-id');\n                });\n\n                if (!this.ordering[path]) { this.ordering[path] = []; }\n                this.ordering[path][column] = items;\n            }, this);\n\n            // Refresh the origin if it's a particle\n            base = this.itemFrom ? (this.itemFrom.attribute('data-mm-base') !== null ? this.itemFrom : this.itemFrom.find('[data-mm-base]')) : null;\n            if (this.isParticle && base && this.targetLevel != this.currentLevel) {\n                var list = (this.itemFrom.data('mm-id').match(/\\d+$/) || [0])[0],\n                    location = base.data('mm-base') || '',\n                    currentLocation = ltrim([location, id].join('/'), ['/']);\n\n                this.ordering[location][list].splice(this.ParticleIndex, 1);\n                this.items[this.itemID] = this.items[currentLocation];\n                delete this.items[currentLocation];\n            }\n        }\n\n        // Column reordering, we just need to swap the array indexes\n        if (!this.itemFrom && !this.itemTo && !this.isParticle) {\n            var colsOrder = [],\n                active = $('.g-toplevel [data-mm-id].active').data('mm-id');\n            items = parent.search('> [data-mm-id]');\n\n            items.forEach(function(element, index) {\n                element = $(element);\n\n                var id = element.data('mm-id'),\n                    column = Number((id.match(/\\d+$/) || [0])[0]);\n\n                element.data('mm-id', id.replace(/\\d+$/, index));\n                colsOrder.push(this.ordering[active][column]);\n            }, this);\n\n            this.ordering[active] = colsOrder;\n        }\n\n        if (!parent.children()) { parent.empty(); }\n\n        /*if (console && console.group && console.info && console.table && console.groupEnd) {\n         console.group();\n         console.info('New Ordering');\n         console.table(this.ordering);\n         console.groupEnd();\n         }*/\n\n        var selector = this.block.parent('.submenu-selector');\n        if (selector) { this.resizer.updateItemSizes(selector.search('> [data-mm-id]')); }\n\n        this.emit('dragEnd', this.map, 'reorder');\n    },\n\n    stopAnimation: function(/*element*/) {\n        var flex = null;\n        if (this.type == 'column') { flex = this.resizer.getSize(this.block); }\n        if (this.root) { this.root.removeClass('moving'); }\n        if (this.block) {\n            this.block.attribute('style', null);\n            if (flex) { this.block.style('flex', '0 1 ' + flex + ' %'); }\n        }\n\n        if (this.original) {\n            if (!this.isNewParticle || (!this.dragdrop.matched && !this.targetLevel)) { this.original.remove(); }\n            else { this.original.attribute('style', null).removeClass('original-placeholder'); }\n        }\n\n        if (!this.wasActive && this.block) { this.block.removeClass('active'); }\n    }\n});\n\n\nmodule.exports = MenuManager;\n","'use strict';\nvar $                  = require('elements'),\n    ready              = require('elements/domready'),\n    zen                = require('elements/zen'),\n    Submit             = require('../fields/submit'),\n    modal              = require('../ui').modal,\n    toastr             = require('../ui').toastr,\n    Eraser             = require('../ui/eraser'),\n    request            = require('agent'),\n    indexOf            = require('mout/array/indexOf'),\n    simpleSort         = require('sortablejs'),\n\n    trim               = require('mout/string/trim'),\n    size               = require('mout/object/size'),\n\n    parseAjaxURI       = require('../utils/get-ajax-url').parse,\n    getAjaxSuffix      = require('../utils/get-ajax-suffix'),\n    getOutlineNameById = require('../utils/get-outline').getOutlineNameById,\n    translate          = require('../utils/translate');\n\nvar AtomsField   = '[name=\"page[head][atoms][_json]\"]',\n    groupOptions = [\n        { name: 'atoms', pull: 'clone', put: false },\n        { name: 'atoms', pull: true, put: true },\n        { name: 'atoms', pull: false, put: false }\n    ];\n\nvar Atoms = {\n    eraser: null,\n    lists: {\n        picker: null,\n        items: null\n    },\n\n    serialize: function() {\n        var output = [],\n            list   = $('.atoms-list'),\n            atoms  = list.search('[data-atom-picked]');\n\n        if (!atoms) {\n            list.empty();\n            return '[]';\n        }\n\n        atoms.forEach(function(item) {\n            item = $(item);\n            output.push(JSON.parse(item.data('atom-picked')));\n        });\n\n        return JSON.stringify(output).replace(/\\//g, '\\\\/');\n    },\n\n    attachEraser: function() {\n        if (Atoms.eraser) {\n            Atoms.eraser.element = $('[data-atoms-erase]');\n            return;\n        }\n\n        Atoms.eraser = new Eraser('[data-atoms-erase]');\n    },\n\n    createSortables: function(element) {\n        var list, sort;\n\n        Atoms.attachEraser();\n\n        groupOptions.forEach(function(groupOption, i) {\n            list = !i ? '.atoms-picker' : (i == 1 ? '.atoms-list' : '#trash');\n            list = $(list);\n            sort = simpleSort.create(list[0], {\n                sort: i == 1,\n                filter: '[data-atom-ignore]',\n                group: groupOption,\n                scroll: false,\n                forceFallback: true,\n                animation: 100,\n\n                onStart: function(event) {\n                    Atoms.attachEraser();\n\n                    var item = $(event.item);\n                    item.addClass('atom-dragging');\n\n                    if ($(event.from).hasClass('atoms-list')) {\n                        Atoms.eraser.show();\n                    }\n                },\n\n                onEnd: function(event) {\n                    var item       = $(event.item),\n                        trash      = $('#trash'),\n                        target     = $(this.originalEvent.target),\n                        touchTrash = false;\n\n                    // workaround for touch devices\n                    if (this.originalEvent.type === 'touchend') {\n                        var trashSize = trash[0].getBoundingClientRect(),\n                            oE        = this.originalEvent,\n                            position  = (oE.pageY || oE.changedTouches[0].pageY) - window.scrollY;\n\n                        touchTrash = position <= trashSize.height;\n                    }\n\n                    if (target.matches('#trash') || target.parent('#trash') || touchTrash) {\n                        item.remove();\n                        Atoms.eraser.hide();\n                        this.options.onSort();\n                        return;\n                    }\n\n                    item.removeClass('atom-dragging');\n\n                    if ($(event.from).hasClass('atoms-list')) {\n                        Atoms.eraser.hide();\n                    }\n                },\n\n                onSort: function() {\n                    var serial = Atoms.serialize(),\n                        field  = $(AtomsField);\n\n                    if (!field) { throw new Error('Field \"' + AtomsField + '\" not found in the DOM.'); }\n\n                    field.value(serial);\n                    $('body').emit('change', { target: field });\n                },\n\n                onOver: function(evt) {\n                    if (!$(evt.from).matches('.atoms-list')) { return; }\n\n                    var over = $(evt.newIndex);\n                    if (over.matches('#trash') || over.parent('#trash')) {\n                        Atoms.eraser.over();\n                    } else {\n                        Atoms.eraser.out();\n                    }\n                }\n            });\n\n            Atoms.lists[!i ? 'picker' : 'items'] = sort;\n            if (i == 1) {\n                element.SimpleSort = sort;\n            }\n        });\n    }\n};\n\nvar AttachSettings = function() {\n    var body = $('body');\n\n    body.delegate('click', '.atoms-list [data-atom-picked] .config-cog', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n\n        var list      = element.parent('ul'),\n            dataField = $(AtomsField),\n            data      = dataField.value(),\n            items     = list.search('> [data-atom-picked]'),\n            item      = element.parent('[data-atom-picked]'),\n            itemData  = item.data('atom-picked');\n\n        modal.open({\n            content: translate('GANTRY5_PLATFORM_JS_LOADING'),\n            method: 'post',\n            data: { data: itemData },\n            overlayClickToClose: false,\n            remote: parseAjaxURI(element.attribute('href') + getAjaxSuffix()),\n            remoteLoaded: function(response, content) {\n                var form       = content.elements.content.find('form'),\n                    fakeDOM    = zen('div').html(response.body.html).find('form'),\n                    submit     = content.elements.content.search('input[type=\"submit\"], button[type=\"submit\"], [data-apply-and-save]'),\n                    dataValue  = JSON.parse(data);\n\n                if (modal.getAll().length > 1) {\n                    var applyAndSave = content.elements.content.search('[data-apply-and-save]');\n                    if (applyAndSave) { applyAndSave.remove(); }\n                }\n\n                if ((!form && !fakeDOM) || !submit) {\n                    return true;\n                }\n\n                // Atom Settings apply\n                submit.on('click', function(e) {\n                    e.preventDefault();\n\n                    var target = $(e.currentTarget);\n\n                    target.hideIndicator();\n                    target.showIndicator();\n\n                    // Refresh the form to collect fresh and dynamic fields\n                    var formElements = content.elements.content.find('form')[0].elements;\n                    var post = Submit(formElements, content.elements.content);\n\n                    if (post.invalid.length) {\n                        target.hideIndicator();\n                        target.showIndicator('fa fa-fw fa-exclamation-triangle');\n                        toastr.error(translate('GANTRY5_PLATFORM_JS_REVIEW_FIELDS'), translate('GANTRY5_PLATFORM_JS_INVALID_FIELDS'));\n                        return;\n                    }\n\n                    request(fakeDOM.attribute('method'), parseAjaxURI(fakeDOM.attribute('action') + getAjaxSuffix()), post.valid.join('&') || {}, function(error, response) {\n                        if (!response.body.success) {\n                            modal.open({\n                                content: response.body.html || response.body,\n                                afterOpen: function(container) {\n                                    if (!response.body.html) { container.style({ width: '90%' }); }\n                                }\n                            });\n                        } else {\n                            var index = indexOf(items, item[0]);\n                            dataValue[index] = response.body.item;\n\n                            dataField.value(JSON.stringify(dataValue).replace(/\\//g, '\\\\/'));\n                            item.find('.atom-title').text(dataValue[index].title);\n                            item.data('atom-picked', JSON.stringify(dataValue[index]).replace(/\\//g, '\\\\/'));\n\n                            // toggle enabled/disabled status as needed\n                            var enabled    = Number(dataValue[index].attributes.enabled),\n                                inheriting = response.body.item.inherit && size(response.body.item.inherit);\n                            item[enabled ? 'removeClass' : 'addClass']('atom-disabled');\n                            item[!inheriting ? 'removeClass' : 'addClass']('g-inheriting');\n                            item.attribute('title', enabled ? '' : translate('GANTRY5_PLATFORM_JS_LM_DISABLED_PARTICLE', 'atom'));\n\n                            item.data('tip', null);\n                            if (inheriting) {\n                                var inherit = response.body.item.inherit,\n                                    outline = getOutlineNameById(inherit ? inherit.outline : null),\n                                    atom = inherit.atom || '',\n                                    include = (inherit.include || []).join(', ');\n\n                                item.data('tip', translate('GANTRY5_PLATFORM_INHERITING_FROM_X', '<strong>' + outline + '</strong>') + '<br />ID: ' + atom + '<br />Replace: ' + include);\n                            }\n\n                            body.emit('change', { target: dataField });\n                            global.G5.tips.reload();\n\n                            // if it's apply and save we also save the panel\n                            if (target.data('apply-and-save') !== null) {\n                                var save = $('body').find('.button-save');\n                                if (save) { body.emit('click', { target: save }); }\n                            }\n\n                            modal.close();\n                            toastr.success(translate('GANTRY5_PLATFORM_JS_GENERIC_SETTINGS_APPLIED', 'Atom'), translate('GANTRY5_PLATFORM_JS_SETTINGS_APPLIED'));\n                        }\n\n                        target.hideIndicator();\n                    });\n                });\n            }\n        });\n    });\n};\n\nvar AttachSortableAtoms = function(atoms) {\n    if (!atoms) { return; }\n    if (!atoms.SimpleSort) { Atoms.createSortables(atoms); }\n};\n\nready(function() {\n    var atoms = $('#atoms');\n\n    $('body').delegate('mouseover', '#atoms', function(event, element) {\n        AttachSortableAtoms(element);\n    });\n\n    AttachSortableAtoms(atoms);\n    AttachSettings();\n});\n\nmodule.exports = Atoms;","\"use strict\";\n\nvar ready         = require('elements/domready'),\n    $             = require('elements'),\n    zen           = require('elements/zen'),\n    Submit        = require('../../fields/submit'),\n    modal         = require('../../ui').modal,\n    toastr        = require('../../ui').toastr,\n    request       = require('agent'),\n    lastItem      = require('mout/array/last'),\n    indexOf       = require('mout/array/indexOf'),\n    simpleSort    = require('sortablejs'),\n\n    trim          = require('mout/string/trim'),\n\n    parseAjaxURI  = require('../../utils/get-ajax-url').parse,\n    getAjaxSuffix = require('../../utils/get-ajax-suffix'),\n    translate     = require('../../utils/translate');\n\nrequire('elements/insertion');\n\nready(function() {\n    var body = $('body');\n\n    var addNewByEnter = function(title, key) {\n        if (key == 'enter' && this.CollectionNew) {\n            this.CollectionNew = false;\n            body.emit('click', { target: this.parent('.settings-param').find('[data-collection-addnew]') });\n        }\n\n        if (key == 'esc' && this.CollectionNew) {\n            this.CollectionNew = false;\n            body.emit('click', { target: this.parent('[data-collection-item]').find('[data-collection-remove]') });\n        }\n    };\n\n    var createSortables = function(list) {\n        var lists = list || $('.collection-list ul');\n        if (!lists) { return; }\n        lists.forEach(function(list) {\n            list = $(list);\n            list.SimpleSort = simpleSort.create(list[0], {\n                handle: '.fa-reorder',\n                filter: '[data-collection-nosort]',\n                scroll: false,\n                animation: 150,\n                onStart: function() {\n                    $(this.el).addClass('collection-sorting');\n                },\n                onEnd: function(evt) {\n                    var element = $(this.el);\n                    element.removeClass('collection-sorting');\n\n                    if (evt.oldIndex === evt.newIndex) { return; }\n\n                    var dataField = element.parent('.settings-param').find('[data-collection-data]'),\n                        data = dataField.value();\n\n                    data = JSON.parse(data);\n\n                    data.splice(evt.newIndex, 0, data.splice(evt.oldIndex, 1)[0]);\n                    dataField.value(JSON.stringify(data));\n                    body.emit('change', { target: dataField });\n                }\n            });\n        });\n    };\n\n    createSortables();\n\n    // delegate sortables collections for ajax support\n    body.delegate('mouseover', '.collection-list ul', function(event, element) {\n        if (!element.SimpleSort) { createSortables(element); }\n    });\n\n    // Add new item\n    body.delegate('click', '[data-collection-addnew]', function(event, element) {\n        var param = element.parent('.settings-param'),\n            list = param.find('ul'),\n            editall = list.parent('[data-field-name]').find('[data-collection-editall]'),\n            dataField = param.find('[data-collection-data]'),\n            tmpl = param.find('[data-collection-template]'),\n            items = list.search('> [data-collection-item]') || [],\n            last = $(lastItem(items));\n\n        var clone = $(tmpl[0].cloneNode(true)), title, editable;\n\n        if (last) { clone.after(last); }\n        else { clone.top(list); }\n        \n        if (items.length && editall) { editall.style('display', 'inline-block'); }\n\n        title = clone.find('a');\n        editable = title.find('[data-title-editable]');\n\n        var re = new RegExp('%id%', 'g');\n        title.href(title.href().replace(re, items.length));\n\n        clone.attribute('style', null).data('collection-item', clone.data('collection-template'));\n        clone.attribute('data-collection-template', null);\n        clone.attribute('data-collection-nosort', null);\n        editable.CollectionNew = true;\n        body.emit('click', { target: title.siblings('[data-title-edit]') });\n\n        editable.on('title-edit-exit', addNewByEnter);\n        body.emit('change', { target: dataField });\n    });\n\n    // Edit Title\n    body.delegate('blur', '[data-collection-item] [data-title-editable]', function(event, element) {\n        var text = trim(element.text()),\n            item = element.parent('[data-collection-item]'),\n            key = item.data('collection-item'),\n            items = element.parent('ul').search('> [data-collection-item]'),\n            dataField = element.parent('.settings-param').find('[data-collection-data]'),\n            data = dataField.value(),\n            index = indexOf(items, item[0]);\n\n        if (index == -1) { return; }\n\n        data = JSON.parse(data);\n        if (!data[index]) { data.splice(index, 0, {}); }\n        data[index][key] = text;\n        dataField.value(JSON.stringify(data));\n        body.emit('change', { target: dataField });\n    }, true);\n\n    // Remove item\n    body.delegate('click', '[data-collection-remove]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n        var item = element.parent('[data-collection-item]'),\n            list = element.parent('ul'),\n            editall = list.parent('[data-field-name]').find('[data-collection-editall]'),\n            items = list.search('> [data-collection-item]'),\n            index = indexOf(items, item[0]),\n            dataField = element.parent('.settings-param').find('[data-collection-data]'),\n            data = dataField.value();\n\n        data = JSON.parse(data);\n        data.splice(index, 1);\n        dataField.value(JSON.stringify(data));\n        item.remove();\n        if (items.length <= 2 && editall) { editall.style('display', 'none'); }\n        body.emit('change', { target: dataField });\n    });\n\n    // Duplicate item\n    body.delegate('click', '[data-collection-duplicate]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n        var param = element.parent('.settings-param'),\n            item = element.parent('[data-collection-item]'),\n            list = element.parent('ul'),\n            editall = list.parent('[data-field-name]').find('[data-collection-editall]'),\n            url = param.find('[data-collection-template]').find('a').href(),\n            items = list.search('> [data-collection-item]'),\n            index = indexOf(items, item[0]),\n            clone = $(item[0].cloneNode(true)).after(item),\n            dataField = element.parent('.settings-param').find('[data-collection-data]'),\n            data = dataField.value();\n\n        var re = new RegExp('%id%', 'g');\n        clone.find('a').href(url.replace(re, items.length + 1));\n\n        data = JSON.parse(data);\n        data.splice(index, 0, data[index]);\n        dataField.value(JSON.stringify(data));\n\n        if (items.length >= 1) { editall.style('display', 'inline-block'); }\n        body.emit('change', { target: dataField });\n    });\n\n    // Preventing click of links when title is being edited\n    body.delegate('click', '[data-collection-item] a', function(event, element) {\n        if (element.find('[contenteditable]')) {\n            event.preventDefault();\n            event.stopPropagation();\n        }\n    });\n\n    // Load item settings\n    body.delegate('click', '[data-collection-item] .config-cog, [data-collection-editall]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n\n        var editable = element.find('[data-title-editable]');\n        if (editable && editable.attribute('contenteditable')) {\n            event.stopPropagation();\n            return false;\n        }\n\n        var isEditAll = element.data('collection-editall') !== null,\n            parent = element.parent('.settings-param'),\n            dataField = parent.find('[data-collection-data]'),\n            data = dataField.value(),\n            item = element.parent('[data-collection-item]'),\n            items = parent.search('ul > [data-collection-item]');\n\n        var dataPost = { data: isEditAll ? data : JSON.stringify(JSON.parse(data)[indexOf(items, item[0])]) };\n        modal.open({\n            content: translate('GANTRY5_PLATFORM_JS_LOADING'),\n            method: 'post',\n            className: 'g5-dialog-theme-default g5-modal-collection g5-modal-collection-' + (isEditAll ? 'editall' : 'single'),\n            data: dataPost,\n            overlayClickToClose: false,\n            remote: parseAjaxURI(element.attribute('href') + getAjaxSuffix()),\n            remoteLoaded: function(response, content) {\n                if (!response.body.success) {\n                    modal.enableCloseByOverlay();\n                    return;\n                }\n                \n                var form = content.elements.content.find('form'),\n                    fakeDOM = zen('div').html(response.body.html).find('form'),\n                    submit = content.elements.content.search('input[type=\"submit\"], button[type=\"submit\"], [data-apply-and-save]'),\n                    dataValue = JSON.parse(data);\n\n                if (modal.getAll().length > 1) {\n                    var applyAndSave = content.elements.content.search('[data-apply-and-save]');\n                    if (applyAndSave) { applyAndSave.remove(); }\n                }\n\n                if (dataValue.length == 1) {\n                    // TODO: need to determine better how to handle single collections cards\n                    //content.elements.content.style({ width: 450 });\n                }\n\n                if ((!form && !fakeDOM) || !submit) {\n                    return true;\n                }\n\n                // Collection Settings apply\n                submit.on('click', function(e) {\n                    e.preventDefault();\n\n                    var target = $(e.currentTarget);\n\n                    target.hideIndicator();\n                    target.showIndicator();\n\n                    var post = Submit(fakeDOM[0].elements, content.elements.content);\n\n                    if (post.invalid.length) {\n                        target.hideIndicator();\n                        target.showIndicator('fa fa-fw fa-exclamation-triangle');\n                        toastr.error(translate('GANTRY5_PLATFORM_JS_REVIEW_FIELDS'), translate('GANTRY5_PLATFORM_JS_INVALID_FIELDS'));\n                        return;\n                    }\n\n                    request(fakeDOM.attribute('method'), parseAjaxURI(fakeDOM.attribute('action') + getAjaxSuffix()), post.valid.join('&') || {}, function(error, response) {\n                        if (!response.body.success) {\n                            modal.open({\n                                content: response.body.html || response.body,\n                                afterOpen: function(container) {\n                                    if (!response.body.html) { container.style({ width: '90%' }); }\n                                }\n                            });\n                        } else {\n                            if (item) { // single editing\n                                dataValue[indexOf(items, item[0])] = response.body.data;\n                            } else { // multi editing\n                                dataValue = response.body.data;\n                            }\n\n                            dataField.value(JSON.stringify(dataValue));\n                            body.emit('change', { target: dataField });\n\n                            element.parent('.settings-param-field').search('ul > [data-collection-item]').forEach(function(item, index) {\n                                item = $(item);\n                                var label = item.find('[data-title-editable]'),\n                                    text = dataValue[index][item.data('collection-item')];\n\n                                label.data('title-editable', text).text(text);\n                            });\n\n                            // if it's apply and save we also save the panel\n                            if (target.data('apply-and-save') !== null) {\n                                var save = $('body').find('.button-save');\n                                if (save) { body.emit('click', { target: save }); }\n                            }\n\n                            modal.close();\n                            toastr.success(translate('GANTRY5_PLATFORM_JS_GENERIC_SETTINGS_APPLIED', 'Collection'), translate('GANTRY5_PLATFORM_JS_SETTINGS_APPLIED'));\n                        }\n\n                        target.hideIndicator();\n                    });\n                });\n            }\n        });\n    });\n});\n\nmodule.exports = {};\n","\"use strict\";\n\nvar prime      = require('prime'),\n    Emitter    = require('prime/emitter'),\n    Bound      = require('prime-util/prime/bound'),\n    Options    = require('prime-util/prime/options'),\n    $          = require('elements'),\n    ready      = require('elements/domready'),\n    zen        = require('elements/zen'),\n\n    DragEvents = require('../../ui/drag.events'),\n\n    forEach    = require('mout/collection/forEach'),\n    bind       = require('mout/function/bind'),\n    clamp      = require('mout/math/clamp');\n\nvar isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n\nvar MOUSEDOWN = DragEvents.EVENTS.START,\n    MOUSEMOVE = DragEvents.EVENTS.MOVE,\n    MOUSEUP   = DragEvents.EVENTS.STOP,\n    FOCUSIN   = isFirefox ? 'focus' : 'focusin';\n\nvar ColorPicker = new prime({\n    mixin: [Options, Bound],\n    inherits: Emitter,\n    options: {},\n    constructor: function(options) {\n        this.setOptions(options);\n        this.built = false;\n        this.attach();\n    },\n\n    attach: function() {\n        var body = $('body');\n\n        MOUSEDOWN.forEach(bind(function(mousedown) {\n            body.delegate(mousedown, '.g-colorpicker i', this.bound('iconClick'));\n        }, this));\n\n        body.delegate(FOCUSIN, '.g-colorpicker input', this.bound('show'), true);\n\n\n        body.delegate('keydown', '.g-colorpicker input', bind(function(event, element) {\n            switch (event.keyCode) {\n                case 9: // tab\n                    this.hide();\n                    break;\n                case 13: // enter\n                case 27: // esc\n                    this.hide();\n                    element[0].blur();\n                    break;\n            }\n            return true;\n        }, this));\n\n        // Update on keyup\n        body.delegate('keyup', '.g-colorpicker input', bind(function(event, element) {\n            this.updateFromInput(true, element);\n            return true;\n        }, this));\n\n        // Update on paste\n        body.delegate('paste', '.g-colorpicker input', bind(function(event, element) {\n            setTimeout(bind(function() {\n                this.updateFromInput(true, element);\n            }, this), 1);\n        }, this));\n    },\n\n    show: function(event, element) {\n        var body = $('body');\n\n        if (!this.built) {\n            this.build();\n        }\n\n        this.element = element;\n        this.reposition();\n        this.wrapper.addClass('cp-visible');\n        this.updateFromInput();\n\n        MOUSEMOVE.forEach(bind(function(mousemove) {\n            body.on(mousemove, this.bound('bodyMove'));\n        }, this));\n\n        MOUSEDOWN.forEach(bind(function(mousedown) {\n            this.wrapper.delegate(mousedown, '.cp-grid, .cp-slider, .cp-opacity-slider', this.bound('bodyDown'));\n            body.on(mousedown, this.bound('bodyClick'));\n        }, this));\n\n        MOUSEUP.forEach(bind(function(mouseup) {\n            body.on(mouseup, this.bound('targetReset'));\n        }, this));\n    },\n\n    hide: function() {\n        var body = $('body');\n\n        if (!this.built) { return; }\n        this.wrapper.removeClass('cp-visible');\n\n        MOUSEMOVE.forEach(bind(function(mousemove) {\n            body.off(mousemove, this.bound('bodyMove'));\n        }, this));\n\n        MOUSEDOWN.forEach(bind(function(mousedown) {\n            this.wrapper.undelegate(mousedown, '.cp-grid, .cp-slider, .cp-opacity-slider', this.bound('bodyDown'));\n            body.off(mousedown, this.bound('bodyClick'));\n        }, this));\n\n        MOUSEUP.forEach(bind(function(mouseup) {\n            body.off(mouseup, this.bound('targetReset'));\n        }, this));\n    },\n\n    iconClick: function(event, element) {\n        event.preventDefault();\n\n        var input = $(element).sibling('input');\n        input[0].focus();\n\n        this.show(event, input);\n    },\n\n    bodyMove: function(event) {\n        event.preventDefault();\n\n        if (this.target) { this.move(this.target, event); }\n    },\n\n    bodyClick: function(event) {\n        var target = $(event.target);\n        if (!target.parent('.cp-wrapper') && !target.parent('.g-colorpicker')) {\n            this.hide();\n        }\n    },\n\n    bodyDown: function(event, element) {\n        event.preventDefault();\n\n        this.target = element;\n        this.move(this.target, event, true);\n    },\n\n    targetReset: function(event) {\n        event.preventDefault();\n\n        this.target = null;\n    },\n\n    move: function(target, event) {\n        var input = this.element,\n            picker = target.find('.cp-picker'),\n            clientRect = target[0].getBoundingClientRect(),\n            offsetX = clientRect.left + window.scrollX,\n            offsetY = clientRect.top + window.scrollY,\n            x = Math.round((event ? event.pageX : 0) - offsetX),\n            y = Math.round((event ? event.pageY : 0) - offsetY),\n            wx, wy, r, phi;\n\n        // Touch support\n        if (event && event.changedTouches) {\n            x = (event.changedTouches ? event.changedTouches[0].pageX : 0) - offsetX;\n            y = (event.changedTouches ? event.changedTouches[0].pageY : 0) - offsetY;\n        }\n\n        if (event && event.manualOpacity) {\n            y = clientRect.height;\n        }\n\n        // Constrain picker to its container\n        if (x < 0) x = 0;\n        if (y < 0) y = 0;\n        if (x > clientRect.width) x = clientRect.width;\n        if (y > clientRect.height) y = clientRect.height;\n\n        // Constrain color wheel values to the wheel\n        if (target.parent('.cp-mode-wheel') && picker.parent('.cp-grid')) {\n            wx = 75 - x;\n            wy = 75 - y;\n            r = Math.sqrt(wx * wx + wy * wy);\n            phi = Math.atan2(wy, wx);\n\n            if (phi < 0) phi += Math.PI * 2;\n            if (r > 75) {\n                x = 75 - (75 * Math.cos(phi));\n                y = 75 - (75 * Math.sin(phi));\n            }\n\n            x = Math.round(x);\n            y = Math.round(y);\n        }\n\n        // Move the picker\n        if (target.hasClass('cp-grid')) {\n            picker.style({\n                top: y,\n                left: x\n            });\n\n            this.updateFromPicker(input, target);\n        } else {\n            picker.style({\n                top: y\n            });\n            this.updateFromPicker(input, target);\n        }\n    },\n\n    build: function() {\n        this.wrapper = zen('div.cp-wrapper.cp-with-opacity.cp-mode-hue');\n        this.slider = zen('div.cp-slider.cp-sprite').bottom(this.wrapper).appendChild(zen('div.cp-picker'));\n        this.opacitySlider = zen('div.cp-opacity-slider.cp-sprite').bottom(this.wrapper).appendChild(zen('div.cp-picker'));\n        this.grid = zen('div.cp-grid.cp-sprite').bottom(this.wrapper).appendChild(zen('div.cp-grid-inner')).appendChild(zen('div.cp-picker'));\n\n        zen('div').bottom(this.grid.find('.cp-picker'));\n\n        var tabs = zen('div.cp-tabs').bottom(this.wrapper);\n\n        this.tabs = {\n            hue: zen('div.cp-tab-hue.active').text('HUE').bottom(tabs),\n            brightness: zen('div.cp-tab-brightness').text('BRI').bottom(tabs),\n            saturation: zen('div.cp-tab-saturation').text('SAT').bottom(tabs),\n            wheel: zen('div.cp-tab-wheel').text('WHEEL').bottom(tabs),\n            transparent: zen('div.cp-tab-transp').text('TRANSPARENT').bottom(tabs)\n        };\n\n        MOUSEDOWN.forEach(bind(function(mousedown) {\n            tabs.delegate(mousedown, '> div', bind(function(event, element) {\n                if (element == this.tabs.transparent) {\n                    this.opacity = 0;\n                    var sliderHeight = this.opacitySlider.position().height;\n                    this.opacitySlider.find('.cp-picker').style({ 'top': clamp(sliderHeight - (sliderHeight * this.opacity), 0, sliderHeight) });\n                    this.move(this.opacitySlider, { manualOpacity: true });\n                    return;\n                }\n\n                var active = tabs.find('.active'),\n                    mode = active.attribute('class').replace(/\\s|active|cp-tab-/g, ''),\n                    newMode = element.attribute('class').replace(/\\s|active|cp-tab-/g, '');\n\n                this.wrapper.removeClass('cp-mode-' + mode).addClass('cp-mode-' + newMode);\n                active.removeClass('active');\n                element.addClass('active');\n\n                this.mode = newMode;\n                this.updateFromInput();\n            }, this));\n        }, this));\n\n        this.wrapper.bottom('#g5-container');\n\n        this.built = true;\n        this.mode = 'hue';\n    },\n\n    updateFromInput: function(dontFireEvent, element) {\n        element = $(element) || this.element;\n        var value = element.value(),\n            opacity = value.replace(/\\s/g, '').match(/^rgba?\\([0-9]{1,3},[0-9]{1,3},[0-9]{1,3},(.+)\\)/),\n            hex, hsb;\n\n        value = rgbstr2hex(value) || value;\n        opacity = opacity ? clamp(opacity[1], 0, 1) : 1;\n\n        if (!(hex = parseHex(value))) { hex = '#ffffff'; }\n        hsb = hex2hsb(hex);\n\n        if (this.built) {\n            // opacity\n            this.opacity = Math.max(opacity, 0);\n            var sliderHeight = this.opacitySlider.position().height;\n            this.opacitySlider.find('.cp-picker').style({ 'top': clamp(sliderHeight - (sliderHeight * this.opacity), 0, sliderHeight) });\n\n            // bg color\n            var gridHeight = this.grid.position().height,\n                gridWidth = this.grid.position().width,\n                r, phi, x, y;\n\n            sliderHeight = this.slider.position().height;\n\n            switch (this.mode) {\n                case 'wheel':\n                    // Set grid position\n                    r = clamp(Math.ceil(hsb.s * 0.75), 0, gridHeight / 2);\n                    phi = hsb.h * Math.PI / 180;\n                    x = clamp(75 - Math.cos(phi) * r, 0, gridWidth);\n                    y = clamp(75 - Math.sin(phi) * r, 0, gridHeight);\n                    this.grid.style({ backgroundColor: 'transparent' }).find('.cp-picker').style({\n                        top: y,\n                        left: x\n                    });\n\n                    // Set slider position\n                    y = 150 - (hsb.b / (100 / gridHeight));\n                    if (hex === '') y = 0;\n                    this.slider.find('.cp-picker').style({ top: y });\n\n                    // Update panel color\n                    this.slider.style({\n                        backgroundColor: hsb2hex({\n                            h: hsb.h,\n                            s: hsb.s,\n                            b: 100\n                        })\n                    });\n                    break;\n\n                case 'saturation':\n                    // Set grid position\n                    x = clamp((5 * hsb.h) / 12, 0, 150);\n                    y = clamp(gridHeight - Math.ceil(hsb.b / (100 / gridHeight)), 0, gridHeight);\n                    this.grid.find('.cp-picker').style({\n                        top: y,\n                        left: x\n                    });\n\n                    // Set slider position\n                    y = clamp(sliderHeight - (hsb.s * (sliderHeight / 100)), 0, sliderHeight);\n                    this.slider.find('.cp-picker').style({ top: y });\n\n                    // Update UI\n                    this.slider.style({\n                        backgroundColor: hsb2hex({\n                            h: hsb.h,\n                            s: 100,\n                            b: hsb.b\n                        })\n                    });\n                    this.grid.find('.cp-grid-inner').style({ opacity: hsb.s / 100 });\n                    break;\n\n                case 'brightness':\n                    // Set grid position\n                    x = clamp((5 * hsb.h) / 12, 0, 150);\n                    y = clamp(gridHeight - Math.ceil(hsb.s / (100 / gridHeight)), 0, gridHeight);\n                    this.grid.find('.cp-picker').style({\n                        top: y,\n                        left: x\n                    });\n\n                    // Set slider position\n                    y = clamp(sliderHeight - (hsb.b * (sliderHeight / 100)), 0, sliderHeight);\n                    this.slider.find('.cp-picker').style({ top: y });\n\n                    // Update UI\n                    this.slider.style({\n                        backgroundColor: hsb2hex({\n                            h: hsb.h,\n                            s: hsb.s,\n                            b: 100\n                        })\n                    });\n                    this.grid.find('.cp-grid-inner').style({ opacity: 1 - (hsb.b / 100) });\n                    break;\n                case 'hue':\n                default:\n                    // Set grid position\n                    x = clamp(Math.ceil(hsb.s / (100 / gridWidth)), 0, gridWidth);\n                    y = clamp(gridHeight - Math.ceil(hsb.b / (100 / gridHeight)), 0, gridHeight);\n                    this.grid.find('.cp-picker').style({\n                        top: y,\n                        left: x\n                    });\n\n                    // Set slider position\n                    y = clamp(sliderHeight - (hsb.h / (360 / sliderHeight)), 0, sliderHeight);\n                    this.slider.find('.cp-picker').style({ top: y });\n\n                    // Update panel color\n                    this.grid.style({\n                        backgroundColor: hsb2hex({\n                            h: hsb.h,\n                            s: 100,\n                            b: 100\n                        })\n                    });\n                    break;\n            }\n        }\n\n        if (!dontFireEvent) { element.value(this.getValue(hex)); }\n\n        this.emit('change', element, hex, opacity);\n\n    },\n\n    updateFromPicker: function(input, target) {\n        var getCoords = function(picker, container) {\n\n            var left, top;\n            if (!picker.length || !container) return null;\n            left = picker[0].getBoundingClientRect().left;\n            top = picker[0].getBoundingClientRect().top;\n\n            return {\n                x: left - container[0].getBoundingClientRect().left + (picker[0].offsetWidth / 2),\n                y: top - container[0].getBoundingClientRect().top + (picker[0].offsetHeight / 2)\n            };\n\n        };\n\n        var hex, hue, saturation, brightness, x, y, r, phi,\n\n            // Panel objects\n            grid = this.wrapper.find('.cp-grid'),\n            slider = this.wrapper.find('.cp-slider'),\n            opacitySlider = this.wrapper.find('.cp-opacity-slider'),\n\n            // Picker objects\n            gridPicker = grid.find('.cp-picker'),\n            sliderPicker = slider.find('.cp-picker'),\n            opacityPicker = opacitySlider.find('.cp-picker'),\n\n            // Picker positions\n            gridPos = getCoords(gridPicker, grid),\n            sliderPos = getCoords(sliderPicker, slider),\n            opacityPos = getCoords(opacityPicker, opacitySlider),\n\n            // Sizes\n            gridWidth = grid[0].getBoundingClientRect().width,\n            gridHeight = grid[0].getBoundingClientRect().height,\n            sliderHeight = slider[0].getBoundingClientRect().height,\n            opacitySliderHeight = opacitySlider[0].getBoundingClientRect().height;\n\n        var value = this.element.value();\n        value = rgbstr2hex(value) || value;\n        if (!(hex = parseHex(value))) { hex = '#ffffff'; }\n\n        // Handle colors\n        if (target.hasClass('cp-grid') || target.hasClass('cp-slider')) {\n\n            // Determine HSB values\n            switch (this.mode) {\n                case 'wheel':\n                    // Calculate hue, saturation, and brightness\n                    x = (gridWidth / 2) - gridPos.x;\n                    y = (gridHeight / 2) - gridPos.y;\n                    r = Math.sqrt(x * x + y * y);\n                    phi = Math.atan2(y, x);\n                    if (phi < 0) phi += Math.PI * 2;\n                    if (r > 75) {\n                        r = 75;\n                        gridPos.x = 69 - (75 * Math.cos(phi));\n                        gridPos.y = 69 - (75 * Math.sin(phi));\n                    }\n                    saturation = clamp(r / 0.75, 0, 100);\n                    hue = clamp(phi * 180 / Math.PI, 0, 360);\n                    brightness = clamp(100 - Math.floor(sliderPos.y * (100 / sliderHeight)), 0, 100);\n                    hex = hsb2hex({\n                        h: hue,\n                        s: saturation,\n                        b: brightness\n                    });\n\n                    // Update UI\n                    slider.style({\n                        backgroundColor: hsb2hex({\n                            h: hue,\n                            s: saturation,\n                            b: 100\n                        })\n                    });\n                    break;\n\n                case 'saturation':\n                    // Calculate hue, saturation, and brightness\n                    hue = clamp(parseInt(gridPos.x * (360 / gridWidth), 10), 0, 360);\n                    saturation = clamp(100 - Math.floor(sliderPos.y * (100 / sliderHeight)), 0, 100);\n                    brightness = clamp(100 - Math.floor(gridPos.y * (100 / gridHeight)), 0, 100);\n                    hex = hsb2hex({\n                        h: hue,\n                        s: saturation,\n                        b: brightness\n                    });\n\n                    // Update UI\n                    slider.style({\n                        backgroundColor: hsb2hex({\n                            h: hue,\n                            s: 100,\n                            b: brightness\n                        })\n                    });\n                    grid.find('.cp-grid-inner').style({ opacity: saturation / 100 });\n                    break;\n\n                case 'brightness':\n                    // Calculate hue, saturation, and brightness\n                    hue = clamp(parseInt(gridPos.x * (360 / gridWidth), 10), 0, 360);\n                    saturation = clamp(100 - Math.floor(gridPos.y * (100 / gridHeight)), 0, 100);\n                    brightness = clamp(100 - Math.floor(sliderPos.y * (100 / sliderHeight)), 0, 100);\n                    hex = hsb2hex({\n                        h: hue,\n                        s: saturation,\n                        b: brightness\n                    });\n\n                    // Update UI\n                    slider.style({\n                        backgroundColor: hsb2hex({\n                            h: hue,\n                            s: saturation,\n                            b: 100\n                        })\n                    });\n                    grid.find('.cp-grid-inner').style({ opacity: 1 - (brightness / 100) });\n                    break;\n\n                default:\n                    // Calculate hue, saturation, and brightness\n                    hue = clamp(360 - parseInt(sliderPos.y * (360 / sliderHeight), 10), 0, 360);\n                    saturation = clamp(Math.floor(gridPos.x * (100 / gridWidth)), 0, 100);\n                    brightness = clamp(100 - Math.floor(gridPos.y * (100 / gridHeight)), 0, 100);\n                    hex = hsb2hex({\n                        h: hue,\n                        s: saturation,\n                        b: brightness\n                    });\n\n                    // Update UI\n                    grid.style({\n                        backgroundColor: hsb2hex({\n                            h: hue,\n                            s: 100,\n                            b: 100\n                        })\n                    });\n                    break;\n\n            }\n        }\n\n        // Handle opacity\n        if (target.hasClass('cp-opacity-slider')) {\n            this.opacity = Math.max(parseFloat(1 - (opacityPos.y / opacitySliderHeight)).toFixed(2), 0);\n        }\n\n        // Adjust case\n        input.value(this.getValue(hex));\n\n        // Handle change event\n        this.emit('change', this.element, hex, this.opacity);\n\n    },\n\n    reposition: function() {\n        var offset = this.element[0].getBoundingClientRect(),\n            ct = $('#g5-container')[0].getBoundingClientRect();\n        this.wrapper.style({\n            top: offset.top + offset.height - ct.top,\n            left: offset.left - ct.left\n        });\n    },\n\n    getValue: function(hex) {\n        if (this.opacity == 1) { return hex; }\n        var rgb = hex2rgb(hex);\n        return 'rgba(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ', ' + this.opacity + ')';\n    }\n});\n\n// Parses a string and returns a valid hex string when possible\nvar parseHex = function(string) {\n    string = string.replace(/[^A-F0-9]/ig, '');\n    if (string.length !== 3 && string.length !== 6) return '';\n    if (string.length === 3) {\n        string = string[0] + string[0] + string[1] + string[1] + string[2] + string[2];\n    }\n\n    return '#' + string.toLowerCase();\n};\n\n// Converts an HSB object to an RGB object\nvar hsb2rgb = function(hsb) {\n    var rgb = {};\n    var h = Math.round(hsb.h);\n    var s = Math.round(hsb.s * 255 / 100);\n    var v = Math.round(hsb.b * 255 / 100);\n    if (s === 0) {\n        rgb.r = rgb.g = rgb.b = v;\n    } else {\n        var t1 = v;\n        var t2 = (255 - s) * v / 255;\n        var t3 = (t1 - t2) * (h % 60) / 60;\n        if (h === 360) h = 0;\n        if (h < 60) {\n            rgb.r = t1;\n            rgb.b = t2;\n            rgb.g = t2 + t3;\n        }\n        else if (h < 120) {\n            rgb.g = t1;\n            rgb.b = t2;\n            rgb.r = t1 - t3;\n        }\n        else if (h < 180) {\n            rgb.g = t1;\n            rgb.r = t2;\n            rgb.b = t2 + t3;\n        }\n        else if (h < 240) {\n            rgb.b = t1;\n            rgb.r = t2;\n            rgb.g = t1 - t3;\n        }\n        else if (h < 300) {\n            rgb.b = t1;\n            rgb.g = t2;\n            rgb.r = t2 + t3;\n        }\n        else if (h < 360) {\n            rgb.r = t1;\n            rgb.g = t2;\n            rgb.b = t1 - t3;\n        }\n        else {\n            rgb.r = 0;\n            rgb.g = 0;\n            rgb.b = 0;\n        }\n    }\n    return {\n        r: Math.round(rgb.r),\n        g: Math.round(rgb.g),\n        b: Math.round(rgb.b)\n    };\n};\n\n// Converts an RGB object to a hex string\nvar rgb2hex = function(rgb) {\n    var hex = [\n        rgb.r.toString(16),\n        rgb.g.toString(16),\n        rgb.b.toString(16)\n    ];\n\n    forEach(hex, function(val, nr) {\n        if (val.length === 1) hex[nr] = '0' + val;\n    });\n\n    return '#' + hex.join('');\n};\n\nvar rgbstr2hex = function(rgb) {\n    rgb = rgb.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\n    return (rgb && rgb.length === 4) ? \"#\" +\n    (\"0\" + parseInt(rgb[1], 10).toString(16)).slice(-2) +\n    (\"0\" + parseInt(rgb[2], 10).toString(16)).slice(-2) +\n    (\"0\" + parseInt(rgb[3], 10).toString(16)).slice(-2) : '';\n};\n\n// Converts an HSB object to a hex string\nvar hsb2hex = function(hsb) {\n    return rgb2hex(hsb2rgb(hsb));\n};\n\n// Converts a hex string to an HSB object\nvar hex2hsb = function(hex) {\n    var hsb = rgb2hsb(hex2rgb(hex));\n    if (hsb.s === 0) hsb.h = 360;\n    return hsb;\n};\n\n// Converts an RGB object to an HSB object\nvar rgb2hsb = function(rgb) {\n    var hsb = {\n        h: 0,\n        s: 0,\n        b: 0\n    };\n    var min = Math.min(rgb.r, rgb.g, rgb.b);\n    var max = Math.max(rgb.r, rgb.g, rgb.b);\n    var delta = max - min;\n    hsb.b = max;\n    hsb.s = max !== 0 ? 255 * delta / max : 0;\n    if (hsb.s !== 0) {\n        if (rgb.r === max) {\n            hsb.h = (rgb.g - rgb.b) / delta;\n        } else if (rgb.g === max) {\n            hsb.h = 2 + (rgb.b - rgb.r) / delta;\n        } else {\n            hsb.h = 4 + (rgb.r - rgb.g) / delta;\n        }\n    } else {\n        hsb.h = -1;\n    }\n    hsb.h *= 60;\n    if (hsb.h < 0) {\n        hsb.h += 360;\n    }\n    hsb.s *= 100 / 255;\n    hsb.b *= 100 / 255;\n    return hsb;\n};\n\n// Converts a hex string to an RGB object\nvar hex2rgb = function(hex) {\n    hex = parseInt(((hex.indexOf('#') > -1) ? hex.substring(1) : hex), 16);\n    return {\n        /* jshint ignore:start */\n        r: hex >> 16,\n        g: (hex & 0x00FF00) >> 8,\n        b: (hex & 0x0000FF)\n        /* jshint ignore:end */\n    };\n};\n\n\nready(function() {\n    var x = new ColorPicker(), body = $('body');\n    x.on('change', function(element, hex, opacity) {\n        clearTimeout(this.timer);\n        var rgb = hex2rgb(hex),\n            yiq = (((rgb.r * 299) + (rgb.g * 587) + (rgb.b * 114)) / 1000) >= 128 ? 'dark' : 'light',\n            check = yiq == 'dark' || (!opacity || opacity < 0.35);\n\n        if (opacity < 1) {\n            var str = 'rgba(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ', ' + opacity + ')';\n            element.style({ backgroundColor: str });\n        } else {\n            element.style({ backgroundColor: hex });\n        }\n\n        element.parent('.g-colorpicker')[!check ? 'addClass' : 'removeClass']('light-text');\n\n        this.timer = setTimeout(function() {\n            element.emit('input');\n            body.emit('input', { target: element });\n        }, 150);\n\n    });\n});\n\nmodule.exports = ColorPicker;\n","\"use strict\";\n\nvar $             = require('../../utils/elements.utils'),\n    prime         = require('prime'),\n    request       = require('agent'),\n    zen           = require('elements/zen'),\n    domready      = require('elements/domready'),\n    bind          = require('mout/function/bind'),\n    rtrim         = require('mout/string/rtrim'),\n    deepClone     = require('mout/lang/deepClone'),\n    deepFillIn    = require('mout/object/deepFillIn'),\n    modal         = require('../../ui').modal,\n    getAjaxSuffix = require('../../utils/get-ajax-suffix'),\n    parseAjaxURI  = require('../../utils/get-ajax-url').parse,\n    getAjaxURL    = require('../../utils/get-ajax-url').global,\n    translate     = require('../../utils/translate'),\n    dropzone      = require('dropzone');\n\nvar FilePicker = new prime({\n    constructor: function(element) {\n        var data = element.data('g5-filepicker'), value;\n        this.data = data ? JSON.parse(data) : false;\n\n        if (this.data && !this.data.value) {\n            this.data.value = $(this.data.field).value();\n        }\n\n        this.colors = {\n            error: '#D84747',\n            success: '#9ADF87',\n            small: '#aaaaaa',\n            gradient: ['#9e38eb', '#4e68fc']\n        };\n\n        //console.log(this.data);\n    },\n\n    open: function() {\n        if (this.data) {\n            this.data.value = $(this.data.field).value();\n        }\n\n        modal.open({\n            method: 'post',\n            data: this.data,\n            content: translate('GANTRY5_PLATFORM_JS_LOADING'),\n            className: 'g5-dialog-theme-default g5-modal-filepicker',\n            remote: parseAjaxURI(getAjaxURL('filepicker') + getAjaxSuffix()),\n            remoteLoaded: bind(this.loaded, this),\n            afterClose: bind(function() {\n                if (this.dropzone) { this.dropzone.destroy(); }\n            }, this)\n        });\n    },\n\n    getPath: function() {\n        var actives = this.content.search('.g-folders .active'), active, path;\n        if (!actives) { return null; }\n\n        active = $(actives[actives.length - 1]);\n        path = JSON.parse(active.data('folder')).pathname;\n        return path.replace(/\\/$/, '') + '/';\n    },\n\n    getPreviewTemplate: function() {\n        var li    = zen('li[data-file]'),\n            del   = zen('span.g-file-delete[data-g-file-delete][data-dz-remove]').html('<i class=\"fa fa-fw fa-trash-o\"></i>').bottom(li),\n            thumb = zen('div.g-thumb[data-dz-thumbnail]').bottom(li),\n            name  = zen('span.g-file-name[data-dz-name]').bottom(li),\n            size  = zen('span.g-file-size[data-dz-size]').bottom(li),\n            mtime = zen('span.g-file-mtime[data-dz-mtime]').bottom(li);\n\n        zen('span.g-file-progress[data-file-uploadprogress]').html('<span class=\"g-file-progress-text\"></span>').bottom(li);\n        zen('div').bottom(thumb);\n\n        li.bottom('body');\n        var html = li[0].outerHTML;\n        li.remove();\n\n        return html;\n    },\n\n    loaded: function(response, modalInstance) {\n        var content   = modalInstance.elements.content,\n            bookmarks = content.search('.g-bookmark'),\n            files     = content.find('.g-files'),\n            fieldData = deepClone(this.data),\n            colors    = this.colors,\n            self      = this;\n\n        this.content = content;\n\n        if (files) {\n            this.dropzone = new dropzone('body', {\n                previewTemplate: this.getPreviewTemplate(),\n                previewsContainer: files.find('ul:not(.g-list-labels)')[0],\n                thumbnailWidth: 100,\n                thumbnailHeight: 100,\n                clickable: '[data-upload]',\n                acceptedFiles: this.acceptedFiles(this.data.filter) || '',\n                accept: bind(function(file, done) {\n                    if (!this.data.filter) { done(); }\n                    else {\n                        if (file.name.match(this.data.filter)) { done(); }\n                        else { done('<code>' + file.name + '</code> ' + translate('GANTRY5_PLATFORM_JS_FILTER_MISMATCH') + ': <br />  <code>' + this.data.filter + '</code>'); }\n                    }\n                }, this),\n                url: bind(function(file) {\n                    return parseAjaxURI(getAjaxURL('filepicker/upload/' + global.btoa(encodeURIComponent(this.getPath() + file[0].name))) + getAjaxSuffix());\n                }, this)\n            });\n\n            // dropzone events\n            this.dropzone.on('thumbnail', function(file, dataUrl) {\n                var ext = file.name.split('.');\n                ext = (!ext.length || ext.length == 1) ? '-' : ext.reverse()[0];\n                $(file.previewElement).addClass('g-image g-image-' + ext.toLowerCase()).find('[data-dz-thumbnail] > div').attribute('style', 'background-image: url(' + encodeURI(dataUrl) + ');');\n            });\n\n            this.dropzone.on('addedfile', function(file) {\n                var element      = $(file.previewElement),\n                    uploader     = element.find('[data-file-uploadprogress]'),\n                    isList       = files.hasClass('g-filemode-list'),\n                    progressConf = {\n                        value: 0,\n                        animation: false,\n                        insertLocation: 'bottom'\n                    };\n\n                var ext = file.name.split('.');\n                ext = (!ext.length || ext.length == 1) ? '-' : ext.reverse()[0];\n\n                if (!file.type.match(/image.*/)) {\n                    element.find('.g-thumb').text(ext);\n                } else {\n                    element.find('.g-thumb').addClass('g-image g-image-' + ext.toLowerCase());\n                }\n\n                progressConf = deepFillIn((isList ? {\n                    size: 20,\n                    thickness: 10,\n                    fill: {\n                        color: colors.small,\n                        gradient: false\n                    }\n                } : {\n                    size: 50,\n                    thickness: 'auto',\n                    fill: {\n                        gradient: colors.gradient,\n                        color: false\n                    }\n                }), progressConf);\n\n                element.addClass('g-file-uploading');\n                uploader.progresser(progressConf);\n                uploader.attribute('title', translate('GANTRY5_PLATFORM_JS_PROCESSING')).find('.g-file-progress-text').html('&bull;&bull;&bull;').attribute('title', translate('GANTRY5_PLATFORM_JS_PROCESSING'));\n\n            }).on('processing', function(file) {\n\n                var element = $(file.previewElement).find('[data-file-uploadprogress]');\n                element.find('.g-file-progress-text').text('0%').attribute('title', '0%');\n\n            }).on('sending', function(file, xhr, formData) {\n\n                var element = $(file.previewElement).find('[data-file-uploadprogress]');\n                element.attribute('title', '0%').find('.g-file-progress-text').text('0%').attribute('title', '0%');\n\n            }).on('uploadprogress', function(file, progress, bytesSent) {\n\n                var element = $(file.previewElement).find('[data-file-uploadprogress]');\n                element.progresser({ value: progress / 100 });\n                element.attribute('title', Math.round(progress) + '%').find('.g-file-progress-text').text(Math.round(progress) + '%').attribute('title', Math.round(progress) + '%');\n\n            }).on('complete', function(file) {\n                self.refreshFiles(content);\n            }).on('error', function(file, error) {\n                var element  = $(file.previewElement),\n                    uploader = element.find('[data-file-uploadprogress]'),\n                    text     = element.find('.g-file-progress-text'),\n                    isList   = files.hasClass('g-filemode-list');\n\n                element.addClass('g-file-error');\n\n                uploader.title('Error').progresser({\n                    fill: {\n                        color: colors.error,\n                        gradient: false\n                    },\n                    value: 1,\n                    thickness: isList ? 10 : 25\n                });\n\n                text.title('Error').html('<i class=\"fa fa-exclamation\"></i>').parent('[data-file-uploadprogress]').popover({\n                    content: error.html ? error.html : (error.error && error.error.message ? error.error.message : error),\n                    placement: 'auto',\n                    trigger: 'mouse',\n                    style: 'filepicker, above-modal',\n                    width: 'auto',\n                    targetEvents: false\n                });\n\n            }).on('success', function(file, response, xhr) {\n                var element  = $(file.previewElement),\n                    uploader = element.find('[data-file-uploadprogress]'),\n                    mtime    = element.find('.g-file-mtime'),\n                    text     = element.find('.g-file-progress-text'),\n                    thumb    = element.find('.g-thumb'),\n                    isList   = files.hasClass('g-filemode-list');\n\n                uploader.progresser({\n                    fill: {\n                        color: colors.success,\n                        gradient: false\n                    },\n                    value: 1,\n                    thickness: isList ? 10 : 25\n                });\n\n                text.html('<i class=\"fa fa-check\"></i>');\n\n                setTimeout(bind(function() {\n                    uploader.animate({ opacity: 0 }, { duration: 500 });\n                    thumb.animate({ opacity: 1 }, {\n                        duration: 500,\n                        callback: function() {\n                            element.data('file', JSON.stringify(response.finfo)).data('file-url', response.url).removeClass('g-file-uploading');\n                            element.dropzone = file;\n                            uploader.remove();\n                            mtime.text(translate('GANTRY5_PLATFORM_JUST_NOW'));\n                        }\n                    });\n                }, this), 500);\n            });\n        }\n\n        // g5 events\n        content.delegate('click', '.g-bookmark-title', function(event, element) {\n            if (event && event.preventDefault) { event.preventDefault(); }\n            var sibling = element.nextSibling('.g-folders'),\n                parent  = element.parent('.g-bookmark');\n\n            if (!sibling) { return; }\n            sibling.slideToggle(function() {\n                parent.toggleClass('collapsed', sibling.gSlideCollapsed);\n            });\n        });\n\n        content.delegate('click', '[data-folder]', bind(function(event, element) {\n            if (event && event.preventDefault) { event.preventDefault(); }\n            var data     = JSON.parse(element.data('folder')),\n                selected = $('[data-file].selected');\n\n            fieldData.root = data.pathname;\n            fieldData.value = selected ? selected.data('file-url') : false;\n            fieldData.subfolder = true;\n\n            element.showIndicator('fa fa-li fa-fw fa-spin-fast fa-spinner');\n            request(parseAjaxURI(getAjaxURL('filepicker') + getAjaxSuffix()), fieldData).send(bind(function(error, response) {\n                element.hideIndicator();\n                this.addActiveState(element);\n\n                if (!response.body.success) {\n                    modal.open({\n                        content: response.body.html || response.body,\n                        afterOpen: function(container) {\n                            if (!response.body.html) { container.style({ width: '90%' }); }\n                        }\n                    });\n                } else {\n                    var dummy, next;\n                    if (response.body.subfolder) {\n                        dummy = zen('div').html(response.body.subfolder);\n                        next = element.nextSibling();\n\n                        if (next && !next.attribute('data-folder')) { next.remove(); }\n                        dummy.children().after(element);\n                    }\n\n                    if (response.body.files) {\n                        files.empty();\n                        dummy = zen('div').html(response.body.files);\n                        dummy.children().bottom(files).style({ opacity: 0 }).animate({ opacity: 1 }, { duration: '250ms' });\n                    } else {\n                        files.find('> ul:not(.g-list-labels)').empty();\n                    }\n\n                    this.dropzone.previewsContainer = files.find('ul:not(.g-list-labels)')[0];\n                }\n            }, this));\n        }, this));\n\n        content.delegate('click', '[data-g-file-preview]', bind(function(event, element) {\n            event.preventDefault();\n            event.stopPropagation();\n            var parent    = element.parent('[data-file]'),\n                data      = JSON.parse(parent.data('file'));\n\n            if (data.isImage) {\n                var thumb = parent.find('.g-thumb > div');\n                modal.open({\n                    className: 'g5-dialog-theme-default g5-modal-filepreview center',\n                    content: '<img src=\"' + thumb[0].style.backgroundImage.slice(4, -1).replace(/\"/g, '') + '\" />'\n                });\n            }\n        }, this));\n\n        content.delegate('click', '[data-g-file-delete]', bind(function(event, element) {\n            event.preventDefault();\n            var parent    = element.parent('[data-file]'),\n                data      = JSON.parse(parent.data('file')),\n                deleteURI = parseAjaxURI(getAjaxURL('filepicker/' + global.btoa(encodeURIComponent(data.pathname)) + getAjaxSuffix()));\n\n            if (!data.isInCustom) { return false; }\n\n            request('delete', deleteURI, function(error, response) {\n                if (!response.body.success) {\n                    modal.open({\n                        content: response.body.html || response.body,\n                        afterOpen: function(container) {\n                            if (!response.body.html) { container.style({ width: '90%' }); }\n                        }\n                    });\n                } else {\n                    parent.addClass('g-file-deleted');\n                    setTimeout(function() {\n                        parent.remove();\n\n                        self.refreshFiles(content);\n                    }, 210);\n                }\n            });\n        }, this));\n\n        content.delegate('click', '[data-file]', bind(function(event, element) {\n            if (event && event.preventDefault) { event.preventDefault(); }\n            var target = $(event.target),\n                remove = target.data('g-file-delete') !== null || target.parent('[data-g-file-delete]'),\n                preview = target.data('g-file-preview') !== null || target.parent('[data-g-file-preview]');\n\n            if (element.hasClass('g-file-error') || element.hasClass('g-file-uploading') || remove || preview) { return; }\n            var data = JSON.parse(element.data('file'));\n\n            files.search('[data-file]').removeClass('selected');\n            element.addClass('selected');\n        }, this));\n\n        content.delegate('click', '[data-select]', bind(function(event, element) {\n            if (event && event.preventDefault) { event.preventDefault(); }\n            var selected = files.find('[data-file].selected'),\n                value    = selected ? selected.data('file-url') : '';\n\n            $(this.data.field).value(value);\n            modal.close();\n        }, this));\n\n        content.delegate('click', '[data-files-mode]', bind(function(event, element) {\n            if (event && event.preventDefault) { event.preventDefault(); }\n            if (element.hasClass('active')) { return; }\n\n            var modes = $('[data-files-mode]');\n            modes.removeClass('active');\n            element.addClass('active');\n\n            files.animate({ opacity: 0 }, {\n                duration: 200,\n                callback: function() {\n                    var mode           = element.data('files-mode'),\n                        uploadProgress = files.search('[data-file-uploadprogress]'),\n                        progressConf   = (mode == 'list') ? {\n                            size: 20,\n                            thickness: 10,\n                            fill: {\n                                color: colors.small,\n                                gradient: false\n                            }\n                        } : {\n                            size: 50,\n                            thickness: 'auto',\n                            fill: {\n                                gradient: colors.gradient,\n                                color: false\n                            }\n                        };\n\n\n                    files.attribute('class', 'g-files g-block g-filemode-' + mode);\n                    if (uploadProgress) {\n                        uploadProgress.forEach(function(element) {\n                            element = $(element);\n                            var config = deepClone(progressConf);\n\n                            if (element.parent('.g-file-error')) {\n                                config.fill = { color: colors.error };\n                                config.value = 1;\n                                config.thickness = mode == 'list' ? 10 : 25;\n                            }\n\n                            element.progresser(config);\n                        });\n                    }\n                    files.animate({ opacity: 1 }, { duration: 200 });\n                }\n            });\n\n        }, this));\n    },\n\n    addActiveState: function(element) {\n        var opened = this.content.search('[data-folder].active, .g-folders > .active'), parent = element.parent();\n        if (opened) { opened.removeClass('active'); }\n\n        element.addClass('active');\n\n        while (parent.tag() == 'ul' && !parent.hasClass('g-folders')) {\n            parent.previousSibling().addClass('active');\n            parent = parent.parent();\n        }\n    },\n\n    acceptedFiles: function(filter) {\n        var attr = '';\n        switch (filter) {\n            case '.(jpe?g|gif|png|svg)$':\n                attr = '.jpg,.jpeg,.gif,.png,.svg';\n                break;\n            case '.(mp4|webm|ogv|mov)$':\n                attr = '.mp4,.webm,.ogv,.mov';\n                break;\n        }\n\n        return attr;\n    },\n\n    refreshFiles: function(content) {\n        var active = $('[data-folder].active'),\n            folder = active[active.length - 1];\n        if (folder) {\n            content.emit('click', { target: $(folder) });\n        }\n    }\n});\n\ndomready(function() {\n    var body = $('body');\n    body.delegate('click', '[data-g5-filepicker]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n        element = $(element);\n        if (!element.GantryFilePicker) {\n            element.GantryFilePicker = new FilePicker(element);\n        }\n\n        element.GantryFilePicker.open();\n    });\n});\n\n\nmodule.exports = FilePicker;\n","\"use strict\";\n// fonts list: https://www.googleapis.com/webfonts/v1/webfonts?key=AIzaSyB2yJM8DBwt66u2MVRgb6M4t9CqkW7_IRY\nvar prime         = require('prime'),\n    $             = require('../../utils/elements.utils'),\n    zen           = require('elements/zen'),\n    storage       = require('prime/map')(),\n    Emitter       = require('prime/emitter'),\n    Bound         = require('prime-util/prime/bound'),\n    Options       = require('prime-util/prime/options'),\n    domready      = require('elements/domready'),\n\n    decouple      = require('../../utils/decouple'),\n\n    bind          = require('mout/function/bind'),\n    map           = require('mout/array/map'),\n    forEach       = require('mout/array/forEach'),\n    contains      = require('mout/array/contains'),\n    last          = require('mout/array/last'),\n    split         = require('mout/array/split'),\n    removeAll     = require('mout/array/removeAll'),\n    insert        = require('mout/array/insert'),\n    append        = require('mout/array/append'),\n    find          = require('mout/array/find'),\n    combine       = require('mout/array/combine'),\n    intersection  = require('mout/array/intersection'),\n    merge         = require('mout/object/merge'),\n\n    unhyphenate   = require('mout/string/unhyphenate'),\n    properCase    = require('mout/string/properCase'),\n    trim          = require('mout/string/trim'),\n    getAjaxSuffix = require('../../utils/get-ajax-suffix'),\n    parseAjaxURI  = require('../../utils/get-ajax-url').parse,\n    getAjaxURL    = require('../../utils/get-ajax-url').global,\n\n    modal         = require('../../ui').modal,\n    asyncForEach  = require('../../utils/async-foreach'),\n    translate     = require('../../utils/translate'),\n\n    request       = require('agent'),\n\n    wf            = require('webfontloader');\n\nrequire('../../utils/elements.viewport');\n\nvar isIE = function() {\n    var ua = window.navigator.userAgent;\n    return ua.indexOf('MSIE ') > 0 || ua.indexOf('Trident/') > 0 || ua.indexOf('Edge/') > 0 || false;\n};\n\nvar Fonts = new prime({\n\n    mixin: Bound,\n\n    inherits: Emitter,\n\n    previewSentence: {\n        'latin': 'Wizard boy Jack loves the grumpy Queen\\'s fox.',\n        'latin-ext': 'Wizard boy Jack loves the grumpy Queen\\'s fox.',\n        'arabic': '              ',\n        'cyrillic': '     ? ,   !',\n        'cyrillic-ext': '     ? ,   !',\n        'devanagari': '        ',\n        'greek': '    ,    ',\n        'greek-ext': '    ,    ',\n        'hebrew': '       ',\n        'khmer': ' ',\n        'telugu': '   ',\n        'vietnamese': 'Ti c th n thy tinh m khng hi g.'\n    },\n\n    constructor: function() {\n        this.wf = wf;\n        this.field = null;\n        this.element = null;\n        this.throttle = false;\n        this.selected = null;\n        this.loadedFonts = [];\n        this.filters = {\n            search: '',\n            script: 'latin',\n            categories: []\n        };\n    },\n\n    open: function(event, element) {\n        var data = element.data('g5-fontpicker');\n        if (!data) {\n            throw new Error('No fontpicker data found');\n        }\n\n        data = JSON.parse(data);\n        this.field = $(data.field);\n\n        modal.open({\n            content: translate('GANTRY5_PLATFORM_JS_LOADING'),\n            className: 'g5-dialog-theme-default g5-modal-fonts',\n            remote: parseAjaxURI(getAjaxURL('fontpicker') + getAjaxSuffix()),\n            remoteLoaded: bind(function(response, content) {\n                var container = content.elements.content;\n\n                this.attachEvents(container);\n                this.updateCategories(container);\n\n                this.search();\n\n                this.scroll(container.find('ul.g-fonts-list'));\n                this.updateTotal();\n                this.selectFromValue();\n\n                setTimeout(function() {\n                    container.find('.particle-search-wrapper input')[0].focus();\n                }, 5);\n            }, this)\n        });\n    },\n\n    scroll: function(container) {\n        clearTimeout(this.throttle);\n        this.throttle = setTimeout(bind(function() {\n            if (!container) {\n                clearTimeout(this.throttle);\n                return;\n            }\n\n            // 550 = container height, 5 = pages\n            var elements = (container.find('ul.g-fonts-list') || container).inviewport(' > li:not(.g-font-hide)', (550 * (isIE() ? 2 : 7))),\n                list     = [];\n\n            if (!elements) { return; }\n\n            $(elements).forEach(function(element) {\n                element = $(element);\n                var dataFont = element.data('font'),\n                    variant  = element.data('variant');\n\n                if (!contains(this.loadedFonts, dataFont) && variant) {\n                    list.push(dataFont + (variant != 'regular' ? ':' + variant : ''));\n                }\n                else {\n                    if (variant) {\n                        element.find('[data-variant=\"' + variant + '\"] .preview').style({\n                            fontFamily: dataFont,\n                            fontWeight: variant == 'regular' ? 'normal' : variant\n                        });\n                    }\n                }\n            }, this);\n\n            if (!list || !list.length) { return; }\n\n            this.wf.load({\n                classes: false,\n                google: {\n                    families: list\n                },\n                fontactive: bind(function(family, fvd) {\n                    container.find('li[data-font=\"' + family + '\"]:not(.g-variant-hide) > .preview').style({\n                        fontFamily: family,\n                        fontWeight: fvd\n                    });\n                    this.loadedFonts.push(family);\n                }, this)\n            });\n        }, this), 100);\n    },\n\n    unselect: function(selected) {\n        selected = selected || this.selected;\n        if (!selected) { return false; }\n\n        var baseVariant = selected.element.data('variant');\n        selected.element.removeClass('selected');\n        selected.element.search('input[type=checkbox]').checked(false);\n        selected.element.search('[data-font]').addClass('g-variant-hide');\n        selected.element.find('[data-variant=\"' + baseVariant + '\"]').removeClass('g-variant-hide');\n        selected.variants = [selected.baseVariant];\n        selected.selected = [];\n    },\n\n    selectFromValue: function() {\n        var value = this.field.value(), name, variants, subset, isLocal = false;\n\n        if (!value.match('family=')) {\n            var locals = $('[data-category=\"local-fonts\"][data-font]') || [], intersect;\n            locals = locals.map(function(l) { return $(l).data('font'); });\n            value = value.replace(/(\\s{1,})?,(\\s{1,})?/gi, ',').split(',');\n            intersect = intersection(locals, value);\n            if (!intersect.length) { return false; }\n\n            isLocal = true;\n            name = intersect.shift();\n        } else {\n            var split  = value.split('&'),\n                family = split[0],\n                split2 = family.split(':');\n\n            name = split2[0].replace('family=', '').replace(/\\+/g, ' ');\n            variants = split2[1] ? split2[1].split(',') : ['regular'];\n            subset = split[1] ? split[1].replace('subset=', '').split(',') : ['latin'];\n        }\n\n        var noConflict = isLocal ? '[data-category=\"local-fonts\"]' : ':not([data-category=\"local-fonts\"])',\n            element = $('ul.g-fonts-list > [data-font=\"' + name + '\"]' + noConflict);\n        variants = variants || element.data('variants').split(',') || ['regular'];\n\n        if (contains(variants, '400')) {\n            removeAll(variants, '400');\n            insert(variants, 'regular');\n        }\n\n        if (contains(variants, '400italic')) {\n            removeAll(variants, '400italic');\n            insert(variants, 'italic');\n        }\n\n        this.selected = {\n            font: name,\n            baseVariant: element.data('variant'),\n            element: element,\n            variants: variants,\n            selected: [],\n            local: isLocal,\n            charsets: subset,\n            availableVariants: element.data('variants').split(','),\n            expanded: isLocal,\n            loaded: isLocal\n        };\n\n        (isLocal ? [name] : variants).forEach(function(variant) {\n            this.select(element, variant);\n            variant = element.find('> ul > [data-variant=\"' + variant + '\"]');\n            if (variant) { variant.removeClass('g-variant-hide'); }\n        }, this);\n\n        var charsetSelected = element.find('.font-charsets-selected');\n        if (charsetSelected) {\n            var subsetsLength = element.data('subsets').split(',').length;\n            charsetSelected.html('(<i class=\"fa fa-fw fa-check-square-o\"></i>  <span class=\"font-charsets-details\">' + subset.length + ' of ' + subsetsLength + '</span> selected)');\n        }\n\n        if (!isLocal) { $('ul.g-fonts-list')[0].scrollTop = element[0].offsetTop; }\n\n        this.toggleExpansion();\n        setTimeout(bind(function() { this.toggleExpansion(); }, this), 50);\n        if (!isLocal) { setTimeout(bind(function() { $('ul.g-fonts-list')[0].scrollTop = element[0].offsetTop; }, this, 250)); }\n    },\n\n    select: function(element, variant/*, target*/) {\n        var baseVariant = element.data('variant'),\n            isLocal     = !baseVariant;\n\n        if (!this.selected || this.selected.element != element) {\n            if (variant && this.selected) {\n                var charsetSelected = this.selected.element.find('.font-charsets-selected');\n                if (charsetSelected) {\n                    var subsetsLength = element.data('subsets').split(',').length;\n                    charsetSelected.html('(<i class=\"fa fa-fw fa-check-square-o\"></i>  <span class=\"font-charsets-details\">1 of ' + subsetsLength + '</span> selected)');\n                }\n            }\n            this.selected = {\n                font: element.data('font'),\n                baseVariant: baseVariant,\n                element: element,\n                variants: [baseVariant],\n                selected: [],\n                local: isLocal,\n                charsets: ['latin'],\n                availableVariants: element.data('variants').split(','),\n                expanded: isLocal,\n                loaded: isLocal\n            };\n        }\n\n        if (!variant) {\n            this.toggleExpansion();\n        }\n\n\n        if (variant || isLocal) {\n            var selected = ($('ul.g-fonts-list > [data-font]:not([data-font=\"' + this.selected.font + '\"]) input[type=\"checkbox\"]:checked'));\n            if (selected) {\n                selected.checked(false);\n                selected.parent('[data-variants]').removeClass('font-selected');\n            }\n            var checkbox = this.selected.element.find('input[type=\"checkbox\"][value=\"' + (isLocal ? this.selected.font : variant) + '\"]'),\n                checked  = checkbox.checked();\n            if (checkbox) {\n                checkbox.checked(!checked);\n            }\n\n            if (!checked) {\n                insert(this.selected.variants, variant);\n                insert(this.selected.selected, variant);\n            } else {\n                if (variant != this.selected.baseVariant) { removeAll(this.selected.variants, variant); }\n                removeAll(this.selected.selected, variant);\n            }\n\n            this.updateSelection();\n        }\n    },\n\n    toggleExpansion: function() {\n        if (this.selected.availableVariants.length <= 1) { return; }\n        if (this.selected.local) {\n            this.selected.expanded = true;\n            return;\n        }\n\n        if (!this.selected.expanded) {\n            var variants = this.selected.element.data('variants'), variant;\n            if (variants.split(',').length > 1) {\n                this.manipulateLink(this.selected.font);\n                this.selected.element.search('[data-font]').removeClass('g-variant-hide');\n\n                if (!this.selected.loaded) {\n                    this.wf.load({\n                        classes: false,\n                        google: {\n                            families: [this.selected.font.replace(/\\s/g, '+') + ':' + variants]\n                        },\n                        fontactive: bind(function(family, fvd) {\n                            var style  = this.fvdToStyle(family, fvd),\n                                search = style.fontWeight;\n\n                            if (search == '400') {\n                                search = style.fontStyle == 'normal' ? 'regular' : 'italic';\n                            } else if (style.fontStyle == 'italic') {\n                                search += 'italic';\n                            }\n\n                            this.selected.element.find('li[data-variant=\"' + search + '\"] .preview').style(style);\n                            this.selected.loaded = true;\n                        }, this)\n                    });\n                }\n            }\n        } else {\n            var exclude = ':not([data-variant=\"' + this.selected.variants.join('\"]):not([data-variant=\"') + '\"])';\n            exclude = this.selected.element.search('[data-font]' + exclude);\n            if (exclude) { exclude.addClass('g-variant-hide'); }\n        }\n\n        this.selected.expanded = !this.selected.expanded;\n    },\n\n    manipulateLink: function(family) {\n        family = family.replace(/\\s/g, '+');\n        var link = $('head link[href*=\"' + family + '\"]');\n        if (!link) { return; }\n\n        var parts = decodeURIComponent(link.href()).split('|');\n        if (!parts || parts.length <= 1) { return; }\n\n        removeAll(parts, family);\n\n        link.attribute('href', encodeURI(parts.join('|')));\n    },\n\n    toggle: function(event, element) {\n        element = $(element);\n        var target = $(event.target);\n\n        if (target.attribute('type') == 'checkbox') {\n            target.checked(!target.checked());\n        }\n\n        this.select(element.parent('[data-font]') || element, element.parent('[data-font]') ? element.data('variant') : false, element);\n\n        return false;\n    },\n\n    updateSelection: function() {\n        var preview = $('.g-particles-footer .font-selected'), selected, variants;\n        if (!preview) { return; }\n\n        if (!this.selected.selected.length) {\n            preview.empty();\n            this.selected.element.removeClass('font-selected');\n            return;\n        }\n\n        selected = this.selected.selected.sort();\n        variants = this.selected.local ? '(<small>local</small>)' : '(<small>' + selected.join(', ').replace('regular', 'normal') + '</small>)';\n        this.selected.element.addClass('font-selected');\n        preview.html('<strong>' + this.selected.font + '</strong> ' + variants);\n    },\n\n    updateTotal: function() {\n        var totals = $('.g-particles-header .particle-search-total'),\n            count  = $('.g-fonts-list > [data-font]:not(.g-font-hide)');\n\n        totals.text(count ? count.length : 0);\n    },\n\n    updateCategories: function(container) {\n        var categories = container.find('[data-font-categories]');\n        if (!categories) { return; }\n\n        this.filters.categories = categories.data('font-categories').split(',');\n    },\n\n    attachEvents: function(container) {\n        var header  = container.find('.g-particles-header'),\n            list    = container.find('.g-fonts-list'),\n            search  = header.find('input.font-search'),\n            preview = header.find('input.font-preview');\n\n        decouple(list, 'scroll', bind(this.scroll, this, list));\n        container.delegate('click', '.g-fonts-list li[data-font]', bind(this.toggle, this));\n\n        if (search) { search.on('keyup', bind(this.search, this, search)); }\n        if (preview) { preview.on('keyup', bind(this.updatePreview, this, preview)); }\n\n        this.attachCharsets(container);\n        this.attachLocalVariants(container);\n        this.attachFooter(container);\n    },\n\n    attachCharsets: function(container) {\n        container.delegate('mouseover', '.font-charsets-selected', bind(function(event, element) {\n            if (!element.PopoverDefined) {\n                var popover = element.getPopover({\n                    placement: 'auto',\n                    width: '200',\n                    trigger: 'mouse',\n                    style: 'font-categories, above-modal'\n                });\n\n                element.on('beforeshow.popover', bind(function(popover) {\n                    var subsets = element.parent('[data-subsets]').data('subsets').split(','),\n                        content = popover.$target.find('.g5-popover-content'),\n                        checked;\n\n                    content.empty();\n\n                    var div, current;\n                    subsets.forEach(function(cs) {\n                        current = contains(this.selected.charsets, cs) ? (cs == 'latin' ? 'checked disabled' : 'checked') : '';\n                        zen('div').html('<label><input type=\"checkbox\" ' + current + ' value=\"' + cs + '\"/> ' + properCase(unhyphenate(cs.replace('ext', 'extended'))) + '</label>').bottom(content);\n                    }, this);\n\n                    content.delegate('click', 'input[type=\"checkbox\"]', bind(function(event, input) {\n                        input = $(input);\n                        checked = content.search('input[type=\"checkbox\"]:checked');\n                        this.selected.charsets = checked ? checked.map('value') : [];\n\n                        element.html('(<i class=\"fa fa-fw fa-check-square-o\"></i>  <span class=\"font-charsets-details\">' + this.selected.charsets.length + ' of ' + subsets.length + '</span> selected)');\n                    }, this));\n\n                    popover.displayContent();\n                }, this));\n\n                element.getPopover().show();\n            }\n        }, this));\n    },\n\n    attachLocalVariants: function(container) {\n        container.delegate('mouseover', '.g-font-variants-list', bind(function(event, element) {\n            if (!element.PopoverDefined) {\n                var popover = element.getPopover({\n                    placement: 'auto',\n                    width: '200',\n                    trigger: 'mouse',\n                    style: 'font-categories, above-modal'\n                });\n\n                element.on('beforeshow.popover', bind(function(popover) {\n                    var content  = popover.$target.find('.g5-popover-content'),\n                        variants = element.parent('[data-variants]').data('variants').split(',');\n\n                    content.empty();\n\n                    asyncForEach(variants, bind(function(variant) {\n                        variant = variant == '400' ? 'regular' : (variant == '400italic' ? 'italic' : variant + '');\n                        zen('div').text(this.mapVariant(variant)).bottom(content);\n                    }, this));\n\n                    popover.displayContent();\n                }, this));\n            }\n        }, this));\n    },\n\n    attachFooter: function(container) {\n        var footer     = container.find('.g-particles-footer'),\n            select     = footer.find('button.button-primary'),\n            categories = footer.find('.font-category'),\n            subsets    = footer.find('.font-subsets'),\n            current;\n\n        select.on('click', bind(function() {\n            if (!$('ul.g-fonts-list > [data-font] input[type=\"checkbox\"]:checked')) {\n                this.field.value('');\n                modal.close();\n                return;\n            }\n\n            var name      = this.selected.font.replace(/\\s/g, '+'),\n                variation = this.selected.selected,\n                charset   = this.selected.charsets;\n\n            if (variation && variation.length == 1 && variation[0] == 'regular') { variation = []; }\n            if (charset && charset.length == 1 && charset[0] == 'latin') { charset = []; }\n\n            if (contains(variation, 'regular')) {\n                removeAll(variation, 'regular');\n                insert(variation, '400');\n            }\n            if (contains(variation, 'italic')) {\n                removeAll(variation, 'italic');\n                insert(variation, '400italic');\n            }\n\n            if (!this.selected.local) {\n                this.field.value('family=' + name + (variation.length ? ':' + variation.join(',') : '') + (charset.length ? '&subset=' + charset.join(',') : ''));\n            } else {\n                this.field.value(name);\n            }\n\n            this.field.emit('input');\n            $('body').emit('input', { target: this.field });\n\n            modal.close();\n        }, this));\n\n        categories.popover({\n            placement: 'top',\n            width: '200',\n            trigger: 'mouse',\n            style: 'font-categories, above-modal'\n        }).on('beforeshow.popover', bind(function(popover) {\n            var cats    = categories.data('font-categories').split(','),\n                content = popover.$target.find('.g5-popover-content'),\n                checked;\n\n            content.empty();\n\n            cats.forEach(function(category) {\n                if (category == 'local-fonts') { return; }\n                current = contains(this.filters.categories, category) ? 'checked' : '';\n                zen('div').html('<label><input type=\"checkbox\" ' + current + ' value=\"' + category + '\"/> ' + properCase(unhyphenate(category)) + '</label>').bottom(content);\n            }, this);\n\n            content.delegate('click', 'input[type=\"checkbox\"]', bind(function(event, input) {\n                input = $(input);\n                checked = content.search('input[type=\"checkbox\"]:checked');\n                this.filters.categories = checked ? checked.map('value') : [];\n                categories.find('small').text(this.filters.categories.length);\n                this.search();\n            }, this));\n\n            popover.displayContent();\n        }, this));\n\n        subsets.popover({\n            placement: 'top',\n            width: '200',\n            trigger: 'mouse',\n            style: 'font-subsets, above-modal'\n        }).on('beforeshow.popover', bind(function(popover) {\n            var subs    = subsets.data('font-subsets').split(','),\n                content = popover.$target.find('.g5-popover-content');\n\n            content.empty();\n\n            var div;\n            subs.forEach(function(sub) {\n                current = sub == this.filters.script ? 'checked' : '';\n                zen('div').html('<label><input name=\"font-subset[]\" type=\"radio\" ' + current + ' value=\"' + sub + '\"/> ' + properCase(unhyphenate(sub.replace('ext', 'extended'))) + '</label>').bottom(content);\n            }, this);\n\n            content.delegate('change', 'input[type=\"radio\"]', bind(function(event, input) {\n                input = $(input);\n                this.filters.script = input.value();\n                $('.g-particles-header input.font-preview').value(this.previewSentence[this.filters.script]);\n                subsets.find('small').text(properCase(unhyphenate(input.value().replace('ext', 'extended'))));\n                this.search();\n                this.updatePreview();\n            }, this));\n\n            popover.displayContent();\n        }, this));\n\n        return container;\n    },\n\n    search: function(input) {\n        input = input || $('.g-particles-header input.font-search');\n        var list  = $('.g-fonts-list'),\n            value = input.value(),\n            name, subsets, category, data;\n\n        list.search('> [data-font]').forEach(function(font) {\n            font = $(font);\n            name = font.data('font');\n            subsets = font.data('subsets').split(',');\n            category = font.data('category');\n            font.removeClass('g-font-hide');\n\n            // We dont want to hide selected fonts\n            if (this.selected && this.selected.font == name && this.selected.selected.length) { return; }\n\n            // Filter by Subset\n            if (!contains(subsets, this.filters.script)) {\n                font.addClass('g-font-hide');\n                return;\n            }\n\n            // Filter by Category\n            if (!contains(this.filters.categories, category)) {\n                font.addClass('g-font-hide');\n                return;\n            }\n\n            // Filter by Name\n            if (!name.match(new RegExp(\"^\" + value + '|\\\\s' + value, 'gi'))) {\n                font.addClass('g-font-hide');\n            } else {\n                font.removeClass('g-font-hide');\n            }\n        }, this);\n\n        this.updateTotal();\n\n        clearTimeout(input.refreshTimer);\n\n        input.refreshTimer = setTimeout(bind(function() {\n            this.scroll($('ul.g-fonts-list'));\n        }, this), 400);\n\n        input.previousValue = value;\n    },\n\n    updatePreview: function(input) {\n        input = input || $('.g-particles-header input.font-preview');\n\n        clearTimeout(input.refreshTimer);\n\n        var value = input.value(),\n            list  = $('.g-fonts-list');\n\n        value = trim(value) ? trim(value) : this.previewSentence[this.filters.script];\n\n        if (input.previousValue == value) { return true; }\n\n        list.search('[data-font] .preview').text(value);\n\n        input.previousValue = value;\n    },\n\n    fvdToStyle: function(family, fvd) {\n        var match = fvd.match(/([a-z])([0-9])/);\n        if (!match) return '';\n\n        var styleMap = {\n            n: 'normal',\n            i: 'italic',\n            o: 'oblique'\n        };\n        return {\n            fontFamily: family,\n            fontStyle: styleMap[match[1]],\n            fontWeight: (match[2] * 100).toString()\n        }\n    },\n\n    mapVariant: function(variant) {\n        switch (variant) {\n            case '100':\n                return 'Thin 100';\n                break;\n            case '100italic':\n                return 'Thin 100 Italic';\n                break;\n            case '200':\n                return 'Extra-Light 200';\n                break;\n            case '200italic':\n                return 'Extra-Light 200 Italic';\n                break;\n            case '300':\n                return 'Light 300';\n                break;\n            case '300italic':\n                return 'Light 300 Italic';\n                break;\n            case '400':\n            case 'regular':\n                return 'Normal 400';\n                break;\n            case '400italic':\n            case 'italic':\n                return 'Normal 400 Italic';\n                break;\n            case '500':\n                return 'Medium 500';\n                break;\n            case '500italic':\n                return 'Medium 500 Italic';\n                break;\n            case '600':\n                return 'Semi-Bold 600';\n                break;\n            case '600italic':\n                return 'Semi-Bold 600 Italic';\n                break;\n            case '700':\n                return 'Bold 700';\n                break;\n            case '700italic':\n                return 'Bold 700 Italic';\n                break;\n            case '800':\n                return 'Extra-Bold 800';\n                break;\n            case '800italic':\n                return 'Extra-Bold 800 Italic';\n                break;\n            case '900':\n                return 'Ultra-Bold 900';\n                break;\n            case '900italic':\n                return 'Ultra-Bold 900 Italic';\n                break;\n            default:\n                return 'Unknown Variant';\n        }\n    }\n});\n\ndomready(function() {\n    var body = $('body');\n    body.delegate('click', '[data-g5-fontpicker]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n        var FontPicker = storage.get(element);\n        if (!FontPicker) {\n            FontPicker = new Fonts();\n            storage.set(element, FontPicker);\n        }\n\n        FontPicker.open(event, element);\n    });\n});\n\nmodule.exports = Fonts;\n","\"use strict\";\nvar $             = require('../../utils/elements.utils'),\n    domready      = require('elements/domready'),\n    modal         = require('../../ui').modal,\n    getAjaxSuffix = require('../../utils/get-ajax-suffix'),\n    parseAjaxURI  = require('../../utils/get-ajax-url').parse,\n    getAjaxURL    = require('../../utils/get-ajax-url').global,\n    translate     = require('../../utils/translate'),\n\n    trim          = require('mout/string/trim'),\n    contains      = require('mout/array/contains');\n\ndomready(function() {\n    var body = $('body');\n    body.delegate('keyup', '.g-icons input[type=\"text\"]', function(event, element){\n        element = $(element);\n        var preview = element.sibling('[data-g5-iconpicker]') || element.siblings().find('[data-g5-iconpicker]'),\n            value = element.value(),\n            size;\n\n        preview.find('i').attribute('class', value || 'fa fa-hand-o-up picker');\n\n        size = preview[0].offsetWidth;\n\n        if (!size) { preview.find('i').attribute('class', 'fa fa-hand-o-up picker'); }\n    });\n\n    body.delegate('click', '[data-g5-iconpicker]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n        element = $(element);\n        var field = $(element.data('g5-iconpicker')),\n            realPreview = element,\n            value = trim(field.value()).replace(/\\s{2,}/g, ' ').split(' ');\n\n        modal.open({\n            content: translate('GANTRY5_PLATFORM_JS_LOADING'),\n            className: 'g5-dialog-theme-default g5-modal-icons',\n            remote: parseAjaxURI(getAjaxURL('icons') + getAjaxSuffix()),\n            afterClose: function() {\n                var popovers = $('.g5-popover');\n                if (popovers) { popovers.remove(); }\n            },\n            remoteLoaded: function(response, content) {\n                var html, large,\n                    container = content.elements.content,\n                    icons = container.search('[data-g-icon]');\n\n                if (!icons || !response.body.success) {\n                    container.html(response.body.html || response.body);\n                    return false;\n                }\n\n                var updatePreview = function() {\n                    var data = [],\n                        active = container.find('[data-g-icon].active'),\n                        options = container.search('.g-particles-header .float-right input:checked, .g-particles-header .float-right select');\n\n                    if (active) { data.push(active.data('g-icon')); }\n                    if (options) {\n                        options.forEach(function(option) {\n                            var v = $(option).value();\n                            if (v && v !== 'fa-') { data.push(v); }\n                        });\n                    }\n\n                    container.find('.g-icon-preview').html('<i class=\"fa ' + data.join(' ') + '\"></i> <span>' + data[0] + '</span>');\n                    container.find('[data-g-select]').disabled(container.find('[data-g-icon].active') ? null : true);\n                };\n\n                var updateTotal = function() {\n                    var total = container.search('[data-g-icon]:not(.hide-icon)');\n                    container.find('.particle-search-total').text(total ? total.length : 0);\n                };\n\n                container.find('[data-g-select]').disabled(container.find('[data-g-icon].active') ? null : true);\n\n                container.delegate('click', '[data-g-icon]', function(event, element) {\n                    if (event && event.preventDefault) { event.preventDefault(); }\n                    element = $(element);\n\n                    var active = container.find('[data-g-icon].active');\n                    if (active) { active.removeClass('active'); }\n\n                    element.addClass('active');\n                    container.find('[data-g-select]').disabled(null);\n\n                    updatePreview();\n                });\n\n                container.delegate('click', '[data-g-select]', function(event){\n                    event.preventDefault();\n\n                    if (!container.find('[data-g-icon].active')) { return false; }\n\n                    var output = container.find('.g-icon-preview i');\n                    field.value(output.attribute('class'));\n                    realPreview.find('i').attribute('class', output.attribute('class'));\n\n                    field.emit('input');\n\n                    $('body').emit('input', {target: field});\n\n                    modal.close();\n                });\n\n                container.delegate('change', '.g-particles-header .float-right input[type=\"checkbox\"], .g-particles-header .float-right select', function(/*e, input*/) {\n                    updatePreview();\n                });\n\n                container.delegate('keyup', '.particle-search-wrapper input[type=\"text\"]', function(e, input) {\n                    input = $(input);\n                    var value = input.value(),\n                        hidden = container.search('[data-g-icon].hide-icon');\n\n                    if (!value) {\n                        if (hidden) {\n                            hidden.removeClass('hide-icon');\n                            updateTotal();\n                        }\n                        return true;\n                    }\n\n                    var found = container.search('[data-g-icon*=\"' + value + '\"]');\n                    container.search('[data-g-icon]').addClass('hide-icon');\n                    if (found) {\n                        found.removeClass('hide-icon');\n                    }\n\n                    updateTotal();\n\n                });\n\n                icons.forEach(function(icon) {\n                    icon = $(icon);\n                    html = '';\n\n                    for (var i = 5, l = 0; i > l; i--) {\n                        large = (!i) ? 'lg' : i + 'x';\n                        html += '<i class=\"fa ' + icon.data('g-icon') + ' fa-' + large + '\"></i> ';\n                    }\n\n                    html += '<h3>' + icon.data('g-icon') + '</h3>';\n\n                    icon.popover({\n                        content: html,\n                        placement: 'auto',\n                        trigger: 'mouse',\n                        style: 'above-modal, icons-preview',\n                        width: 'auto',\n                        targetEvents: false,\n                        delay: 1\n                    }).on('hidden.popover', function(instance) {\n                        if (instance.$target) { instance.$target.remove(); }\n                    });\n\n                    if (contains(value, icon.data('g-icon'))) {\n                        // set active icon\n                        icon.addClass('active');\n\n                        // toggle options\n                        value.forEach(function(name) {\n                            var field = container.find('[name=\"' + name + '\"]');\n                            if (field) { field.checked(true); }\n                            else {\n                                field = container.find('option[value=\"' + name + '\"]');\n                                if (field) { field.parent().value(name); }\n                            }\n                        });\n\n                        // scroll into place of active icon\n                        var wrap = icon.parent('.icons-wrapper'),\n                            wrapHeight = wrap[0].offsetHeight;\n                        wrap[0].scrollTop = icon[0].offsetTop - (wrapHeight / 2);\n\n                        // update preview\n                        updatePreview();\n                    }\n                });\n\n                setTimeout(function() {\n                    container.find('.particle-search-wrapper input')[0].focus();\n                }, 5);\n            }\n        });\n    });\n});\n\nmodule.exports = {};\n","\"use strict\";\n\nmodule.exports = {\n    colorpicker: require('./colorpicker'),\n    fonts: require('./fonts'),\n    menu: require('./menu'),\n    icons: require('./icons'),\n    filepicker: require('./filepicker'),\n    collections: require('./collections'),\n    keyvalue: require('./keyvalue'),\n    instancepicker: require('./instancepicker')\n};","\"use strict\";\n\nvar $             = require('elements'),\n    zen           = require('elements/zen'),\n    ready         = require('elements/domready'),\n    Submit        = require('../../fields/submit'),\n    modal         = require('../../ui').modal,\n    request       = require('agent'),\n    trim          = require('mout/string/trim'),\n    parseAjaxURI  = require('../../utils/get-ajax-url').parse,\n    getAjaxURL    = require('../../utils/get-ajax-url').global,\n    getAjaxSuffix = require('../../utils/get-ajax-suffix'),\n    translate     = require('../../utils/translate');\n\nvar WordpressWidgetsCustomizer = require('../../utils/wp-widgets-customizer');\n\nready(function() {\n    var body = $('body'),\n        particleField = $('[data-g-instancepicker] ~ input[type=\"hidden\"]'),\n        moduleType = {\n            wordpress: 'widget',\n            joomla: 'module'\n        };\n\n    //if (particleField) {\n        //particleField.on('change', function(){\n        body.delegate('input', '[data-g-instancepicker] ~ input[type=\"hidden\"]', function(event, element){\n            if (!element.value()) {\n                var title = element.siblings('.g-instancepicker-title'),\n                    label = element.siblings('[data-g-instancepicker]'),\n                    reset = element.sibling('.g-reset-field');\n\n                title.text('');\n                label.text(label.data('g-instancepicker-text'));\n                reset.style('display', 'none');\n            }\n        });\n    //}\n\n\n    body.delegate('click', '[data-g-instancepicker]', function(event, element) {\n        if (event) { event.preventDefault(); }\n\n        var data = JSON.parse(element.data('g-instancepicker')),\n            field = $('[name=\"' + data.field + '\"]'),\n            value, uri; // = 'particle' + ((data.type == moduleType[GANTRY_PLATFORM]) ? '/' + moduleType[GANTRY_PLATFORM] : ''),\n\n        if (data.type == moduleType[GANTRY_PLATFORM]) {\n            uri = (data.type != 'widget' ? 'particle/' : '') + moduleType[GANTRY_PLATFORM];\n        } else {\n            uri = 'particle';\n        }\n\n        if (!field) { return false; }\n\n        value = field.value();\n\n        if ((data.type == 'particle' || data.type == 'widget') && value) {\n            value = JSON.parse(value || {});\n            uri = value.type + '/' + value[data.type];\n        }\n\n        if (data.modal_close) { return true; }\n\n        modal.open({\n            content: translate('GANTRY5_PLATFORM_JS_LOADING'),\n            method: !value || data.type == 'module' ? 'get' : 'post', // data.type == moduleType[GANTRY_PLATFORM]\n            data: !value || data.type == 'module' ? {} : value, // data.type == moduleType[GANTRY_PLATFORM]\n            overlayClickToClose: false,\n            remote: parseAjaxURI(getAjaxURL(uri) + getAjaxSuffix()),\n            remoteLoaded: function(response, modalInstance) {\n                if (!response.body.success) {\n                    modal.enableCloseByOverlay();\n                    return;\n                }\n\n                var content = modalInstance.elements.content,\n                    select = content.find('[data-mm-select]');\n\n                var search = content.find('.search input'),\n                    blocks = content.search('[data-mm-type]'),\n                    filters = content.search('[data-mm-filter]');\n\n                if (search && filters && blocks) {\n                    search.on('input', function() {\n                        if (!this.value()) {\n                            blocks.removeClass('hidden');\n                            return;\n                        }\n\n                        blocks.addClass('hidden');\n\n                        var found = [], value = this.value().toLowerCase(), text;\n\n                        filters.forEach(function(filter) {\n                            filter = $(filter);\n                            text = trim(filter.data('mm-filter')).toLowerCase();\n                            if (text.match(new RegExp(\"^\" + value + '|\\\\s' + value, 'gi'))) {\n                                found.push(filter.matches('[data-mm-type]') ? filter : filter.parent('[data-mm-type]'));\n                            }\n                        }, this);\n\n                        if (found.length) { $(found).removeClass('hidden'); }\n                    });\n\n                    setTimeout(function() {\n                        search[0].focus();\n                    }, 5);\n                }\n\n                var elementData = JSON.parse(element.data('g-instancepicker'));\n                if (elementData.type == moduleType[GANTRY_PLATFORM]) { elementData.modal_close = true; }\n                if (select) { select.data('g-instancepicker', JSON.stringify(elementData)); }\n                else {\n                    var form = content.find('form'),\n                        fakeDOM = zen('div').html(response.body.html || response.body).find('form'),\n                        submit = content.find('input[type=\"submit\"], button[type=\"submit\"]');\n\n                    if ((!form && !fakeDOM) || !submit) { return true; }\n\n                    var applyAndSave = content.search('[data-apply-and-save]');\n                    if (applyAndSave) { applyAndSave.remove(); }\n\n                    submit.on('click', function(e) {\n                        e.preventDefault();\n\n                        submit.showIndicator();\n\n                        var post = Submit(fakeDOM[0].elements, content);\n\n                        request(fakeDOM.attribute('method'), parseAjaxURI(fakeDOM.attribute('action') + getAjaxSuffix()), post.valid.join('&') || {}, function(error, response) {\n                            if (!response.body.success) {\n                                modal.open({\n                                    content: response.body.html || response.body,\n                                    afterOpen: function(container) {\n                                        if (!response.body.html) { container.style({ width: '90%' }); }\n                                    }\n                                });\n                            } else {\n\n                                var label = field.siblings('.g-instancepicker-title');\n\n                                if (field) {\n                                    field.value(JSON.stringify(response.body.item));\n                                    $('body').emit('change', { target: field });\n                                }\n\n                                if (label) { label.text(response.body.item.title); }\n                            }\n\n                            modal.close();\n                            submit.hideIndicator();\n\n                            WordpressWidgetsCustomizer(field);\n                        });\n                    });\n\n                }\n            }\n        });\n    });\n});\n\nmodule.exports = {};\n","\"use strict\";\n\nvar ready         = require('elements/domready'),\n    $             = require('elements'),\n    zen           = require('elements/zen'),\n    has           = require('mout/object/has'),\n    some          = require('mout/array/some'),\n    modal         = require('../../ui').modal,\n    toastr        = require('../../ui').toastr,\n    request       = require('agent'),\n    indexOf       = require('mout/array/indexOf'),\n    contains      = require('mout/array/contains'),\n    lastItem      = require('mout/array/last'),\n    keys          = require('mout/object/keys'),\n    simpleSort    = require('sortablejs'),\n    escapeUnicode = require('mout/string/escapeUnicode'),\n\n    trim          = require('mout/string/trim'),\n\n    getAjaxSuffix = require('../../utils/get-ajax-suffix'),\n    translate     = require('../../utils/translate');\n\nrequire('elements/insertion');\n\nready(function() {\n    var body = $('body');\n\n    var createSortables = function(list) {\n        var lists = list || $('.g-keyvalue-field ul');\n        if (!lists) { return; }\n        lists.forEach(function(list) {\n            list = $(list);\n            list.SimpleSort = simpleSort.create(list[0], {\n                handle: '.fa-reorder',\n                filter: '[data-keyvalue-nosort]',\n                scroll: false,\n                animation: 150,\n                onStart: function() {\n                    $(this.el).addClass('keyvalue-sorting');\n                },\n                onEnd: function(evt) {\n                    var element = $(this.el);\n                    element.removeClass('keyvalue-sorting');\n\n                    if (evt.oldIndex === evt.newIndex) { return; }\n\n                    var dataField = element.parent('.settings-param').find('[data-keyvalue-data]'),\n                        data      = dataField.value();\n\n                    data = JSON.parse(data);\n\n                    data.splice(evt.newIndex, 0, data.splice(evt.oldIndex, 1)[0]);\n                    dataField.value(JSON.stringify(data));\n                    body.emit('change', { target: dataField });\n                }\n            });\n        });\n    };\n\n    createSortables();\n\n    // delegate sortables collections for ajax support\n    body.delegate('mouseover', '.g-keyvalue-field ul', function(event, element) {\n        if (!element.SimpleSort) { createSortables(element); }\n    });\n\n    // Add new item\n    body.delegate('click', '[data-keyvalue-addnew]', function(event, element) {\n        var param = element.parent('.settings-param'),\n            list  = param.find('ul'),\n            tmpl  = param.find('[data-keyvalue-template]'),\n            items = list.search('> [data-keyvalue-item]') || [],\n            last  = $(lastItem(items));\n\n        var clone = $(tmpl[0].cloneNode(true));\n\n        if (last) { clone.after(last); }\n        else { clone.top(list); }\n\n        clone.attribute('style', null).data('keyvalue-item', clone.data('keyvalue-template'));\n        clone.attribute('data-keyvalue-template', null);\n        clone.attribute('data-keyvalue-nosort', null);\n        clone.find('[data-keyvalue-key]')[0].focus();\n\n        //body.emit('change', { target: dataField });\n    });\n\n    // Remove item\n    body.delegate('click', '[data-keyvalue-remove]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n        var item      = element.parent('[data-keyvalue-item]'),\n            key       = item.find('input[type=\"text\"]').data('keyvalue-key'),\n            dataField = element.parent('.settings-param').find('[data-keyvalue-data]'),\n            items     = element.parent('ul').search('> [data-keyvalue-item]'),\n            index     = indexOf(items, item[0]),\n            data      = JSON.parse(dataField.value());\n\n        data.splice(index, 1);\n        dataField.value(escapeUnicode(JSON.stringify(data)));\n        item.remove();\n\n        body.emit('change', { target: dataField });\n    });\n\n    // Change values\n    body.delegate('blur', '[data-keyvalue-item] input[type=\"text\"]', function(event, element) {\n        var parent     = element.parent('[data-keyvalue-item]'),\n            wrapper    = parent.find('.g-keyvalue-wrapper'),\n            keyElement = parent.find('[data-keyvalue-key]'),\n            valElement = parent.find('[data-keyvalue-value]'),\n            key        = keyElement.data('keyvalue-key'),\n            keyValue   = trim(keyElement.value()),\n            valValue   = trim(valElement.value()),\n            items      = element.parent('ul').search('> [data-keyvalue-item]:not(.g-keyvalue-warning):not(.g-keyvalue-excluded)'),\n            index      = indexOf(items, parent[0]),\n\n            dataField  = element.parent('.settings-param').find('[data-keyvalue-data]'),\n            data       = JSON.parse(dataField.value()),\n            exclude    = JSON.parse(dataField.data('keyvalue-exclude')),\n            excluded   = contains(exclude, keyValue),\n            duplicate  = some(data, function(obj) { return has(obj, keyValue); }) && key !== keyValue;\n\n        if (keyElement == element) {\n            // renamed or cleared key, need to cleanup JSON\n            if (key !== keyValue && !duplicate) {\n                data.splice(index, 1);\n                keyElement.data('keyvalue-key', keyValue || '');\n            }\n\n            parent[duplicate ? 'addClass' : 'removeClass']('g-keyvalue-warning');\n            parent[excluded ? 'addClass' : 'removeClass']('g-keyvalue-excluded');\n\n            wrapper\n                .data('tip', duplicate ? translate('GANTRY5_PLATFORM_JS_KEYVALUE_DUPLICATE', keyValue) : (excluded ? translate('GANTRY5_PLATFORM_JS_KEYVALUE_EXCLUDED', keyValue) : null))\n                .data('tip-place', 'top-right')\n                .data('tip-spacing', 2)\n                .data('tip-offset', 8);\n\n            if (excluded || duplicate) {\n                window.G5.tips.get(wrapper[0]).show();\n            } else {\n                window.G5.tips.remove(wrapper[0]);\n            }\n        }\n\n        if (keyValue && !excluded && !duplicate) {\n            if (!data[index]) { data.splice(index, 0, {}); }\n            data[index][keyValue] = valValue;\n        }\n\n        dataField.value(escapeUnicode(JSON.stringify(data)));\n        body.emit('change', { target: dataField });\n\n    }, true);\n\n    body.delegate('update', '[data-keyvalue-data]', function(event, element) {\n        var parent = element.parent(),\n            items  = parent.search('[data-keyvalue-item]'),\n            list   = parent.find('ul'),\n            data   = JSON.parse(element.value()),\n            tmpl   = parent.find('[data-keyvalue-template]');\n\n        if (items) { items.remove(); }\n\n        data.forEach(function(obj, index) {\n            var clone = $(tmpl[0].cloneNode(true)),\n                key   = keys(obj).shift(),\n                value = obj[key];\n\n            list.appendChild(clone);\n\n            clone.attribute('style', null).data('keyvalue-item', clone.data('keyvalue-template'));\n            clone.attribute('data-keyvalue-template', null);\n            clone.attribute('data-keyvalue-nosort', null);\n            clone.find('[data-keyvalue-key]').value(key);\n            clone.find('[data-keyvalue-value]').value(value);\n        });\n    });\n\n});\n\nmodule.exports = {};\n","\"use strict\";\nvar $             = require('../../utils/elements.utils'),\n    domready      = require('elements/domready');\n\ndomready(function() {\n    var body = $('body');\n    body.delegate('click', '[data-g5-content] .g-main-nav .g-toplevel [data-g5-ajaxify]', function(event, element) {\n        if (event && event.preventDefault) { event.preventDefault(); }\n        var items = $('[data-g5-content] .g-main-nav .g-toplevel [data-g5-ajaxify] !> li');\n        if (items) { items.removeClass('active'); }\n        element.parent('li').addClass('active');\n    });\n});\n\nmodule.exports = {};","\"use strict\";\n\nvar $             = require('elements'),\n    zen           = require('elements/zen'),\n    ready         = require('elements/domready'),\n    trim          = require('mout/string/trim'),\n    keys          = require('mout/object/keys'),\n    modal         = require('../ui').modal,\n    toastr        = require('../ui').toastr,\n    request       = require('agent'),\n    getAjaxSuffix = require('../utils/get-ajax-suffix'),\n    parseAjaxURI  = require('../utils/get-ajax-url').parse,\n    getAjaxURL    = require('../utils/get-ajax-url').global,\n\n    Eraser        = require('../ui/eraser'),\n    simpleSort    = require('sortablejs'),\n\n    flags         = require('../utils/flags-state');\n\n\nvar PositionsField = '[name=\"page[head][atoms][_json]\"]',\n    groupOptions   = [\n        { name: 'positions', pull: true, put: true },\n        { name: 'positions', pull: false, put: false }\n    ];\n\nvar Positions = {\n    eraser: null,\n    lists: [],\n\n    serialize: function(position) {\n        var data,\n            output = [],\n            positions  = $(position) || $('[data-position]');\n\n        if (!positions) {\n            return '[]';\n        }\n\n        positions.forEach(function(position) {\n            position = $(position);\n            data = JSON.parse(position.data('position'));\n            data.modules = [];\n\n            // collect positions items\n            (position.search('[data-pm-data]') || []).forEach(function(item) {\n                item = $(item);\n                data.modules.push(JSON.parse(item.data('pm-data') || '{}'));\n            });\n\n            output.push(data);\n            position.data('position', JSON.stringify(data));\n        });\n\n        return JSON.stringify(output).replace(/\\//g, '\\\\/');\n    },\n\n    attachEraser: function() {\n        if (Positions.eraser) {\n            Positions.eraser.element = $('[data-positions-erase]');\n            Positions.eraser.hide('fast');\n            return;\n        }\n\n        Positions.eraser = new Eraser('[data-positions-erase]');\n    },\n\n    createSortables: function(element) {\n        var list, sort;\n\n        Positions.attachEraser();\n\n        groupOptions.forEach(function(groupOption, i) {\n            list = !i ? '[data-position] ul' : '#trash';\n            list = $(list);\n\n            list.forEach(function(element, listIndex){\n                sort = simpleSort.create(element, {\n                    sort: !i,\n                    filter: '[data-position-ignore]',\n                    group: groupOption,\n                    scroll: true,\n                    forceFallback: true,\n                    animation: 100,\n\n                    onStart: function(event) {\n                        Positions.attachEraser();\n\n                        var item = $(event.item);\n                        item.addClass('position-dragging');\n\n                        Positions.eraser.show();\n                    },\n\n                    onEnd: function(event) {\n                        var item       = $(event.item),\n                            trash      = $('#trash'),\n                            target     = $(this.originalEvent.target),\n                            touchTrash = false;\n\n                        // workaround for touch devices\n                        if (this.originalEvent.type === 'touchend') {\n                            var trashSize = trash[0].getBoundingClientRect(),\n                                oE        = this.originalEvent,\n                                position  = (oE.pageY || oE.changedTouches[0].pageY) - window.scrollY;\n\n                            touchTrash = position <= trashSize.height;\n                        }\n\n                        if (target.matches('#trash') || target.parent('#trash') || touchTrash) {\n                            item.remove();\n                            Positions.eraser.hide();\n                            this.options.onSort(event);\n                            return;\n                        }\n\n                        item.removeClass('position-dragging');\n\n                        Positions.eraser.hide();\n                    },\n\n                    onSort: function(event) {\n                        var from = $(event.from),\n                            to = $(event.to),\n                            lists = [from.parent('[data-position]'), to.parent('[data-position]')];\n\n                        if (event.from[0] === event.to[0]) {\n                            lists.shift();\n                        }\n\n                        Positions.serialize(lists);\n                    },\n\n                    onOver: function(event) {\n                        if (!$(event.from).matches('ul')) { return; }\n\n                        var over = $(event.newIndex);\n                        if (over.matches('#trash') || over.parent('#trash')) {\n                            Positions.eraser.over();\n                        } else {\n                            Positions.eraser.out();\n                        }\n                    }\n                });\n\n                if (!i) {\n                    if (!Positions.lists[listIndex]) {\n                        Positions.lists[listIndex] = sort;\n                    }\n                }\n            });\n\n            if (!i) {\n                element.SimpleSort = sort;\n            }\n        });\n    }\n};\n\n\nvar AttachSortablePositions = function(positions) {\n    if (!positions) { return; }\n    if (!positions.SimpleSort) { Positions.createSortables(positions); }\n};\n\nready(function() {\n    var positions = $('#positions');\n\n    $('body').delegate('mouseover', '#positions', function(event, element) {\n        AttachSortablePositions(element);\n    });\n\n    AttachSortablePositions(positions);\n});\n\nmodule.exports = Positions;","\"use strict\";\n\nvar $             = require('elements'),\n    zen           = require('elements/zen'),\n    ready         = require('elements/domready'),\n    trim          = require('mout/string/trim'),\n    keys          = require('mout/object/keys'),\n    modal         = require('../ui').modal,\n    toastr        = require('../ui').toastr,\n    request       = require('agent'),\n    getAjaxSuffix = require('../utils/get-ajax-suffix'),\n    parseAjaxURI  = require('../utils/get-ajax-url').parse,\n    getAjaxURL    = require('../utils/get-ajax-url').global,\n    Submit        = require('../fields/submit'),\n\n    flags         = require('../utils/flags-state'),\n    translate     = require('../utils/translate'),\n    Cards         = require('./cards');\n\nready(function() {\n    var body = $('body'),\n        warningURL = parseAjaxURI(getAjaxURL('confirmdeletion') + getAjaxSuffix());\n\n    // Handles Positions Duplicate / Remove\n    body.delegate('click', '#positions [data-g-config]', function(event, element) {\n        var mode = element.data('g-config'),\n            href = element.data('g-config-href'),\n            encode = window.btoa(href),//.substr(-20, 20), // in case the strings gets too long\n            method = (element.data('g-config-method') || 'post').toLowerCase();\n\n        if (event && event.preventDefault) { event.preventDefault(); }\n\n        if (mode == 'delete' && !flags.get('free:to:delete:' + encode, false)) {\n            // confirm before proceeding\n            flags.warning({\n                url: warningURL,\n                data: {page_type: 'POSITION'},\n                callback: function(response, content) {\n                    var confirm = content.find('[data-g-delete-confirm]'),\n                        cancel  = content.find('[data-g-delete-cancel]');\n\n                    if (!confirm) { return; }\n\n                    confirm.on('click', function(e) {\n                        e.preventDefault();\n                        if (this.attribute('disabled')) { return false; }\n\n                        flags.get('free:to:delete:' + encode, true);\n                        $([confirm, cancel]).attribute('disabled');\n                        body.emit('click', { target: element });\n\n                        modal.close();\n                    });\n\n                    cancel.on('click', function(e) {\n                        e.preventDefault();\n                        if (this.attribute('disabled')) { return false; }\n\n                        $([confirm, cancel]).attribute('disabled');\n                        flags.get('free:to:delete:' + encode, false);\n\n                        modal.close();\n                    });\n                }\n            });\n\n            return false;\n        }\n\n        element.hideIndicator();\n        element.showIndicator();\n\n        request(method, parseAjaxURI(href + getAjaxSuffix()), {}, function(error, response) {\n            if (!response.body.success) {\n                modal.open({\n                    content: response.body.html || response.body,\n                    afterOpen: function(container) {\n                        if (!response.body.html) { container.style({ width: '90%' }); }\n                    }\n                });\n            } else {\n                var positionDeleted = response.body.position,\n                    reload = $('[href=\"' + getAjaxURL('positions') + '\"]');\n\n                if (!reload) { window.location = window.location; }\n                else {\n                    body.emit('click', {target: reload});\n                }\n\n                toastr.success(response.body.html || 'Action successfully completed.', response.body.title || '');\n                if (positionDeleted) {\n                    body.positionDeleted = positionDeleted;\n                }\n            }\n\n            element.hideIndicator();\n        });\n\n    });\n\n    // Positions Add\n    body.delegate('click', '#positions .position-add', function(event, element) {\n        event.preventDefault();\n\n        var data = {};\n\n        modal.open({\n            content: translate('GANTRY5_PLATFORM_JS_LOADING'),\n            method: 'get',\n            overlayClickToClose: false,\n            remote: parseAjaxURI(element.attribute('href') + getAjaxSuffix()),\n            remoteLoaded: function(response, content) {\n                if (!response.body.success) {\n                    modal.enableCloseByOverlay();\n                    return;\n                }\n\n                var form       = content.elements.content.find('form'),\n                    fakeDOM    = zen('div').html(response.body.html).find('form'),\n                    submit     = content.elements.content.search('input[type=\"submit\"], button[type=\"submit\"], [data-apply-and-save]');\n\n                var search      = content.elements.content.find('.search input'),\n                    blocks      = content.elements.content.search('[data-mm-type]'),\n                    filters     = content.elements.content.search('[data-mm-filter]'),\n                    urlTemplate = content.elements.content.find('.g-urltemplate');\n\n                if (urlTemplate) { body.emit('input', { target: urlTemplate }); }\n\n                var editable = content.elements.content.find('[data-title-editable]');\n                if (editable) {\n                    editable.on('title-edit-end', function(title, original/*, canceled*/) {\n                        title = trim(title);\n                        if (!title) {\n                            title = trim(original) || 'Title';\n                            this.text(title).data('title-editable', title);\n\n                            return true;\n                        }\n                    });\n                }\n\n                if (search && filters && blocks) {\n                    search.on('input', function() {\n                        if (!this.value()) {\n                            blocks.removeClass('hidden');\n                            return;\n                        }\n\n                        blocks.addClass('hidden');\n\n                        var found = [], value = this.value().toLowerCase(), text;\n\n                        filters.forEach(function(filter) {\n                            filter = $(filter);\n                            text = trim(filter.data('mm-filter')).toLowerCase();\n                            if (text.match(new RegExp(\"^\" + value + '|\\\\s' + value, 'gi'))) {\n                                found.push(filter.matches('[data-mm-type]') ? filter : filter.parent('[data-mm-type]'));\n                            }\n                        }, this);\n\n                        if (found.length) { $(found).removeClass('hidden'); }\n                    });\n                }\n\n                if (search) {\n                    setTimeout(function() {\n                        search[0].focus();\n                    }, 5);\n                }\n\n                if ((!form && !fakeDOM) || !submit) { return true; }\n            }\n        });\n    });\n\n    // Positions Items settings\n    body.delegate('click', '#positions .item-settings', function(event, element) {\n        event.preventDefault();\n\n        var data = {},\n            parent = element.parent('[data-pm-data]'),\n            position = JSON.parse(element.parent('[data-position]').data('position'));\n\n        data.position = position.name;\n        data.item = parent.data('pm-data');\n\n        modal.open({\n            content: translate('GANTRY5_PLATFORM_JS_LOADING'),\n            method: 'post',\n            data: data,\n            overlayClickToClose: false,\n            remote: parseAjaxURI(getAjaxURL('positions/edit/' + parent.data('pm-blocktype')) + getAjaxSuffix()),\n            remoteLoaded: function(response, content) {\n                if (!response.body.success) {\n                    modal.enableCloseByOverlay();\n                    return;\n                }\n\n                var form       = content.elements.content.find('form'),\n                    fakeDOM    = zen('div').html(response.body.html).find('form'),\n                    submit     = content.elements.content.search('input[type=\"submit\"], button[type=\"submit\"], [data-apply-and-save]');\n\n                var editable = content.elements.content.find('[data-title-editable]');\n                if (editable) {\n                    editable.on('title-edit-end', function(title, original/*, canceled*/) {\n                        title = trim(title);\n                        if (!title) {\n                            title = trim(original) || 'Title';\n                            this.text(title).data('title-editable', title);\n\n                            return true;\n                        }\n                    });\n                }\n\n                if ((!form && !fakeDOM) || !submit) { return true; }\n\n                // Position Settings apply\n                submit.on('click', function(e) {\n                    e.preventDefault();\n\n                    var target = $(e.currentTarget);\n                    target.disabled(true);\n                    target.hideIndicator();\n                    target.showIndicator();\n\n                    var post = Submit(fakeDOM[0].elements, content.elements.content);\n\n                    if (post.invalid.length) {\n                        target.disabled(false);\n                        target.hideIndicator();\n                        target.showIndicator('fa fa-fw fa-exclamation-triangle');\n                        toastr.error(translate('GANTRY5_PLATFORM_JS_REVIEW_FIELDS'), translate('GANTRY5_PLATFORM_JS_INVALID_FIELDS'));\n                        return;\n                    }\n\n                    request(fakeDOM.attribute('method'), parseAjaxURI(fakeDOM.attribute('action') + getAjaxSuffix()), post.valid.join('&'), function(error, response) {\n                        if (!response.body.success) {\n                            modal.open({\n                                content: response.body.html || response.body,\n                                afterOpen: function(container) {\n                                    if (!response.body.html) { container.style({ width: '90%' }); }\n                                }\n                            });\n                        } else {\n                            var parent = element.parent('[data-pm-data]');\n\n                            if (parent) {\n                                parent.data('pm-data', JSON.stringify(response.body.item));\n\n                                var status = response.body.item.enabled || response.body.item.options.attributes.enabled;\n                                var dummy = zen('div').html(response.body.html);\n                                parent.html(dummy.firstChild().html());\n                                parent[status == '0' ? 'addClass' : 'removeClass']('g-menu-item-disabled');\n                            }\n\n                            // if it's apply and save we also save the panel\n                            if (target.data('apply-and-save') !== null) {\n                                var save = $('body').find('.button-save');\n                                if (save) { body.emit('click', { target: save }); }\n                            }\n\n                            Cards.serialize(element.parent('[data-position]'));\n\n                            modal.close();\n                            toastr.success(translate('GANTRY5_PLATFORM_JS_POSITIONS_SETTINGS_APPLIED'), translate('GANTRY5_PLATFORM_JS_SETTINGS_APPLIED'));\n                        }\n\n                        target.hideIndicator();\n                    });\n                });\n            }\n        });\n    });\n\n    // Handles Positions Titles Rename\n    var updateTitle = function(title, original, wasCanceled) {\n            this.style('text-overflow', 'ellipsis');\n            if (wasCanceled || title == original) { return; }\n            var element = this,\n                href = element.data('g-config-href'),\n                method = (element.data('g-config-method') || 'post').toLowerCase(),\n                parent = element.parent();\n\n            parent.showIndicator();\n            parent.find('[data-title-edit]').addClass('disabled');\n\n            request(method, parseAjaxURI(href + getAjaxSuffix()), { title: trim(title) }, function(error, response) {\n                if (!response.body.success) {\n                    modal.open({\n                        content: response.body.html || response.body,\n                        afterOpen: function(container) {\n                            if (!response.body.html) { container.style({ width: '90%' }); }\n                        }\n                    });\n\n                    element.data('title-editable', original).text(original);\n                } else {\n                    element.data('title', title).data('tip', title);\n\n                    // refresh ID label and actions buttons\n                    var dummy = zen('div').html(response.body.position),\n                        actions = dummy.find('.position-actions');\n\n                    element.parent('.card').find('h4 .position-key').html(response.body.id);\n                    element.parent('.card').find('.position-actions').html(actions.html());\n\n                    var position = element.parent('.card').find('[data-position]'),\n                        data = JSON.parse(position.data('position'));\n\n                    data.title = title;\n                    position.data('position', JSON.stringify(data));\n                }\n\n                parent.hideIndicator();\n                parent.find('[data-title-edit]').removeClass('disabled');\n            });\n        },\n\n        attachEditables = function(editables) {\n            if (!editables || !editables.length) { return; }\n            editables.forEach(function(editable) {\n                editable = $(editable);\n                editable.confWasAttached = true;\n                editable.on('title-edit-start', function(){\n                    editable.style('text-overflow', 'inherit');\n                });\n                editable.on('title-edit-end', updateTitle);\n            });\n        };\n\n    // Global state change\n    body.on('statechangeAfter', function(event, element) {\n        var editables = $('#positions [data-title-editable]');\n        if (!editables) { return true; }\n\n        editables = editables.filter(function(editable) {\n            return (typeof $(editable).confWasAttached) === 'undefined';\n        });\n\n        attachEditables(editables);\n    });\n\n    attachEditables($('#positions [data-title-editable]'));\n});\n\nmodule.exports = {};\n","\"use strict\";\nvar ready = require('elements/domready'),\n    $ = require('elements/attributes'),\n    modal = require('../ui').modal,\n    contains = require('mout/array/contains'),\n    forEach = require('mout/collection/forEach');\n\nrequire('../ui/popover');\n\nvar isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1,\n    FOCUSIN   = isFirefox ? 'focus' : 'focusin';\n\nready(function() {\n\n    var body = $('body');\n\n    body.delegate('click', '[data-g-styles]', function(event, element) {\n        var target = $(event.target);\n        if (event && event.preventDefault) { event.preventDefault(); }\n        if (target.hasClass('swatch-preview') || target.parent('.swatch-preview')) { return true; }\n\n        var data = JSON.parse(element.data('g-styles')), input, value, type, evt;\n        forEach(data, function(preset, name) {\n            input = $('[name=\"' + name + '\"]');\n            value = input ? input.value() : false;\n\n            if (!input || value === preset) { return; }\n\n            evt = {\n                target: input,\n                forceOverride: true\n            };\n\n            type = (input.tag() == 'select' || contains(['hidden', 'checkbox'], input.type())) ? 'change' : 'input';\n\n            input.value(preset);\n            body.emit(type, evt);\n            body.emit('keyup', evt);\n        });\n    });\n\n    body.delegate('click', '[data-g-styles] .swatch-preview', function(event, element) {\n        var image = element.parent('[data-g-styles]').find('img');\n        if (!image) { return false; }\n\n        modal.open({\n            content: image[0].outerHTML,\n            afterOpen: function(container) {\n                var padding = parseInt(container.compute('padding-left'), 10) + parseInt(container.compute('padding-right'), 10);\n                container.style({\n                    maxWidth: '80%',\n                    width: padding + (image[0].naturalWidth || image[0].width)\n                });\n            }\n        });\n    });\n\n});\n\nmodule.exports = {};\n","\"use strict\";\nvar ready  = require('elements/domready'),\n    trim   = require('mout/string/trim'),\n    forOwn = require('mout/object/forOwn'),\n    $      = require('elements');\n\nvar Cookie = {\n    write: function(name, value) {\n        var date = new Date();\n        date.setTime(date.getTime() + 3600 * 1000 * 24 * 365 * 10); // 10 years\n\n        var host   = window.location.host.toString(),\n            domain = host.substring(host.lastIndexOf(\".\", host.lastIndexOf(\".\") - 1) + 1);\n\n        if (host.match(/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)) { domain = host; }\n        var cookie = [name, '=', JSON.stringify(value), '; expires=', date.toGMTString(), '; domain=.', domain, '; path=/;'];\n\n        document.cookie = cookie.join('');\n    },\n\n    read: function(name) {\n        name = name.replace(/([-.*+?^${}()|[\\]\\/\\\\])/g, '\\\\$1');\n        var value = document.cookie.match('(?:^|;)\\\\s*' + name + '=([^;]*)');\n        return (value) ? JSON.parse(decodeURIComponent(value[1])) : null;\n    }\n};\n\nvar loadFromStorage = function() {\n    var storage    = Cookie.read('g5-collapsed') || {},\n        collapsers = $('[data-g-collapse]');\n    if (!collapsers) { return false; }\n\n    var item, data, handle, panel, card;\n    forOwn(storage, function(value, key) {\n        item = $('[data-g-collapse-id=\"' + key + '\"]');\n        if (!item) { return; }\n\n        data = JSON.parse(item.data('g-collapse'));\n        handle = data.handle ? item.find(data.handle) : item.find('.g-collapse');\n        panel = data.target ? item.find(data.target) : item;\n        card = item.parent('.card') || panel;\n        handle\n            .data('title', value ? data.expand : data.collapse)\n            .data('tip', value ? data.expand : data.collapse);\n\n        panel.attribute('style', null);\n        card[!value ? 'removeClass' : 'addClass']('g-collapsed');\n        item[!value ? 'removeClass' : 'addClass']('g-collapsed-main');\n    });\n};\n\nready(function() {\n    var body = $('body'), data, target, storage;\n\n    // single collapser\n    body.delegate('click', '[data-g-collapse]', function(event, element) {\n        element = event.element || element;\n\n        data = JSON.parse(element.data('g-collapse'));\n        target = $(event.target);\n        storage = ((data.store !== false) ? Cookie.read('g5-collapsed') : storage) || {};\n        if (!data.handle) { data.handle = element.find('.g-collapse'); }\n\n        if (!target.matches(data.handle) && !target.parent(data.handle)) { return false; }\n\n        if (storage[data.id] === undefined) {\n            storage[data.id] = data.collapsed;\n\n            if (data.store !== false) { Cookie.write('g5-collapsed', storage); }\n        }\n\n        var collapsed = storage[data.id],\n            panel     = data.target ? element.find(data.target) : element,\n            card      = panel.parent('.card') || panel;\n\n        if (card && card.hasClass('g-collapsed')) {\n            card.removeClass('g-collapsed');\n            element.removeClass('g-collapsed-main');\n            /* for animations\n             panel.style({\n             overflow: 'hidden',\n             height: 0\n             });*/\n        }\n\n        var slide = function(override) {\n            collapsed = typeof override != 'number' ? override : collapsed;\n            if (!collapsed) {\n                card.addClass('g-collapsed');\n                element.addClass('g-collapsed-main');\n                element.attribute('style', null);\n            }\n\n            data.handle\n                .data('title', !collapsed ? data.expand : data.collapse)\n                .data('tip', !collapsed ? data.expand : data.collapse);\n            storage[data.id] = !collapsed;\n            data.collapsed = !collapsed;\n\n            var refreshData = JSON.parse(element.data('g-collapse'));\n            refreshData.collapsed = !collapsed;\n            element.data('g-collapse', JSON.stringify(refreshData));\n\n            if (data.store !== false) {\n                Cookie.write('g5-collapsed', storage);\n            }\n        };\n\n        if (element.gFastCollapse) {\n            panel[collapsed ? 'removeClass' : 'addClass']('g-collapsed');\n            element[collapsed ? 'removeClass' : 'addClass']('g-collapsed-main');\n            slide(collapsed);\n        } else {\n            element.removeClass('g-collapsed-main');\n            // for animations\n            // panel.removeClass('g-collapsed')[collapsed ? 'slideDown' : 'slideUp'](slide);\n            panel.removeClass('g-collapsed')[collapsed ? 'removeClass' : 'addClass']('g-collapsed');\n            slide(collapsed);\n        }\n\n        element.gFastCollapse = false;\n    });\n\n    // global collapse togglers\n    body.delegate('click', '[data-g-collapse-all]', function(event, element) {\n        var mode          = element.data('g-collapse-all') == 'true',\n            parent        = element.parent('.g-filter-actions'),\n            container     = parent.nextSibling(),\n            collapsers    = container.search('[data-g-collapse]'),\n            CookieStorage = Cookie.read('g5-collapsed') || {},\n            panel, data, handle, card;\n\n        if (!collapsers) { return; }\n\n        collapsers.forEach(function(collapser) {\n            collapser = $(collapser);\n            card = collapser.parent('.card');\n            data = JSON.parse(collapser.data('g-collapse'));\n            handle = data.handle ? collapser.find(data.handle) : collapser.find('.g-collapse');\n            panel = data.target ? collapser.find(data.target) : collapser;\n\n            storage = ((data.store !== false) ? CookieStorage : storage) || {};\n\n            storage[data.id] = mode;\n            if (data.store !== false) {\n                Cookie.write('g5-collapsed', storage);\n            }\n\n            panel.attribute('style', null);\n            collapser[!mode ? 'removeClass' : 'addClass']('g-collapsed-main');\n            card[!mode ? 'removeClass' : 'addClass']('g-collapsed');\n        });\n    });\n\n    // filter by card title\n    body.delegate('input', '[data-g-collapse-filter]', function(event, element) {\n        var filter    = JSON.parse(element.data('g-collapse-filter') || '{}'),\n            parent    = element.parent('.g-filter-actions'),\n            container = parent.nextSibling(),\n            cards     = container.search(filter.element || '.card'),\n            value     = element.value();\n\n        if (!cards) { return; }\n\n        if (!value) { cards.attribute('style', null); }\n        cards.forEach(function(element, index) {\n            element = $(element);\n            var title   = trim(element.find(filter.title || 'h4 .g-title').text()),\n                matches = title.match(new RegExp(\"^\" + value + '|\\\\s' + value, 'gi'));\n\n            if (matches) { element.attribute('style', null); }\n            else { element.style('display', 'none'); }\n        });\n    });\n\n    // this is now handled from the twig files\n    // no need to run on domready\n    //loadFromStorage();\n});\n\nmodule.exports = loadFromStorage;\n","\"use strict\";\n\nvar prime      = require('prime'),\n    Emitter    = require('prime/emitter'),\n    Bound      = require('prime-util/prime/bound'),\n    Options    = require('prime-util/prime/options'),\n    bind       = require('mout/function/bind'),\n    contains   = require('mout/array/contains'),\n    DragEvents = require('./drag.events'),\n    $          = require('../utils/elements.utils');\n\n// $ utils\nrequire('elements/events');\nrequire('elements/delegation');\n\nvar isIE = (navigator.appName === \"Microsoft Internet Explorer\");\n\nvar DragDrop = new prime({\n\n    mixin: [Bound, Options],\n    inherits: Emitter,\n\n    options: {\n        delegate: null,\n        droppables: false,\n        catchClick: false\n    },\n\n    DRAG_EVENTS: DragEvents,\n\n    constructor: function(container, options) {\n        this.container = $(container);\n        if (!this.container) { return; }\n        this.setOptions(options);\n\n        this.element = null;\n        this.origin = {\n            x: 0,\n            y: 0,\n            transform: null,\n            offset: {\n                x: 0,\n                y: 0\n            }\n        };\n\n        this.matched = false;\n        this.lastMatched = false;\n        this.lastOvered = null;\n\n        this.attach();\n    },\n\n    attach: function() {\n        this.DRAG_EVENTS.EVENTS.START.forEach(bind(function(event) {\n            this.container.delegate(event, this.options.delegate, this.bound('start'));\n        }, this));\n    },\n\n    detach: function() {\n        this.DRAG_EVENTS.EVENTS.START.forEach(bind(function(event) {\n            this.container.undelegate(event, this.options.delegate, this.bound('start'));\n        }, this));\n    },\n\n    start: function(event, element) {\n        //if (event && event.type.match(/^touch/i)) { event.preventDefault(); }\n\n        clearTimeout(this.scrollInterval);\n        if (element.LMTooltip) { element.LMTooltip.remove(); }\n        $('html').attribute('style', 'height: 100% !important');\n        this.scrollHeight = document.body.scrollHeight;\n\n        // Prevents dragging a column from itself and limiting to its handle\n        var target = $(event.target);\n        if (!element.parent('[data-lm-root]') && element.hasClass('g-block') && (!target.matches('.submenu-reorder') && !target.parent('.submenu-reorder'))) { return true; }\n\n        if (event.which && event.which !== 1 || $(event.target).matches(this.options.exclude)) { return true; }\n        this.element = $(element);\n        this.original = this.element;\n        this.matched = false;\n        if (this.options.catchClick) { this.moved = false; }\n\n        // we force the menu column reorder handle to the g-block parent\n        if (target.matches('.submenu-reorder') || target.parent('.submenu-reorder')) {\n            this.element = target.parent('[data-mm-id]');\n        }\n\n        this.emit('dragdrop:beforestart', event, this.element);\n\n        // Stops default MS touch actions since preventDefault doesn't work\n        if (isIE) {\n            this.element.style({\n                '-ms-touch-action': 'none',\n                'touch-action': 'none'\n            });\n        }\n\n        // Stops text selection\n        event.preventDefault();\n\n        this.origin = {\n            x: event.changedTouches ? event.changedTouches[0].pageX : event.pageX,\n            y: event.changedTouches ? event.changedTouches[0].pageY : event.pageY,\n            transform: this.element.compute('transform')\n        };\n\n        var clientRect = this.element[0].getBoundingClientRect();\n        this.origin.offset = {\n            clientRect: clientRect,\n            scroll: {\n                x: window.scrollX,\n                y: window.scrollY\n            },\n            x: this.origin.x - clientRect.right,\n            y: clientRect.top - this.origin.y\n        };\n\n        // Only allow to sort grids when targeting the left handle\n        if (this.element.data('lm-blocktype') === 'grid' && Math.abs(this.origin.offset.x) < clientRect.width) {\n            return false;\n        }\n\n        var offset  = Math.abs(this.origin.offset.x),\n            columns = (this.element.parent().data('lm-blocktype') === 'grid' && this.element.parent().parent().data('lm-root')) ||\n                (this.element.parent().parent().data('lm-blocktype') == 'container' && (this.element.parent().parent().parent().data('lm-root') || this.element.parent().parent().parent().data('lm-blocktype') == 'wrapper'));\n\n        if (\n            this.element.data('lm-blocktype') == 'grid' &&\n            (this.element.parent().data('lm-blocktype') === 'container' && this.element.parent().parent().parent().data('lm-root')) ||\n            (this.element.parent().data('lm-blocktype') === 'section' && this.element.parent().parent().parent().data('lm-root'))\n        ) { columns = false; }\n\n        // Resizing and only if it's not a non-visible (atoms) section\n        if ((offset < 6 && this.element.parent().find(':last-child') !== this.element) || (columns && offset > 3 && offset < 10)) {\n            if (this.element.parent('[data-lm-blocktype=\"atoms\"]')) { return false; }\n\n            this.emit('dragdrop:resize', event, this.element, (this.element.parent('[data-mm-id]') || this.element).siblings(':not(.placeholder)'), this.origin.offset.x);\n            return false;\n        }\n\n        if (columns || (element.hasClass('submenu-column') && (!target.matches('.submenu-reorder') && !target.parent('.submenu-reorder')))) { return true; }\n\n        this.element.style({\n            'pointer-events': 'none',\n            zIndex: 100\n        });\n\n        this.DRAG_EVENTS.EVENTS.MOVE.forEach(bind(function(event) {\n            $('body').on(event, this.bound('move'));\n        }, this));\n\n        this.DRAG_EVENTS.EVENTS.STOP.forEach(bind(function(event) {\n            // Trackpads `tap` (mousedown + mouseup) happens too fast and the stop event\n            // won't get attached. We need to defer it to avoid issues\n\n            $('body').on(event, this.bound('deferStop'));\n        }, this));\n\n        this.emit('dragdrop:start', event, this.element);\n\n        return this.element;\n    },\n\n    deferStop: function(event) {\n        var self = this;\n        setTimeout(function() {\n            self.stop(event);\n        }, 0);\n    },\n\n    stop: function(event) {\n        //if (event && event.type.match(/^touch/i)) { event.preventDefault(); }\n\n        clearTimeout(this.scrollInterval);\n        $('html').attribute('style', null);\n        if (!this.moved && this.options.catchClick) {\n            // this is just a click\n            this.element.style({ transform: this.origin.transform || 'translate(0, 0)' });\n            this.emit('dragdrop:stop', event, this.matched, this.element);\n            this._removeStyleAttribute(this.element);\n            this.emit('dragdrop:stop:animation', this.element);\n            this.emit('dragdrop:click', event, this.element);\n\n            this.DRAG_EVENTS.EVENTS.MOVE.forEach(bind(function(event) {\n                $('body').off(event, this.bound('move'));\n            }, this));\n\n            this.DRAG_EVENTS.EVENTS.STOP.forEach(bind(function(event) {\n                $('body').off(event, this.bound('deferStop'));\n            }, this));\n\n            this.element = null;\n\n            return;\n        }\n\n        var settings = { duration: '250ms' };\n\n        if (this.removeElement) {\n            this.DRAG_EVENTS.EVENTS.MOVE.forEach(bind(function(event) {\n                $('body').off(event, this.bound('move'));\n            }, this));\n\n            this.DRAG_EVENTS.EVENTS.STOP.forEach(bind(function(event) {\n                $('body').off(event, this.bound('deferStop'));\n            }, this));\n\n            return this.emit('dragdrop:stop:erase', event, this.element);\n        }\n\n        if (this.element) {\n\n            this.emit('dragdrop:stop', event, this.matched, this.element);\n\n            if (this.matched) {\n                this.element.style({\n                    opacity: 0,\n                    transform: 'translate(0, 0)'\n                }).removeClass('active');\n            }\n\n            if (!this.matched) {\n\n                settings.callback = bind(function(element) {\n                    this._removeStyleAttribute(element);\n                    setTimeout(bind(function() {\n                        this.emit('dragdrop:stop:animation', element);\n                    }, this), 1);\n                }, this, this.element);\n\n                this.element.animate({\n                    transform: this.origin.transform || 'translate(0, 0)',\n                    opacity: 1\n                }, settings);\n            } else {\n\n                this.element.style({\n                    transform: this.origin.transform || 'translate(0, 0)',\n                    opacity: 1\n                });\n\n                this._removeStyleAttribute(this.element);\n                this.emit('dragdrop:stop:animation', this.element);\n            }\n        }\n\n        this.DRAG_EVENTS.EVENTS.MOVE.forEach(bind(function(event) {\n            $('body').off(event, this.bound('move'));\n        }, this));\n\n        this.DRAG_EVENTS.EVENTS.STOP.forEach(bind(function(event) {\n            $('body').off(event, this.bound('deferStop'));\n        }, this));\n\n        this.element = null;\n    },\n\n    move: function(event) {\n        //if (event && event.type.match(/^touch/i)) { event.preventDefault(); }\n\n        if (this.options.catchClick) {\n            var didItMove = {\n                x: event.changedTouches ? event.changedTouches[0].pageX : event.pageX,\n                y: event.changedTouches ? event.changedTouches[0].pageY : event.pageY\n            };\n\n            if (Math.abs(didItMove.x - this.origin.x) <= 3 && Math.abs(didItMove.y - this.origin.y) <= 3) {\n                return;\n            }\n\n            if (!this.moved) {\n                this.element.style({ opacity: 0.5 });\n                this.emit('dragdrop:move:once', this.element);\n            }\n\n            this.moved = true;\n        }\n\n        var clientX = event.clientX || (event.touches && event.touches[0].clientX) || 0,\n            clientY = event.clientY || (event.touches && event.touches[0].clientY) || 0,\n            overing = document.elementFromPoint(clientX, clientY),\n            isGrid  = this.element.data('lm-blocktype') === 'grid';\n\n\n        // Logic to auto-scroll on drag\n        var scrollHeight = this.scrollHeight,\n            Height       = document.body.clientHeight,\n            Scroll       = window.pageYOffset;\n\n        clearTimeout(this.scrollInterval);\n        if (!overing) { return; }\n\n        if (!$(overing).matches('#trash') && !$(overing).parent('#trash')) {\n            var st, sl, trash = $('#g5-container #trash');\n            if (clientY + 50 >= Height && Scroll + Height < scrollHeight) {\n                this.scrollInterval = setInterval(function() {\n                    sl = (window.pageXOffset || document.documentElement.scrollLeft) - (document.documentElement.clientLeft || 0);\n                    st = (window.pageYOffset || document.documentElement.scrollTop) - (document.documentElement.clientTop || 0);\n                    window.scrollTo(sl, Math.min(scrollHeight, st + 4));\n                }, 8);\n            } else if (clientY - 50 <= (trash ? trash[0].offsetHeight : 0) && scrollHeight > 0) {\n                this.scrollInterval = setInterval(function() {\n                    sl = (window.pageXOffset || document.documentElement.scrollLeft) - (document.documentElement.clientLeft || 0);\n                    st = (window.pageYOffset || document.documentElement.scrollTop) - (document.documentElement.clientTop || 0);\n                    window.scrollTo(sl, Math.max(0, st - 4));\n                }, 8);\n            }\n        }\n\n        // We tweak the overing to take into account the negative offset for the handle\n        if (isGrid) {\n            // More accurate is: clientX + (this.element[0].getBoundingClientRect().left - clientX)\n            overing = document.elementFromPoint(clientX + 30, clientY);\n        }\n\n        if (!overing) { return false; }\n\n        this.matched = $(overing).matches(this.options.droppables) ? overing : ($(overing).parent(this.options.droppables) || [false])[0];\n        this.isPlaceHolder = $(overing).matches('[data-lm-placeholder]') ? true : ($(overing).parent('[data-lm-placeholder]') ? true : false);\n\n        var deltaX    = this.lastX - clientX,\n            deltaY    = this.lastY - clientY,\n            direction = Math.abs(deltaX) > Math.abs(deltaY) && deltaX > 0 && 'left' ||\n                Math.abs(deltaX) > Math.abs(deltaY) && deltaX < 0 && 'right' ||\n                Math.abs(deltaY) > Math.abs(deltaX) && deltaY > 0 && 'up' ||\n                'down';\n\n\n        deltaX = (event.changedTouches ? event.changedTouches[0].pageX : event.pageX) - this.origin.x;\n        deltaY = (event.changedTouches ? event.changedTouches[0].pageY : event.pageY) - this.origin.y;\n\n        var isNew = this.element.parent('.particles-container');\n        if (isNew) {\n            deltaY += this.origin.offset.scroll.y - window.scrollY;\n        }\n\n        this.direction = direction;\n        this.element.style({ transform: 'translate(' + deltaX + 'px, ' + deltaY + 'px)' });\n\n        if (!this.isPlaceHolder) {\n            if (this.lastMatched && this.matched !== this.lastMatched) {\n                this.emit('dragdrop:leave', event, this.lastMatched, this.element);\n                this.lastMatched = false;\n            }\n\n            if (this.matched && this.matched !== this.lastMatched && overing !== this.lastOvered) {\n                this.emit('dragdrop:enter', event, this.matched, this.element);\n                this.lastMatched = this.matched;\n            }\n\n            if (this.matched && this.lastMatched) {\n                var rect = this.matched.getBoundingClientRect();\n                // Note: you can divide x axis by 3 rather than 2 for 4 directions\n                var location = {\n                    x: Math.abs((clientX - rect.left)) < (rect.width / 2) && 'before' ||\n                    Math.abs((clientX - rect.left)) >= (rect.width - (rect.width / 2)) && 'after' ||\n                    'other',\n                    y: Math.abs((clientY - rect.top)) < (rect.height / 2) && 'above' ||\n                    Math.abs((clientY - rect.top)) >= (rect.height / 2) && 'below' ||\n                    'other'\n                };\n\n                this.emit('dragdrop:location', event, location, this.matched, this.element);\n            } else {\n                this.emit('dragdrop:nolocation', event);\n            }\n        }\n\n        this.lastOvered = overing;\n        this.lastX = clientX;\n        this.lastY = clientY;\n\n        this.emit('dragdrop:move', event, this.element);\n    },\n\n    _removeStyleAttribute: function(element) {\n        element = $(element || this.element);\n        if (element.data('mm-id')) { return; }\n\n        element.attribute('style', null);//.style({flex: flex});\n    }\n\n});\n\nmodule.exports = DragDrop;\n","\"use strict\";\nvar getSupportedEvent = function(events) {\n    events = events.split(' ');\n\n    var element = document.createElement('div'), event;\n    var isSupported = false;\n\n    for (var i = events.length - 1; i >= 0; i--) {\n        event = 'on' + events[i];\n        isSupported = (event in element);\n\n        if (!isSupported) {\n            element.setAttribute(event, 'return;');\n            isSupported = typeof element[event] === 'function';\n        }\n\n        if (isSupported) {\n            isSupported = events[i];\n            break;\n        }\n    }\n\n    element = null;\n    return isSupported;\n};\n\nvar getSupportedEvents = function(events) {\n    events = events.split(' ');\n\n    var isSupported = false, supported = [];\n    for (var i = events.length - 1; i >= 0; i--) {\n        isSupported = getSupportedEvent(events[i]);\n        if (isSupported) { supported.push(isSupported); }\n    }\n\n    return supported;\n};\n\nvar EVENT = {\n        START: getSupportedEvent('mousedown touchstart MSPointerDown pointerdown'),\n        MOVE: getSupportedEvent('mousemove touchmove MSPointerMove pointermove'),\n        STOP: getSupportedEvent('mouseup touchend MSPointerUp pointerup')\n    },\n    EVENTS = {\n        START: getSupportedEvents('mousedown touchstart MSPointerDown pointerdown'),\n        MOVE: getSupportedEvents('mousemove touchmove MSPointerMove pointermove'),\n        STOP: getSupportedEvents('mouseup touchend MSPointerUp pointerup')\n    };\n\n\nmodule.exports = {\n    EVENT: EVENT,\n    EVENTS: EVENTS\n};\n","\"use strict\";\nvar prime     = require('prime'),\n    $         = require('../utils/elements.utils'),\n    Emitter   = require('prime/emitter'),\n    Bound     = require('prime-util/prime/bound'),\n    Options   = require('prime-util/prime/options');\n\n\nvar Eraser = new prime({\n    mixin: [Options, Bound],\n\n    inherits: Emitter,\n\n    constructor: function(element, options){\n        this.setOptions(options);\n\n        this.element = $(element);\n\n        if (!this.element) { return; }\n\n        this.hide(true);\n    },\n\n    setTop: function() {\n        if (typeof this.top !== 'undefined') { return; }\n        this.top = parseInt(this.element.compute('top'), 10);\n        this.left = $('#g5-container')[0].getBoundingClientRect().left;\n        if (GANTRY_PLATFORM == 'grav') {\n            this.left = 0;\n        }\n    },\n\n    show: function(fast){\n        if (!this.element) { return; }\n        this.setTop();\n        this.out();\n        this.element[fast ? 'style' : 'animate']({top: this.top, left: this.left}, {duration: '150ms'});\n    },\n\n    hide: function(fast){\n        if (!this.element) { return; }\n        this.setTop();\n        this.element.style('display', 'block');\n        var top = {top: -(this.element[0].offsetHeight)};\n        this.out();\n        this.element[fast ? 'style' : 'animate'](top, {duration: '150ms'});\n    },\n\n    over: function(){\n        this.element.find('.trash-zone').animate({transform: 'scale(1.2)'}, {duration: '150ms', equation: 'cubic-bezier(0.5,0,0.5,1)'});\n    },\n\n    out: function(){\n        this.element.find('.trash-zone').animate({transform: 'scale(1)'}, {duration: '150ms', equation: 'cubic-bezier(0.5,0,0.5,1)'});\n    }\n});\n\nmodule.exports = Eraser;\n","\"use strict\";\n\nvar Selectize = require('./selectize');\n\nmodule.exports = {\n    modal: require('./modal'),\n    togglers: require('./togglers'),\n    collapse: require('./collapse'),\n    selectize: Selectize,\n    toastr: require('./toastr')\n};\n","\"use strict\";\n// Based on Vex (https://github.com/hubspot/vex)\n\nvar prime    = require('prime'),\n    $        = require('../utils/elements.utils'),\n    zen      = require('elements/zen'),\n    storage  = require('prime/map')(),\n    Emitter  = require('prime/emitter'),\n    Bound    = require('prime-util/prime/bound'),\n    Options  = require('prime-util/prime/options'),\n    domready = require('elements/domready'),\n\n    bind     = require('mout/function/bind'),\n    map      = require('mout/array/map'),\n    forEach  = require('mout/array/forEach'),\n    last     = require('mout/array/last'),\n    merge    = require('mout/object/merge'),\n    trim     = require('mout/string/trim'),\n\n    request  = require('agent');\n\nvar animationEndSupport = false;\n\nvar Modal = new prime({\n    mixin: [Bound, Options],\n\n    inherits: Emitter,\n\n    animationEndEvent: ['animationend', 'webkitAnimationEnd', 'mozAnimationEnd', 'MSAnimationEnd', 'oanimationend'],\n\n    globalID: 1,\n\n    options: {\n        baseClassNames: {\n            container: 'g5-dialog',\n            content: 'g5-content',\n            overlay: 'g5-overlay',\n            close: 'g5-close',\n            closing: 'g5-closing',\n            open: 'g5-dialog-open'\n        },\n\n        content: '',\n        remote: '',\n        showCloseButton: true,\n        escapeToClose: true,\n        overlayClickToClose: true,\n        appendNode: '#g5-container',\n        className: 'g5-dialog-theme-default',\n        css: {},\n        overlayClassName: '',\n        overlayCSS: '',\n        contentClassName: '',\n        contentCSS: '',\n        closeClassName: 'g5-dialog-close',\n        closeCSS: '',\n\n        afterOpen: null,\n        afterClose: null\n    },\n\n    constructor: function(options) {\n        this.setOptions(options);\n        this.defaults = this.options;\n\n        var self = this;\n        domready(function() {\n            $(window).on('keydown', function(event) {\n                if (event.keyCode === 27) {\n                    return self.closeByEscape();\n                }\n            });\n\n            self.animationEndEvent = animationEndSupport;\n        });\n\n        this\n            .on('dialogOpen', function(options) {\n                $('body').addClass(options.baseClassNames.open);\n                $('html').addClass(options.baseClassNames.open);\n            })\n            .on('dialogAfterClose', bind(function(options) {\n                var all = this.getAll();\n                if (!all || !all.length) {\n                    $('body').removeClass(options.baseClassNames.open);\n                    $('html').removeClass(options.baseClassNames.open);\n                }\n            }, this));\n    },\n\n    storage: function() {\n        return storage;\n    },\n\n    open: function(options) {\n        options = merge(this.options, options);\n        options.id = this.globalID++;\n\n        var elements = {};\n\n        // container\n        elements.container = zen('div')\n            .addClass(options.baseClassNames.container)\n            .addClass(options.className)\n            .style(options.css)\n            .attribute('tabindex', '0')\n            .attribute('role', 'dialog')\n            .attribute('aria-hidden', 'true')\n            .attribute('aria-labelledby', 'g-modal-labelledby')\n            .attribute('aria-describedby', 'g-modal-describedby');\n\n        storage.set(elements.container, { dialog: options });\n\n        // overlay\n        elements.overlay = zen('div')\n            .addClass(options.baseClassNames.overlay)\n            .addClass(options.overlayClassName)\n            .style(options.overlayCSS);\n\n        storage.set(elements.overlay, { dialog: options });\n\n        if (options.overlayClickToClose) {\n            elements.container.on('click', bind(this._overlayClick, this, elements.container[0]));\n            elements.overlay.on('click', bind(this._overlayClick, this, elements.overlay[0]));\n        }\n\n        elements.container.appendChild(elements.overlay);\n\n        // content\n        elements.content = zen('div')\n            .addClass(options.baseClassNames.content)\n            .addClass(options.contentClassName)\n            .style(options.contentCSS)\n            .attribute('aria-live', 'assertive')\n            .attribute('tabindex', '0')\n            .html(options.content);\n\n        storage.set(elements.content, { dialog: options });\n        elements.container.appendChild(elements.content);\n\n        if (options.overlayClickToClose) {\n            elements.content.on('click', function(/*e*/){\n                return true;\n            });\n        }\n\n        // remote\n        if (options.remote && options.remote.length > 1) {\n            this.showLoading();\n\n            options.method = options.method || 'get';\n            var agent = request();\n            agent.method(options.method);\n            agent.url(options.remote);\n            if (options.data) { agent.data(options.data); }\n\n            agent.send(bind(function(error, response) {\n                if (elements.container.hasClass(options.baseClassNames.closing)) {\n                    this.hideLoading();\n                    return;\n                }\n\n                elements.content.html(response.body.html || response.body);\n\n                if (!response.body.success) {\n                    if (!response.body.html) { elements.content.style({ width: '90%' }); }\n                }\n\n                this.hideLoading();\n                if (options.remoteLoaded && !elements.container.hasClass(options.baseClassNames.closing)) {\n                    options.remoteLoaded(response, options);\n                }\n\n                elements.container.attribute('aria-hidden', 'false');\n                setTimeout(function(){ elements.content[0].focus(); }, 0);\n\n                var selects = $('[data-selectize]');\n                if (selects) { selects.selectize(); }\n            }, this));\n        } else {\n            elements.container.attribute('aria-hidden', 'false');\n            setTimeout(function(){ elements.content[0].focus(); }, 0);\n        }\n\n        // close button\n        if (options.showCloseButton) {\n            elements.closeButton = zen('div')\n                .addClass(options.baseClassNames.close)\n                .addClass(options.closeClassName)\n                .attribute('role', 'button').attribute('aria-label', 'Close')\n                .style(options.closeCSS);\n\n            storage.set(elements.closeButton, { dialog: options });\n            elements.content.appendChild(elements.closeButton);\n        }\n\n        // delegate container to pick g5-close clicks\n        elements.container.delegate('click', '.g5-dialog-close', bind(function(event){\n            event.preventDefault();\n            this._closeButtonClick(elements.container);\n        }, this));\n\n        // inject the dialog in the DOM\n        var container = $(options.appendNode);\n\n        // wordpress workaround for out-of-scope cases\n        if (GANTRY_PLATFORM == 'wordpress') {\n            container = $('#customize-preview') || $('#widgets-right') || $(options.appendNode);\n            if ('#' + container.id() != options.appendNode) {\n                var wpwrap = $('#wpwrap') || $('.wp-customizer'), sibling, workaround;\n                if (wpwrap.id() == 'wpwrap') {\n                    sibling = wpwrap.nextSibling(options.appendNode);\n                    workaround =  sibling ? sibling : zen('div.g5wp-out-of-scope' + options.appendNode).after(wpwrap);\n                } else {\n                    sibling = wpwrap.find('> ' + options.appendNode);\n                    workaround =  sibling ? sibling : zen('div.g5wp-out-of-scope' + options.appendNode).top(wpwrap);\n                }\n                container = workaround;\n            }\n        }\n\n        container.appendChild(elements.container);\n\n        options.elements = elements;\n\n        if (options.afterOpen) {\n            options.afterOpen(elements.content, options);\n        }\n\n        setTimeout(bind(function() {\n            return this.emit('dialogOpen', options);\n        }, this), 0);\n\n        return elements.content;\n    },\n\n    getAll: function() {\n        var options = this.options;\n        return $(\".\" + options.baseClassNames.container + \":not(.\" + options.baseClassNames.closing + \") .\" + options.baseClassNames.content);\n    },\n\n    getByID: function(id) {\n        var all = this.getAll();\n        if (!all) { return []; }\n\n        return $(all.filter(function(element) {\n            element = $(element);\n            return storage.get(element).dialog.id === id;\n        }));\n    },\n\n    getLast: function() {\n        var ids, id;\n\n        ids = map(this.getAll(), function(element) {\n            element = $(element);\n\n            return storage.get(element).dialog.id;\n        });\n\n        if (!ids.length) {\n            return false;\n        }\n\n        return Math.max.apply(Math, ids);\n    },\n\n    close: function(id) {\n        if (!id) {\n            var element = $(last(this.getAll()));\n            if (!element) {\n                return false;\n            }\n\n            id = storage.get(element).dialog.id;\n        }\n\n        return this.closeByID(id);\n    },\n\n    closeAll: function() {\n        var ids;\n\n        ids = map(this.getAll(), function(element) {\n            element = $(element);\n\n            return storage.get(element).dialog.id;\n        });\n\n        if (!ids.length) {\n            return false;\n        }\n\n        forEach(ids.reverse(), function(id) {\n            return this.closeByID(id);\n        }, this);\n\n        return true;\n    },\n\n    closeByID: function(id) {\n        var content = this.getByID(id);\n        if (!content || !content.length) {\n            return false;\n        }\n\n        var container, options;\n\n        container = storage.get(content).dialog.elements.container;\n        options = merge({}, storage.get(content).dialog);\n\n        var beforeClose = function() {\n                if (options.beforeClose) {\n                    return options.beforeClose(content, options);\n                }\n            },\n            close = bind(function() {\n                if (options.remoteLoaded) { options.remoteLoaded = function(){}; }\n                content.emit('dialogClose', options);\n                container.remove();\n                this.emit('dialogAfterClose', options);\n                if (options.afterClose) {\n                    return options.afterClose(content, options);\n                }\n\n            }, this);\n\n        if (animationEndSupport) {\n            beforeClose();\n            container.off(this.animationEndEvent).on(this.animationEndEvent, function() {\n                return close();\n            }).addClass(options.baseClassNames.closing);\n        } else {\n            beforeClose();\n            close();\n        }\n\n        return true;\n    },\n\n    closeByEscape: function() {\n        var id = this.getLast();\n\n        if (id === false) {\n            return false;\n        }\n\n        var element = this.getByID(id);\n\n        if (!storage.get(element).dialog.escapeToClose) {\n            return false;\n        }\n\n        return this.closeByID(id);\n\n    },\n\n    enableCloseByOverlay: function() {\n        var id = this.getLast();\n\n        if (id === false) {\n            return false;\n        }\n\n        var elements = storage.get(this.getByID(id)).dialog.elements;\n\n        elements.container.on('click', bind(this._overlayClick, this, elements.container[0]));\n        elements.overlay.on('click', bind(this._overlayClick, this, elements.overlay[0]));\n\n        elements.content.on('click', function(/*e*/){\n            return true;\n        });\n    },\n\n    showLoading: function() {\n        this.hideLoading();\n        return $('#g5-container').appendChild(zen('div.g5-dialog-loading-spinner.' + this.options.className));\n    },\n\n    hideLoading: function() {\n        var spinner = $('.g5-dialog-loading-spinner');\n        return spinner ? spinner.remove() : false;\n    },\n\n    // private\n    _overlayClick: function(element, event) {\n        if (event.target !== element) {\n            return;\n        }\n\n        return this.close(storage.get($(element)).dialog.id);\n    },\n\n    _closeButtonClick: function(element) {\n        return this.close(storage.get($(element)).dialog.id);\n    }\n});\n\ndomready(function() {\n    var style = (document.body || document.documentElement).style;\n\n    forEach(['animation', 'WebkitAnimation', 'MozAnimation', 'MsAnimation', 'OAnimation'], function(animation, index) {\n        if (animationEndSupport) {\n            return;\n        }\n        animationEndSupport = style[animation] !== undefined ? Modal.prototype.animationEndEvent[index] : false;\n    });\n});\n\nvar modal = new Modal();\n\nmodule.exports = modal;\n","\"use strict\";\n\nvar prime    = require('prime'),\n    $        = require('../utils/elements.utils'),\n    zen      = require('elements/zen'),\n    storage  = require('prime/map')(),\n    Emitter  = require('prime/emitter'),\n    Bound    = require('prime-util/prime/bound'),\n    Options  = require('prime-util/prime/options'),\n    domready = require('elements/domready'),\n\n    bind     = require('mout/function/bind'),\n    map      = require('mout/array/map'),\n    forEach  = require('mout/array/forEach'),\n    last     = require('mout/array/last'),\n    merge    = require('mout/object/merge'),\n    isFunct  = require('mout/lang/isFunction'),\n\n    request  = require('agent');\n\nvar Popover = new prime({\n    mixin: [Bound, Options],\n\n    inherits: Emitter,\n\n    options: {\n        mainClass: 'g5-popover',\n        placement: 'auto',\n        width: 'auto',\n        height: 'auto',\n        trigger: 'click',\n        style: '',\n        delay: 300,\n        cache: true,\n        multi: false,\n        arrow: true,\n        title: '',\n        content: '',\n        closeable: false,\n        padding: true,\n        targetEvents: true,\n        allowElementsClick: false,\n        url: '',\n        type: 'html',\n        where: '#g5-container',\n        template: '<div class=\"g5-popover\">' +\n        '<div class=\"g-arrow\"></div>' +\n        '<div class=\"g5-popover-inner\">' +\n        '<a href=\"#\" class=\"close\">x</a>' +\n        '<h3 class=\"g5-popover-title\"></h3>' +\n        '<div class=\"g5-popover-content\"><i class=\"icon-refresh\"></i> <p>&nbsp;</p></div>' +\n        '</div>' +\n        '</div>'\n    },\n\n    constructor: function(element, options) {\n        this.setOptions(options);\n        this.element = $(element);\n\n        if (this.options.trigger === 'click') {\n            this.element.off('click', this.bound('toggle')).on('click', this.bound('toggle'));\n        } else {\n            this.element.off('mouseenter', this.bound('mouseenterHandler')).off('mouseleave', this.bound('mouseleaveHandler'))\n                .on('mouseenter', this.bound('mouseenterHandler'))\n                .on('mouseleave', this.bound('mouseleaveHandler'));\n        }\n\n        this._poped = false;\n        //this._inited = true;\n    },\n\n    destroy: function() {\n        this.hide();\n        storage.set(this.element[0], null);\n        this.element.off('click', this.bound('toggle')).off('mouseenter', this.bound('mouseenterHandler')).off('mouseleave', this.bound('mouseleaveHandler'));\n\n        if (this.$target) {\n            this.$target.remove();\n        }\n    },\n\n    hide: function(event) {\n        if (event) {\n            event.preventDefault();\n            event.stopPropagation();\n        }\n        //var e = $.Event('hide.' + pluginType);\n        this.element.emit('hide.popover', this);\n        if (this.$target) {\n            this.$target.removeClass('in').style({ display: 'none' });\n            this.$target.remove();\n        }\n        this.element.emit('hidden.popover', this);\n\n        if (this._focusAttached) {\n            $('body').off('focus', this.bound('focus'), true);\n            this._focusAttached = false;\n            this.restoreFocus();\n        }\n    },\n\n    toggle: function(e) {\n        if (e) {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        this[this.getTarget().hasClass('in') ? 'hide' : 'show']();\n    },\n\n    focus: function(e) {\n        if (!this.getTarget().hasClass('in')) { return; }\n        var self = this,\n            target = $(e.target || e);\n\n        if (\n            this.$target[0] === target[0] || target.parent(this.$target) ||\n            this.element[0] === target[0] || target.parent(this.element)\n        ) { return; }\n\n        this.hide();\n        if (this._focusAttached) this.restoreFocus();\n    },\n\n    restoreFocus: function(element) {\n        element = $(element || this.element);\n        var tag = element.tag();\n\n        setTimeout(function(){\n            if (tag != 'a' && tag != 'input' && tag != 'button') {\n                var items = element.find('a, button, input');\n                if (items) items[0].focus();\n            } else {\n                element[0].focus();\n            }\n        }, 0);\n    },\n\n    hideAll: function(force) {\n        var css = '';\n        if (force) { css = 'div.' + this.options.mainClass; }\n        else { css = 'div.' + this.options.mainClass + ':not(.' + this.options.mainClass + '-fixed)'; }\n\n        var elements = $(css);\n        if (!elements) { return this; }\n        elements.removeClass('in').style({ display: 'none' }).attribute('tabindex', '-1');\n        if (!force && this._focusAttached) this.restoreFocus();\n\n        if (this._focusAttached) {\n            $('body').off('focus', this.bound('focus'), true);\n            this._focusAttached = false;\n        }\n        return this;\n    },\n\n    show: function() {\n        var target = this.getTarget().attribute('class', null).addClass(this.options.mainClass).attribute('tabindex', '0');\n\n        if (!this.options.multi) {\n            this.hideAll();\n        }\n\n        // use cache by default, if not cache setted  , reInit the contents\n        this.element.emit('beforeshow.popover', this);\n        if (!this.options.cache || !this._poped) {\n            this.setTitle(this.getTitle());\n\n            if (!this.options.closeable) {\n                target.find('.close').off('click').remove();\n            }\n\n            if (!this.isAsync()) {\n                this.setContent(this.getContent());\n            } else {\n                this.setContentASync(this.options.content);\n                this.displayContent();\n                return;\n            }\n\n            target.style({ display: 'block' });\n        }\n\n        this.displayContent();\n        this.bindBodyEvents();\n\n        setTimeout(function(){\n            target[0].focus();\n        }, 0);\n\n        if (!this._focusAttached) {\n            $('body').on('focus', this.bound('focus'), true);\n            this._focusAttached = true;\n        }\n    },\n\n    displayContent: function() {\n        var elementPos = this.element.position(),\n            target = this.getTarget().attribute('class', null).addClass(this.options.mainClass),\n            targetContent = this.getContentElement(),\n            targetWidth, targetHeight, placement;\n\n        this.element.emit('show.popover', this);\n\n        if (this.options.width !== 'auto') {\n            target.style({ width: this.options.width });\n        }\n        if (this.options.height !== 'auto') {\n            targetContent.style({ height: this.options.height });\n        }\n\n        // init the popover and insert into the document body\n        if (!this.options.arrow && target.find('.g-arrow')) {\n            target.find('.g-arrow').remove();\n        }\n\n        var container = $(this.options.where);\n\n        // wordpress workaround for out-of-scope cases\n        if (GANTRY_PLATFORM == 'wordpress') {\n            container = $('#customize-preview') || $('#widgets-right') || $(this.options.where);\n            if ('#' + container.id() != this.options.where) {\n                var wpwrap = $('#wpwrap') || $('.wp-customizer'), sibling, workaround;\n                if (wpwrap.id() == 'wpwrap') {\n                    sibling = wpwrap.nextSibling(this.options.where);\n                    workaround =  sibling ? sibling : zen('div.g5wp-out-of-scope' + this.options.where).after(wpwrap);\n                } else {\n                    sibling = wpwrap.find('> ' + this.options.where);\n                    workaround =  sibling ? sibling : zen('div.g5wp-out-of-scope' + this.options.where).top(wpwrap);\n                }\n                container = workaround;\n            }\n        }\n\n        target.remove().style({\n            top: -1000,\n            left: -1000,\n            display: 'block'\n        }).bottom(container);\n\n        if (this.options.style) {\n            if (typeof this.options.style === 'string') {\n                this.options.style = this.options.style.split(',').map(Function.prototype.call, String.prototype.trim);\n            }\n\n            this.options.style.forEach(function(style) {\n                this.$target.addClass(this.options.mainClass + '-' + style);\n            }, this);\n        }\n\n        if (!this.options.padding) {\n            targetContent.css('height', targetContent.position().height);\n            this.$target.addClass('g5-popover-no-padding');\n        }\n\n        targetWidth = target[0].offsetWidth;\n        targetHeight = target[0].offsetHeight;\n        placement = this.getPlacement(elementPos, targetHeight);\n        if (this.options.targetEvents) { this.initTargetEvents(); }\n        var positionInfo = this.getTargetPosition(elementPos, placement, targetWidth, targetHeight);\n        this.$target.style(positionInfo.position).addClass(placement).addClass('in');\n\n        if (this.options.type === 'iframe') {\n            var iframe = target.find('iframe');\n            iframe.style({\n                width: target.position().width,\n                height: iframe.parent().position.height\n            });\n        }\n\n        if (!this.options.arrow) {\n            this.$target.style({ 'margin': 0 });\n        }\n        if (this.options.arrow) {\n            var arrow = this.$target.find('.g-arrow');\n            arrow.attribute('style', null);\n            if (positionInfo.arrowOffset) {\n                arrow.style(positionInfo.arrowOffset);\n            }\n        }\n\n        this._poped = true;\n        this.element[0].focus();\n        this.element.emit('shown.popover', this);\n\n    },\n\n\n    /*getter setters */\n    getTarget: function() {\n        if (!this.$target) {\n            this.$target = $(zen('div').html(this.options.template).children()[0]);\n        }\n        return this.$target;\n    },\n\n    getTitleElement: function() {\n        return this.getTarget().find('.' + this.options.mainClass + '-title');\n    },\n\n    getContentElement: function() {\n        return this.getTarget().find('.' + this.options.mainClass + '-content');\n    },\n\n    getTitle: function() {\n        return this.options.title || this.element.data('g5-popover-title') || this.element.attribute('title');\n    },\n\n    setTitle: function(title) {\n        var element = this.getTitleElement();\n        if (title) {\n            element.html(title);\n        }\n        else {\n            element.remove();\n        }\n    },\n\n    hasContent: function() {\n        return this.getContent();\n    },\n\n    getContent: function() {\n        if (this.options.url) {\n            if (this.options.type === 'iframe') {\n                this.content = $('<iframe frameborder=\"0\"></iframe>').attribute('src', this.options.url);\n            }\n        } else if (!this.content) {\n            var content = '';\n            if (isFunct(this.options.content)) {\n                content = this.options.content.apply(this.element[0], arguments);\n            } else {\n                content = this.options.content;\n            }\n            this.content = this.element.data('g5-popover-content') || content;\n        }\n        return this.content;\n    },\n\n    setContent: function(content) {\n        var target = this.getTarget();\n        this.getContentElement().html(content);\n        this.$target = target;\n    },\n\n    isAsync: function() {\n        return this.options.type === 'async';\n    },\n\n    setContentASync: function(content) {\n        request('get', this.options.url, bind(function(error, response) {\n            if (content && isFunct(content)) {\n                this.content = content.apply(this.element[0], [response]);\n            } else {\n                this.content = response.body.html;\n            }\n\n            this.setContent(this.content);\n\n            var target = this.getContentElement();\n            target.attribute('style', null);\n\n            setTimeout(bind(function(){\n                target.parent('.' + this.options.mainClass)[0].focus();\n            }, this), 0);\n\n            this.displayContent();\n            this.bindBodyEvents();\n\n            var selects = $('[data-selectize]');\n            if (selects) { selects.selectize(); }\n        }, this));\n    },\n\n    bindBodyEvents: function() {\n        var body = $('body');\n        body.off('keyup', this.bound('escapeHandler')).on('keyup', this.bound('escapeHandler'));\n        body.off('click', this.bound('bodyClickHandler')).on('click', this.bound('bodyClickHandler'));\n    },\n\n\n    /* event handlers */\n    mouseenterHandler: function() {\n        if (this._timeout) {\n            clearTimeout(this._timeout);\n        }\n        if (!(this.getTarget()[0].offsetWidth > 0 || this.getTarget()[0].offsetHeight > 0)) {\n            this.show();\n        }\n    },\n    mouseleaveHandler: function() {\n        // key point, set the _timeout  then use clearTimeout when mouse leave\n        this._timeout = setTimeout(bind(function() {\n            this.hide();\n        }, this), this.options.delay);\n    },\n\n    escapeHandler: function(e) {\n        if (e.keyCode === 27) {\n            this.hideAll();\n        }\n    },\n\n    bodyClickHandler: function() {\n        this.hideAll();\n    },\n\n    targetClickHandler: function(e) {\n        var target = $(e.target);\n        if (target.matches(this.options.allowElementsClick)) { e.preventDefault(); }\n        if (!target.parent('[data-g-popover-follow]') && target.data('g-popover-follow') === null) { e.stopPropagation(); }\n    },\n\n    initTargetEvents: function() {\n        if (this.options.trigger !== 'click') {\n            this.$target\n                .off('mouseenter', this.bound('mouseenter'))\n                .off('mouseleave', this.bound('mouseleave'))\n                .on('mouseenter', this.bound('mouseenterHandler'))\n                .on('mouseleave', this.bound('mouseleaveHandler'));\n        }\n\n        var close = this.$target.find('.close');\n        if (close) {\n            close.off('click', this.bound('hide')).on('click', this.bound('hide'));\n        }\n\n        this.$target.off('click', this.bound('targetClickHandler')).on('click', this.bound('targetClickHandler'));\n    },\n\n    /* utils methods */\n    getPlacement: function(pos, targetHeight) {\n        var\n            placement,\n            de = document.documentElement,\n            db = document.body,\n            clientWidth = de.clientWidth,\n            clientHeight = de.clientHeight,\n            scrollTop = Math.max(db.scrollTop, de.scrollTop),\n            scrollLeft = Math.max(db.scrollLeft, de.scrollLeft),\n            pageX = Math.max(0, pos.left - scrollLeft),\n            pageY = Math.max(0, pos.top - scrollTop),\n            arrowSize = 20;\n\n        // if placement equals autocaculate the placement by element information;\n        if (typeof(this.options.placement) === 'function') {\n            placement = this.options.placement.call(this, this.getTarget()[0], this.element[0]);\n        } else {\n            placement = this.element.data('g5-popover-placement') || this.options.placement;\n        }\n\n        if (placement === 'auto') {\n            if (pageX < clientWidth / 3) {\n                if (pageY < clientHeight / 3) {\n                    placement = 'bottom-right';\n                } else if (pageY < clientHeight * 2 / 3) {\n                    placement = 'right';\n                } else {\n                    placement = 'top-right';\n                }\n                //placement= pageY>targetHeight+arrowSize?'top-right':'bottom-right';\n            } else if (pageX < clientWidth * 2 / 3) {\n                if (pageY < clientHeight / 3) {\n                    placement = 'bottom';\n                } else if (pageY < clientHeight * 2 / 3) {\n                    placement = 'bottom';\n                } else {\n                    placement = 'top';\n                }\n            } else {\n                placement = pageY > targetHeight + arrowSize ? 'top-left' : 'bottom-left';\n                if (pageY < clientHeight / 3) {\n                    placement = 'bottom-left';\n                } else if (pageY < clientHeight * 2 / 3) {\n                    placement = 'left';\n                } else {\n                    placement = 'top-left';\n                }\n            }\n        }\n        return placement;\n    },\n\n    getTargetPosition: function(elementPos, placement, targetWidth, targetHeight) {\n        var pos = elementPos,\n            elementW = this.element[0].offsetWidth,\n            elementH = this.element[0].offsetHeight,\n            position = {},\n            arrowOffset = null,\n            arrowSize = this.options.arrow ? 28 : 0,\n            fixedW = elementW < arrowSize + 10 ? arrowSize : 0,\n            fixedH = elementH < arrowSize + 10 ? arrowSize : 0;\n\n        switch (placement) {\n            case 'bottom':\n                position = {\n                    top: pos.top + pos.height,\n                    left: pos.left + pos.width / 2 - targetWidth / 2\n                };\n                break;\n            case 'top':\n                position = {\n                    top: pos.top - targetHeight,\n                    left: pos.left + pos.width / 2 - targetWidth / 2\n                };\n                break;\n            case 'left':\n                position = {\n                    top: pos.top + pos.height / 2 - targetHeight / 2,\n                    left: pos.left - targetWidth\n                };\n                break;\n            case 'right':\n                position = {\n                    top: pos.top + pos.height / 2 - targetHeight / 2,\n                    left: pos.left + pos.width\n                };\n                break;\n            case 'top-right':\n                position = {\n                    top: pos.top - targetHeight,\n                    left: pos.left - fixedW\n                };\n                arrowOffset = { left: elementW / 2 + fixedW };\n                break;\n            case 'top-left':\n                position = {\n                    top: pos.top - targetHeight,\n                    left: pos.left - targetWidth + pos.width + fixedW\n                };\n                arrowOffset = { left: targetWidth - elementW / 2 - fixedW };\n                break;\n            case 'bottom-right':\n                position = {\n                    top: pos.top + pos.height,\n                    left: pos.left - fixedW\n                };\n                arrowOffset = { left: elementW / 2 + fixedW };\n                break;\n            case 'bottom-left':\n                position = {\n                    top: pos.top + pos.height,\n                    left: pos.left - targetWidth + pos.width + fixedW\n                };\n                arrowOffset = { left: targetWidth - elementW / 2 - fixedW };\n                break;\n            case 'right-top':\n                position = {\n                    top: pos.top - targetHeight + pos.height + fixedH,\n                    left: pos.left + pos.width\n                };\n                arrowOffset = { top: targetHeight - elementH / 2 - fixedH };\n                break;\n            case 'right-bottom':\n                position = {\n                    top: pos.top - fixedH,\n                    left: pos.left + pos.width\n                };\n                arrowOffset = { top: elementH / 2 + fixedH };\n                break;\n            case 'left-top':\n                position = {\n                    top: pos.top - targetHeight + pos.height + fixedH,\n                    left: pos.left - targetWidth\n                };\n                arrowOffset = { top: targetHeight - elementH / 2 - fixedH };\n                break;\n            case 'left-bottom':\n                position = {\n                    top: pos.top,\n                    left: pos.left - targetWidth\n                };\n                arrowOffset = { top: elementH / 2 };\n                break;\n\n        }\n\n        return {\n            position: position,\n            arrowOffset: arrowOffset\n        };\n    }\n\n});\n\n$.implement({\n    getPopover: function(options) {\n        var popover = storage.get(this);\n\n        if (!popover && options !== 'destroy') {\n            options = options || {};\n            popover = new Popover(this, options);\n            storage.set(this, popover);\n            this.PopoverDefined = true;\n        }\n\n        return popover;\n    },\n\n    popover: function(options) {\n        return this.forEach(function(element) {\n            var popover = storage.get(element);\n\n            if (!popover && options !== 'destroy') {\n                options = options || {};\n                popover = new Popover(element, options);\n                storage.set(element, popover);\n            }\n        });\n    },\n\n    position: function() {\n        var node = this[0],\n            ct = $('#g5-container')[0].getBoundingClientRect(),\n            box = {\n                left: 0,\n                right: 0,\n                top: 0,\n                bottom: 0\n            };\n\n        if (typeof node.getBoundingClientRect !== \"undefined\") {\n            box = node.getBoundingClientRect();\n        }\n\n        return {\n            x: box.left - ct.left,\n            left: box.left - ct.left,\n            y: box.top - ct.top,\n            top: box.top - ct.top,\n            right: box.right - ct.right,\n            bottom: box.bottom - ct.bottom,\n            width: box.right - box.left,\n            height: box.bottom - box.top\n        };\n    }\n});\n\nmodule.exports = $;\n","\"use strict\";\n\nvar $        = require('elements'),\n    prime    = require('prime'),\n    Emitter  = require('prime/emitter'),\n    Bound    = require('prime-util/prime/bound'),\n    Options  = require('prime-util/prime/options'),\n    zen      = require('elements/zen'),\n    moofx    = require('moofx'),\n\n    bind     = require('mout/function/bind'),\n    isArray  = require('mout/lang/isArray'),\n    isNumber = require('mout/lang/isNumber');\n\nvar Progresser = new prime({\n\n    mixin: [Bound, Options],\n\n    inherits: Emitter,\n\n    options: {\n        value: 0.0,\n        size: 50.0,\n        startAngle: -Math.PI / 2,\n        thickness: 'auto',\n        fill: { // { color: 'hex|rgba' } || { gradient: [from, to], gradientAngle: Math.PI / 4, gradientDirection: [x0, y0, x1, y1] }\n            gradient: ['#9e38eb', '#4e68fc']//['#3aeabb', '#fdd250']\n        },\n        emptyFill: 'rgba(0, 0, 0, .1)',\n        animation: {\n            duration: 1200,\n            equation: 'cubic-bezier(0.645, 0.045, 0.355, 1)'\n        },\n        animationStartValue: 0.0,\n        reverse: false,\n        lineCap: 'butt', // butt, round, square\n        insertElement: null,\n        insertLocation: 'before'\n    },\n\n    constructor: function(element, options) {\n        this.setOptions(options);\n\n        this.element = this.element || $(element);\n        this.canvas = this.canvas || zen('canvas')[this.options.insertLocation || 'before'](this.options.insertElement || this.element)[0];\n        this.radius = this.options.size / 2;\n        this.arcFill = null;\n        this.lastFrameValue = 0.0;\n\n        this.canvas.width = this.options.size;\n        this.canvas.height = this.options.size;\n        this.ctx = this.canvas.getContext('2d');\n\n        this.initFill();\n        this.draw();\n    },\n\n    initFill: function() {\n        var fill = this.options.fill,\n            size = this.options.size,\n            ctx  = this.ctx;\n\n        if (!fill) { throw Error('The fill is not specified.'); }\n\n        if (fill.color) {\n            this.arcFill = fill.color;\n        }\n\n        if (fill.gradient) {\n            var gr = fill.gradient;\n\n            if (gr.length == 1) { this.arcFill = gr[0]; }\n            else {\n                var ga = fill.gradientAngle || 0,  // gradient direction angle; 0 by default\n                    gd = fill.gradientDirection || [\n                            size / 2 * (1 - Math.cos(ga)), // x0\n                            size / 2 * (1 + Math.sin(ga)), // y0\n                            size / 2 * (1 + Math.cos(ga)), // x1\n                            size / 2 * (1 - Math.sin(ga))  // y1\n                        ],\n                    lg = ctx.createLinearGradient.apply(ctx, gd);\n\n                for (var i = 0; i < gr.length; i++) {\n                    var color = gr[i],\n                        pos   = i / (gr.length - 1);\n\n                    if (isArray(color)) {\n                        pos = color[1];\n                        color = color[0];\n                    }\n\n                    lg.addColorStop(pos, color);\n                }\n\n                this.arcFill = lg;\n            }\n        }\n    },\n\n    draw: function() {\n        this[this.options.animation ? 'drawAnimated' : 'drawFrame'](this.options.value);\n    },\n\n    drawFrame: function(v) {\n        this.lastFrameValue = v;\n        this.ctx.clearRect(0, 0, this.options.size, this.options.size);\n        this.drawEmptyArc(v);\n        this.drawArc(v);\n    },\n\n    drawArc: function(v) {\n        var ctx = this.ctx,\n            r   = this.radius,\n            t   = this.getThickness(),\n            a   = this.options.startAngle;\n\n        ctx.save();\n        ctx.beginPath();\n\n        if (!this.options.reverse) {\n            ctx.arc(r, r, r - t / 2, a, a + Math.PI * 2 * v);\n        } else {\n            ctx.arc(r, r, r - t / 2, a - Math.PI * 2 * v, a);\n        }\n\n        ctx.lineWidth = t;\n        ctx.lineCap = this.options.lineCap;\n        ctx.strokeStyle = this.arcFill;\n        ctx.stroke();\n        ctx.restore();\n    },\n\n    drawEmptyArc: function(v) {\n        var ctx = this.ctx,\n            r   = this.radius,\n            t   = this.getThickness(),\n            a   = this.options.startAngle;\n\n        if (v < 1) {\n            ctx.save();\n            ctx.beginPath();\n\n            if (v <= 0) {\n                ctx.arc(r, r, r - t / 2, 0, Math.PI * 2);\n            } else {\n                if (!this.reverse) {\n                    ctx.arc(r, r, r - t / 2, a + Math.PI * 2 * v, a);\n                } else {\n                    ctx.arc(r, r, r - t / 2, a, a - Math.PI * 2 * v);\n                }\n            }\n\n            ctx.lineWidth = t;\n            ctx.strokeStyle = this.options.emptyFill;\n            ctx.stroke();\n            ctx.restore();\n        }\n    },\n\n    drawAnimated: function(v) {\n        this.element.emit('progress-animation-start');\n\n        moofx(bind(function(now) {\n            var stepValue = this.options.animationStartValue * (1 - now) + v * now;\n            this.drawFrame(stepValue);\n            this.element.emit('progress-animation-change', now, stepValue);\n        }, this), {\n            duration: this.options.animation.duration || '1200',\n            equation: this.options.animation.equation || 'linear',\n            callback: bind(function() {\n                if (this.options.animation.callback) { this.options.animation.callback(); }\n                this.element.emit('progress-animation-end');\n            }, this)\n        }).start(0, 1);\n    },\n\n    getThickness: function() {\n        return isNumber(this.options.thickness) ? this.options.thickness : this.options.size / 14;\n    }\n});\n\nmodule.exports = Progresser;\n","\"use strict\";\n// selectize (v0.12.1) (commit: 4dae761)\n\nvar prime      = require('prime'),\n    ready      = require('elements/domready'),\n    zen        = require('elements/zen'),\n\n    sifter     = require('sifter'),\n\n    Emitter    = require('prime/emitter'),\n    Bound      = require('prime-util/prime/bound'),\n    Options    = require('prime-util/prime/options'),\n\n    $          = require('../utils/elements.utils'),\n    moofx      = require('moofx'),\n\n    bind       = require('mout/function/bind'),\n    forEach    = require('mout/collection/forEach'),\n    indexOf    = require('mout/array/indexOf'),\n    last       = require('mout/array/last'),\n    debounce   = require('mout/function/debounce'),\n    isArray    = require('mout/lang/isArray'),\n    isBoolean  = require('mout/lang/isBoolean'),\n    merge      = require('mout/object/merge'),\n    unset      = require('mout/object/unset'),\n    size       = require('mout/object/size'),\n    values     = require('mout/object/values'),\n    escapeHTML = require('mout/string/escapeHtml'),\n    trim       = require('mout/string/trim'),\n    slugify    = require('mout/string/slugify');\n\n\nvar IS_MAC                = /Mac/.test(navigator.userAgent),\n    IS_IE                 = /MSIE 9/i.test(navigator.userAgent) || /MSIE 10/i.test(navigator.userAgent) || /rv:11.0/i.test(navigator.userAgent),\n    COUNT                 = 0,\n\n    KEY_A                 = 65,\n    KEY_COMMA             = 188,\n    KEY_RETURN            = 13,\n    KEY_ESC               = 27,\n    KEY_LEFT              = 37,\n    KEY_UP                = 38,\n    KEY_P                 = 80,\n    KEY_RIGHT             = 39,\n    KEY_DOWN              = 40,\n    KEY_N                 = 78,\n    KEY_BACKSPACE         = 8,\n    KEY_DELETE            = 46,\n    KEY_SHIFT             = 16,\n    KEY_CMD               = IS_MAC ? 91 : 17,\n    KEY_CTRL              = IS_MAC ? 18 : 17,\n    KEY_TAB               = 9,\n\n    TAG_SELECT            = 1,\n    TAG_INPUT             = 2,\n\n    // for now, android support in general is too spotty to support validity\n    SUPPORTS_VALIDITY_API = !/android/i.test(window.navigator.userAgent) && !!document.createElement('form').validity;\n\nvar hash_key = function(value) {\n    if (typeof value === 'undefined' || value === null) return null;\n    if (typeof value === 'boolean') return value ? '1' : '0';\n    return value + '';\n};\n\nvar isset = function(object) {\n    return typeof object !== 'undefined';\n};\n\nvar escape_replace = function(str) {\n    return (str + '').replace(/\\$/g, '$$$$');\n};\n\nvar once = function(fn) {\n    var called = false;\n    return function() {\n        if (called) return;\n        called = true;\n        fn.apply(this, arguments);\n    };\n};\n\nvar debounce_events = function(self, types, fn) {\n    var type;\n    var trigger = self.emit;\n    var event_args = {};\n\n    // override trigger method\n    self.emit = function() {\n        var type = arguments[0];\n        if (types.indexOf(type) !== -1) {\n            event_args[type] = arguments;\n        } else {\n            return trigger.apply(self, arguments);\n        }\n    };\n\n    // invoke provided function\n    fn.apply(self, []);\n    self.emit = trigger;\n\n    // trigger queued events\n    for (type in event_args) {\n        if (event_args.hasOwnProperty(type)) {\n            trigger.apply(self, event_args[type]);\n        }\n    }\n};\n\nvar build_hash_table = function(key, objects) {\n    if (!isArray(objects)) return objects;\n    var i, n, table = {};\n    for (i = 0, n = objects.length; i < n; i++) {\n        if (objects[i].hasOwnProperty(key)) {\n            table[objects[i][key]] = objects[i];\n        }\n    }\n    return table;\n};\n\nvar domToString = function(d) {\n    var tmp = document.createElement('div');\n    tmp.appendChild(d.cloneNode(true));\n    return tmp.innerHTML;\n};\n\nvar getSelection = function(input) {\n    var result = {};\n    if ('selectionStart' in input) {\n        result.start = input.selectionStart;\n        result.length = input.selectionEnd - result.start;\n    } else if (document.selection) {\n        input.focus();\n        var sel = document.selection.createRange();\n        var selLen = document.selection.createRange().text.length;\n        sel.moveStart('character', -input.value.length);\n        result.start = sel.text.length - selLen;\n        result.length = selLen;\n    }\n    return result;\n};\n\nvar transferStyles = function($from, $to, properties) {\n    var i, n, styles = {};\n    if (properties) {\n        for (i = 0, n = properties.length; i < n; i++) {\n            styles[properties[i]] = $from.compute(properties[i]);\n        }\n    } else {\n        styles = $from.compute();\n    }\n    $to.style(styles);\n};\n\nvar measured = null;\nvar measureString = function(str, $parent) {\n    if (!str) {\n        return 0;\n    }\n\n    var $test;\n    if (!measured) {\n        $test = zen('test').style({\n            position: 'absolute',\n            top: -99999,\n            left: -99999,\n            width: 'auto',\n            padding: 0,\n            whiteSpace: 'pre'\n        }).text(str).bottom('body');\n\n        transferStyles($parent, $test, [\n            'letterSpacing',\n            'fontSize',\n            'fontFamily',\n            'fontWeight',\n            'textTransform'\n        ]);\n\n        measured = $test;\n    } else {\n        $test = measured;\n        $test.text(str);\n    }\n\n    //var width = $test[0].offsetWidth;\n    //$test.remove();\n\n    return $test[0].offsetWidth;\n};\n\nvar highlight = function($element, pattern) {\n    if (typeof pattern === 'string' && !pattern.length) return;\n    var regex = (typeof pattern === 'string') ? new RegExp(pattern, 'i') : pattern;\n\n    var highlight = function(node) {\n        var skip = 0;\n        if (node.nodeType === 3) {\n            var pos = node.data.search(regex);\n            if (pos >= 0 && node.data.length > 0) {\n                var match = node.data.match(regex);\n                var spannode = document.createElement('span');\n                spannode.className = 'g-highlight';\n                var middlebit = node.splitText(pos);\n                var endbit = middlebit.splitText(match[0].length);\n                var middleclone = middlebit.cloneNode(true);\n                spannode.appendChild(middleclone);\n                middlebit.parentNode.replaceChild(spannode, middlebit);\n                skip = 1;\n            }\n        } else if (node.nodeType === 1 && node.childNodes && !/(script|style)/i.test(node.tagName)) {\n            for (var i = 0; i < node.childNodes.length; ++i) {\n                i += highlight(node.childNodes[i]);\n            }\n        }\n        return skip;\n    };\n\n    return forEach($element, function(el) {\n        highlight(el);\n    });\n};\n\nvar autoGrow = function(input) {\n    input = $(input);\n    var currentWidth = null;\n\n    var update = function(options, e) {\n        var value, keyCode, printable, placeholder, width;\n        var shift, character, selection;\n        e = e || window.event || {};\n        options = options || {};\n\n        if (e.metaKey || e.altKey) return;\n        if (!options.force && input.selectizeGrow === false) return;\n\n        value = input.value();\n        if (e.type && e.type.toLowerCase() === 'keydown') {\n            keyCode = e.keyCode;\n            printable = (\n                (keyCode >= 97 && keyCode <= 122) || // a-z\n                (keyCode >= 65 && keyCode <= 90) || // A-Z\n                (keyCode >= 48 && keyCode <= 57) || // 0-9\n                keyCode === 32 // space\n            );\n\n            if (keyCode === KEY_DELETE || keyCode === KEY_BACKSPACE) {\n                selection = getSelection(input[0]);\n                if (selection.length) {\n                    value = value.substring(0, selection.start) + value.substring(selection.start + selection.length);\n                } else if (keyCode === KEY_BACKSPACE && selection.start) {\n                    value = value.substring(0, selection.start - 1) + value.substring(selection.start + 1);\n                } else if (keyCode === KEY_DELETE && typeof selection.start !== 'undefined') {\n                    value = value.substring(0, selection.start) + value.substring(selection.start + 1);\n                }\n            } else if (printable) {\n                shift = e.shiftKey;\n                character = String.fromCharCode(e.keyCode);\n                if (shift) character = character.toUpperCase();\n                else character = character.toLowerCase();\n                value += character;\n            }\n        }\n\n        placeholder = input.attribute('placeholder');\n        if (!value && placeholder) {\n            value = placeholder;\n        }\n\n        width = measureString(value, input) + 4;\n        if (width !== currentWidth) {\n            currentWidth = width;\n            input[0].style.width = width + 'px';\n            input.emit('resize');\n        }\n    };\n\n    input.on('keydown', update);\n    input.on('keyup', update);\n    input.on('update', update);\n    input.on('blur', update);\n\n    update();\n};\n\nvar Selectize = new prime({\n\n    mixin: [Bound, Options],\n\n    inherits: Emitter,\n\n    options: {\n        delimiter: ' ',\n        splitOn: null, // regexp or string for splitting up values from a paste command\n        persist: true,\n        diacritics: true,\n        create: false,\n        createOnBlur: true,\n        createFilter: null,\n        highlight: true,\n        openOnFocus: true,\n        maxOptions: 1000,\n        maxItems: null,\n        hideSelected: null,\n        addPrecedence: false,\n        selectOnTab: false,\n        preload: false,\n        allowEmptyOption: false,\n        closeAfterSelect: false,\n        searchOnKeypress: true,\n\n        scrollDuration: 60,\n        loadThrottle: 300,\n        loadingClass: 'g-loading',\n\n        dataAttr: 'data-data',\n        optgroupField: 'optgroup',\n        valueField: 'value',\n        labelField: 'text',\n        optgroupLabelField: 'label',\n        optgroupValueField: 'value',\n        lockOptgroupOrder: false,\n\n        sortField: '$order',\n        searchField: ['text'],\n        searchConjunction: 'and',\n\n        mode: null,\n        wrapperClass: 'g-selectize-control',\n        inputClass: 'g-selectize-input',\n        dropdownClass: 'g-selectize-dropdown',\n        dropdownContentClass: 'g-selectize-dropdown-content',\n\n        dropdownParent: null,\n\n        copyClassesToDropdown: true,\n\n        /*\n         load            : null, // function(query, callback) { ... }\n         score           : null, // function(search) { ... }\n         onInitialize    : null, // function() { ... }\n         onChange        : null, // function(value) { ... }\n         onItemAdd       : null, // function(value, $item) { ... }\n         onItemRemove    : null, // function(value) { ... }\n         onClear         : null, // function() { ... }\n         onOptionAdd     : null, // function(value, data) { ... }\n         onOptionRemove  : null, // function(value) { ... }\n         onOptionClear   : null, // function() { ... }\n         onOptionGroupAdd     : null, // function(id, data) { ... }\n         onOptionGroupRemove  : null, // function(id) { ... }\n         onOptionGroupClear   : null, // function() { ... }\n         onDropdownOpen  : null, // function($dropdown) { ... }\n         onDropdownClose : null, // function($dropdown) { ... }\n         onType          : null, // function(str) { ... }\n         onDelete        : null, // function(values) { ... }\n         */\n\n        render: {\n            /*\n             item: null,\n             optgroup: null,\n             optgroup_header: null,\n             option: null,\n             option_create: null\n             */\n        }\n    },\n\n    constructor: function(input, options) {\n        input = $(input);\n        this.setOptions(options);\n\n        // detect rtl environment\n        var computedStyle = window.getComputedStyle && window.getComputedStyle(input[0], null);\n        var dir = computedStyle ? computedStyle.getPropertyValue('direction') : input[0].currentStyle && input[0].currentStyle.direction;\n        dir = dir || input.parents('[dir]:first').attr('dir') || '';\n\n        this.rand = 'selectize-id-' + (Math.random() + 1).toString(36).substring(5);\n        this.input = input;\n        this.input.selectizeInstance = this;\n\n        this.order = 0;\n        this.tabIndex = input.attribute('tabindex') || '';\n        this.tagType = input.tag() == 'select' ? TAG_SELECT : TAG_INPUT;\n        this.rtl = /rtl/i.test(dir);\n        this.highlightedValue = null;\n        this.isRequired = input.attribute('required');\n        forEach(['isOpen', 'isDisabled',  'isInvalid', 'isLocked', 'isFocused', 'isInputHidden', 'isSetup', 'isShiftDown', 'isCmdDown', 'isCtrlDown', 'ignoreFocus', 'ignoreBlur', 'ignoreHover', 'hasOptions'], function(option) {\n            this[option] = false;\n        }, this);\n        this.currentResults = null;\n        this.lastValue = '';\n        this.caretPos = 0;\n        this.loading = 0;\n        this.loadedSearches = {};\n\n        this.$activeOption = null;\n        this.$activeItems = [];\n\n        this.Optgroups = {};\n        this.Options = {};\n        this.UserOptions = {};\n        this.items = [];\n        this.renderCache = {};\n        this.onSearchChange = this.options.loadThrottle === null ? this.onSearchChange : debounce(this.onSearchChange, this.options.loadThrottle);\n\n        // search system\n        this.sifter = new sifter(this.Options, { diacritics: this.options.diacritics });\n\n        var i, n;\n\n        // build options table\n        if (this.options.Options) {\n            for (i = 0, n = this.options.Options.length; i < n; i++) {\n                this.registerOption(this.options.Options[i]);\n            }\n            delete this.options.Options;\n        }\n\n        // build optgroup table\n        if (this.options.Optgroups) {\n            for (i = 0, n = this.options.Optgroups.length; i < n; i++) {\n                this.registerOptionGroup(this.options.Optgroups[i]);\n            }\n            delete this.options.Optgroups;\n        }\n\n        // option-demand defaults\n        this.options.mode = this.options.mode || (this.options.maxItems === 1 ? 'single' : 'multi');\n        if (!isBoolean(this.options.hideSelected)) { this.options.hideSelected = (this.options.mode === 'multi'); }\n\n        this.setupCallbacks();\n        this.setupTemplates();\n        this.setup();\n\n    },\n\n    setup: function() {\n        var $input = this.input,\n            $wrapper,\n            $control,\n            $control_input,\n            $dropdown,\n            $dropdown_content,\n            $dropdown_parent,\n            inputMode,\n            timeout_blur,\n            timeout_focus,\n            classes;\n\n        inputMode = this.options.mode;\n        classes = $input.attribute('class') || '';\n\n        $wrapper = zen('div').addClass(this.options.wrapperClass).addClass(classes).addClass('g-' + inputMode).after(this.input);\n        $control = zen('div').addClass(this.options.inputClass).addClass('g-items').bottom($wrapper);\n        $control_input = zen('input[type=\"text\"][autocomplete=\"off\"][role=\"textbox\"]').bottom($control).attribute('tabindex', $input.disabled() ? '-1' : this.tabIndex);\n        $dropdown_parent = $(this.options.dropdownParent || $wrapper);\n        $dropdown = zen('div').addClass(this.options.dropdownClass).addClass('g-' + inputMode).hide().bottom($dropdown_parent);\n        $dropdown_content = zen('div[id=\"' + this.rand + '\"]').addClass(this.options.dropdownContentClass).bottom($dropdown);\n\n        if (this.options.copyClassesToDropdown) {\n            $dropdown.addClass(classes);\n        }\n\n        if (inputMode == 'single') {\n            $wrapper.style('width', parseInt($input[0].offsetWidth) + 12 + 24); // padding compensation\n        }\n\n        if ((this.options.maxItems === null || this.options.maxItems > 1) && this.tagType === TAG_SELECT) {\n            $input.attribute('multiple', 'multiple');\n        }\n\n        if (this.options.placeholder) {\n            $control_input.attribute('placeholder', this.options.placeholder);\n        }\n\n        // if splitOn was not passed in, construct it from the delimiter to allow pasting universally\n        if (!this.options.splitOn && this.options.delimiter) {\n            var delimiterEscaped = this.options.delimiter.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n            this.options.splitOn = new RegExp('\\\\s*' + delimiterEscaped + '+\\\\s*');\n        }\n\n        if ($input.attribute('autocorrect')) {\n            $control_input.attribute('autocorrect', $input.attribute('autocorrect'));\n        }\n\n        if ($input.attribute('autocapitalize')) {\n            $control_input.attribute('autocapitalize', $input.attribute('autocapitalize'));\n        }\n\n        this.$wrapper = $wrapper;\n        this.$control = $control;\n        this.$control_input = $control_input;\n        this.$dropdown = $dropdown;\n        this.$dropdown_content = $dropdown_content;\n\n        $dropdown.delegate('mouseover', '[data-selectable]', bind(function() { return this.onOptionHover.apply(this, arguments); }, this));\n        $dropdown.delegate('mousedown', '[data-selectable]', bind(function() { return this.onOptionSelect.apply(this, arguments); }, this));\n        $dropdown.delegate('click', '[data-selectable]', bind(function() { return this.onOptionSelect.apply(this, arguments); }, this));\n\n        autoGrow($control_input);\n\n        $control.delegate('mousedown', '*:not(input)', bind(function(event, element) {\n            if (element == $control) { return true; }\n            return this.onItemSelect.apply(this, arguments);\n        }, this));\n\n        $control.on('mousedown', bind(function() { return this.onMouseDown.apply(this, arguments); }, this));\n        $control.on('click', bind(function() { return this.onClick.apply(this, arguments); }, this));\n        $control.delegate('click', '.g-remove-single-item', bind(function() { return this.onItemRemoveViaX.apply(this, arguments); }, this));\n\n        $control_input.on('mousedown', function(e) { e.stopPropagation(); });\n        $control_input.on('keydown', bind(function() { return this.onKeyDown.apply(this, arguments); }, this));\n        $control_input.on('keyup', bind(function() { return this.onKeyUp.apply(this, arguments); }, this));\n        $control_input.on('keypress', bind(function() { return this.onKeyPress.apply(this, arguments); }, this));\n        $control_input.on('resize', bind(function() { this.positionDropdown.apply(this, []); }, this));\n        $control_input.on('blur', bind(function() { return this.onBlur.apply(this, arguments); }, this));\n        $control_input.on('focus', bind(function() {\n            this.ignoreBlur = false;\n            return this.onFocus.apply(this, arguments);\n        }, this));\n        $control_input.on('paste', bind(function() { return this.onPaste.apply(this, arguments); }, this));\n\n        $(document).on('keydown', bind(function(e) {\n            this.isCmdDown = e[IS_MAC ? 'metaKey' : 'ctrlKey'];\n            this.isCtrlDown = e[IS_MAC ? 'altKey' : 'ctrlKey'];\n            this.isShiftDown = e.shiftKey;\n        }, this));\n\n        $(document).on('keyup', bind(function(e) {\n            if (e.keyCode === KEY_CTRL) this.isCtrlDown = false;\n            if (e.keyCode === KEY_SHIFT) this.isShiftDown = false;\n            if (e.keyCode === KEY_CMD) this.isCmdDown = false;\n        }, this));\n\n        $(document).on('mousedown', bind(function(e) {\n            if (this.isFocused) {\n                // prevent events on the dropdown scrollbar from causing the control to blur\n                if (e.target === this.$dropdown[0] || e.target.parentNode === this.$dropdown[0]) {\n                    e.preventDefault();\n                    return false;\n                }\n                // blur on click outside\n                if (!this.$control.find($(e.target)) && e.target !== this.$control[0]) {\n                    this.blur(e.target);\n                }\n            }\n        }, this));\n\n        $(window).on('scroll', bind(function() {\n            if (this.isOpen) {\n                this.positionDropdown.apply(this, arguments);\n            }\n        }, this));\n        $(window).on('resize', bind(function() {\n            if (this.isOpen) {\n                this.positionDropdown.apply(this, arguments);\n            }\n        }, this));\n        $(window).on('mousemove', bind(function() {\n            this.ignoreHover = false;\n        }, this));\n\n        // store original children and tab index so that they can be\n        // restored when the destroy() method is called.\n        this.revertSettings = {\n            $children: this.input.children(),//.detach(),\n            tabindex: this.input.attribute('tabindex')\n        };\n\n        this.input.attribute('tabindex', -1).attribute('aria-hidden', true).hide().after($wrapper);\n\n        if (isArray(this.options.items)) {\n            this.setValue(this.options.items);\n            delete this.options.items;\n        }\n\n        // feature detect for the validation API\n        if (SUPPORTS_VALIDITY_API) {\n            this.input.on('invalid', bind(function(e) {\n                e.preventDefault();\n                this.isInvalid = true;\n                this.refreshState();\n            }, this));\n        }\n\n        this.updateOriginalInput();\n        this.refreshItems();\n        this.refreshState();\n        this.updatePlaceholder();\n        this.isSetup = true;\n\n        if (this.input.disabled()) {\n            this.disable();\n        }\n\n        this.on('change', this.onChange);\n\n        this.input.selectizeInstance = this;\n        this.input.addClass('selectized');\n        this.emit('initialize');\n\n        // preload options\n        if (this.options.preload === true) {\n            this.onSearchChange('');\n        }\n        // ARIA\n        $wrapper\n            .attribute('role', 'combobox')\n            .attribute('aria-autocomplete', 'list')\n            .attribute('aria-haspopup', true)\n            .attribute('aria-expanded', false)\n            .attribute('aria-labelledby', this.rand + '-' + slugify(this.getValue()));\n\n        $dropdown_content\n            .attribute('role', 'tree')\n            .attribute('aria-expanded', false)\n            .attribute('aria-hidden', true);\n\n\n    },\n\n    setupTemplates: function() {\n        var field_label    = this.options.labelField,\n            field_value    = this.options.valueField,\n            field_optgroup = this.options.optgroupLabelField,\n            mode           = this.options.mode;\n\n        var templates = {\n            'optgroup': function(data) {\n                return '<div class=\"g-optgroup\">' + data.html + '</div>';\n            },\n            'optgroup_header': function(data, escape) {\n                return '<div class=\"g-optgroup-header\">' + escape(data[field_optgroup]) + '</div>';\n            },\n            'option': function(data, escape) {\n                var label = '<div class=\"g-option\">' + escape(data[field_label]) + '</div>';\n                if (this.options.Subtitles) {\n                    label = '<div class=\"g-option\"><span>' + escape(data[field_label]) + '</span> <div class=\"g-option-subtitle\"><small>' + escape(data[field_value]) + '</small></div></div>';\n                }\n                return label;\n            },\n            'item': function(data, escape) {\n                var removeButton = '',\n                    title = escape(data[field_value]);\n\n                if (mode !== 'single') {\n                    removeButton = '<span  class=\"g-remove-single-item\" tabindex=\"-1\" title=\"Remove\">&times;</span></div>';\n                }\n\n                if (this.options.Subtitles) {\n                    title = 'class name: ' + title;\n                }\n\n                return '<div class=\"g-item\" title=\"' + title + '\">' + escape(data[field_label]) + removeButton;\n            },\n            'option_create': function(data, escape) {\n                return '<div class=\"g-create\">Add <strong>' + escape(data.input) + '</strong>&hellip;</div>';\n            }\n        };\n\n        this.options.render = merge({}, templates, this.options.render);\n    },\n\n    setupCallbacks: function() {\n        var key, fn, callbacks = {\n            'initialize': 'onInitialize',\n            'change': 'onChange',\n            'item_add': 'onItemAdd',\n            'item_remove': 'onItemRemove',\n            'clear': 'onClear',\n            'option_add': 'onOptionAdd',\n            'option_remove': 'onOptionRemove',\n            'option_clear': 'onOptionClear',\n            'optgroup_add': 'onOptionGroupAdd',\n            'optgroup_remove': 'onOptionGroupRemove',\n            'optgroup_clear': 'onOptionGroupClear',\n            'dropdown_open': 'onDropdownOpen',\n            'dropdown_close': 'onDropdownClose',\n            'type': 'onType',\n            'load': 'onLoad',\n            'focus': 'onFocus',\n            'blur': 'onBlur'\n        };\n\n        for (key in callbacks) {\n            if (callbacks.hasOwnProperty(key)) {\n                fn = this.options[callbacks[key]];\n                if (fn) { this.on(key, fn); }\n            }\n        }\n    },\n\n\n\n    onClick: function(e) {\n        // necessary for mobile webkit devices (manual focus triggering\n        // is ignored unless invoked within a click event)\n        if (!this.isFocused) {\n            this.focus();\n            e.preventDefault();\n        }\n    },\n\n    onMouseDown: function(e) {\n        var defaultPrevented = e.defaultPrevented || (typeof e.defaultPrevented === 'undefined');\n        var $target = $(e.target);\n\n        if (this.isFocused) {\n            // retain focus by preventing native handling. if the\n            // event target is the input it should not be modified.\n            // otherwise, text selection within the input won't work.\n            if (e.target !== this.$control_input[0]) {\n                if (this.options.mode === 'single') {\n                    // toggle dropdown\n                    this.isOpen ? this.close() : this.open();\n                } else if (!defaultPrevented) {\n                    this.setActiveItem(null);\n                }\n\n                /*e.preventDefault();\n                 e.stopPropagation();*/\n                return false;\n            }\n        } else {\n            // give control focus\n            if (!defaultPrevented) {\n                window.setTimeout(bind(function() {\n                    this.focus();\n                }, this), 0);\n            }\n        }\n    },\n\n    onChange: function() {\n        this.input.emit('change', this.input.value(), this);\n        $('body').emit('change', { target: this.input });\n    },\n\n    onPaste: function(e) {\n        if (this.isFull() || this.isInputHidden || this.isLocked) {\n            e.preventDefault();\n        } else {\n            // If a regex or string is included, this will split the pasted\n            // input and create Items for each separate value\n            if (this.options.splitOn) {\n                setTimeout(bind(function() {\n                    var splitInput = trim(this.$control_input.value() || '').split(this.options.splitOn);\n                    for (var i = 0, n = splitInput.length; i < n; i++) {\n                        this.createItem(splitInput[i]);\n                    }\n                }, this), 0);\n            }\n        }\n    },\n\n    onKeyPress: function(e) {\n        if (this.isLocked) return e && e.preventDefault();\n        var character = String.fromCharCode(e.keyCode || e.which);\n        if (this.options.create && this.options.mode === 'multi' && character === this.options.delimiter) {\n            this.createItem();\n            e.preventDefault();\n            return false;\n        }\n    },\n\n    onKeyDown: function(e) {\n        var isInput = e.target === this.$control_input[0];\n\n        if (this.isLocked) {\n            if (e.keyCode !== KEY_TAB) {\n                e.preventDefault();\n            }\n            return;\n        }\n\n        switch (e.keyCode) {\n            case KEY_A:\n                if (this.isCmdDown) {\n                    this.selectAll();\n                    return;\n                }\n                break;\n            case KEY_ESC:\n                if (this.isOpen) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    this.close();\n                    //this.blur();\n                }\n                return;\n            case KEY_N:\n                if (!e.ctrlKey || e.altKey) break;\n            case KEY_DOWN:\n                if (!this.isOpen && this.hasOptions) {\n                    this.open();\n                } else if (this.$activeOption) {\n                    this.ignoreHover = true;\n                    var $next = this.getAdjacentOption(this.$activeOption, 1);\n                    if ($next) { this.setActiveOption($next, true, true); }\n                }\n                e.preventDefault();\n                return;\n            case KEY_P:\n                if (!e.ctrlKey || e.altKey) break;\n            case KEY_UP:\n                if (this.$activeOption) {\n                    this.ignoreHover = true;\n                    var $prev = this.getAdjacentOption(this.$activeOption, -1);\n                    if ($prev) { this.setActiveOption($prev, true, true); }\n                }\n                e.preventDefault();\n                return;\n            case KEY_RETURN:\n                if (this.isOpen && this.$activeOption) {\n                    this.onOptionSelect({ currentTarget: this.$activeOption });\n                    e.preventDefault();\n                }\n                return;\n            case KEY_LEFT:\n                this.advanceSelection(-1, e);\n                return;\n            case KEY_RIGHT:\n                this.advanceSelection(1, e);\n                return;\n            case KEY_TAB:\n                if (this.options.selectOnTab && this.isOpen && this.$activeOption) {\n                    this.onOptionSelect({ currentTarget: this.$activeOption });\n\n                    // Default behaviour is to jump to the next field, we only want this\n                    // if the current field doesn't accept any more entries\n                    if (!self.isFull()) {\n                        e.preventDefault();\n                    }\n                }\n                if (this.options.create && this.createItem()) {\n                    e.preventDefault();\n                }\n                return;\n            case KEY_BACKSPACE:\n            case KEY_DELETE:\n                this.deleteSelection(e);\n                return;\n        }\n\n        if ((this.isFull() || this.isInputHidden) && !(IS_MAC ? e.metaKey : e.ctrlKey)) {\n            e.preventDefault();\n            return;\n        }\n    },\n\n    onKeyUp: function(e) {\n\n        if (this.isLocked) return e && e.preventDefault();\n        var value = this.$control_input.value() || '';\n        if (this.lastValue !== value) {\n            this.lastValue = value;\n            this.onSearchChange(value);\n            this.refreshOptions();\n            this.emit('type', value);\n        }\n    },\n\n    onSearchChange: function(value) {\n        var fn = this.options.load;\n        if (!fn) return;\n        if (this.loadedSearches.hasOwnProperty(value)) return;\n        this.loadedSearches[value] = true;\n        this.load(bind(function(callback) {\n            fn.apply(this, [value, callback]);\n        }, this));\n    },\n\n    onFocus: function(e) {\n        var wasFocused = this.isFocused;\n\n        if (this.isDisabled) {\n            this.blur();\n            e && e.preventDefault();\n            return false;\n        }\n\n        if (this.ignoreFocus) return;\n        this.isFocused = true;\n        if (this.options.preload === 'focus') this.onSearchChange('');\n\n        if (!wasFocused) this.emit('focus');\n\n        if (!this.$activeItems.length) {\n            this.showInput();\n            this.setActiveItem(null);\n            this.refreshOptions(!!this.options.openOnFocus);\n        }\n\n        this.refreshState();\n    },\n\n    onBlur: function(e, dest) {\n        if (!this.isFocused) return;\n        this.isFocused = false;\n\n        if (this.ignoreFocus) {\n            return;\n        } else if (!this.ignoreBlur && (document.activeElement === this.$dropdown_content[0])) {\n            // ^- g5 custom [before: no e.target && ..]\n            // necessary to prevent IE closing the dropdown when the scrollbar is clicked\n            this.ignoreBlur = true;\n            this.onFocus(e);\n            return;\n        }\n\n        var deactivate = bind(function() {\n            this.close();\n            this.setTextboxValue('');\n            this.setActiveItem(null);\n            this.setActiveOption(null);\n            this.setCaret(this.items.length);\n            this.refreshState();\n\n            dest && dest.focus();\n\n            this.ignoreFocus = false;\n            this.emit('blur');\n\n        }, this);\n\n        this.ignoreFocus = true;\n        if (this.options.create && this.options.createOnBlur) {\n            this.createItem(null, false, deactivate);\n        } else {\n            deactivate();\n        }\n    },\n\n    onOptionHover: function(e, element) {\n        element = $(element);\n        if (this.ignoreHover) return;\n        this.setActiveOption(element || e.currentTarget, false);\n    },\n\n    onOptionSelect: function(e, element) {\n        var value, $target, $option, self = this;\n\n        if (e.preventDefault) {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n\n        $target = $(element || e.currentTarget);\n        if ($target.hasClass('g-create')) {\n            this.createItem(null, bind(function() {\n                if (this.options.closeAfterSelect) {\n                    this.close();\n                }\n            }, this));\n        } else {\n            value = $target.attribute('data-value');\n            if (typeof value !== 'undefined') {\n                this.lastQuery = null;\n                this.setTextboxValue('');\n                this.addItem(value);\n                if (this.options.closeAfterSelect) {\n                    this.close();\n                } else if (!this.options.hideSelected && e.type && /mouse/.test(e.type)) {\n                    this.setActiveOption(this.getOption(value));\n                }\n            }\n        }\n    },\n\n    onItemSelect: function(e, element) {\n        if (this.isLocked) return;\n        if (this.options.mode === 'multi') {\n            e.preventDefault();\n            this.setActiveItem(element || e.currentTarget, e);\n        }\n    },\n\n    onItemRemoveViaX: function(e, element) {\n        e.preventDefault();\n        if (this.isLocked || this.options.mode == 'single') return;\n\n        var $item = element.parent();\n        this.setActiveItem($item);\n        if (this.deleteSelection()) {\n            this.setCaret(this.items.length);\n        }\n    },\n\n    load: function(fn) {\n        var $wrapper = this.$wrapper.addClass(this.options.loadingClass);\n\n        this.loading++;\n        fn.apply(this, [bind(function(results) {\n            this.loading = Math.max(this.loading - 1, 0);\n            if (results && results.length) {\n                this.addOption(results);\n                this.refreshOptions(this.isFocused && !this.isInputHidden);\n            }\n            if (!this.loading) {\n                $wrapper.removeClass(this.options.loadingClass);\n            }\n            this.emit('load', results);\n        }, this)]);\n    },\n\n    setTextboxValue: function(value) {\n        var $input = this.$control_input;\n        var changed = $input.value() !== value;\n        if (changed) {\n            $input.value(value).emit('update');\n            this.lastValue = value;\n        }\n    },\n\n    getValue: function(value) {\n        // g5 custom\n        if (this.tagType === TAG_SELECT && this.input.attribute('multiple')) {\n            return value || this.items;\n        } else {\n            return (value || this.items).join(this.options.delimiter);\n        }\n    },\n\n    setValue: function(value, silent) {\n        var events = silent ? [] : ['change'];\n\n        debounce_events(this, events, function() {\n            this.clear(silent);\n            this.previousValue = this.getValue() || value;\n            this.addItems(value, silent);\n        });\n    },\n\n    setActiveItem: function(item, e) {\n        var eventName, idx, begin, end, $item, swap, $last;\n\n        if (this.options.mode === 'single') { return; }\n        item = $(item);\n\n        // clear the active selection\n        if (!item) {\n            if (this.$activeItems.length) { $(this.$activeItems).removeClass('g-active'); }\n            this.$activeItems = [];\n            if (this.isFocused) {\n                this.showInput();\n            }\n            return;\n        }\n\n        // modify selection\n        eventName = e && e.type.toLowerCase();\n\n        if (eventName === 'mousedown' && this.isShiftDown && this.$activeItems.length) {\n            $last = $(last(this.$control.children('.g-active')));\n            begin = Array.prototype.indexOf.apply(this.$control[0].childNodes, [$last[0]]);\n            end = Array.prototype.indexOf.apply(this.$control[0].childNodes, [item[0]]);\n            if (begin > end) {\n                swap = begin;\n                begin = end;\n                end = swap;\n            }\n            for (var i = begin; i <= end; i++) {\n                $item = this.$control[0].childNodes[i];\n                if (this.$activeItems.indexOf($item) === -1) {\n                    $($item).addClass('g-active');\n                    this.$wrapper.attribute('aria-activedescendant', slugify(this.rand + '-' + $($item).attribute('data-value')));\n                    this.$activeItems.push($item);\n                }\n            }\n            e.preventDefault();\n        } else if ((eventName === 'mousedown' && this.isCtrlDown) || (eventName === 'keydown' && this.isShiftDown)) {\n            if (item.hasClass('g-active')) {\n                idx = this.$activeItems.indexOf(item[0]);\n                this.$activeItems.splice(idx, 1);\n                item.removeClass('g-active');\n            } else {\n                this.$activeItems.push(item.addClass('g-active')[0]);\n                this.$wrapper.attribute('aria-activedescendant', slugify(this.rand + '-' + item.attribute('data-value')));\n            }\n        } else {\n            if ($(this.$activeItems)) $(this.$activeItems).removeClass('g-active');\n            this.$activeItems = [item.addClass('g-active')[0]];\n            this.$wrapper.attribute('aria-activedescendant', slugify(this.rand + '-' + item.attribute('data-value')));\n        }\n\n        // ensure control has focus\n        this.hideInput();\n        if (!this.isFocused) {\n            this.focus();\n        }\n    },\n\n    setActiveOption: function($option, scroll, animate) {\n        var height_menu, height_item, y;\n        var scroll_top, scroll_bottom;\n\n        if (this.$activeOption) this.$activeOption.removeClass('g-active');\n        this.$activeOption = null;\n\n        $option = $($option);\n        if (!$option) return;\n\n        this.$activeOption = $option.addClass('g-active');\n        this.$wrapper.attribute('aria-activedescendant', slugify(this.rand + '-' + $option.attribute('data-value')));\n\n        if (scroll || !isset(scroll)) {\n\n            height_menu = this.$dropdown_content[0].offsetHeight;\n            height_item = this.$activeOption[0].offsetHeight;\n            scroll = this.$dropdown_content[0].scrollTop || 0;\n            y = this.$activeOption.position().top - this.$dropdown_content.position().top + scroll;\n            scroll_top = y;\n            scroll_bottom = y - height_menu + height_item;\n\n            if (y + height_item > height_menu + scroll) {\n                this.$dropdown_content[0].scrollTop = scroll_bottom;\n                /*moofx(bind(function(value){\n                 this.$dropdown_content[0].scrollTop = value;\n                 }, this), {\n                 duration: animate ? this.options.scrollDuration : 0,\n                 equation: 'linear'\n                 }).start(scroll, scroll_bottom);*/\n            } else if (y < scroll) {\n                this.$dropdown_content[0].scrollTop = scroll_top;\n                /*moofx(bind(function(value){\n                 this.$dropdown_content[0].scrollTop = value;\n                 }, this), {\n                 duration: animate ? this.options.scrollDuration : 0,\n                 equation: 'linear'\n                 }).start(scroll, scroll_top);*/\n            }\n\n        }\n    },\n\n    selectAll: function() {\n        if (this.options.mode === 'single') return;\n\n        var items = this.$control.children(':not(input)');\n        if (items) {\n            items.addClass('g-active');\n            this.$wrapper.attribute('aria-activedescendant', slugify(this.rand + '-' + items.attribute('data-value')));\n        }\n\n        this.$activeItems = Array.prototype.slice.apply(items || []);\n        if (this.$activeItems.length) {\n            this.hideInput();\n            this.close();\n        }\n        this.focus();\n    },\n\n    hideInput: function() {\n\n        this.setTextboxValue('');\n        this.$control_input.style({\n            opacity: 0,\n            position: 'absolute',\n            left: this.rtl ? 10000 : -10000\n        });\n        this.isInputHidden = true;\n    },\n\n    showInput: function() {\n        this.$control_input.style({\n            opacity: 1,\n            position: 'relative',\n            left: 0\n        });\n        this.isInputHidden = false;\n    },\n\n    focus: function() {\n        if (this.isDisabled) { return; }\n\n        this.ignoreFocus = true;\n        this.$control_input[0].focus();\n        setTimeout(bind(function() {\n            this.ignoreFocus = false;\n            this.onFocus();\n        }, this), 0);\n    },\n\n    blur: function(dest) {\n        this.$control_input[0].blur();\n        this.onBlur(null, dest);\n        // g5 custom\n        //this.$control_input[0].blur();\n    },\n\n    getScoreFunction: function(query) {\n        return this.sifter.getScoreFunction(query, this.getSearchOptions());\n    },\n\n    getSearchOptions: function() {\n        var sort = this.options.sortField;\n        if (typeof sort === 'string') {\n            sort = [{ field: sort }];\n        }\n\n        return {\n            fields: this.options.searchField,\n            conjunction: this.options.searchConjunction,\n            sort: sort\n        };\n    },\n\n    search: function(query) {\n        var i, value, score, result, calculateScore;\n        var options = this.getSearchOptions();\n\n        // validate user-provided result scoring function\n        if (this.options.score) {\n            calculateScore = this.options.score.apply(this, [query]);\n            if (typeof calculateScore !== 'function') {\n                throw new Error('Selectize \"score\" setting must be a function that returns a function');\n            }\n        }\n\n        // perform search\n        if (query !== this.lastQuery) {\n            this.lastQuery = query;\n            result = this.sifter.search(query, merge(options, { score: calculateScore }));\n            this.currentResults = result;\n        } else {\n            result = merge({}, this.currentResults);\n        }\n\n        // filter out selected items\n        if (this.options.hideSelected) {\n            for (i = result.items.length - 1; i >= 0; i--) {\n                if (this.items.indexOf(hash_key(result.items[i].id)) !== -1) {\n                    result.items.splice(i, 1);\n                }\n            }\n        }\n\n        return result;\n    },\n\n    refreshOptions: function(triggerDropdown) {\n        var i, j, k, n, groups, groups_order, option, option_html, optgroup, optgroups, html, html_children, has_create_option;\n        var $active, $active_before, $create;\n\n        if (typeof triggerDropdown === 'undefined') {\n            triggerDropdown = true;\n        }\n\n        var query = trim(this.$control_input.value());\n        var results = this.search(query);\n        var $dropdown_content = this.$dropdown_content;\n        var active_before = this.$activeOption && hash_key(this.$activeOption.attribute('data-value'));\n\n        // build markup\n        n = results.items.length;\n        if (typeof this.options.maxOptions === 'number') {\n            n = Math.min(n, this.options.maxOptions);\n        }\n\n        // render and group available options individually\n        groups = {};\n        groups_order = [];\n\n        // g5 custom\n        //if (this.options.optgroupOrder) {\n        //    groups_order = this.options.optgroupOrder;\n        //    for (i = 0; i < groups_order.length; i++) {\n        //        groups[groups_order[i]] = [];\n        //    }\n        //} else {\n        //    groups_order = [];\n        //}\n\n        for (i = 0; i < n; i++) {\n            option = this.Options[results.items[i].id];\n            option_html = this.render('option', option);\n            optgroup = option[this.options.optgroupField] || '';\n            optgroups = isArray(optgroup) ? optgroup : [optgroup];\n\n            for (j = 0, k = optgroups && optgroups.length; j < k; j++) {\n                optgroup = optgroups[j];\n                if (!this.Optgroups.hasOwnProperty(optgroup)) {\n                    optgroup = '';\n                }\n                if (!groups.hasOwnProperty(optgroup)) {\n                    groups[optgroup] = document.createDocumentFragment();\n                    groups_order.push(optgroup);\n                }\n                groups[optgroup].appendChild(option_html);\n            }\n        }\n\n        // sort optgroups\n        if (this.options.lockOptgroupOrder) {\n            groups_order.sort(function(a, b) {\n                var a_order = this.Optgroups[a].$order || 0;\n                var b_order = this.Optgroups[b].$order || 0;\n                return a_order - b_order;\n            });\n        }\n\n        // render optgroup headers & join groups\n        html = document.createDocumentFragment();\n        for (i = 0, n = groups_order.length; i < n; i++) {\n            optgroup = groups_order[i];\n            if (this.Optgroups.hasOwnProperty(optgroup) && groups[optgroup].childNodes.length) {\n                // render the optgroup header and options within it,\n                // then pass it to the wrapper template\n                html_children = document.createDocumentFragment();\n                html_children.appendChild(this.render('optgroup_header', this.Optgroups[optgroup]));\n                html_children.appendChild(groups[optgroup]);\n                html.appendChild(this.render('optgroup', merge({}, this.Optgroups[optgroup], {\n                    html: domToString(html_children),\n                    dom: html_children\n                })));\n            } else {\n                html.appendChild(groups[optgroup]);\n            }\n        }\n\n        $dropdown_content.html(domToString(html));\n\n        // highlight matching terms inline\n        if (this.options.highlight && results.query.length && results.tokens.length) {\n            for (i = 0, n = results.tokens.length; i < n; i++) {\n                highlight($dropdown_content, results.tokens[i].regex);\n            }\n        }\n\n        // add \"selected\" class to selected options\n        if (!this.options.hideSelected) {\n            for (i = 0, n = this.items.length; i < n; i++) {\n                this.getOption(this.items[i]).addClass('g-selected').attribute('aria-selected', true);\n            }\n        }\n\n        // add create option\n        has_create_option = this.canCreate(query);\n        if (has_create_option) {\n            //$dropdown_content.prepend(this.render('option_create', { input: query }));\n            $(this.render('option_create', { input: query })).top($dropdown_content);\n            $create = $($dropdown_content[0].childNodes[0]);\n        }\n\n        // activate\n        this.hasOptions = results.items.length > 0 || has_create_option;\n        if (this.hasOptions) {\n            if (results.items.length > 0) {\n                $active_before = active_before && this.getOption(active_before);\n                if ($active_before && $active_before.length) {\n                    $active = $active_before;\n                } else if (this.options.mode === 'single' && this.items.length) {\n                    $active = this.getOption(this.items[0]);\n                }\n                if (!$active || !$active.length) {\n                    if ($create && !this.options.addPrecedence) {\n                        $active = this.getAdjacentOption($create, 1);\n                    } else {\n                        $active = $dropdown_content.find('[data-selectable]:first-child');\n                    }\n                }\n            } else {\n                $active = $create;\n            }\n            this.setActiveOption($active);\n            if (triggerDropdown && !this.isOpen) { this.open(); }\n        } else {\n            this.setActiveOption(null);\n            if (triggerDropdown && this.isOpen) { this.close(); }\n        }\n    },\n\n    addOption: function(data) {\n        var value;\n\n        if (isArray(data)) {\n            for (var i = 0, n = data.length; i < n; i++) {\n                this.addOption(data[i]);\n            }\n            return;\n        }\n\n        if (value = this.registerOption(data)) {\n            this.UserOptions[value] = true;\n            this.lastQuery = null;\n            this.emit('option_add', value, data);\n        }\n\n        // g5 custom\n        /*value = hash_key(data[this.options.valueField]);\n         if (typeof value !== 'string' || this.Options.hasOwnProperty(value)) return;\n\n         this.UserOptions[value] = true;\n         this.Options[value] = data;\n         this.lastQuery = null;\n         this.emit('option_add', value, data);*/\n    },\n\n    registerOption: function(data) {\n        var key = hash_key(data[this.options.valueField]);\n        if ((!key && !this.options.allowEmptyOption) || this.options.hasOwnProperty(key)) return false;\n        data.$order = data.$order || ++this.order;\n        this.Options[key] = data;\n\n        return key;\n    },\n\n    registerOptionGroup: function(data) {\n        var key = hash_key(data[this.options.optgroupValueField]);\n        if (!key) return false;\n\n        data.$order = data.$order || ++this.order;\n        this.Optgroups[key] = data;\n\n        return key;\n    },\n\n\n    addOptionGroup: function(id, data) {\n        data[this.options.optgroupValueField] = id;\n        if (id = this.registerOptionGroup(data)) {\n            this.emit('optgroup_add', id, data);\n        }\n    },\n\n    removeOptionGroup: function(id) {\n        if (this.Optgroups.hasOwnProperty(id)) {\n            delete this.Optgroups[id];\n            this.renderCache = {};\n            this.emit('optgroup_remove', id);\n        }\n    },\n\n    clearOptionGroups: function() {\n        this.Optgroups = {};\n        this.renderCache = {};\n        this.emit('optgroup_clear');\n    },\n\n    updateOption: function(value, data) {\n        var self = this;\n        var $item, $item_new, dummy;\n        var value_new, index_item, cache_items, cache_options, order_old;\n\n        value = hash_key(value);\n        value_new = hash_key(data[this.options.valueField]);\n\n        // sanity checks\n        if (value === null) return;\n        if (!this.Options.hasOwnProperty(value)) return;\n        if (typeof value_new !== 'string') throw new Error('Value must be set in option data');\n\n        order_old = this.Options[value].$order;\n\n        // update references\n        if (value_new !== value) {\n            delete this.Options[value];\n            index_item = this.items.indexOf(value);\n            if (index_item !== -1) {\n                this.items.splice(index_item, 1, value_new);\n            }\n        }\n        data.$order = data.$order || order_old;\n        this.Options[value_new] = data;\n\n        // invalidate render cache\n        cache_items = this.renderCache['item'];\n        cache_options = this.renderCache['option'];\n\n        if (cache_items) {\n            delete cache_items[value];\n            delete cache_items[value_new];\n        }\n        if (cache_options) {\n            delete cache_options[value];\n            delete cache_options[value_new];\n        }\n\n        // update the item if it's selected\n        if (this.items.indexOf(value_new) !== -1) {\n            $item = this.getItem(value);\n            $item_new = $(this.render('item', data));\n            if ($item.hasClass('g-active')) {\n                $item_new.addClass('g-active');\n                this.$wrapper.attribute('aria-activedescendant', slugify(this.rand + '-' + $item_new.attribute('data-value')));\n            }\n\n            $item_new.after($item);\n            $item.remove();\n        }\n\n        // invalidate last query because we might have updated the sortField\n        this.lastQuery = null;\n\n        // update dropdown contents\n        if (this.isOpen) {\n            this.refreshOptions(false);\n        }\n    },\n\n    removeOption: function(value, silent) {\n        value = hash_key(value);\n\n        var cache_items = this.renderCache['item'];\n        var cache_options = this.renderCache['option'];\n        if (cache_items) delete cache_items[value];\n        if (cache_options) delete cache_options[value];\n\n        delete this.UserOptions[value];\n        delete this.Options[value];\n        this.lastQuery = null;\n        this.emit('option_remove', value);\n        this.removeItem(value, silent);\n    },\n\n    clearOptions: function() {\n        this.loadedSearches = {};\n        this.UserOptions = {};\n        this.renderCache = {};\n        this.Options = this.sifter.items = {};\n        this.lastQuery = null;\n        this.emit('option_clear');\n        this.clear();\n    },\n\n    getOption: function(value) {\n        return this.getElementWithValue(value, this.$dropdown_content.search('[data-selectable]'));\n    },\n\n    getAdjacentOption: function($option, direction) {\n        var $options = this.$dropdown.search('[data-selectable]');\n        var index = indexOf($options, ($option ? $option[0] : null)) + direction;\n\n        return index >= 0 && index < ($options ? $options.length : 0) ? $($options[index]) : $();\n    },\n\n    getElementWithValue: function(value, $els) {\n        value = hash_key(value);\n\n        if (typeof value !== 'undefined' && value !== null) {\n            for (var i = 0, n = ($els ? $els.length : 0); i < n; i++) {\n                if ($els[i].getAttribute('data-value') === value) {\n                    return $($els[i]);\n                }\n            }\n        }\n\n        return $();\n    },\n\n    getItem: function(value) {\n        return this.getElementWithValue(value, this.$control.children());\n    },\n\n    addItems: function(values, silent) {\n        var items = isArray(values) ? values : [values];\n        for (var i = 0, n = items.length; i < n; i++) {\n            this.isPending = (i < n - 1);\n            this.addItem(items[i], silent);\n        }\n    },\n\n    addItem: function(value, silent) {\n        var events = silent ? [] : ['change'];\n\n        debounce_events(this, events, function() {\n            var $item, $option, $options;\n            var inputMode = this.options.mode;\n            var i, active, value_next, wasFull;\n            value = hash_key(value);\n\n            if (this.items.indexOf(value) !== -1) {\n                // g5 custom [before: && this.isOpen]\n                if (inputMode === 'single') this.close();\n                return;\n            }\n\n            if (!this.Options.hasOwnProperty(value)) return;\n            if (inputMode === 'single') this.clear(silent);\n            if (inputMode === 'multi' && this.isFull()) return;\n\n            $item = $(this.render('item', this.Options[value]));\n            // if (inputMode !== 'multi') $item.find('.g-remove-single-item').remove();\n\n            // ARIA\n            $item.attribute('id', this.rand + '-' + slugify($item.attribute('data-value')));\n            if (inputMode === 'multi') $item.attribute('aria-selected', true);\n\n            wasFull = this.isFull();\n            this.items.splice(this.caretPos, 0, value);\n            this.insertAtCaret($item);\n            if (!this.isPending || (!wasFull && this.isFull())) {\n                this.refreshState();\n            }\n\n            if (this.isSetup) {\n                $options = this.$dropdown_content.search('[data-selectable]');\n\n                // update menu / remove the option (if this is not one item being added as part of series)\n                if (!this.isPending) {\n                    $option = this.getOption(value);\n                    var adj = this.getAdjacentOption($option, 1);\n                    value_next = (adj) ? adj.attribute('data-value') : null;\n                    this.refreshOptions(this.isFocused && inputMode !== 'single');\n                    if (value_next) {\n                        this.setActiveOption(this.getOption(value_next));\n                    }\n                }\n\n                // hide the menu if the maximum number of items have been selected or no options are left\n                if (!$options || this.isFull()) {\n                    this.close();\n                } else {\n                    this.positionDropdown();\n                }\n\n                this.updatePlaceholder();\n                this.emit('item_add', value, $item);\n                this.updateOriginalInput({ silent: silent });\n            }\n        });\n    },\n\n    removeItem: function(value, silent) {\n        var $item, i, idx;\n\n        $item = (value instanceof $) ? value : this.getItem(value);\n        value = hash_key($item.attribute('data-value'));\n        i = this.items.indexOf(value);\n\n        if (i !== -1) {\n            $item.remove();\n            if ($item.hasClass('g-active')) {\n                idx = this.$activeItems.indexOf($item[0]);\n                this.$activeItems.splice(idx, 1);\n            }\n\n            this.items.splice(i, 1);\n            this.lastQuery = null;\n            if (!this.options.persist && this.UserOptions.hasOwnProperty(value)) {\n                this.removeOption(value, silent);\n            }\n\n            if (i < this.caretPos) {\n                this.setCaret(this.caretPos - 1);\n            }\n\n            this.refreshState();\n            this.updatePlaceholder();\n            this.updateOriginalInput({ silent: silent });\n            this.positionDropdown();\n            this.emit('item_remove', value, $item);\n        }\n    },\n\n    createItem: function(input, triggerDropdown) {\n        var caret = this.caretPos;\n        input = input || trim(this.$control_input.value() || '');\n\n        var callback = arguments[arguments.length - 1];\n        if (typeof callback !== 'function') callback = function() {};\n\n        if (!isBoolean(triggerDropdown)) {\n            triggerDropdown = true;\n        }\n\n        if (!this.canCreate(input)) {\n            callback();\n            return false;\n        }\n\n        this.lock();\n\n        var setup = (typeof this.options.create === 'function') ? this.options.create : bind(function(input) {\n            var data = {};\n            data[this.options.labelField] = input;\n            data[this.options.valueField] = input;\n            return data;\n        }, this);\n\n        var create = once(bind(function(data) {\n            this.unlock();\n\n            if (!data || typeof data !== 'object') return callback();\n            var value = hash_key(data[this.options.valueField]);\n            if (typeof value !== 'string') return callback();\n\n            this.setTextboxValue('');\n            this.addOption(data);\n            this.setCaret(caret);\n            this.addItem(value);\n            this.refreshOptions(triggerDropdown && this.options.mode !== 'single');\n            callback(data);\n        }, this));\n\n        var output = setup.apply(this, [input, create]);\n        if (typeof output !== 'undefined') {\n            create(output);\n        }\n\n        return true;\n    },\n\n    refreshItems: function() {\n        this.lastQuery = null;\n\n        if (this.isSetup) {\n            this.addItem(this.items);\n        }\n\n        this.refreshState();\n        this.updateOriginalInput();\n    },\n\n    refreshState: function() {\n        var invalid;\n        if (this.isRequired) {\n            if (this.items.length) this.isInvalid = false;\n            this.$control_input.attribute('required', this.isInvalid || null);\n        }\n        this.refreshClasses();\n    },\n\n    refreshClasses: function() {\n        var isFull   = this.isFull(),\n            isLocked = this.isLocked;\n\n        this.$wrapper.toggleClass('g-rtl', this.rtl);\n\n        this.$control.toggleClass('g-focus', this.isFocused);\n        this.$control.toggleClass('g-disabled', this.isDisabled);\n        this.$control.toggleClass('g-required', this.isRequired);\n        this.$control.toggleClass('g-invalid', this.isInvalid);\n        this.$control.toggleClass('g-locked', isLocked);\n        this.$control.toggleClass('g-full', isFull);\n        this.$control.toggleClass('g-not-full', !isFull);\n        this.$control.toggleClass('g-input-active', this.isFocused && !this.isInputHidden);\n        this.$control.toggleClass('g-dropdown-active', this.isOpen);\n        this.$control.toggleClass('g-has-options', !size(this.options.Options));\n        this.$control.toggleClass('g-has-items', this.items.length > 0);\n\n        // ARIA\n        if (this.isOpen) {\n            this.$wrapper\n                .attribute('aria-owns', this.rand)\n                .attribute('aria-activedescendant', slugify(this.rand + '-' + this.getValue()))\n                .attribute('aria-expanded', true);\n\n            this.$dropdown_content\n                .attribute('aria-expanded', true)\n                .attribute('aria-hidden', false);\n        } else {\n            this.$wrapper\n                .attribute('aria-owns', null)\n                .attribute('aria-activedescendant', null)\n                .attribute('aria-expanded', false);\n\n            this.$dropdown_content\n                .attribute('aria-expanded', false)\n                .attribute('aria-hidden', true);\n        }\n\n        this.$control_input.selectizeGrow = !isFull && !isLocked;\n    },\n\n    isFull: function() {\n        return this.options.maxItems !== null && this.items.length >= this.options.maxItems;\n    },\n\n    updateOriginalInput: function(opts) {\n        var options, label;\n        opts = opts || {};\n\n        if (this.tagType === TAG_SELECT) {\n            options = [];\n            for (var i = 0, n = this.items.length; i < n; i++) {\n                label = this.Options[this.items[i]][this.options.labelField] || '';\n                options.push('<option value=\"' + escapeHTML(this.items[i]) + '\" selected=\"selected\">' + escapeHTML(label) + '</option>');\n            }\n            if (!options.length && !this.input.attribute('multiple')) {\n                options.push('<option value=\"\" selected=\"selected\"></option>');\n            }\n            this.input.html(options.join(''));\n        } else {\n            this.input.value(this.getValue());\n            this.input.attribute('value', this.input.value());\n        }\n\n        if (this.isSetup && !opts.silent) {\n            this.emit('change', this.input.value());\n        }\n    },\n\n    updatePlaceholder: function() {\n        if (!this.options.placeholder) return;\n        var control_input = this.$control_input;\n\n        if (this.items.length) {\n            control_input.attribute('placeholder', null);\n        } else {\n            control_input.attribute('placeholder', this.options.placeholder);\n        }\n        control_input.emit('update', { force: true });\n    },\n\n    open: function() {\n        if (this.isLocked || this.isOpen || (this.options.mode === 'multi' && this.isFull())) return;\n        this.focus();\n        this.isOpen = true;\n        this.refreshState();\n        this.$dropdown.style({\n            visibility: 'hidden',\n            display: 'block'\n        });\n        this.positionDropdown();\n        this.$dropdown.style({ visibility: 'visible' });\n        this.emit('dropdown_open', this.$dropdown);\n    },\n\n    close: function() {\n        var trigger = this.isOpen;\n\n        if (this.options.mode === 'single' && this.items.length) {\n            this.hideInput();\n        }\n\n        this.isOpen = false;\n        this.$dropdown.hide();\n        this.setActiveOption(null);\n        this.refreshState();\n\n        if (trigger) this.emit('dropdown_close', this.$dropdown);\n    },\n\n    positionDropdown: function() {\n        var control = this.$control,\n            offset  = control.position();//this.options.dropdownParent === 'body' ? control.offset() : control.position();\n        offset.top += control[0].offsetHeight;\n\n        this.$dropdown.style({\n            width: control[0].offsetWidth,\n            top: control[0].offsetTop + control[0].offsetHeight,\n            left: control[0].offsetLeft\n        });\n    },\n\n    clear: function(silent) {\n        if (!this.items.length) return;\n\n        var non_input = this.$control.children(':not(input)');\n        if (non_input) non_input.remove();\n\n        this.items = [];\n        this.lastQuery = null;\n        this.setCaret(0);\n        this.setActiveItem(null);\n        this.updatePlaceholder();\n        this.updateOriginalInput({ silent: silent });\n        this.refreshState();\n        this.showInput();\n        this.emit('clear');\n    },\n\n    insertAtCaret: function($el) {\n        var caret = Math.min(this.caretPos, this.items.length);\n        if (caret === 0) {\n            $el.top(this.$control);//.prepend($el);\n        } else {\n            //$(this.$control[0].childNodes[caret]).before($el);\n            $el.after(this.$control.find(':nth-child(' + caret + ')'));\n            //this.$control.find(':nth-child(' + caret + ')').before($el);\n        }\n        this.setCaret(caret + 1);\n    },\n\n    deleteSelection: function(e) {\n        var i, n, direction, selection, values, caret, option_select, $option_select, $tail;\n\n        direction = (e && e.keyCode === KEY_BACKSPACE) ? -1 : 1;\n        selection = getSelection(this.$control_input[0]);\n\n        if (this.$activeOption && !this.options.hideSelected) {\n            option_select = this.getAdjacentOption(this.$activeOption, -1);\n            if (option_select) { option_select = option_select.attribute('data-value'); }\n        }\n\n        // determine items that will be removed\n        values = [];\n\n        if (this.$activeItems.length) {\n            var children = this.$control.children(':not(input)');\n            $tail = this.$control.children('.g-active');\n            if ($tail) { $tail = $(direction > 0 ? last($tail) : $tail[0]); }\n            caret = (!children ? -1 : indexOf(children, $tail[0]));\n            if (direction > 0) { caret++; }\n\n            for (i = 0, n = this.$activeItems.length; i < n; i++) {\n                values.push($(this.$activeItems[i]).attribute('data-value'));\n            }\n            if (e) {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n        } else if ((this.isFocused || this.options.mode === 'single') && this.items.length) {\n            if (direction < 0 && selection.start === 0 && selection.length === 0) {\n                values.push(this.items[this.caretPos - 1]);\n            } else if (direction > 0 && selection.start === this.$control_input.value().length) {\n                values.push(this.items[this.caretPos]);\n            }\n        }\n\n        // allow the callback to abort\n        if (!values.length || (typeof this.options.onDelete === 'function' && this.options.onDelete.apply(this, [values]) === false)) {\n            return false;\n        }\n\n        // perform removal\n        if (typeof caret !== 'undefined') {\n            this.setCaret(caret);\n        }\n        while (values.length) {\n            this.removeItem(values.pop());\n        }\n\n        this.showInput();\n        this.positionDropdown();\n        this.refreshOptions(true);\n\n        // select previous option\n        if (option_select) {\n            $option_select = this.getOption(option_select);\n            if ($option_select.length) {\n                this.setActiveOption($option_select);\n            }\n        }\n\n        return true;\n    },\n\n    advanceSelection: function(direction, e) {\n        var tail, selection, idx, valueLength, cursorAtEdge, $tail;\n\n        if (direction === 0) return;\n        if (this.rtl) direction *= -1;\n\n        tail = direction > 0 ? 'last-child' : 'first-child';\n        selection = getSelection(this.$control_input[0]);\n\n        if (this.isFocused && !this.isInputHidden) {\n            valueLength = this.$control_input.value().length;\n            cursorAtEdge = direction < 0\n                ? selection.start === 0 && selection.length === 0\n                : selection.start === valueLength;\n\n            if (cursorAtEdge && !valueLength) {\n                this.advanceCaret(direction, e);\n            }\n        } else {\n            $tail = this.$control.children('.g-active:' + tail);\n            if ($tail) {\n                idx = indexOf(this.$control.children(':not(input)'), $tail);\n                this.setActiveItem(null);\n                this.setCaret(direction > 0 ? idx + 1 : idx);\n            }\n        }\n    },\n\n    advanceCaret: function(direction, e) {\n        var fn, $adj;\n\n        if (direction === 0) return;\n\n        fn = direction > 0 ? 'nextSibling' : 'previousSibling';\n        if (this.isShiftDown) {\n            $adj = this.$control_input[fn]();\n            if ($adj) {\n                this.hideInput();\n                this.setActiveItem($adj);\n                e && e.preventDefault();\n            }\n        } else {\n            this.setCaret(this.caretPos + direction);\n        }\n    },\n\n    setCaret: function(i) {\n\n        if (this.options.mode === 'single') {\n            i = this.items.length;\n        } else {\n            i = Math.max(0, Math.min(this.items.length, i));\n        }\n\n        if (!this.isPending) {\n            // the input must be moved by leaving it in place and moving the\n            // siblings, due to the fact that focus cannot be restored once lost\n            // on mobile webkit devices\n            var j, n, fn, $children, $child;\n            $children = this.$control.children(':not(input)');\n            for (j = 0, n = ($children ? $children.length : 0); j < n; j++) {\n                $child = $($children[j]);//.detach();\n                if (j < i) {\n                    $child.before(this.$control_input);\n                } else {\n                    this.$control.appendChild($child);\n                }\n            }\n        }\n\n        this.caretPos = i;\n    },\n\n    lock: function() {\n        this.close();\n        this.isLocked = true;\n        this.refreshState();\n    },\n\n    unlock: function() {\n        this.isLocked = false;\n        this.refreshState();\n    },\n\n    disable: function() {\n        this.input.disabled(true);\n        this.$control_input.attribute('disabled', true).attribute('tabindex', -1);\n        this.isDisabled = true;\n        this.lock();\n    },\n\n    enable: function() {\n        this.input.attribute('disabled', null);\n        this.$control_input.attribute('disabled', null).attribute('tabindex', this.tabIndex);\n        this.isDisabled = false;\n        this.unlock();\n    },\n\n    destroy: function() {\n        var revertSettings = this.revertSettings;\n\n        this.emit('destroy');\n        this.off();\n        this.$wrapper.remove();\n        this.$dropdown.remove();\n\n        this.input\n            .html('')\n            .appendChild(revertSettings.$children)\n            .attribute('tabindex', null)\n            .removeClass('selectized')\n            .attribute({ tabindex: revertSettings.tabindex })\n            .show();\n\n        /*$(window).off(eventNS);\n         $(document).off(eventNS);\n         $(document.body).off(eventNS);*/\n\n        delete this.$control_input.selectizeGrow;\n        delete this.input.selectizeInstance;\n        delete this.input[0].selectize;\n    },\n\n    render: function(templateName, data) {\n        var value, id, label;\n        var name = '';\n        var cache = false;\n        var regex_tag = /^[\\t \\r\\n]*<([a-z][a-z0-9\\-_]*(?:\\:[a-z][a-z0-9\\-_]*)?)/i;\n\n        if (templateName === 'option' || templateName === 'item') {\n            value = hash_key(data[this.options.valueField]);\n            cache = !!value;\n        }\n\n        // pull markup from cache if it exists\n        if (cache) {\n            if (!isset(this.renderCache[templateName])) {\n                this.renderCache[templateName] = {};\n            }\n            if (this.renderCache[templateName].hasOwnProperty(value)) {\n                return this.renderCache[templateName][value];\n            }\n        }\n\n        // render markup\n        var html = zen('div').html(this.options.render[templateName].apply(this, [data, escapeHTML]));\n        html = html.firstChild();\n\n        // add mandatory attributes\n        if (templateName === 'option' || templateName === 'option_create') {\n            html = html.data('selectable', '');\n        }\n        if (templateName === 'optgroup') {\n            id = data[this.options.optgroupValueField] || '';\n            name = escape_replace(escapeHTML(id));\n            html = html.data('group', name).attribute('role', 'group').attribute('aria-label', name);\n        }\n        if (templateName === 'option' || templateName === 'item') {\n            name = escape_replace(escapeHTML(value || ''));\n            html = html.data('value', name).attribute('id', slugify(this.rand + '-' + name)).attribute('role', 'treeitem').attribute('aria-label', trim(data.text)).attribute('aria-selected', 'false');\n        }\n\n        // update cache\n        if (cache) {\n            this.renderCache[templateName][value] = html[0];\n        }\n\n        return html[0];\n    },\n\n    clearCache: function(templateName) {\n        if (typeof templateName === 'undefined') {\n            this.renderCache = {};\n        } else {\n            delete this.renderCache[templateName];\n        }\n    },\n\n    canCreate: function(input) {\n        if (!this.options.create) return false;\n        var filter = this.options.createFilter;\n        return input.length\n            && (typeof filter !== 'function' || filter.apply(self, [input]))\n            && (typeof filter !== 'string' || new RegExp(filter).test(input))\n            && (!(filter instanceof RegExp) || filter.test(input));\n    },\n\n    getPreviousValue: function() {\n        return this.previousValue;\n    }\n});\n\n$.implement({\n    selectize: function(settings_user) {\n        settings_user = settings_user || {};\n        var defaults             = Selectize.prototype.options,\n            settings             = merge({}, defaults, settings_user),\n            attr_data            = settings.dataAttr,\n            field_label          = settings.labelField,\n            field_value          = settings.valueField,\n            field_optgroup       = settings.optgroupField,\n            field_optgroup_label = settings.optgroupLabelField,\n            field_optgroup_value = settings.optgroupValueField;\n\n        var init_textbox = function(input, settings_element) {\n            input = $(input);\n            var i, n, values, option;\n\n            var data_raw = input.attribute(attr_data);\n\n            if (!data_raw) {\n                var value = trim(input.value() || '');\n                if (!settings.allowEmptyOption && !value.length) return;\n\n                values = value.split(settings.delimiter);\n                for (i = 0, n = values.length; i < n; i++) {\n                    option = {};\n                    option[field_label] = values[i];\n                    option[field_value] = values[i];\n\n                    settings_element.Options.push(option);\n                }\n\n                settings_element.items = values;\n            } else {\n                settings_element.Options = JSON.parse(data_raw);\n                for (i = 0, n = settings_element.Options.length; i < n; i++) {\n                    settings_element.items.push(settings_element.Options[i][field_value]);\n                }\n            }\n        };\n\n        var init_select = function(input, settings_element) {\n            var i, n, tagName, children, order = 0;\n            var options = settings_element.Options;\n            var optionsMap = {};\n\n            var readData = function(el) {\n                var data = attr_data && el.attribute(attr_data);\n                if (typeof data === 'string' && data.length) {\n                    return JSON.parse(data);\n                }\n                return null;\n            };\n\n            var addOption = function(option, group) {\n                var value, opt;\n\n                option = $(option);\n\n                value = hash_key(option.value());\n                if (!value.length && !settings.allowEmptyOption) return;\n\n                // if the option already exists, it's probably been\n                // duplicated in another optgroup. in this case, push\n                // the current group to the \"optgroup\" property on the\n                // existing option so that it's rendered in both places.\n                if (optionsMap.hasOwnProperty(value)) {\n                    if (group) {\n                        var arr = optionsMap[value][field_optgroup];\n                        if (!arr) {\n                            optionsMap[value][field_optgroup] = group;\n                        } else if (!isArray(arr)) {\n                            optionsMap[value][field_optgroup] = [arr, group];\n                        } else {\n                            arr.push(group);\n                        }\n                    }\n                    return;\n                }\n\n                opt = readData(option) || {};\n                opt[field_label] = opt[field_label] || option.text();\n                opt[field_value] = opt[field_value] || value;\n                opt[field_optgroup] = opt[field_optgroup] || group;\n\n                optionsMap[value] = opt;\n                options.push(opt);\n\n                if (option.matches(':selected')) {\n                    settings_element.items.push(value);\n                }\n            };\n\n            var addGroup = function(optgroup) {\n                var i, n, id, optgrp, options;\n\n                optgroup = $(optgroup);\n                id = optgroup.attribute('label');\n\n                if (id) {\n                    optgrp = readData(optgroup) || {};\n                    optgrp[field_optgroup_label] = id;\n                    optgrp[field_optgroup_value] = id;\n                    settings_element.Optgroups.push(optgrp);\n                }\n\n                options = optgroup.search('option');\n                for (i = 0, n = options.length; i < n; i++) {\n                    addOption(options[i], id);\n                }\n            };\n\n            settings_element.maxItems = input.attribute('multiple') ? null : 1;\n\n            children = input.children() || 0;\n            for (i = 0, n = children.length; i < n; i++) {\n                tagName = children[i].tagName.toLowerCase();\n                if (tagName === 'optgroup') {\n                    addGroup(children[i]);\n                } else if (tagName === 'option') {\n                    addOption(children[i]);\n                }\n            }\n        };\n\n        return this.forEach(function($input, i) {\n            settings = merge({}, defaults, settings_user),\n            $input = $($input);\n            if ($input.selectizeInstance) return;\n\n            var instance,\n                dataOptions = $input.data('selectize'),\n                tag_name    = $input.tag().toLowerCase(),\n                placeholder = $input.attribute('placeholder') || $input.attribute('data-placeholder');\n\n            // g5 custom\n            if (dataOptions) { dataOptions = JSON.parse(dataOptions); }\n            settings = merge({}, settings, dataOptions);\n            // end g5 custom\n\n            if (!placeholder && !settings.allowEmptyOption) {\n                var chlds = $input.children('option[value=\"\"]');\n                placeholder = chlds ? $input.children('option[value=\"\"]').text() : '';\n            }\n\n            var settings_element = {\n                'placeholder': placeholder,\n                'Options': [],\n                'Optgroups': [],\n                'items': []\n            };\n\n            if (tag_name === 'select') {\n                init_select($input, settings_element);\n            } else {\n                init_textbox($input, settings_element);\n            }\n\n            instance = new Selectize($input, merge({}, defaults, settings_element, settings_user, dataOptions));\n            $input.selectizeInstance = instance;\n        });\n    }\n});\n\nready(function() {\n    var selects = $('[data-selectize]');\n    if (!selects) { return; }\n\n    selects.selectize();\n});\n\n\nmodule.exports = Selectize;\n","\"use strict\";\n\nvar prime   = require('prime'),\n    Emitter = require('prime/emitter'),\n    Bound   = require('prime-util/prime/bound'),\n    Options = require('prime-util/prime/options'),\n    zen     = require('elements/zen'),\n    $       = require('../utils/elements.utils.js'),\n    storage = require('prime/map')(),\n\n    bind    = require('mout/function/bind'),\n    merge   = require('mout/object/merge');\n\nvar Toaster = new prime({\n    mixin: [Bound, Options],\n\n    inherits: Emitter,\n\n    options: {\n        tapToDismiss: true,\n        noticeClass: 'g-notifications',\n        containerID: 'g-notifications-container',\n\n        types: {\n            base: '',\n            error: 'fa-minus-circle',\n            info: 'fa-info-circle',\n            success: 'fa-check-circle',\n            warning: 'fa-exclamation-triangle'\n        },\n\n        showDuration: 300,\n        showEquation: 'cubic-bezier(0.02, 0.01, 0.47, 1)',\n        hideDuration: 500,\n        hideEquation: 'cubic-bezier(0.02, 0.01, 0.47, 1)',\n\n        timeOut: 2500, // timeOut and extendedTimeout to 0 == sticky\n        extendedTimeout: 2500,\n\n        location: 'bottom-right',\n\n        titleClass: 'g-notifications-title',\n        messageClass: 'g-notifications-message',\n        closeButton: true,\n\n        target: '#g5-container',\n        targetLocation: 'bottom',\n\n        newestOnTop: true,\n        preventDuplicates: false,\n        progressBar: true\n\n\n        /*\n        onShow: function() {},\n        onHidden: function() {},\n        onClick: function() {}\n        */\n    },\n\n    constructor: function(options) {\n        this.setOptions(options);\n\n        this.id = 0;\n        this.previousNotice = null;\n        this.map = storage;\n    },\n\n    mergeOptions: function(options) {\n        return merge(this.options, options || {});\n    },\n\n    base: function(message, title, options) {\n        options = this.mergeOptions(options);\n\n        return this.notify(merge(options, {\n            title: title || '',\n            type: options.type || 'base',\n            message: message\n        }));\n    },\n\n    success: function(message, title, options) {\n        options = this.mergeOptions(options);\n\n        return this.notify(merge(options, {\n            title: title || 'Success!',\n            type: 'success',\n            message: message\n        }));\n    },\n\n    info: function(message, title, options) {\n        options = this.mergeOptions(options);\n\n        return this.notify(merge(options, {\n            title: title || 'Info',\n            type: 'info',\n            message: message\n        }));\n    },\n    warning: function(message, title, options) {\n        options = this.mergeOptions(options);\n\n        return this.notify(merge(options, {\n            title: title || 'Warning!',\n            type: 'warning',\n            message: message\n        }));\n    },\n\n    error: function(message, title, options) {\n        options = this.mergeOptions(options);\n\n        return this.notify(merge(options, {\n            title: title || 'Error!',\n            type: 'error',\n            message: message\n        }));\n    },\n\n    notify: function(options) {\n        options = this.mergeOptions(options);\n\n        if (options.preventDuplicates && this.previousNotice === options.message) { return; }\n\n        this.id++;\n        this.previousNotice = options.message;\n\n        var container = this.getContainer(options, true),\n            element = zen('div'), title = zen('div'), message = zen('div'),\n            icon = zen('i.fa'),\n            progress = zen('div.g-notifications-progress'),\n            close = zen('a.fa.fa-close[href=\"#\"]');\n\n        this.map.set(element, {\n            container: container,\n            interval: null,\n            progressBar: {\n                interval: null,\n                hideETA: null,\n                maxHideTime: null\n            },\n            response: {\n                id: this.id,\n                state: 'visible',\n                start: new Date(),\n                options: options\n            },\n            options: options\n        });\n\n        if (options.title) {\n            element.appendChild(title.html(options.title).addClass(options.titleClass));\n        }\n\n        if (options.message) {\n            element.appendChild(message.html(options.message).addClass(options.messageClass));\n        }\n\n        if (options.closeButton) {\n            close.top(element);\n        }\n\n        if (options.progressBar) {\n            progress.top(element);\n        }\n\n        if (options.type && options.title) {\n            if (options.types[options.type]) {\n                element.addClass('g-notifications-theme-' + options.type);\n                icon.top(title).addClass(options.types[options.type]);\n            }\n        }\n\n        element.style({ opacity: 0 });\n        element[options.newestOnTop ? 'top' : 'bottom'](container);\n        element.animate({ opacity: 1 }, {\n            duration: options.showDuration,\n            equation: options.showEquation,\n            callback: options.onShow\n        });\n\n        if (options.timeOut > 0) {\n            var map = this.map.get(element);\n            map.interval = setTimeout(bind(function() {\n                this.hide(element);\n            }, this), options.timeOut);\n            map.progressBar.maxHideTime = parseFloat(options.timeOut);\n            map.progressBar.hideETA = new Date().getTime() + map.progressBar.maxHideTime;\n\n            if (options.progressBar) {\n                map.progressBar.interval = setInterval(bind(function() {\n                    this.updateProgress(element, progress);\n                }, this), 10);\n            }\n\n            this.map.set(element, map);\n        }\n\n        var stick = bind(function() { this.stickAround(element); }, this),\n            delay = bind(function() { this.delayedHide(element); }, this);\n        element.on('mouseover', stick);\n        element.on('mouseout', delay);\n\n        if (!options.onClick && options.tapToDismiss) {\n            element.on('click', bind(function(){\n                element.off('mouseover', stick);\n                element.off('mouseout', delay);\n\n                this.hide(element);\n            }, this));\n        }\n\n        if (options.closeButton && close) {\n            close.on('click', bind(function(event){\n                event.stopPropagation();\n                event.preventDefault();\n\n                element.off('mouseover', stick);\n                element.off('mouseout', delay);\n                this.hide(element, true);\n            }, this));\n        }\n\n    },\n\n    stickAround: function(element) {\n        var map = this.map.get(element);\n\n        clearTimeout(map.interval);\n        map.progressBar.hideETA = 0;\n        element.animate({ opacity: 1 }, {\n            duration: map.options.showDuration,\n            equation: map.options.showEquation,\n            callback: map.options.onShow\n        });\n\n        this.map.set(element, map);\n    },\n\n    hide: function(element, override) {\n        if (element.find(':focus') && !override) { return; }\n\n        var map = this.map.get(element);\n\n        clearTimeout(map.progressBar.interval);\n\n        this.map.set(element, map);\n        return element.animate({ opacity: 0 }, {\n            duration: map.options.hideDuration,\n            equation: map.options.hideEquation,\n            callback: bind(function() {\n                this.remove(element);\n                if (map.options.onHidden && map.response.state !== 'hidden') { map.options.onHidden(); }\n                map.response.state = 'hidden';\n                map.response.endTime = new Date();\n\n                this.map.set(element, map);\n            }, this)\n        });\n    },\n\n    delayedHide: function(element, override) {\n        var map = this.map.get(element);\n\n        if (map.options.timeOut > 0 || map.options.extendedTimeout > 0) {\n            map.interval = setTimeout(bind(function() {\n                this.hide(element);\n            }, this), map.options.extendedTimeout);\n            map.progressBar.maxHideTime = parseFloat(map.options.extendedTimeout);\n            map.progressBar.hideETA = new Date().getTime() + map.progressBar.maxHideTime;\n        }\n\n        this.map.set(element, map);\n    },\n\n    updateProgress: function(element, progress) {\n        var map = this.map.get(element),\n            percentage = ((map.progressBar.hideETA - (new Date().getTime())) / map.progressBar.maxHideTime) * 100;\n\n        this.map.set(element, map);\n        progress.style({ width: percentage + '%' });\n    },\n\n    getContainer: function(options, create) {\n        options = this.mergeOptions(options);\n\n        var container = $('#' + options.containerID);\n        if (container) { return container; }\n\n        if (create) { container = this.createContainer(options); }\n\n        return container;\n    },\n\n    createContainer: function(options) {\n        options = this.mergeOptions(options);\n\n        return zen('div#' + options.containerID + '.' + options.location)[options.targetLocation](options.target).attribute('aria-live', 'polite').attribute('role', 'alert');\n    },\n\n    remove: function(element) {\n        if (!element) { return; }\n\n        var map = this.map.get(element);\n        if (!map.container) { map.container = this.getContainer(map.options); }\n        /*if ($toastElement.is(':visible')) {\n            return;\n        }*/\n\n        element.remove();\n        if (!map.container.children()) {\n            map.container.remove();\n            this.previousNotice = null;\n        }\n\n        this.map.set(element, map);\n    }\n});\n\nvar toaster = new Toaster();\n\nmodule.exports = toaster;\n","\"use strict\";\nvar ready         = require('elements/domready'),\n    $             = require('elements'),\n\n    modal         = require('./modal'),\n    toastr        = require('./toastr'),\n    request       = require('agent'),\n\n    getAjaxSuffix = require('../utils/get-ajax-suffix'),\n    parseAjaxURI  = require('../utils/get-ajax-url').parse,\n    getAjaxURL    = require('../utils/get-ajax-url').global;\n\nvar hiddens,\n    toggles = function(event, element) {\n        if (event.type.match(/^touch/) || event.type == 'click') { event.preventDefault(); }\n        if (event.type == 'click') { return false; }\n        element = $(element);\n        hiddens = element.find('~~ [type=hidden]');\n\n        if (!hiddens) return true;\n        hiddens.value(hiddens.value() == '0' ? '1' : '0');\n        element.parent('.enabler').attribute('aria-checked', hiddens.value() == '1' ? 'true' : 'false');\n\n        hiddens.emit('change');\n        $('body').emit('change', { target: hiddens });\n\n        return false;\n    };\n\nready(function() {\n    var body = $('body');\n    body.delegate('keydown', '.enabler', function(event, element){\n        element = $(element);\n        if (element.disabled() || element.find('[disabled]')) {\n            return;\n        }\n\n        var key = (event.which ? event.which : event.keyCode);\n        if (key == 32 || key == 13) { // ARIA support: Space / Enter toggle\n            event.preventDefault();\n            toggles(event, element.find('.toggle'));\n        }\n    });\n\n    ['touchend', 'mouseup', 'click'].forEach(function(event) {\n        body.delegate(event, '.enabler .toggle', toggles);\n    });\n\n    var URI = parseAjaxURI(getAjaxURL('devprod') + getAjaxSuffix());\n    body.delegate('change', '[data-g-devprod] input[type=\"hidden\"]', function(event, element) {\n        var value = element.value(),\n            parent = element.parent('[data-g-devprod]'),\n            labels = JSON.parse(parent.data('g-devprod'));\n\n        parent.showIndicator();\n\n        request('post', URI, { mode: value }, function(error, response) {\n            if (!response.body.success) {\n                modal.open({\n                    content: response.body.html || response.body,\n                    afterOpen: function(container) {\n                        if (!response.body.html) { container.style({ width: '90%' }); }\n                    }\n                });\n\n                element.value(!value);\n            } else {\n                parent.find('.devprod-mode').text(labels[response.body.mode] || 'Unknown');\n                toastr.success(response.body.html, response.body.title);\n            }\n\n            parent.hideIndicator();\n        });\n    });\n});\n\nmodule.exports = {};\n","\"use strict\";\n\nvar ready    = require('elements/domready'),\n    tooltips = require('ext/tooltips');\n\ntooltips.defaults = {\n    baseClass: 'g-tips',\n    typeClass: null,\n    effectClass: 'g-fade',\n    inClass: 'g-tip-in',\n    place: 'top',\n    spacing: 10,\n    offset: -3,\n    auto: 1\n};\n\nvar Instance = null;\n\nready(function() {\n    Instance = new tooltips(document, {\n        tooltip: tooltips.defaults,\n        key: 'tip',\n        showOn: 'mouseenter',\n        hideOn: 'mouseleave',\n        observe: 1\n    });\n\n    window.G5.tips = Instance;\n});\n\nmodule.exports = Instance;\n","\"use strict\";\n\nvar prime         = require('prime'),\n    $             = require('../utils/elements.utils'),\n    zen           = require('elements/zen'),\n    domready      = require('elements/domready'),\n    storage       = require('prime/map')(),\n    modal         = require('../ui').modal,\n\n    size          = require('mout/collection/size'),\n    indexOf       = require('mout/array/indexOf'),\n    merge         = require('mout/object/merge'),\n    keys          = require('mout/object/keys'),\n    guid          = require('mout/random/guid'),\n    toQueryString = require('mout/queryString/encode'),\n    contains      = require('mout/string/contains'),\n\n    getParam      = require('mout/queryString/getParam'),\n    setParam      = require('mout/queryString/setParam'),\n\n    request       = require('agent')(),\n    History       = require('./history'),\n    flags         = require('./flags-state'),\n    parseAjaxURI  = require('./get-ajax-url').parse,\n    getAjaxSuffix = require('./get-ajax-suffix'),\n    lm            = require('../lm'),\n    mm            = require('../menu'),\n    assignments   = require('../assignments');\n\nrequire('../ui/popover');\n\nvar ERROR = false, TMP_SELECTIZE_DISABLE = false, ConfNavIndex = -1;\n\nHistory.Adapter.bind(window, 'statechange', function() {\n    if (request.running()) {\n        return false;\n    }\n    var body = $('body'),\n        State = History.getState(),\n        URI = State.url,\n        Data = State.data,\n        sidebar = $('#navbar'),\n        mainheader = $('#main-header'),\n        params = '';\n\n    if (Data.doNothing) { return true; }\n\n    if (size(Data) && Data.parsed !== false && storage.get(Data.uuid)) {\n        Data = storage.get(Data.uuid);\n    }\n\n    if (Data.element) {\n        var isTopNavOrMenu = Data.element.parent('#main-header') || Data.element.matches('.menu-select-wrap');\n        body.emit('statechangeBefore', {\n            target: Data.element,\n            Data: Data\n        });\n    } else {\n        var url = URI.replace(window.location.origin, '');\n        Data.element = $('[href=\"' + url + '\"]');\n    }\n\n    URI = parseAjaxURI(URI + getAjaxSuffix());\n\n    var lis;\n    if (sidebar && Data.element) {\n        var active = sidebar.search('li.active');\n        lis = sidebar.search('li');\n        lis.removeClass('active');\n\n        if (Data.element.parent('#navbar')) {\n            Data.element.parent('li').addClass('active');\n        }\n    }\n\n    if (mainheader && Data.element && (!Data.element.matches('a.menu-item') && !Data.element.matches('select.menu-select-wrap'))) {\n        lis = mainheader.search('.float-right li');\n        lis.removeClass('active');\n\n        if (Data.element.parent('#main-header')) {\n            Data.element.parent('li').addClass('active');\n        }\n    }\n\n    if (Data.params) {\n        params = toQueryString(JSON.parse(Data.params));\n        if (contains(URI, '?')) { params = params.replace(/^\\?/, '&'); }\n    }\n\n    if (!ERROR) { modal.closeAll(); }\n    request.url(URI + params).data(Data.extras || {}).method(Data.extras ? 'post' : 'get').send(function(error, response) {\n        if (!response.body.success) {\n            if (!ERROR) {\n                ERROR = true;\n                modal.open({\n                    content: response.body.html || response.body,\n                    afterOpen: function(container) {\n                        if (!response.body.html) { container.style({ width: '90%' }); }\n                    }\n                });\n\n                History.back();\n            } else {\n                ERROR = false;\n            }\n\n            if (Data.element) {\n                Data.element.hideIndicator();\n            }\n\n            return false;\n\n        }\n\n        var target = Data.parent ? Data.element.parent(Data.parent) : $(Data.target),\n            destination = (target || $('[data-g5-content]') || body);\n\n        if (response.body && response.body.html) {\n            var fader;\n            destination.html(response.body.html);\n            if (fader = (destination.matches('[data-g5-content]') ? destination : destination.find('[data-g5-content]'))) {\n                fader.style({ opacity: 0 });\n                if (isTopNavOrMenu) { $(navbar).attribute('tabindex', '-1').attribute('aria-hidden', 'true'); }\n                $('#navbar')[isTopNavOrMenu ? 'slideUp' : 'slideDown']();\n                fader.animate({ opacity: 1 });\n            }\n        } else { destination.html(response.body); }\n\n        body.getPopover().hideAll(true).destroy();\n\n        if (Data.element) {\n            body.emit('statechangeAfter', {\n                target: Data.element,\n                Data: Data\n            });\n        }\n\n        var element = (Data.event && Data.event.activeSpinner) || Data.element;\n        if (element) {\n            element.hideIndicator();\n        }\n\n        var selects = $('[data-selectize]');\n        if (selects) { selects.selectize(); }\n        selectorChangeEvent();\n        assignments.chromeFix();\n\n        body.emit('statechangeEnd');\n    });\n});\n\nvar selectorChangeEvent = function() {\n    var selectors = $('[data-selectize-ajaxify]');\n    if (!selectors) { return; }\n\n    selectors.forEach(function(selector) {\n        selector = $(selector);\n        var selectize = selector.selectize().selectizeInstance;\n        if (!selectize || selectize.HasChangeEvent) { return; }\n\n        selectize.on('change', function() {\n            if (TMP_SELECTIZE_DISABLE) {\n                TMP_SELECTIZE_DISABLE = false;\n                return false;\n            }\n            var value = selectize.getValue(),\n                options = selectize.Options,\n                flagCallback = function() {\n                    flags.off('update:pending', flagCallback);\n                    modal.close();\n\n                    selectize.input\n                        .data('g5-ajaxify', '')\n                        .data('g5-ajaxify-target', selector.data('g5-ajaxify-target') || '[data-g5-content-wrapper]')\n                        .data('g5-ajaxify-target-parent', selector.data('g5-ajaxify-target-parent') || null)\n                        .data('g5-ajaxify-href', options[value].url)\n                        .data('g5-ajaxify-params', options[value].params ? JSON.stringify(options[value].params) : null);\n\n\n                    var active = $('#navbar li.active') || $('#main-header li.active') || $('#navbar li:nth-child(2)');\n                    if (active) { active.showIndicator(); }\n\n                    $('body').emit('click', {\n                        target: selectize.input,\n                        activeSpinner: active\n                    });\n                };\n\n            if (!options[value]) { return; }\n\n            if (flags.get('pending')) {\n                flags.warning({\n                    callback: function(response, content) {\n                        var saveContinue = content.find('[data-g-unsaved-save]'),\n                            discardContinue = content.find('[data-g-unsaved-discard]');\n\n                        if (!saveContinue) { return; }\n                        saveContinue.on('click', function(e) {\n                            e.preventDefault();\n                            if (this.attribute('disabled')) { return false; }\n\n                            $([saveContinue, discardContinue]).attribute('disabled');\n                            flags.on('update:pending', flagCallback);\n                            $('body').emit('click', { target: $('.button-save') });\n                        });\n\n                        discardContinue.on('click', function(e) {\n                            e.preventDefault();\n                            if (this.attribute('disabled')) { return false; }\n\n                            $([saveContinue, discardContinue]).attribute('disabled');\n                            flags.set('pending', false);\n                            flagCallback();\n                        });\n                    },\n\n                    afterclose: function() {\n                        TMP_SELECTIZE_DISABLE = true;\n                        selectize.setValue(selectize.getPreviousValue());\n                    }\n                });\n\n                return;\n            }\n\n            flagCallback();\n        });\n\n        selectize.HasChangeEvent = true;\n    });\n};\n\n\ndomready(function() {\n    var body = $('body');\n\n    // Update NONCE if any\n    if (GANTRY_AJAX_NONCE) {\n        var currentURI = History.getPageUrl(),\n            currentNonce, currentView;\n\n        // hack to inject the default view in WP/Grav in case it's missing\n        switch (GANTRY_PLATFORM) {\n            case 'wordpress':\n                currentNonce = getParam(currentURI, '_wpnonce');\n                currentView = getParam(currentURI, 'view');\n\n                if (!currentView) {\n                    currentURI = setParam(currentURI, 'view', 'configurations/default/styles');\n                    History.replaceState({ uuid: guid(), doNothing: true }, window.document.title, currentURI);\n                }\n\n                // refresh nonce\n                if (currentNonce !== GANTRY_AJAX_NONCE) {\n                    currentURI = setParam(currentURI, '_wpnonce', GANTRY_AJAX_NONCE);\n                    History.replaceState({ uuid: guid(), doNothing: true }, window.document.title, currentURI);\n                }\n                break;\n\n            case 'grav':\n                currentNonce = getParam(currentURI, 'nonce');\n                currentView = contains(currentURI, 'configurations/default/styles');\n\n                if (!currentView) {\n                    currentURI += 'configurations/default/styles';\n                    History.replaceState({ uuid: guid(), doNothing: true }, window.document.title, currentURI);\n                }\n\n                // refresh nonce\n                if (currentNonce !== GANTRY_AJAX_NONCE) {\n                    currentURI = setParam(currentURI, 'nonce', GANTRY_AJAX_NONCE);\n                    History.replaceState({ uuid: guid(), doNothing: true }, window.document.title, currentURI);\n                }\n                break;\n        }\n\n\n    }\n\n    // back to configuration\n    body.delegate('click', '.button-back-to-conf', function(event, element) {\n        event.preventDefault();\n\n        var confSelector = $('#configuration-selector'),\n            outlineDeleted = body.outlineDeleted,\n            currentOutline = confSelector.value();\n\n        ConfNavIndex = ConfNavIndex == -1 ? 1 : ConfNavIndex;\n        var navbar = $('#navbar'),\n            item = navbar.find('li:nth-child(' + (ConfNavIndex + 1) + ') [data-g5-ajaxify]');\n\n        if (flags.get('pending')) {\n            flags.warning({\n                callback: function(response, content) {\n                    var saveContinue = content.find('[data-g-unsaved-save]'),\n                        discardContinue = content.find('[data-g-unsaved-discard]'),\n                        flagCallback = function() {\n                            flags.off('update:pending', flagCallback);\n                            modal.close();\n\n                            body.emit('click', { target: item });\n                            navbar.attribute('tabindex', null).attribute('aria-hidden', 'false');\n                            navbar.slideDown();\n                        };\n\n                    if (!saveContinue) { return; }\n                    saveContinue.on('click', function(e) {\n                        e.preventDefault();\n                        if (this.attribute('disabled')) { return false; }\n\n                        $([saveContinue, discardContinue]).attribute('disabled');\n                        flags.on('update:pending', flagCallback);\n                        body.emit('click', { target: $('.button-save') });\n                    });\n\n                    discardContinue.on('click', function(e) {\n                        e.preventDefault();\n                        if (this.attribute('disabled')) { return false; }\n\n                        $([saveContinue, discardContinue]).attribute('disabled');\n                        flags.set('pending', false);\n                        flagCallback();\n                    });\n                }\n            });\n\n            return;\n        }\n\n        element.showIndicator();\n\n        if (outlineDeleted == currentOutline) {\n            var ids = keys(confSelector.selectizeInstance.Options),\n                id = ids.shift();\n            body.outlineDeleted = null;\n            item.href(item.href().replace('/' + outlineDeleted + '/', '/' + id + '/').replace('style=' + outlineDeleted, 'style=' + id));\n        }\n\n        body.emit('click', { target: item });\n        navbar.attribute('tabindex', null);\n        navbar.slideDown();\n    });\n\n    body.delegate('click', '#navbar a[data-g5-ajaxify]', function(event, element) {\n        var navbar = $('#navbar'),\n            lis = navbar.search('li a[data-g5-ajaxify]');\n\n        ConfNavIndex = indexOf(lis, element[0]) + 1;\n    });\n\n    // generic ajaxified links\n    body.delegate('click', '[data-g5-ajaxify]', function(event, element) {\n        if (event && event.preventDefault) {\n            if (event.which === 2 || event.metaKey || event.ctrlKey || event.altKey || event.shiftKey) {\n                return true;\n            }\n\n            event.preventDefault();\n        }\n\n        if (flags.get('pending') && (!element.matches('a.menu-item') && !element.parent('[data-menu-items]'))) {\n            flags.warning({\n                callback: function(response, content) {\n                    var saveContinue = content.find('[data-g-unsaved-save]'),\n                        discardContinue = content.find('[data-g-unsaved-discard]'),\n                        flagCallback = function() {\n                            flags.off('update:pending', flagCallback);\n                            modal.close();\n                            body.emit('click', event);\n                        };\n\n                    if (!saveContinue) { return; }\n                    saveContinue.on('click', function(e) {\n                        e.preventDefault();\n                        if (this.attribute('disabled')) { return false; }\n\n                        $([saveContinue, discardContinue]).attribute('disabled');\n                        flags.on('update:pending', flagCallback);\n                        body.emit('click', { target: $('.button-save') });\n                    });\n\n                    discardContinue.on('click', function(e) {\n                        e.preventDefault();\n                        if (this.attribute('disabled')) { return false; }\n\n                        $([saveContinue, discardContinue]).attribute('disabled');\n                        flags.set('pending', false);\n                        flagCallback();\n                    });\n                }\n            });\n\n            return;\n        }\n\n        element.showIndicator();\n\n        var data = element.data('g5-ajaxify'),\n            target = element.data('g5-ajaxify-target'),\n            parent = element.data('g5-ajaxify-target-parent'),\n            url = element.attribute('href') || element.data('g5-ajaxify-href'),\n            params = element.data('g5-ajaxify-params') || false,\n            title = element.attribute('title') || window.document.title;\n\n        data = data ? JSON.parse(data) : { parsed: false };\n        if (data) {\n            var uuid = guid(), extras;\n\n            // TODO: The menu needs to be able to receive POST\n            if (element.data('mm-id') || element.parent('[data-mm-id]')) {\n                extras = {};\n                extras.menutype = $('select.menu-select-wrap').value();\n                extras.settings = JSON.stringify(mm.menumanager.settings);\n                extras.ordering = JSON.stringify(mm.menumanager.ordering);\n                extras.items = JSON.stringify(mm.menumanager.items);\n            }\n\n            storage.set(uuid, merge({}, data, {\n                target: target,\n                parent: parent,\n                element: element,\n                params: params,\n                extras: extras,\n                event: event\n            }));\n            data = { uuid: uuid };\n        }\n\n        History.pushState(data, title, url);\n\n        var navbar, active, actives = $('#navbar .active, #main-header .active');\n\n        if (navbar = element.parent('#navbar, #main-header')) {\n            if (actives) { actives.removeClass('active'); }\n\n            active = navbar.search('.active');\n            if (active) { active.removeClass('active'); }\n            element.parent('li').addClass('active');\n        }\n    });\n\n    // attach change events to configurations selector\n    selectorChangeEvent();\n});\n\n\nmodule.exports = {};\n","\"use strict\";\n\n// credits: https://github.com/cowboy/javascript-sync-async-foreach\nvar asyncForEach = function(arr, eachFn, doneFn) {\n    arr = arr || [];\n    var i = -1;\n    // Resolve array length to a valid (ToUint32) number.\n    var len = arr.length >>> 0;\n\n    (function next(result) {\n        // This flag will be set to true if `this.async` is called inside the\n        // eachFn` callback.\n        var async;\n        // Was false returned from the `eachFn` callback or passed to the\n        // `this.async` done function?\n        var abort = result === false;\n\n        // Increment counter variable and skip any indices that don't exist. This\n        // allows sparse arrays to be iterated.\n        do { ++i; } while (!(i in arr) && i !== len);\n\n        // Exit if result passed to `this.async` done function or returned from\n        // the `eachFn` callback was false, or when done iterating.\n        if (abort || i === len) {\n            // If a `doneFn` callback was specified, invoke that now. Pass in a\n            // boolean value representing \"not aborted\" state along with the array.\n            if (doneFn) {\n                doneFn(!abort, arr);\n            }\n            return;\n        }\n\n        // Invoke the `eachFn` callback, setting `this` inside the callback to a\n        // custom object that contains one method, and passing in the array item,\n        // index, and the array.\n        result = eachFn.call({\n            // If `this.async` is called inside the `eachFn` callback, set the async\n            // flag and return a function that can be used to continue iterating.\n            async: function() {\n                async = true;\n                return next;\n            }\n        }, arr[i], i, arr);\n\n        // If the async flag wasn't set, continue by calling `next` synchronously,\n        // passing in the result of the `eachFn` callback.\n        if (!async) {\n            next(result);\n        }\n    }());\n};\n\nmodule.exports = asyncForEach;\n","'use strict';\n\nvar rAF = (function() {\n    return window.requestAnimationFrame ||\n        window.webkitRequestAnimationFrame ||\n        function(callback) { window.setTimeout(callback, 1000 / 60); };\n}());\n\nvar decouple = function(element, event, callback) {\n    var evt, tracking = false;\n    element = element[0] || element;\n\n    var capture = function(e) {\n        evt = e;\n        track();\n    };\n\n    var track = function() {\n        if (!tracking) {\n            rAF(update);\n            tracking = true;\n        }\n    };\n\n    var update = function() {\n        callback.call(element, evt);\n        tracking = false;\n    };\n\n    try {\n        element.addEventListener(event, capture, false);\n    } catch (e) {}\n\n    return capture;\n};\n\nmodule.exports = decouple;","\"use strict\";\nvar $          = require('elements'),\n    moofx      = require('moofx'),\n    map        = require('mout/array/map'),\n    series     = require('mout/function/series'),\n    slick      = require('slick'),\n    zen        = require('elements/zen'),\n    progresser = require('../ui/progresser');\n\nvar walk = function(combinator, method) {\n\n    return function(expression) {\n        var parts = slick.parse(expression || \"*\");\n\n        expression = map(parts, function(part) {\n            return combinator + \" \" + part;\n        }).join(', ');\n\n        return this[method](expression);\n    };\n\n};\n\n\n$.implement({\n    style: function() {\n        var moo = moofx(this);\n        moo.style.apply(moo, arguments);\n        return this;\n    },\n\n    animate: function() {\n        var moo = moofx(this);\n        moo.animate.apply(moo, arguments);\n        return this;\n    },\n\n    hide: function() {\n        return this.style('display', 'none');\n    },\n\n    show: function(mode) {\n        return this.style('display', mode || 'inherit');\n    },\n\n    progresser: function(options) {\n        var instance;\n\n        this.forEach(function(node) {\n            instance = node.ProgresserInstance;\n\n            if (!instance) { instance = new progresser(node, options); }\n            else { instance.constructor(node, options); }\n\n            node.ProgresserInstance = instance;\n            return instance;\n        });\n    },\n\n    compute: function() {\n        var moo = moofx(this);\n        return moo.compute.apply(moo, arguments);\n    },\n\n    showIndicator: function(klass, keepIcon) {\n        this.forEach(function(node) {\n            node = $(node);\n            if (typeof klass == 'boolean') {\n                keepIcon = klass;\n                klass = null;\n            }\n\n            var icon = keepIcon ? false : node.find('i');\n            node.gHadIcon = !!icon;\n\n            if (!icon) {\n                if (!node.find('span') && !node.children()) { zen('span').text(node.text()).top(node.empty()); }\n\n                icon = zen('i');\n                icon.top(node);\n            }\n\n            if (!node.gIndicator) { node.gIndicator = icon.attribute('class') || true; }\n            icon.attribute('class', klass || 'fa fa-fw fa-spin-fast fa-spinner');\n        });\n    },\n\n    hideIndicator: function() {\n        this.forEach(function(node) {\n            node = $(node);\n            if (!node.gIndicator) { return; }\n\n            var icon = node.find('i');\n\n            if (!icon) { return; }\n\n            if (!node.gHadIcon) { icon.remove(); }\n            else { icon.attribute('class', node.gIndicator); }\n\n            node.gIndicator = null;\n        });\n    },\n\n    slideDown: function(animation, callback) {\n        var element       = this,\n            size          = this.getRealSize(),\n            callbackStart = function() {\n                element.gSlideCollapsed = false;\n            },\n            callbackEnd   = function() {\n                element.attribute('style', element.gSlideStyle);\n            };\n\n        callback = typeof animation == 'function' ? animation : (callback || function() {});\n        if (this.gSlideCollapsed === false) { return callback(); }\n        callback = series(callbackStart, callback, callbackEnd);\n\n        animation = typeof animation == 'string' ? animation : {\n            duration: '250ms',\n            callback: callback\n        };\n\n        this.style('visibility', 'visible').attribute('aria-hidden', false);\n        this.animate({ height: size.height }, animation);\n    },\n\n    slideUp: function(animation, callback) {\n        if (typeof this.gSlideCollapsed == 'undefined') {\n            this.gSlideStyle = this.attribute('style');\n        }\n\n        var element       = this,\n            callbackStart = function() {\n                element.gSlideCollapsed = true;\n            },\n            callbackEnd = function() {\n                element.style('visibility', 'hidden').attribute('aria-hidden', true);\n            };\n\n        callback = typeof animation == 'function' ? animation : (callback || function() {});\n        if (this.gSlideCollapsed === true) { return callback(); }\n        callback = series(callbackStart, callback, callbackEnd);\n\n        animation = typeof animation == 'string' ? animation : {\n            duration: '250ms',\n            callback: callback\n        };\n        this.style({ overflow: 'hidden' }).animate({ height: 0 }, animation);\n    },\n\n    slideToggle: function(animation, callback) {\n        var size = this.getRealSize();\n        return this[size.height && !this.gSlideCollapsed ? 'slideUp' : 'slideDown'](animation, callback);\n    },\n\n    getRealSize: function() {\n        var style = this.attribute('style'), size;\n        this.style({\n            position: 'relative',\n            overflow: 'inherit',\n            top: -50000,\n            height: 'auto',\n            width: 'auto'\n        });\n\n        size = {\n            width: parseInt(this.compute('width'), 10),\n            height: parseInt(this.compute('height'), 10)\n        };\n\n        this.attribute('style', style);\n\n        return size;\n    },\n\n    sibling: walk('++', 'find'),\n\n    siblings: walk('~~', 'search')\n});\n\nmodule.exports = $;\n","\"use strict\";\nvar $     = require('elements');\n\n$.implement({\n    belowthefold: function(expression, treshold) {\n        var elements = this.search(expression);\n        treshold = treshold || 0;\n        if (!elements) { return false; }\n\n        var fold = this.position().height + this[0].scrollTop;\n        return elements.filter(function(element) {\n            return fold <= $(element)[0].offsetTop - treshold;\n        });\n    },\n\n    abovethetop: function(expression, treshold) {\n        var elements = this.search(expression);\n        treshold = treshold || 0;\n        if (!elements) { return false; }\n\n        var top = this[0].scrollTop;\n        return elements.filter(function(element) {\n            return top >= $(element)[0].offsetTop + $(element).position().height - treshold;\n        });\n    },\n\n    rightofscreen: function(expression, treshold) {\n        var elements = this.search(expression);\n        treshold = treshold || 0;\n        if (!elements) { return false; }\n\n        var fold = this.position().width + this[0].scrollLeft;\n        return elements.filter(function(element) {\n            return fold <= $(element)[0].offsetLeft - treshold;\n        });\n    },\n\n    leftofscreen: function(expression, treshold) {\n        var elements = this.search(expression);\n        treshold = treshold || 0;\n        if (!elements) { return false; }\n\n        var left = this[0].scrollLeft;\n        return elements.filter(function(element) {\n            return left >= $(element)[0].offsetLeft + $(element).position().width - treshold;\n        });\n    },\n\n    inviewport: function(expression, treshold) {\n        var elements = this.search(expression);\n        treshold = treshold || 0;\n        if (!elements) { return false; }\n\n        var position = this.position();\n        return elements.filter(function(element) {\n            element = $(element);\n            return element[0].offsetTop + treshold >= this[0].scrollTop &&\n                element[0].offsetTop - treshold <= this[0].scrollTop + position.height;\n        }, this);\n    }\n});\n\nmodule.exports = $;\n","\"use strict\";\n\nvar $ = require('elements');\n\nvar fieldValidation = function(field) {\n    field = $(field);\n    var _field = field[0],\n        tag = field.tag(),\n        type = field.type(),\n        isValid = true;\n\n    // only validate input, textarea, select\n    if (!~['input', 'textarea', 'select'].indexOf(tag)) { return isValid; }\n\n    // use native validation if available\n    if (typeof _field.willValidate !== 'undefined') {\n        if (tag == 'input' && (_field.type.toLowerCase() !== type || field.hasClass('custom-validation-field'))) {\n            // type not supported or custom, fallback validation\n            _field.setCustomValidity(validate(field) ? '' : 'The field value is invalid');\n        }\n\n        // native validity check\n        _field.checkValidity();\n\n    } else {\n        _field.validity = _field.validity || {};\n        _field.validity.valid = validate(field);\n    }\n\n    isValid = _field.validity.valid;\n\n    return isValid;\n};\n\nvar validate = function(field) {\n    field = $(field);\n\n    var isValid = true,\n        value = field.value(),\n        type = field.type(),\n        isCheckbox = (type == 'checkbox' || type == 'radio'),\n        disabled = field.attribute('disabled'),\n        required = field.attribute('required'),\n        minlength = field.attribute('minlength'),\n        maxlength = field.attribute('maxlength'),\n        min = field.attribute('min'),\n        max = field.attribute('max'),\n        pattern = field.attribute('pattern');\n\n    // disabled fields should not be validated\n    if (disabled) { return isValid; }\n\n    // required\n    isValid = isValid && (!required || (isCheckbox && field.checked()) || (!isCheckbox && value));\n\n    // minlength / maxlength\n    isValid = isValid && (isCheckbox || ((!minlength || value.length >= minlength) && (!maxlength || value.length <= maxlength)));\n\n    // pattern\n    if (isValid && pattern) {\n        pattern = new RegExp(pattern);\n        isValid = pattern.test(value);\n    }\n\n    // min / max\n    if (isValid && (min !== null || max !== null)) {\n        if (min !== null) {\n            isValid = parseFloat(value) >= parseFloat(min);\n        }\n\n        if (max !== null) {\n            isValid = parseFloat(value) <= parseFloat(max);\n        }\n    }\n\n    return isValid;\n};\n\nmodule.exports = fieldValidation;\n","\"use strict\";\n\nvar prime         = require('prime'),\n    map           = require('prime/map'),\n    Emitter       = require('prime/emitter'),\n    modal         = require('../ui').modal,\n\n    getAjaxURL    = require('./get-ajax-url').global,\n    parseAjaxURI  = require('./get-ajax-url').parse,\n    getAjaxSuffix = require('./get-ajax-suffix');\n\nvar FlagsState = new prime({\n\n    inherits: Emitter,\n\n    constructor: function() {\n        this.flags = map();\n    },\n\n    set: function(key, value) {\n        return this.flags.set(key, value).get(key);\n    },\n\n    get: function(key, def) {\n        var value = this.flags.get(key);\n        return value ? value : this.set(key, def);\n    },\n\n    keys: function() {\n        return this.flags.keys();\n    },\n\n    values: function() {\n        return this.flags.values();\n    },\n\n    warning: function(options){\n        var callback = options.callback || function() {},\n            afterclose = options.afterclose || function() {},\n            warningURL = parseAjaxURI(options.url || getAjaxURL('unsaved') + getAjaxSuffix());\n\n        if (!options.url && !options.message) { options.url = true; }\n        if (options.url) {\n            modal.open({\n                content: 'Loading...',\n                remote: warningURL,\n                data: options.data || false,\n                remoteLoaded: function(response, modal) {\n                    var content = modal.elements.content;\n                    if (!callback) { return; }\n\n                    callback.call(this, response, content, modal);\n                },\n                afterClose: afterclose || function() {}\n            });\n        } else {\n            modal.open({\n                content: options.message,\n                afterOpen: function(response, modal) {\n                    var content = modal.elements.content;\n                    if (!callback) { return; }\n\n                    callback.call(this, response, content, modal);\n                },\n                afterClose: afterclose || function() {}\n            });\n        }\n    }\n\n});\n\nmodule.exports = new FlagsState();\n","\"use strict\";\n\nvar getAjaxSuffix = function() {\n    var GANTRY_AJAX_SUFFIX = window.GANTRY_AJAX_SUFFIX || undefined;\n    return typeof GANTRY_AJAX_SUFFIX == 'undefined' ? '' : GANTRY_AJAX_SUFFIX;\n};\n\nmodule.exports = getAjaxSuffix;\n","\"use strict\";\nvar unescapeHtml  = require('mout/string/unescapeHtml'),\n    getAjaxSuffix = require('./get-ajax-suffix'),\n    endsWith      = require('mout/string/endsWith'),\n    getQuery      = require('mout/queryString/getQuery'),\n    getParam      = require('mout/queryString/getParam'),\n    setParam      = require('mout/queryString/setParam');\n\nvar getAjaxURL = function(view, search) {\n    var GANTRY_AJAX_URL = window.GANTRY_AJAX_URL || '';\n    if (!search) { search = '%ajax%'; }\n    var re  = new RegExp(search, 'g'),\n        url = typeof GANTRY_AJAX_URL == 'undefined' ? '' : GANTRY_AJAX_URL;\n\n    return unescapeHtml(url.replace(re, view));\n};\n\nvar getConfAjaxURL = function(view, search) {\n    var GANTRY_AJAX_CONF_URL = window.GANTRY_AJAX_CONF_URL || '';\n    if (!search) { search = '%ajax%'; }\n    var re  = new RegExp(search, 'g'),\n        url = typeof GANTRY_AJAX_CONF_URL == 'undefined' ? '' : GANTRY_AJAX_CONF_URL;\n\n    return unescapeHtml(url.replace(re, view));\n};\n\nvar parseAjaxURI = function(uri) {\n    var GANTRY_PLATFORM = window.GANTRY_PLATFORM || '',\n        platform        = typeof GANTRY_PLATFORM == 'undefined' ? '' : GANTRY_PLATFORM;\n\n    switch (platform) {\n        case 'wordpress':\n            uri = uri.replace(/themes\\.php/ig, 'admin-ajax.php');\n            break;\n        case 'grav':\n            // converts foo/bar?nonce=1234.json to foo/bar.json?nonce=1234\n            var suffix = getAjaxSuffix();\n            if (endsWith(uri, suffix)) {\n                var query  = '' + getQuery(uri),\n                    nonce  = '' + getParam(uri, 'nonce');\n\n                uri = uri.replace(query, suffix) + query.replace(nonce, (nonce.replace(suffix, '')));\n            }\n            break;\n        default:\n    }\n\n    return uri;\n};\n\nmodule.exports = {\n    global: getAjaxURL,\n    config: getConfAjaxURL,\n    parse: parseAjaxURI\n};\n","\"use strict\";\nvar $    = require('elements'),\n    trim = require('mout/string/trim');\n\nvar getOutlineNameById = function(outline) {\n    if (outline == null) { return ''; }\n    return trim($('#configuration-selector').selectizeInstance.Options[outline].text);\n};\n\nvar getCurrentOutline = function() {\n    return trim($('#configuration-selector').selectizeInstance.getValue());\n};\n\nmodule.exports = { getOutlineNameById: getOutlineNameById, getCurrentOutline: getCurrentOutline };\n","\"use strict\";\n\nvar zen = require('elements/zen');\n\nvar cached            = null,\n    getScrollbarWidth = function() {\n        if (cached !== null) { return cached; }\n\n        var size, dummy = zen('div').bottom('#g5-container');\n        dummy.style({\n            width: 100,\n            height: 100,\n            overflow: 'scroll',\n            position: 'absolute',\n            zIndex: -9999\n        });\n\n        size = dummy[0].offsetWidth - dummy[0].clientWidth;\n        dummy.remove();\n\n        cached = size;\n        return size;\n    };\n\nmodule.exports = getScrollbarWidth;\n","\"use strict\";\n\nvar $        = require('elements'),\n    domready = require('elements/domready');\n\n// Localise Globals\nvar History = {};\n\n// Check Existence\nif (typeof History.Adapter !== 'undefined') {\n    throw new Error('History.js Adapter has already been loaded...');\n}\n\n// Add the Adapter\nHistory.Adapter = {\n    /**\n     * History.Adapter.bind(el,event,callback)\n     * @param {Element|string} el\n     * @param {string} event - custom and standard events\n     * @param {function} callback\n     * @return {void}\n     */\n    bind: function(el, event, callback) {\n        $(el).on(event, callback);\n    },\n\n    /**\n     * History.Adapter.trigger(el,event)\n     * @param {Element|string} el\n     * @param {string} event - custom and standard events\n     * @param {Object=} extra - a object of extra event data (optional)\n     * @return void\n     */\n    trigger: function(el, event, extra) {\n        $(el).emit(event, extra);\n    },\n\n    /**\n     * History.Adapter.extractEventData(key,event,extra)\n     * @param {string} key - key for the event data to extract\n     * @param {string} event - custom and standard events\n     */\n    extractEventData: function(key, event) {\n        // MooTools Native then MooTools Custom\n        return (event && event.event && event.event[key]) || (event && event[key]) || undefined;\n    },\n\n    /**\n     * History.Adapter.onDomLoad(callback)\n     * @param {function} callback\n     * @return {void}\n     */\n    onDomLoad: function(callback) {\n        domready(callback);\n    }\n};\n\n// Try and Initialise History\nif (typeof History.init !== 'undefined') {\n    History.init();\n}\n\nmodule.exports = History;","\"use strict\";\n\n// ========================================================================\n// Initialise\n\n// Localise Globals\nvar\n    console        = window.console || undefined, // Prevent a JSLint complain\n    document       = window.document, // Make sure we are using the correct document\n    navigator      = window.navigator, // Make sure we are using the correct navigator\n    sessionStorage = false, // sessionStorage\n    setTimeout     = window.setTimeout,\n    clearTimeout   = window.clearTimeout,\n    setInterval    = window.setInterval,\n    clearInterval  = window.clearInterval,\n    JSON           = window.JSON,\n    alert          = window.alert,\n    History        = window.History = require('./history-adapter') || {}, // Public History Object\n    history        = window.history; // Old History Object\n\ntry {\n    sessionStorage = window.sessionStorage; // This will throw an exception in some browsers when cookies/localStorage are explicitly disabled (i.e. Chrome)\n    sessionStorage.setItem('TEST', '1');\n    sessionStorage.removeItem('TEST');\n} catch (e) {\n    sessionStorage = false;\n}\n\n// MooTools Compatibility\nJSON.stringify = JSON.stringify || JSON.encode;\nJSON.parse = JSON.parse || JSON.decode;\n\n// Check Existence\nif (typeof History.init === 'undefined') {\n\n    // Initialise History\n    History.init = function (options) {\n        // Check Load Status of Adapter\n        if (typeof History.Adapter === 'undefined') {\n            return false;\n        }\n\n        // Check Load Status of Core\n        if (typeof History.initCore !== 'undefined') {\n            History.initCore();\n        }\n\n        // Check Load Status of HTML4 Support\n        if (typeof History.initHtml4 !== 'undefined') {\n            History.initHtml4();\n        }\n\n        // Return true\n        return true;\n    };\n\n\n    // ========================================================================\n    // Initialise Core\n\n    // Initialise Core\n    History.initCore = function (options) {\n        // Initialise\n        if (typeof History.initCore.initialized !== 'undefined') {\n            // Already Loaded\n            return false;\n        }\n        else {\n            History.initCore.initialized = true;\n        }\n\n\n        // ====================================================================\n        // Options\n\n        /**\n         * History.options\n         * Configurable options\n         */\n        History.options = History.options || {};\n\n        /**\n         * History.options.hashChangeInterval\n         * How long should the interval be before hashchange checks\n         */\n        History.options.hashChangeInterval = History.options.hashChangeInterval || 100;\n\n        /**\n         * History.options.safariPollInterval\n         * How long should the interval be before safari poll checks\n         */\n        History.options.safariPollInterval = History.options.safariPollInterval || 500;\n\n        /**\n         * History.options.doubleCheckInterval\n         * How long should the interval be before we perform a double check\n         */\n        History.options.doubleCheckInterval = History.options.doubleCheckInterval || 500;\n\n        /**\n         * History.options.disableSuid\n         * Force History not to append suid\n         */\n        History.options.disableSuid = History.options.disableSuid || false;\n\n        /**\n         * History.options.storeInterval\n         * How long should we wait between store calls\n         */\n        History.options.storeInterval = History.options.storeInterval || 1000;\n\n        /**\n         * History.options.busyDelay\n         * How long should we wait between busy events\n         */\n        History.options.busyDelay = History.options.busyDelay || 250;\n\n        /**\n         * History.options.debug\n         * If true will enable debug messages to be logged\n         */\n        History.options.debug = History.options.debug || false;\n\n        /**\n         * History.options.initialTitle\n         * What is the title of the initial state\n         */\n        History.options.initialTitle = History.options.initialTitle || document.title;\n\n        /**\n         * History.options.html4Mode\n         * If true, will force HTMl4 mode (hashtags)\n         */\n        History.options.html4Mode = History.options.html4Mode || false;\n\n        /**\n         * History.options.delayInit\n         * Want to override default options and call init manually.\n         */\n        History.options.delayInit = History.options.delayInit || false;\n\n\n        // ====================================================================\n        // Interval record\n\n        /**\n         * History.intervalList\n         * List of intervals set, to be cleared when document is unloaded.\n         */\n        History.intervalList = [];\n\n        /**\n         * History.clearAllIntervals\n         * Clears all setInterval instances.\n         */\n        History.clearAllIntervals = function () {\n            var i, il = History.intervalList;\n            if (typeof il !== \"undefined\" && il !== null) {\n                for (i = 0; i < il.length; i++) {\n                    clearInterval(il[i]);\n                }\n                History.intervalList = null;\n            }\n        };\n\n\n        // ====================================================================\n        // Debug\n\n        /**\n         * History.debug(message,...)\n         * Logs the passed arguments if debug enabled\n         */\n        History.debug = function () {\n            if ((History.options.debug || false)) {\n                History.log.apply(History, arguments);\n            }\n        };\n\n        /**\n         * History.log(message,...)\n         * Logs the passed arguments\n         */\n        History.log = function () {\n            // Prepare\n            var\n                consoleExists = !(typeof console === 'undefined' || typeof console.log === 'undefined' || typeof console.log.apply === 'undefined'),\n                textarea = document.getElementById('log'),\n                message,\n                i, n,\n                args, arg\n                ;\n\n            // Write to Console\n            if (consoleExists) {\n                args = Array.prototype.slice.call(arguments);\n                message = args.shift();\n                if (typeof console.debug !== 'undefined') {\n                    console.debug.apply(console, [message, args]);\n                }\n                else {\n                    console.log.apply(console, [message, args]);\n                }\n            }\n            else {\n                message = (\"\\n\" + arguments[0] + \"\\n\");\n            }\n\n            // Write to log\n            for (i = 1, n = arguments.length; i < n; ++i) {\n                arg = arguments[i];\n                if (typeof arg === 'object' && typeof JSON !== 'undefined') {\n                    try {\n                        arg = JSON.stringify(arg);\n                    }\n                    catch (Exception) {\n                        // Recursive Object\n                    }\n                }\n                message += \"\\n\" + arg + \"\\n\";\n            }\n\n            // Textarea\n            if (textarea) {\n                textarea.value += message + \"\\n-----\\n\";\n                textarea.scrollTop = textarea.scrollHeight - textarea.clientHeight;\n            }\n            // No Textarea, No Console\n            else if (!consoleExists) {\n                alert(message);\n            }\n\n            // Return true\n            return true;\n        };\n\n\n        // ====================================================================\n        // Emulated Status\n\n        /**\n         * History.getInternetExplorerMajorVersion()\n         * Get's the major version of Internet Explorer\n         * @return {integer}\n         * @license Public Domain\n         * @author Benjamin Arthur Lupton <contact@balupton.com>\n         * @author James Padolsey <https://gist.github.com/527683>\n         */\n        History.getInternetExplorerMajorVersion = function () {\n            var result = History.getInternetExplorerMajorVersion.cached =\n                    (typeof History.getInternetExplorerMajorVersion.cached !== 'undefined')\n                        ? History.getInternetExplorerMajorVersion.cached\n                        : (function () {\n                        var v = 3,\n                            div = document.createElement('div'),\n                            all = div.getElementsByTagName('i');\n                        while ((div.innerHTML = '<!--[if gt IE ' + (++v) + ']><i></i><![endif]-->') && all[0]) {\n                        }\n                        return (v > 4) ? v : false;\n                    })()\n                ;\n            return result;\n        };\n\n        /**\n         * History.isInternetExplorer()\n         * Are we using Internet Explorer?\n         * @return {boolean}\n         * @license Public Domain\n         * @author Benjamin Arthur Lupton <contact@balupton.com>\n         */\n        History.isInternetExplorer = function () {\n            var result =\n                    History.isInternetExplorer.cached =\n                        (typeof History.isInternetExplorer.cached !== 'undefined')\n                            ? History.isInternetExplorer.cached\n                            : Boolean(History.getInternetExplorerMajorVersion())\n                ;\n            return result;\n        };\n\n        /**\n         * History.emulated\n         * Which features require emulating?\n         */\n\n        if (History.options.html4Mode) {\n            History.emulated = {\n                pushState: true,\n                hashChange: true\n            };\n        }\n\n        else {\n\n            History.emulated = {\n                pushState: !Boolean(\n                    window.history && window.history.pushState && window.history.replaceState\n                    && !(\n                    (/ Mobile\\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i).test(navigator.userAgent) /* disable for versions of iOS before version 4.3 (8F190) */\n                    || (/AppleWebKit\\/5([0-2]|3[0-2])/i).test(navigator.userAgent) /* disable for the mercury iOS browser, or at least older versions of the webkit engine */\n                    )\n                ),\n                hashChange: Boolean(\n                    !(('onhashchange' in window) || ('onhashchange' in document))\n                    ||\n                    (History.isInternetExplorer() && History.getInternetExplorerMajorVersion() < 8)\n                )\n            };\n        }\n\n        /**\n         * History.enabled\n         * Is History enabled?\n         */\n        History.enabled = !History.emulated.pushState;\n\n        /**\n         * History.bugs\n         * Which bugs are present\n         */\n        History.bugs = {\n            /**\n             * Safari 5 and Safari iOS 4 fail to return to the correct state once a hash is replaced by a `replaceState` call\n             * https://bugs.webkit.org/show_bug.cgi?id=56249\n             */\n            setHash: Boolean(!History.emulated.pushState && navigator.vendor === 'Apple Computer, Inc.' && /AppleWebKit\\/5([0-2]|3[0-3])/.test(navigator.userAgent)),\n\n            /**\n             * Safari 5 and Safari iOS 4 sometimes fail to apply the state change under busy conditions\n             * https://bugs.webkit.org/show_bug.cgi?id=42940\n             */\n            safariPoll: Boolean(!History.emulated.pushState && navigator.vendor === 'Apple Computer, Inc.' && /AppleWebKit\\/5([0-2]|3[0-3])/.test(navigator.userAgent)),\n\n            /**\n             * MSIE 6 and 7 sometimes do not apply a hash even it was told to (requiring a second call to the apply function)\n             */\n            ieDoubleCheck: Boolean(History.isInternetExplorer() && History.getInternetExplorerMajorVersion() < 8),\n\n            /**\n             * MSIE 6 requires the entire hash to be encoded for the hashes to trigger the onHashChange event\n             */\n            hashEscape: Boolean(History.isInternetExplorer() && History.getInternetExplorerMajorVersion() < 7)\n        };\n\n        /**\n         * History.isEmptyObject(obj)\n         * Checks to see if the Object is Empty\n         * @param {Object} obj\n         * @return {boolean}\n         */\n        History.isEmptyObject = function (obj) {\n            for (var name in obj) {\n                if (obj.hasOwnProperty(name)) {\n                    return false;\n                }\n            }\n            return true;\n        };\n\n        /**\n         * History.cloneObject(obj)\n         * Clones a object and eliminate all references to the original contexts\n         * @param {Object} obj\n         * @return {Object}\n         */\n        History.cloneObject = function (obj) {\n            var hash, newObj;\n            if (obj) {\n                hash = JSON.stringify(obj);\n                newObj = JSON.parse(hash);\n            }\n            else {\n                newObj = {};\n            }\n            return newObj;\n        };\n\n\n        // ====================================================================\n        // URL Helpers\n\n        /**\n         * History.getRootUrl()\n         * Turns \"http://mysite.com/dir/page.html?asd\" into \"http://mysite.com\"\n         * @return {String} rootUrl\n         */\n        History.getRootUrl = function () {\n            // Create\n            var rootUrl = document.location.protocol + '//' + (document.location.hostname || document.location.host);\n            if (document.location.port || false) {\n                rootUrl += ':' + document.location.port;\n            }\n            rootUrl += '/';\n\n            // Return\n            return rootUrl;\n        };\n\n        /**\n         * History.getBaseHref()\n         * Fetches the `href` attribute of the `<base href=\"...\">` element if it exists\n         * @return {String} baseHref\n         */\n        History.getBaseHref = function () {\n            // Create\n            var\n                baseElements = document.getElementsByTagName('base'),\n                baseElement = null,\n                baseHref = '';\n\n            // Test for Base Element\n            if (baseElements.length === 1) {\n                // Prepare for Base Element\n                baseElement = baseElements[0];\n                baseHref = baseElement.href.replace(/[^\\/]+$/, '');\n            }\n\n            // Adjust trailing slash\n            baseHref = baseHref.replace(/\\/+$/, '');\n            if (baseHref) baseHref += '/';\n\n            // Return\n            return baseHref;\n        };\n\n        /**\n         * History.getBaseUrl()\n         * Fetches the baseHref or basePageUrl or rootUrl (whichever one exists first)\n         * @return {String} baseUrl\n         */\n        History.getBaseUrl = function () {\n            // Create\n            var baseUrl = History.getBaseHref() || History.getBasePageUrl() || History.getRootUrl();\n\n            // Return\n            return baseUrl;\n        };\n\n        /**\n         * History.getPageUrl()\n         * Fetches the URL of the current page\n         * @return {String} pageUrl\n         */\n        History.getPageUrl = function () {\n            // Fetch\n            var\n                State = History.getState(false, false),\n                stateUrl = (State || {}).url || History.getLocationHref(),\n                pageUrl;\n\n            // Create\n            pageUrl = stateUrl.replace(/\\/+$/, '').replace(/[^\\/]+$/, function (part, index, string) {\n                return (/\\./).test(part) ? part : part + '/';\n            });\n\n            // Return\n            return pageUrl;\n        };\n\n        /**\n         * History.getBasePageUrl()\n         * Fetches the Url of the directory of the current page\n         * @return {String} basePageUrl\n         */\n        History.getBasePageUrl = function () {\n            // Create\n            var basePageUrl = (History.getLocationHref()).replace(/[#\\?].*/, '').replace(/[^\\/]+$/, function (part, index, string) {\n                    return (/[^\\/]$/).test(part) ? '' : part;\n                }).replace(/\\/+$/, '') + '/';\n\n            // Return\n            return basePageUrl;\n        };\n\n        /**\n         * History.getFullUrl(url)\n         * Ensures that we have an absolute URL and not a relative URL\n         * @param {string} url\n         * @param {Boolean} allowBaseHref\n         * @return {string} fullUrl\n         */\n        History.getFullUrl = function (url, allowBaseHref) {\n            // Prepare\n            var fullUrl = url, firstChar = url.substring(0, 1);\n            allowBaseHref = (typeof allowBaseHref === 'undefined') ? true : allowBaseHref;\n\n            // Check\n            if (/[a-z]+\\:\\/\\//.test(url)) {\n                // Full URL\n            }\n            else if (firstChar === '/') {\n                // Root URL\n                fullUrl = History.getRootUrl() + url.replace(/^\\/+/, '');\n            }\n            else if (firstChar === '#') {\n                // Anchor URL\n                fullUrl = History.getPageUrl().replace(/#.*/, '') + url;\n            }\n            else if (firstChar === '?') {\n                // Query URL\n                fullUrl = History.getPageUrl().replace(/[\\?#].*/, '') + url;\n            }\n            else {\n                // Relative URL\n                if (allowBaseHref) {\n                    fullUrl = History.getBaseUrl() + url.replace(/^(\\.\\/)+/, '');\n                } else {\n                    fullUrl = History.getBasePageUrl() + url.replace(/^(\\.\\/)+/, '');\n                }\n                // We have an if condition above as we do not want hashes\n                // which are relative to the baseHref in our URLs\n                // as if the baseHref changes, then all our bookmarks\n                // would now point to different locations\n                // whereas the basePageUrl will always stay the same\n            }\n\n            // Return\n            return fullUrl.replace(/\\#$/, '');\n        };\n\n        /**\n         * History.getShortUrl(url)\n         * Ensures that we have a relative URL and not a absolute URL\n         * @param {string} url\n         * @return {string} url\n         */\n        History.getShortUrl = function (url) {\n            // Prepare\n            var shortUrl = url, baseUrl = History.getBaseUrl(), rootUrl = History.getRootUrl();\n\n            // Trim baseUrl\n            if (History.emulated.pushState) {\n                // We are in a if statement as when pushState is not emulated\n                // The actual url these short urls are relative to can change\n                // So within the same session, we the url may end up somewhere different\n                shortUrl = shortUrl.replace(baseUrl, '');\n            }\n\n            // Trim rootUrl\n            shortUrl = shortUrl.replace(rootUrl, '/');\n\n            // Ensure we can still detect it as a state\n            if (History.isTraditionalAnchor(shortUrl)) {\n                shortUrl = './' + shortUrl;\n            }\n\n            // Clean It\n            shortUrl = shortUrl.replace(/^(\\.\\/)+/g, './').replace(/\\#$/, '');\n\n            // Return\n            return shortUrl;\n        };\n\n        /**\n         * History.getLocationHref(document)\n         * Returns a normalized version of document.location.href\n         * accounting for browser inconsistencies, etc.\n         *\n         * This URL will be URI-encoded and will include the hash\n         *\n         * @param {object} document\n         * @return {string} url\n         */\n        History.getLocationHref = function (doc) {\n            doc = doc || document;\n\n            // most of the time, this will be true\n            if (doc.URL === doc.location.href)\n                return doc.location.href;\n\n            // some versions of webkit URI-decode document.location.href\n            // but they leave document.URL in an encoded state\n            if (doc.location.href === decodeURIComponent(doc.URL))\n                return doc.URL;\n\n            // FF 3.6 only updates document.URL when a page is reloaded\n            // document.location.href is updated correctly\n            if (doc.location.hash && decodeURIComponent(doc.location.href.replace(/^[^#]+/, \"\")) === doc.location.hash)\n                return doc.location.href;\n\n            if (doc.URL.indexOf('#') == -1 && doc.location.href.indexOf('#') != -1)\n                return doc.location.href;\n\n            return doc.URL || doc.location.href;\n        };\n\n\n        // ====================================================================\n        // State Storage\n\n        /**\n         * History.store\n         * The store for all session specific data\n         */\n        History.store = {};\n\n        /**\n         * History.idToState\n         * 1-1: State ID to State Object\n         */\n        History.idToState = History.idToState || {};\n\n        /**\n         * History.stateToId\n         * 1-1: State String to State ID\n         */\n        History.stateToId = History.stateToId || {};\n\n        /**\n         * History.urlToId\n         * 1-1: State URL to State ID\n         */\n        History.urlToId = History.urlToId || {};\n\n        /**\n         * History.storedStates\n         * Store the states in an array\n         */\n        History.storedStates = History.storedStates || [];\n\n        /**\n         * History.savedStates\n         * Saved the states in an array\n         */\n        History.savedStates = History.savedStates || [];\n\n        /**\n         * History.noramlizeStore()\n         * Noramlize the store by adding necessary values\n         */\n        History.normalizeStore = function () {\n            History.store.idToState = History.store.idToState || {};\n            History.store.urlToId = History.store.urlToId || {};\n            History.store.stateToId = History.store.stateToId || {};\n        };\n\n        /**\n         * History.getState()\n         * Get an object containing the data, title and url of the current state\n         * @param {Boolean} friendly\n         * @param {Boolean} create\n         * @return {Object} State\n         */\n        History.getState = function (friendly, create) {\n            // Prepare\n            if (typeof friendly === 'undefined') {\n                friendly = true;\n            }\n            if (typeof create === 'undefined') {\n                create = true;\n            }\n\n            // Fetch\n            var State = History.getLastSavedState();\n\n            // Create\n            if (!State && create) {\n                State = History.createStateObject();\n            }\n\n            // Adjust\n            if (friendly) {\n                State = History.cloneObject(State);\n                State.url = State.cleanUrl || State.url;\n            }\n\n            // Return\n            return State;\n        };\n\n        /**\n         * History.getIdByState(State)\n         * Gets a ID for a State\n         * @param {State} newState\n         * @return {String} id\n         */\n        History.getIdByState = function (newState) {\n\n            // Fetch ID\n            var id = History.extractId(newState.url),\n                str;\n\n            if (!id) {\n                // Find ID via State String\n                str = History.getStateString(newState);\n                if (typeof History.stateToId[str] !== 'undefined') {\n                    id = History.stateToId[str];\n                }\n                else if (typeof History.store.stateToId[str] !== 'undefined') {\n                    id = History.store.stateToId[str];\n                }\n                else {\n                    // Generate a new ID\n                    while (true) {\n                        id = (new Date()).getTime() + String(Math.random()).replace(/\\D/g, '');\n                        if (typeof History.idToState[id] === 'undefined' && typeof History.store.idToState[id] === 'undefined') {\n                            break;\n                        }\n                    }\n\n                    // Apply the new State to the ID\n                    History.stateToId[str] = id;\n                    History.idToState[id] = newState;\n                }\n            }\n\n            // Return ID\n            return id;\n        };\n\n        /**\n         * History.normalizeState(State)\n         * Expands a State Object\n         * @param {object} State\n         * @return {object}\n         */\n        History.normalizeState = function (oldState) {\n            // Variables\n            var newState, dataNotEmpty;\n\n            // Prepare\n            if (!oldState || (typeof oldState !== 'object')) {\n                oldState = {};\n            }\n\n            // Check\n            if (typeof oldState.normalized !== 'undefined') {\n                return oldState;\n            }\n\n            // Adjust\n            if (!oldState.data || (typeof oldState.data !== 'object')) {\n                oldState.data = {};\n            }\n\n            // ----------------------------------------------------------------\n\n            // Create\n            newState = {};\n            newState.normalized = true;\n            newState.title = oldState.title || '';\n            newState.url = History.getFullUrl(oldState.url ? oldState.url : (History.getLocationHref()));\n            newState.hash = History.getShortUrl(newState.url);\n            newState.data = History.cloneObject(oldState.data);\n\n            // Fetch ID\n            newState.id = History.getIdByState(newState);\n\n            // ----------------------------------------------------------------\n\n            // Clean the URL\n            newState.cleanUrl = newState.url.replace(/\\??\\&_suid.*/, '');\n            newState.url = newState.cleanUrl;\n\n            // Check to see if we have more than just a url\n            dataNotEmpty = !History.isEmptyObject(newState.data);\n\n            // Apply\n            if ((newState.title || dataNotEmpty) && History.options.disableSuid !== true) {\n                // Add ID to Hash\n                newState.hash = History.getShortUrl(newState.url).replace(/\\??\\&_suid.*/, '');\n                if (!/\\?/.test(newState.hash)) {\n                    newState.hash += '?';\n                }\n                newState.hash += '&_suid=' + newState.id;\n            }\n\n            // Create the Hashed URL\n            newState.hashedUrl = History.getFullUrl(newState.hash);\n\n            // ----------------------------------------------------------------\n\n            // Update the URL if we have a duplicate\n            if ((History.emulated.pushState || History.bugs.safariPoll) && History.hasUrlDuplicate(newState)) {\n                newState.url = newState.hashedUrl;\n            }\n\n            // ----------------------------------------------------------------\n\n            // Return\n            return newState;\n        };\n\n        /**\n         * History.createStateObject(data,title,url)\n         * Creates a object based on the data, title and url state params\n         * @param {object} data\n         * @param {string} title\n         * @param {string} url\n         * @return {object}\n         */\n        History.createStateObject = function (data, title, url) {\n            // Hashify\n            var State = {\n                'data': data,\n                'title': title,\n                'url': url\n            };\n\n            // Expand the State\n            State = History.normalizeState(State);\n\n            // Return object\n            return State;\n        };\n\n        /**\n         * History.getStateById(id)\n         * Get a state by it's UID\n         * @param {String} id\n         */\n        History.getStateById = function (id) {\n            // Prepare\n            id = String(id);\n\n            // Retrieve\n            var State = History.idToState[id] || History.store.idToState[id] || undefined;\n\n            // Return State\n            return State;\n        };\n\n        /**\n         * Get a State's String\n         * @param {State} passedState\n         */\n        History.getStateString = function (passedState) {\n            // Prepare\n            var State, cleanedState, str;\n\n            // Fetch\n            State = History.normalizeState(passedState);\n\n            // Clean\n            cleanedState = {\n                data: State.data,\n                title: passedState.title,\n                url: passedState.url\n            };\n\n            // Fetch\n            str = JSON.stringify(cleanedState);\n\n            // Return\n            return str;\n        };\n\n        /**\n         * Get a State's ID\n         * @param {State} passedState\n         * @return {String} id\n         */\n        History.getStateId = function (passedState) {\n            // Prepare\n            var State, id;\n\n            // Fetch\n            State = History.normalizeState(passedState);\n\n            // Fetch\n            id = State.id;\n\n            // Return\n            return id;\n        };\n\n        /**\n         * History.getHashByState(State)\n         * Creates a Hash for the State Object\n         * @param {State} passedState\n         * @return {String} hash\n         */\n        History.getHashByState = function (passedState) {\n            // Prepare\n            var State, hash;\n\n            // Fetch\n            State = History.normalizeState(passedState);\n\n            // Hash\n            hash = State.hash;\n\n            // Return\n            return hash;\n        };\n\n        /**\n         * History.extractId(url_or_hash)\n         * Get a State ID by it's URL or Hash\n         * @param {string} url_or_hash\n         * @return {string} id\n         */\n        History.extractId = function (url_or_hash) {\n            // Prepare\n            var id, parts, url, tmp;\n\n            // Extract\n\n            // If the URL has a #, use the id from before the #\n            if (url_or_hash.indexOf('#') != -1) {\n                tmp = url_or_hash.split(\"#\")[0];\n            }\n            else {\n                tmp = url_or_hash;\n            }\n\n            parts = /(.*)\\&_suid=([0-9]+)$/.exec(tmp);\n            url = parts ? (parts[1] || url_or_hash) : url_or_hash;\n            id = parts ? String(parts[2] || '') : '';\n\n            // Return\n            return id || false;\n        };\n\n        /**\n         * History.isTraditionalAnchor\n         * Checks to see if the url is a traditional anchor or not\n         * @param {String} url_or_hash\n         * @return {Boolean}\n         */\n        History.isTraditionalAnchor = function (url_or_hash) {\n            // Check\n            var isTraditional = !(/[\\/\\?\\.]/.test(url_or_hash));\n\n            // Return\n            return isTraditional;\n        };\n\n        /**\n         * History.extractState\n         * Get a State by it's URL or Hash\n         * @param {String} url_or_hash\n         * @return {State|null}\n         */\n        History.extractState = function (url_or_hash, create) {\n            // Prepare\n            var State = null, id, url;\n            create = create || false;\n\n            // Fetch SUID\n            id = History.extractId(url_or_hash);\n            if (id) {\n                State = History.getStateById(id);\n            }\n\n            // Fetch SUID returned no State\n            if (!State) {\n                // Fetch URL\n                url = History.getFullUrl(url_or_hash);\n\n                // Check URL\n                id = History.getIdByUrl(url) || false;\n                if (id) {\n                    State = History.getStateById(id);\n                }\n\n                // Create State\n                if (!State && create && !History.isTraditionalAnchor(url_or_hash)) {\n                    State = History.createStateObject(null, null, url);\n                }\n            }\n\n            // Return\n            return State;\n        };\n\n        /**\n         * History.getIdByUrl()\n         * Get a State ID by a State URL\n         */\n        History.getIdByUrl = function (url) {\n            // Fetch\n            var id = History.urlToId[url] || History.store.urlToId[url] || undefined;\n\n            // Return\n            return id;\n        };\n\n        /**\n         * History.getLastSavedState()\n         * Get an object containing the data, title and url of the current state\n         * @return {Object} State\n         */\n        History.getLastSavedState = function () {\n            return History.savedStates[History.savedStates.length - 1] || undefined;\n        };\n\n        /**\n         * History.getLastStoredState()\n         * Get an object containing the data, title and url of the current state\n         * @return {Object} State\n         */\n        History.getLastStoredState = function () {\n            return History.storedStates[History.storedStates.length - 1] || undefined;\n        };\n\n        /**\n         * History.hasUrlDuplicate\n         * Checks if a Url will have a url conflict\n         * @param {Object} newState\n         * @return {Boolean} hasDuplicate\n         */\n        History.hasUrlDuplicate = function (newState) {\n            // Prepare\n            var hasDuplicate = false,\n                oldState;\n\n            // Fetch\n            oldState = History.extractState(newState.url);\n\n            // Check\n            hasDuplicate = oldState && oldState.id !== newState.id;\n\n            // Return\n            return hasDuplicate;\n        };\n\n        /**\n         * History.storeState\n         * Store a State\n         * @param {Object} newState\n         * @return {Object} newState\n         */\n        History.storeState = function (newState) {\n            // Store the State\n            History.urlToId[newState.url] = newState.id;\n\n            // Push the State\n            History.storedStates.push(History.cloneObject(newState));\n\n            // Return newState\n            return newState;\n        };\n\n        /**\n         * History.isLastSavedState(newState)\n         * Tests to see if the state is the last state\n         * @param {Object} newState\n         * @return {boolean} isLast\n         */\n        History.isLastSavedState = function (newState) {\n            // Prepare\n            var isLast = false,\n                newId, oldState, oldId;\n\n            // Check\n            if (History.savedStates.length) {\n                newId = newState.id;\n                oldState = History.getLastSavedState();\n                oldId = oldState.id;\n\n                // Check\n                isLast = (newId === oldId);\n            }\n\n            // Return\n            return isLast;\n        };\n\n        /**\n         * History.saveState\n         * Push a State\n         * @param {Object} newState\n         * @return {boolean} changed\n         */\n        History.saveState = function (newState) {\n            // Check Hash\n            if (History.isLastSavedState(newState)) {\n                return false;\n            }\n\n            // Push the State\n            History.savedStates.push(History.cloneObject(newState));\n\n            // Return true\n            return true;\n        };\n\n        /**\n         * History.getStateByIndex()\n         * Gets a state by the index\n         * @param {integer} index\n         * @return {Object}\n         */\n        History.getStateByIndex = function (index) {\n            // Prepare\n            var State = null;\n\n            // Handle\n            if (typeof index === 'undefined') {\n                // Get the last inserted\n                State = History.savedStates[History.savedStates.length - 1];\n            }\n            else if (index < 0) {\n                // Get from the end\n                State = History.savedStates[History.savedStates.length + index];\n            }\n            else {\n                // Get from the beginning\n                State = History.savedStates[index];\n            }\n\n            // Return State\n            return State;\n        };\n\n        /**\n         * History.getCurrentIndex()\n         * Gets the current index\n         * @return (integer)\n         */\n        History.getCurrentIndex = function () {\n            // Prepare\n            var index = null;\n\n            // No states saved\n            if (History.savedStates.length < 1) {\n                index = 0;\n            }\n            else {\n                index = History.savedStates.length - 1;\n            }\n            return index;\n        };\n\n        // ====================================================================\n        // Hash Helpers\n\n        /**\n         * History.getHash()\n         * @param {Location=} location\n         * Gets the current document hash\n         * Note: unlike location.hash, this is guaranteed to return the escaped hash in all browsers\n         * @return {string}\n         */\n        History.getHash = function (doc) {\n            var url = History.getLocationHref(doc),\n                hash;\n            hash = History.getHashByUrl(url);\n            return hash;\n        };\n\n        /**\n         * History.unescapeHash()\n         * normalize and Unescape a Hash\n         * @param {String} hash\n         * @return {string}\n         */\n        History.unescapeHash = function (hash) {\n            // Prepare\n            var result = History.normalizeHash(hash);\n\n            // Unescape hash\n            result = decodeURIComponent(result);\n\n            // Return result\n            return result;\n        };\n\n        /**\n         * History.normalizeHash()\n         * normalize a hash across browsers\n         * @return {string}\n         */\n        History.normalizeHash = function (hash) {\n            // Prepare\n            var result = hash.replace(/[^#]*#/, '').replace(/#.*/, '');\n\n            // Return result\n            return result;\n        };\n\n        /**\n         * History.setHash(hash)\n         * Sets the document hash\n         * @param {string} hash\n         * @return {History}\n         */\n        History.setHash = function (hash, queue) {\n            // Prepare\n            var State, pageUrl;\n\n            // Handle Queueing\n            if (queue !== false && History.busy()) {\n                // Wait + Push to Queue\n                //History.debug('History.setHash: we must wait', arguments);\n                History.pushQueue({\n                    scope: History,\n                    callback: History.setHash,\n                    args: arguments,\n                    queue: queue\n                });\n                return false;\n            }\n\n            // Log\n            //History.debug('History.setHash: called',hash);\n\n            // Make Busy + Continue\n            History.busy(true);\n\n            // Check if hash is a state\n            State = History.extractState(hash, true);\n            if (State && !History.emulated.pushState) {\n                // Hash is a state so skip the setHash\n                //History.debug('History.setHash: Hash is a state so skipping the hash set with a direct pushState call',arguments);\n\n                // PushState\n                History.pushState(State.data, State.title, State.url, false);\n            }\n            else if (History.getHash() !== hash) {\n                // Hash is a proper hash, so apply it\n\n                // Handle browser bugs\n                if (History.bugs.setHash) {\n                    // Fix Safari Bug https://bugs.webkit.org/show_bug.cgi?id=56249\n\n                    // Fetch the base page\n                    pageUrl = History.getPageUrl();\n\n                    // Safari hash apply\n                    History.pushState(null, null, pageUrl + '#' + hash, false);\n                }\n                else {\n                    // Normal hash apply\n                    document.location.hash = hash;\n                }\n            }\n\n            // Chain\n            return History;\n        };\n\n        /**\n         * History.escape()\n         * normalize and Escape a Hash\n         * @return {string}\n         */\n        History.escapeHash = function (hash) {\n            // Prepare\n            var result = History.normalizeHash(hash);\n\n            // Escape hash\n            result = window.encodeURIComponent(result);\n\n            // IE6 Escape Bug\n            if (!History.bugs.hashEscape) {\n                // Restore common parts\n                result = result\n                    .replace(/\\%21/g, '!')\n                    .replace(/\\%26/g, '&')\n                    .replace(/\\%3D/g, '=')\n                    .replace(/\\%3F/g, '?');\n            }\n\n            // Return result\n            return result;\n        };\n\n        /**\n         * History.getHashByUrl(url)\n         * Extracts the Hash from a URL\n         * @param {string} url\n         * @return {string} url\n         */\n        History.getHashByUrl = function (url) {\n            // Extract the hash\n            var hash = String(url)\n                    .replace(/([^#]*)#?([^#]*)#?(.*)/, '$2')\n                ;\n\n            // Unescape hash\n            hash = History.unescapeHash(hash);\n\n            // Return hash\n            return hash;\n        };\n\n        /**\n         * History.setTitle(title)\n         * Applies the title to the document\n         * @param {State} newState\n         * @return {Boolean}\n         */\n        History.setTitle = function (newState) {\n            // Prepare\n            var title = newState.title,\n                firstState;\n\n            // Initial\n            if (!title) {\n                firstState = History.getStateByIndex(0);\n                if (firstState && firstState.url === newState.url) {\n                    title = firstState.title || History.options.initialTitle;\n                }\n            }\n\n            // Apply\n            try {\n                document.getElementsByTagName('title')[0].innerHTML = title.replace('<', '&lt;').replace('>', '&gt;').replace(' & ', ' &amp; ');\n            }\n            catch (Exception) {\n            }\n            document.title = title;\n\n            // Chain\n            return History;\n        };\n\n\n        // ====================================================================\n        // Queueing\n\n        /**\n         * History.queues\n         * The list of queues to use\n         * First In, First Out\n         */\n        History.queues = [];\n\n        /**\n         * History.busy(value)\n         * @param {boolean} value [optional]\n         * @return {boolean} busy\n         */\n        History.busy = function (value) {\n            // Apply\n            if (typeof value !== 'undefined') {\n                //History.debug('History.busy: changing ['+(History.busy.flag||false)+'] to ['+(value||false)+']', History.queues.length);\n                History.busy.flag = value;\n            }\n            // Default\n            else if (typeof History.busy.flag === 'undefined') {\n                History.busy.flag = false;\n            }\n\n            // Queue\n            if (!History.busy.flag) {\n                // Execute the next item in the queue\n                clearTimeout(History.busy.timeout);\n                var fireNext = function () {\n                    var i, queue, item;\n                    if (History.busy.flag) return;\n                    for (i = History.queues.length - 1; i >= 0; --i) {\n                        queue = History.queues[i];\n                        if (queue.length === 0) continue;\n                        item = queue.shift();\n                        History.fireQueueItem(item);\n                        History.busy.timeout = setTimeout(fireNext, History.options.busyDelay);\n                    }\n                };\n                History.busy.timeout = setTimeout(fireNext, History.options.busyDelay);\n            }\n\n            // Return\n            return History.busy.flag;\n        };\n\n        /**\n         * History.busy.flag\n         */\n        History.busy.flag = false;\n\n        /**\n         * History.fireQueueItem(item)\n         * Fire a Queue Item\n         * @param {Object} item\n         * @return {Mixed} result\n         */\n        History.fireQueueItem = function (item) {\n            return item.callback.apply(item.scope || History, item.args || []);\n        };\n\n        /**\n         * History.pushQueue(callback,args)\n         * Add an item to the queue\n         * @param {Object} item [scope,callback,args,queue]\n         */\n        History.pushQueue = function (item) {\n            // Prepare the queue\n            History.queues[item.queue || 0] = History.queues[item.queue || 0] || [];\n\n            // Add to the queue\n            History.queues[item.queue || 0].push(item);\n\n            // Chain\n            return History;\n        };\n\n        /**\n         * History.queue (item,queue), (func,queue), (func), (item)\n         * Either firs the item now if not busy, or adds it to the queue\n         */\n        History.queue = function (item, queue) {\n            // Prepare\n            if (typeof item === 'function') {\n                item = {\n                    callback: item\n                };\n            }\n            if (typeof queue !== 'undefined') {\n                item.queue = queue;\n            }\n\n            // Handle\n            if (History.busy()) {\n                History.pushQueue(item);\n            } else {\n                History.fireQueueItem(item);\n            }\n\n            // Chain\n            return History;\n        };\n\n        /**\n         * History.clearQueue()\n         * Clears the Queue\n         */\n        History.clearQueue = function () {\n            History.busy.flag = false;\n            History.queues = [];\n            return History;\n        };\n\n\n        // ====================================================================\n        // IE Bug Fix\n\n        /**\n         * History.stateChanged\n         * States whether or not the state has changed since the last double check was initialised\n         */\n        History.stateChanged = false;\n\n        /**\n         * History.doubleChecker\n         * Contains the timeout used for the double checks\n         */\n        History.doubleChecker = false;\n\n        /**\n         * History.doubleCheckComplete()\n         * Complete a double check\n         * @return {History}\n         */\n        History.doubleCheckComplete = function () {\n            // Update\n            History.stateChanged = true;\n\n            // Clear\n            History.doubleCheckClear();\n\n            // Chain\n            return History;\n        };\n\n        /**\n         * History.doubleCheckClear()\n         * Clear a double check\n         * @return {History}\n         */\n        History.doubleCheckClear = function () {\n            // Clear\n            if (History.doubleChecker) {\n                clearTimeout(History.doubleChecker);\n                History.doubleChecker = false;\n            }\n\n            // Chain\n            return History;\n        };\n\n        /**\n         * History.doubleCheck()\n         * Create a double check\n         * @return {History}\n         */\n        History.doubleCheck = function (tryAgain) {\n            // Reset\n            History.stateChanged = false;\n            History.doubleCheckClear();\n\n            // Fix IE6,IE7 bug where calling history.back or history.forward does not actually change the hash (whereas doing it manually does)\n            // Fix Safari 5 bug where sometimes the state does not change: https://bugs.webkit.org/show_bug.cgi?id=42940\n            if (History.bugs.ieDoubleCheck) {\n                // Apply Check\n                History.doubleChecker = setTimeout(\n                    function () {\n                        History.doubleCheckClear();\n                        if (!History.stateChanged) {\n                            //History.debug('History.doubleCheck: State has not yet changed, trying again', arguments);\n                            // Re-Attempt\n                            tryAgain();\n                        }\n                        return true;\n                    },\n                    History.options.doubleCheckInterval\n                );\n            }\n\n            // Chain\n            return History;\n        };\n\n\n        // ====================================================================\n        // Safari Bug Fix\n\n        /**\n         * History.safariStatePoll()\n         * Poll the current state\n         * @return {History}\n         */\n        History.safariStatePoll = function () {\n            // Poll the URL\n\n            // Get the Last State which has the new URL\n            var\n                urlState = History.extractState(History.getLocationHref()),\n                newState;\n\n            // Check for a difference\n            if (!History.isLastSavedState(urlState)) {\n                newState = urlState;\n            }\n            else {\n                return;\n            }\n\n            // Check if we have a state with that url\n            // If not create it\n            if (!newState) {\n                //History.debug('History.safariStatePoll: new');\n                newState = History.createStateObject();\n            }\n\n            // Apply the New State\n            //History.debug('History.safariStatePoll: trigger');\n            History.Adapter.trigger(window, 'popstate');\n\n            // Chain\n            return History;\n        };\n\n\n        // ====================================================================\n        // State Aliases\n\n        /**\n         * History.back(queue)\n         * Send the browser history back one item\n         * @param {Integer} queue [optional]\n         */\n        History.back = function (queue) {\n            //History.debug('History.back: called', arguments);\n\n            // Handle Queueing\n            if (queue !== false && History.busy()) {\n                // Wait + Push to Queue\n                //History.debug('History.back: we must wait', arguments);\n                History.pushQueue({\n                    scope: History,\n                    callback: History.back,\n                    args: arguments,\n                    queue: queue\n                });\n                return false;\n            }\n\n            // Make Busy + Continue\n            History.busy(true);\n\n            // Fix certain browser bugs that prevent the state from changing\n            History.doubleCheck(function () {\n                History.back(false);\n            });\n\n            // Go back\n            history.go(-1);\n\n            // End back closure\n            return true;\n        };\n\n        /**\n         * History.forward(queue)\n         * Send the browser history forward one item\n         * @param {Integer} queue [optional]\n         */\n        History.forward = function (queue) {\n            //History.debug('History.forward: called', arguments);\n\n            // Handle Queueing\n            if (queue !== false && History.busy()) {\n                // Wait + Push to Queue\n                //History.debug('History.forward: we must wait', arguments);\n                History.pushQueue({\n                    scope: History,\n                    callback: History.forward,\n                    args: arguments,\n                    queue: queue\n                });\n                return false;\n            }\n\n            // Make Busy + Continue\n            History.busy(true);\n\n            // Fix certain browser bugs that prevent the state from changing\n            History.doubleCheck(function () {\n                History.forward(false);\n            });\n\n            // Go forward\n            history.go(1);\n\n            // End forward closure\n            return true;\n        };\n\n        /**\n         * History.go(index,queue)\n         * Send the browser history back or forward index times\n         * @param {Integer} queue [optional]\n         */\n        History.go = function (index, queue) {\n            //History.debug('History.go: called', arguments);\n\n            // Prepare\n            var i;\n\n            // Handle\n            if (index > 0) {\n                // Forward\n                for (i = 1; i <= index; ++i) {\n                    History.forward(queue);\n                }\n            }\n            else if (index < 0) {\n                // Backward\n                for (i = -1; i >= index; --i) {\n                    History.back(queue);\n                }\n            }\n            else {\n                throw new Error('History.go: History.go requires a positive or negative integer passed.');\n            }\n\n            // Chain\n            return History;\n        };\n\n\n        // ====================================================================\n        // HTML5 State Support\n\n        // Non-Native pushState Implementation\n        if (History.emulated.pushState) {\n            /*\n             * Provide Skeleton for HTML4 Browsers\n             */\n\n            // Prepare\n            var emptyFunction = function () {};\n            History.pushState = History.pushState || emptyFunction;\n            History.replaceState = History.replaceState || emptyFunction;\n        } // History.emulated.pushState\n\n        // Native pushState Implementation\n        else {\n            /*\n             * Use native HTML5 History API Implementation\n             */\n\n            /**\n             * History.onPopState(event,extra)\n             * Refresh the Current State\n             */\n            History.onPopState = function (event, extra) {\n                // Prepare\n                var stateId = false, newState = false, currentHash, currentState;\n\n                // Reset the double check\n                History.doubleCheckComplete();\n\n                // Check for a Hash, and handle apporiatly\n                currentHash = History.getHash();\n                if (currentHash) {\n                    // Expand Hash\n                    currentState = History.extractState(currentHash || History.getLocationHref(), true);\n                    if (currentState) {\n                        // We were able to parse it, it must be a State!\n                        // Let's forward to replaceState\n                        //History.debug('History.onPopState: state anchor', currentHash, currentState);\n                        History.replaceState(currentState.data, currentState.title, currentState.url, false);\n                    }\n                    else {\n                        // Traditional Anchor\n                        //History.debug('History.onPopState: traditional anchor', currentHash);\n                        History.Adapter.trigger(window, 'anchorchange');\n                        History.busy(false);\n                    }\n\n                    // We don't care for hashes\n                    History.expectedStateId = false;\n                    return false;\n                }\n\n                // Ensure\n                stateId = History.Adapter.extractEventData('state', event, extra) || false;\n\n                // Fetch State\n                if (stateId) {\n                    // Vanilla: Back/forward button was used\n                    newState = History.getStateById(stateId);\n                }\n                else if (History.expectedStateId) {\n                    // Vanilla: A new state was pushed, and popstate was called manually\n                    newState = History.getStateById(History.expectedStateId);\n                }\n                else {\n                    // Initial State\n                    newState = History.extractState(History.getLocationHref());\n                }\n\n                // The State did not exist in our store\n                if (!newState) {\n                    // Regenerate the State\n                    newState = History.createStateObject(null, null, History.getLocationHref());\n                }\n\n                // Clean\n                History.expectedStateId = false;\n\n                // Check if we are the same state\n                if (History.isLastSavedState(newState)) {\n                    // There has been no change (just the page's hash has finally propagated)\n                    //History.debug('History.onPopState: no change', newState, History.savedStates);\n                    History.busy(false);\n                    return false;\n                }\n\n                // Store the State\n                History.storeState(newState);\n                History.saveState(newState);\n\n                // Force update of the title\n                History.setTitle(newState);\n\n                // Fire Our Event\n                History.Adapter.trigger(window, 'statechange');\n                History.busy(false);\n\n                // Return true\n                return true;\n            };\n            History.Adapter.bind(window, 'popstate', History.onPopState);\n\n            /**\n             * History.pushState(data,title,url)\n             * Add a new State to the history object, become it, and trigger onpopstate\n             * We have to trigger for HTML4 compatibility\n             * @param {object} data\n             * @param {string} title\n             * @param {string} url\n             * @return {true}\n             */\n            History.pushState = function (data, title, url, queue) {\n                //History.debug('History.pushState: called', arguments);\n\n                // Check the State\n                if (History.getHashByUrl(url) && History.emulated.pushState) {\n                    throw new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');\n                }\n\n                // Handle Queueing\n                if (queue !== false && History.busy()) {\n                    // Wait + Push to Queue\n                    //History.debug('History.pushState: we must wait', arguments);\n                    History.pushQueue({\n                        scope: History,\n                        callback: History.pushState,\n                        args: arguments,\n                        queue: queue\n                    });\n                    return false;\n                }\n\n                // Make Busy + Continue\n                History.busy(true);\n\n                // Create the newState\n                var newState = History.createStateObject(data, title, url);\n\n                // Check it\n                if (History.isLastSavedState(newState)) {\n                    // Won't be a change\n                    History.busy(false);\n                }\n                else {\n                    // Store the newState\n                    History.storeState(newState);\n                    History.expectedStateId = newState.id;\n\n                    // Push the newState\n                    history.pushState(newState.id, newState.title, newState.url);\n\n                    // Fire HTML5 Event\n                    History.Adapter.trigger(window, 'popstate');\n                }\n\n                // End pushState closure\n                return true;\n            };\n\n            /**\n             * History.replaceState(data,title,url)\n             * Replace the State and trigger onpopstate\n             * We have to trigger for HTML4 compatibility\n             * @param {object} data\n             * @param {string} title\n             * @param {string} url\n             * @return {true}\n             */\n            History.replaceState = function (data, title, url, queue) {\n                //History.debug('History.replaceState: called', arguments);\n\n                // Check the State\n                if (History.getHashByUrl(url) && History.emulated.pushState) {\n                    throw new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');\n                }\n\n                // Handle Queueing\n                if (queue !== false && History.busy()) {\n                    // Wait + Push to Queue\n                    //History.debug('History.replaceState: we must wait', arguments);\n                    History.pushQueue({\n                        scope: History,\n                        callback: History.replaceState,\n                        args: arguments,\n                        queue: queue\n                    });\n                    return false;\n                }\n\n                // Make Busy + Continue\n                History.busy(true);\n\n                // Create the newState\n                var newState = History.createStateObject(data, title, url);\n\n                // Check it\n                if (History.isLastSavedState(newState)) {\n                    // Won't be a change\n                    History.busy(false);\n                }\n                else {\n                    // Store the newState\n                    History.storeState(newState);\n                    History.expectedStateId = newState.id;\n\n                    // Push the newState\n                    history.replaceState(newState.id, newState.title, newState.url);\n\n                    // Fire HTML5 Event\n                    History.Adapter.trigger(window, 'popstate');\n                }\n\n                // End replaceState closure\n                return true;\n            };\n\n        } // !History.emulated.pushState\n\n\n        // ====================================================================\n        // Initialise\n\n        /**\n         * Load the Store\n         */\n        if (sessionStorage) {\n            // Fetch\n            try {\n                History.store = JSON.parse(sessionStorage.getItem('History.store')) || {};\n            }\n            catch (err) {\n                History.store = {};\n            }\n\n            // Normalize\n            History.normalizeStore();\n        }\n        else {\n            // Default Load\n            History.store = {};\n            History.normalizeStore();\n        }\n\n        /**\n         * Clear Intervals on exit to prevent memory leaks\n         */\n        History.Adapter.bind(window, \"unload\", History.clearAllIntervals);\n\n        /**\n         * Create the initial State\n         */\n        History.saveState(History.storeState(History.extractState(History.getLocationHref(), true)));\n\n        /**\n         * Bind for Saving Store\n         */\n        if (sessionStorage) {\n            // When the page is closed\n            History.onUnload = function () {\n                // Prepare\n                var currentStore, item, currentStoreString;\n\n                // Fetch\n                try {\n                    currentStore = JSON.parse(sessionStorage.getItem('History.store')) || {};\n                }\n                catch (err) {\n                    currentStore = {};\n                }\n\n                // Ensure\n                currentStore.idToState = currentStore.idToState || {};\n                currentStore.urlToId = currentStore.urlToId || {};\n                currentStore.stateToId = currentStore.stateToId || {};\n\n                // Sync\n                for (item in History.idToState) {\n                    if (!History.idToState.hasOwnProperty(item)) {\n                        continue;\n                    }\n                    currentStore.idToState[item] = History.idToState[item];\n                }\n                for (item in History.urlToId) {\n                    if (!History.urlToId.hasOwnProperty(item)) {\n                        continue;\n                    }\n                    currentStore.urlToId[item] = History.urlToId[item];\n                }\n                for (item in History.stateToId) {\n                    if (!History.stateToId.hasOwnProperty(item)) {\n                        continue;\n                    }\n                    currentStore.stateToId[item] = History.stateToId[item];\n                }\n\n                // Update\n                History.store = currentStore;\n                History.normalizeStore();\n\n                // In Safari, going into Private Browsing mode causes the\n                // Session Storage object to still exist but if you try and use\n                // or set any property/function of it it throws the exception\n                // \"QUOTA_EXCEEDED_ERR: DOM Exception 22: An attempt was made to\n                // add something to storage that exceeded the quota.\" infinitely\n                // every second.\n                currentStoreString = JSON.stringify(currentStore);\n                try {\n                    // Store\n                    sessionStorage.setItem('History.store', currentStoreString);\n                }\n                catch (e) {\n                    if (e.code === DOMException.QUOTA_EXCEEDED_ERR) {\n                        if (sessionStorage.length) {\n                            // Workaround for a bug seen on iPads. Sometimes the quota exceeded error comes up and simply\n                            // removing/resetting the storage can work.\n                            sessionStorage.removeItem('History.store');\n                            sessionStorage.setItem('History.store', currentStoreString);\n                        } else {\n                            // Otherwise, we're probably private browsing in Safari, so we'll ignore the exception.\n                        }\n                    } else {\n                        throw e;\n                    }\n                }\n            };\n\n            // For Internet Explorer\n            History.isInternetExplorer() && History.intervalList.push(setInterval(History.onUnload, History.options.storeInterval));\n\n            // For Other Browsers\n            History.Adapter.bind(window, 'beforeunload', History.onUnload);\n            History.Adapter.bind(window, 'unload', History.onUnload);\n\n            // Both are enabled for consistency\n        }\n\n        // Non-Native pushState Implementation\n        if (!History.emulated.pushState) {\n            // Be aware, the following is only for native pushState implementations\n            // If you are wanting to include something for all browsers\n            // Then include it above this if block\n\n            /**\n             * Setup Safari Fix\n             */\n            if (History.bugs.safariPoll) {\n                History.intervalList.push(setInterval(History.safariStatePoll, History.options.safariPollInterval));\n            }\n\n            /**\n             * Ensure Cross Browser Compatibility\n             */\n            if (navigator.vendor === 'Apple Computer, Inc.' || (navigator.appCodeName || '') === 'Mozilla') {\n                /**\n                 * Fix Safari HashChange Issue\n                 */\n\n                    // Setup Alias\n                History.Adapter.bind(window, 'hashchange', function () {\n                    History.Adapter.trigger(window, 'popstate');\n                });\n\n                // Initialise Alias\n                if (History.getHash()) {\n                    History.Adapter.onDomLoad(function () {\n                        History.Adapter.trigger(window, 'hashchange');\n                    });\n                }\n            }\n\n        } // !History.emulated.pushState\n\n\n    }; // History.initCore\n\n    // Try to Initialise History\n    if (!History.options || !History.options.delayInit) {\n        History.init();\n    }\n}\n\nmodule.exports = History;","(function() {\n    var lastTime = 0;\n    var vendors = ['ms', 'moz', 'webkit', 'o'];\n    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];\n        window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame']\n        || window[vendors[x]+'CancelRequestAnimationFrame'];\n    }\n\n    if (!window.requestAnimationFrame)\n        window.requestAnimationFrame = function(callback, element) {\n            var currTime = new Date().getTime();\n            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n            var id = window.setTimeout(function() { callback(currTime + timeToCall); },\n                timeToCall);\n            lastTime = currTime + timeToCall;\n            return id;\n        };\n\n    if (!window.cancelAnimationFrame)\n        window.cancelAnimationFrame = function(id) {\n            clearTimeout(id);\n        };\n}());\n\nmodule.exports = {};","var prime      = require('prime'),\n    deepClone  = require('mout/lang/deepClone');\n\n//var objectDiff = require('objectdiff');\n\nvar SaveState = new prime({\n\n    constructor: function(session) {\n        session = deepClone(session);\n        this.setSession(session);\n    },\n\n    setSession: function(session) {\n        session = !session ? {}\n            : {\n            time: +(new Date()),\n            data: deepClone(session)\n        };\n\n        this.session = session;\n        return this.session;\n    },\n\n    getTime: function() {\n        return this.session.time;\n    },\n\n    getData: function() {\n        return this.session.data;\n    },\n\n    getSession: function() {\n        return this.session;\n    },\n\n    getDiff: function(data) {\n        // Unsupported at this state\n        return data;\n        /*\n        var diff = objectDiff.diff(this.getData(), data);\n        return {\n            diff: diff,\n            xml: objectDiff.convertToXMLString(diff)\n        };\n        */\n    }\n});\n\nmodule.exports = SaveState;\n","\"use strict\";\n\nvar replace = require('mout/string/replace');\n\nmodule.exports = function(key, replacement) {\n    var G5T = global.G5T || function(key) { return key; };\n    return replace(G5T(key), '%s', replacement || '');\n};","var $ = require('elements');\n\nmodule.exports = function(field) {\n    if (!field) { return false; }\n\n    if ($('body').hasClass('wp-customizer') && jQuery) {\n        var widgetContainer = field.parent('.widget-content'),\n            title = field.siblings('.g-instancepicker-title');\n\n        if (widgetContainer) {\n            var jQueryEvent = jQuery.Event('change');\n            jQueryEvent.target = field[0];\n            jQuery(widgetContainer[0]).trigger(jQueryEvent);\n        }\n\n        if (title) {\n            setTimeout(function(){\n                title.hideIndicator();\n            }, 5);\n        }\n    }\n};","/*\nAgent\n- heavily inspired by superagent by visionmedia https://github.com/visionmedia/superagent, released under the MIT license\n- code derived from MooTools 1.4 Request.js && superagent\n- MIT-License\n*/\"use strict\";\n/* global ActiveXObject */\n\nvar prime   = require(\"prime\"),\n    Emitter = require(\"prime/emitter\")\n\nvar isObject   = require(\"mout/lang/isObject\"),\n    isString   = require(\"mout/lang/isString\"),\n    isArray    = require(\"mout/lang/isArray\"),\n    isFunction = require(\"mout/lang/isFunction\"),\n    trim       = require(\"mout/string/trim\"),\n    upperCase  = require(\"mout/string/upperCase\"),\n    forIn      = require(\"mout/object/forIn\"),\n    mixIn      = require(\"mout/object/mixIn\"),\n    remove     = require(\"mout/array/remove\"),\n    forEach    = require(\"mout/array/forEach\")\n\nvar capitalize = function(str){\n    return str.replace(/\\b[a-z]/g, upperCase)\n}\n\n// MooTools\n\nvar getRequest = (function(){\n\n    var XMLHTTP = function(){\n        return new XMLHttpRequest()\n    }, MSXML2 = function(){\n        return new ActiveXObject(\"MSXML2.XMLHTTP\")\n    }, MSXML = function(){\n        return new ActiveXObject(\"Microsoft.XMLHTTP\")\n    }\n\n    try {\n      XMLHTTP()\n      return XMLHTTP\n    } catch(e){}\n    try {\n        MSXML2()\n        return MSXML2\n    } catch(e){}\n    try {\n        MSXML()\n        return MSXML\n    } catch(e){}\n\n    return null\n\n})()\n\nvar encodeJSON = function(object){\n    if (object == null) return \"\"\n    if (object.toJSON) return object.toJSON()\n    return JSON.stringify(object)\n}\n\n// MooTools\n\nvar encodeQueryString = function(object, base){\n\n    if (object == null) return \"\"\n    if (object.toQueryString) return object.toQueryString()\n\n    var queryString = []\n\n    forIn(object, function(value, key){\n        if (base) key = base + \"[\" + key + \"]\"\n        var result\n\n        if (value == null) return\n\n        if (isArray(value)){\n            var qs = {}\n            for (var i = 0; i < value.length; i++) qs[i] = value[i]\n            result = encodeQueryString(qs, key)\n        } else if (isObject(value)){\n            result = encodeQueryString(value, key)\n        } else {\n            result = key + \"=\" + encodeURIComponent(value)\n        }\n\n        queryString.push(result)\n    })\n\n    return queryString.join(\"&\")\n\n}\n\nvar decodeJSON = JSON.parse\n\n// decodeQueryString by Brian Donovan\n// http://stackoverflow.com/users/549363/brian-donovan\n\nvar decodeQueryString = function(params){\n\n    var pairs  = params.split('&'),\n        result = {}\n\n    for (var i = 0; i < pairs.length; i++){\n\n        var pair      = pairs[i].split('='),\n            key       = decodeURIComponent(pair[0]),\n            value     = decodeURIComponent(pair[1]),\n            isArray   = /\\[\\]$/.test(key),\n            dictMatch = key.match(/^(.+)\\[([^\\]]+)\\]$/)\n\n        if (dictMatch){\n            key = dictMatch[1]\n            var subkey = dictMatch[2]\n\n            result[key] = result[key] || {}\n            result[key][subkey] = value\n        } else if (isArray){\n            key = key.substring(0, key.length - 2)\n            result[key] = result[key] || []\n            result[key].push(value)\n        } else {\n            result[key] = value\n        }\n\n    }\n\n    return result\n\n}\n\nvar encoders = {\n    \"application/json\" : encodeJSON,\n    \"application/x-www-form-urlencoded\" : encodeQueryString\n}\n\nvar decoders = {\n    \"application/json\": decodeJSON,\n    \"application/x-www-form-urlencoded\": decodeQueryString\n}\n\n// parseHeader from superagent\n// https://github.com/visionmedia/superagent\n// MIT\n\nvar parseHeader = function(str){\n    var lines = str.split(/\\r?\\n/), fields = {}\n\n    lines.pop() // trailing CRLF\n\n    for (var i = 0, l = lines.length; i < l; ++i){\n        var line  = lines[i],\n            index = line.indexOf(':'),\n            field = capitalize(line.slice(0, index)),\n            value = trim(line.slice(index + 1))\n\n        fields[field] = value\n    }\n\n    return fields\n}\n\nvar REQUESTS = 0, Q = [] // Queue stuff\n\nvar Request = prime({\n\n    constructor: function Request(){\n        this._header = {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n        }\n    },\n\n    header: function(name, value){\n        if (isObject(name)) for (var key in name) this.header(key, name[key])\n        else if (!arguments.length) return this._header\n        else if (arguments.length === 1) return this._header[capitalize(name)]\n        else if (arguments.length === 2){\n            if (value == null) delete this._header[capitalize(name)]\n            else this._header[capitalize(name)] = value\n        }\n        return this\n    },\n\n    running: function(){\n        return !!this._running\n    },\n\n    abort: function(){\n\n        if (this._queued){\n            remove(Q, this._queued)\n            delete this._queued\n        }\n\n        if (this._xhr){\n            this._xhr.abort()\n            this._end()\n        }\n\n        return this\n    },\n\n    method: function(m){\n        if (!arguments.length) return this._method\n        this._method = m.toUpperCase()\n        return this\n    },\n\n    data: function(d){\n        if (!arguments.length) return this._data\n        this._data = d\n        return this\n    },\n\n    url: function(u){\n        if (!arguments.length) return this._url\n        this._url = u\n        return this\n    },\n\n    user: function(u){\n        if (!arguments.length) return this._user\n        this._user = u\n        return this\n    },\n\n    password: function(p){\n        if (!arguments.length) return this._password\n        this._password = p\n        return this\n    },\n\n    _send: function(method, url, data, header, user, password, callback){\n        var self = this\n\n        if (REQUESTS === agent.MAX_REQUESTS) return Q.unshift(this._queued = function(){\n            delete self._queued\n            self._send(method, url, data, header, user, password, callback)\n        })\n\n        REQUESTS++\n\n        var xhr = this._xhr = agent.getRequest()\n\n        if (xhr.addEventListener) forEach(['progress', 'load', 'error' , 'abort', 'loadend'], function(method){\n            xhr.addEventListener(method, function(event){\n                self.emit(method, event)\n            }, false)\n        })\n\n        xhr.open(method, url, true, user, password)\n        if (user != null && \"withCredentials\" in xhr) xhr.withCredentials = true\n\n        xhr.onreadystatechange = function(){\n            if (xhr.readyState === 4){\n                var status = xhr.status\n                var response = new Response(xhr.responseText, status, parseHeader(xhr.getAllResponseHeaders()))\n                var error = response.error ? new Error(method + \" \" + url + \" \" + status) : null\n                self._end()\n                callback(error, response)\n            }\n        }\n\n        for (var field in header) xhr.setRequestHeader(field, header[field])\n        xhr.send(data || null)\n    },\n\n    _end: function(){\n        this._xhr.onreadystatechange = function(){}\n\n        delete this._xhr\n        delete this._running\n\n        REQUESTS--\n\n        var queued = Q.pop()\n        if (queued) queued()\n    },\n\n    send: function(callback){\n        if (this._running) this.abort()\n        this._running = true\n\n        if (!callback) callback = function(){}\n\n        var method   = this._method || \"POST\",\n            data     = this._data || null,\n            url      = this._url,\n            user     = this._user || null,\n            password = this._password || null\n\n        if (data && !isString(data)){\n            var contentType = this._header['Content-Type'].split(/ *; */).shift(),\n                encode      = encoders[contentType]\n            if (encode) data = encode(data)\n        }\n\n        if (/GET|HEAD/.test(method) && data) url += (url.indexOf(\"?\") > -1 ? \"&\" : \"?\") + data\n\n        var header = mixIn({}, this._header);\n\n        this._send(method, url, data, header, user, password, callback)\n\n        return this\n\n    }\n\n})\n\nRequest.implement(new Emitter)\n\nvar Response = prime({\n\n    constructor: function Response(text, status, header){\n\n        this.text   = text\n        this.status = status\n\n        this.header = header\n\n        // statuses from superagent\n        // https://github.com/visionmedia/superagent\n        // MIT\n\n        var t = status / 100 | 0\n\n        this.info        = t === 1\n        this.ok          = t === 2\n        this.clientError = t === 4\n        this.serverError = t === 5\n        this.error       = t === 4 || t === 5\n        var length = '' + header['Content-Length']\n\n        // sugar\n        this.accepted      = status === 202\n        this.noContent     = length === '0' || status === 204 || status === 1223\n        this.badRequest    = status === 400\n        this.unauthorized  = status === 401\n        this.notAcceptable = status === 406\n        this.notFound      = status === 404\n\n        var contentType = header['Content-Type'] ? header['Content-Type'].split(/ *; */).shift() : '',\n            decode\n\n        if (!this.noContent) decode = decoders[contentType]\n\n        this.body = decode ? decode(this.text) : this.text\n\n    }\n\n})\n\nvar methods  = \"get|post|put|delete|head|patch|options\",\n    rMethods = new RegExp(\"^(\" + methods + \")$\", \"i\")\n\nvar agent = function(method, url, data, callback){\n    var request = new Request()\n\n    if (!arguments.length) return request\n\n    if (!rMethods.test(method)){ // shift\n        callback = data\n        data     = url\n        url      = method\n        method   = \"post\"\n    }\n\n    if (isFunction(data)){\n        callback = data\n        data = null\n    }\n\n    request.method(method)\n\n    if (url) request.url(url)\n    if (data) request.data(data)\n    if (callback) request.send(callback)\n\n    return request\n}\n\nagent.encoder = function(ct, encode){\n    if (arguments.length === 1) return encoders[ct]\n    encoders[ct] = encode\n    return agent\n}\n\nagent.decoder = function(ct, decode){\n    if (arguments.length === 1) return decoders[ct]\n    decoders[ct] = decode\n    return agent\n}\n\nforEach(methods.split(\"|\"), function(method){\n    agent[method] = function(url, data, callback){\n        return agent(method, url, data, callback)\n    }\n})\n\nagent.MAX_REQUESTS = Infinity\nagent.getRequest = getRequest\nagent.Request  = Request\nagent.Response = Response\n\nmodule.exports = agent\n","\n\n    /**\n     * Array forEach\n     */\n    function forEach(arr, callback, thisObj) {\n        if (arr == null) {\n            return;\n        }\n        var i = -1,\n            len = arr.length;\n        while (++i < len) {\n            // we iterate over sparse items since there is no way to make it\n            // work properly on IE 7-8. see #64\n            if ( callback.call(thisObj, arr[i], i, arr) === false ) {\n                break;\n            }\n        }\n    }\n\n    module.exports = forEach;\n\n\n","\n\n    /**\n     * Array.indexOf\n     */\n    function indexOf(arr, item, fromIndex) {\n        fromIndex = fromIndex || 0;\n        if (arr == null) {\n            return -1;\n        }\n\n        var len = arr.length,\n            i = fromIndex < 0 ? len + fromIndex : fromIndex;\n        while (i < len) {\n            // we iterate over sparse items since there is no way to make it\n            // work properly on IE 7-8. see #64\n            if (arr[i] === item) {\n                return i;\n            }\n\n            i++;\n        }\n\n        return -1;\n    }\n\n    module.exports = indexOf;\n\n","var indexOf = require('./indexOf');\n\n    /**\n     * Remove a single item from the array.\n     * (it won't remove duplicates, just a single item)\n     */\n    function remove(arr, item){\n        var idx = indexOf(arr, item);\n        if (idx !== -1) arr.splice(idx, 1);\n    }\n\n    module.exports = remove;\n\n","var mixIn = require('../object/mixIn');\n\n    /**\n     * Create Object using prototypal inheritance and setting custom properties.\n     * - Mix between Douglas Crockford Prototypal Inheritance <http://javascript.crockford.com/prototypal.html> and the EcmaScript 5 `Object.create()` method.\n     * @param {object} parent    Parent Object.\n     * @param {object} [props] Object properties.\n     * @return {object} Created object.\n     */\n    function createObject(parent, props){\n        function F(){}\n        F.prototype = parent;\n        return mixIn(new F(), props);\n\n    }\n    module.exports = createObject;\n\n\n","var isKind = require('./isKind');\n    /**\n     */\n    var isArray = Array.isArray || function (val) {\n        return isKind(val, 'Array');\n    };\n    module.exports = isArray;\n\n","var isKind = require('./isKind');\n    /**\n     */\n    function isFunction(val) {\n        return isKind(val, 'Function');\n    }\n    module.exports = isFunction;\n\n","var kindOf = require('./kindOf');\n    /**\n     * Check if value is from a specific \"kind\".\n     */\n    function isKind(val, kind){\n        return kindOf(val) === kind;\n    }\n    module.exports = isKind;\n\n","var isKind = require('./isKind');\n    /**\n     */\n    function isObject(val) {\n        return isKind(val, 'Object');\n    }\n    module.exports = isObject;\n\n","var isKind = require('./isKind');\n    /**\n     */\n    function isString(val) {\n        return isKind(val, 'String');\n    }\n    module.exports = isString;\n\n","\n\n    var _rKind = /^\\[object (.*)\\]$/,\n        _toString = Object.prototype.toString,\n        UNDEF;\n\n    /**\n     * Gets the \"kind\" of value. (e.g. \"String\", \"Number\", etc)\n     */\n    function kindOf(val) {\n        if (val === null) {\n            return 'Null';\n        } else if (val === UNDEF) {\n            return 'Undefined';\n        } else {\n            return _rKind.exec( _toString.call(val) )[1];\n        }\n    }\n    module.exports = kindOf;\n\n","\n\n    /**\n     * Typecast a value to a String, using an empty string value for null or\n     * undefined.\n     */\n    function toString(val){\n        return val == null ? '' : val.toString();\n    }\n\n    module.exports = toString;\n\n\n","var hasOwn = require('./hasOwn');\n\n    var _hasDontEnumBug,\n        _dontEnums;\n\n    function checkDontEnum(){\n        _dontEnums = [\n                'toString',\n                'toLocaleString',\n                'valueOf',\n                'hasOwnProperty',\n                'isPrototypeOf',\n                'propertyIsEnumerable',\n                'constructor'\n            ];\n\n        _hasDontEnumBug = true;\n\n        for (var key in {'toString': null}) {\n            _hasDontEnumBug = false;\n        }\n    }\n\n    /**\n     * Similar to Array/forEach but works over object properties and fixes Don't\n     * Enum bug on IE.\n     * based on: http://whattheheadsaid.com/2010/10/a-safer-object-keys-compatibility-implementation\n     */\n    function forIn(obj, fn, thisObj){\n        var key, i = 0;\n        // no need to check if argument is a real object that way we can use\n        // it for arrays, functions, date, etc.\n\n        //post-pone check till needed\n        if (_hasDontEnumBug == null) checkDontEnum();\n\n        for (key in obj) {\n            if (exec(fn, obj, key, thisObj) === false) {\n                break;\n            }\n        }\n\n\n        if (_hasDontEnumBug) {\n            var ctor = obj.constructor,\n                isProto = !!ctor && obj === ctor.prototype;\n\n            while (key = _dontEnums[i++]) {\n                // For constructor, if it is a prototype object the constructor\n                // is always non-enumerable unless defined otherwise (and\n                // enumerated above).  For non-prototype objects, it will have\n                // to be defined on this object, since it cannot be defined on\n                // any prototype objects.\n                //\n                // For other [[DontEnum]] properties, check if the value is\n                // different than Object prototype value.\n                if (\n                    (key !== 'constructor' ||\n                        (!isProto && hasOwn(obj, key))) &&\n                    obj[key] !== Object.prototype[key]\n                ) {\n                    if (exec(fn, obj, key, thisObj) === false) {\n                        break;\n                    }\n                }\n            }\n        }\n    }\n\n    function exec(fn, obj, key, thisObj){\n        return fn.call(thisObj, obj[key], key, obj);\n    }\n\n    module.exports = forIn;\n\n\n","var hasOwn = require('./hasOwn');\nvar forIn = require('./forIn');\n\n    /**\n     * Similar to Array/forEach but works over object properties and fixes Don't\n     * Enum bug on IE.\n     * based on: http://whattheheadsaid.com/2010/10/a-safer-object-keys-compatibility-implementation\n     */\n    function forOwn(obj, fn, thisObj){\n        forIn(obj, function(val, key){\n            if (hasOwn(obj, key)) {\n                return fn.call(thisObj, obj[key], key, obj);\n            }\n        });\n    }\n\n    module.exports = forOwn;\n\n\n","\n\n    /**\n     * Safer Object.hasOwnProperty\n     */\n     function hasOwn(obj, prop){\n         return Object.prototype.hasOwnProperty.call(obj, prop);\n     }\n\n     module.exports = hasOwn;\n\n\n","var forOwn = require('./forOwn');\n\n    /**\n    * Combine properties from all the objects into first one.\n    * - This method affects target object in place, if you want to create a new Object pass an empty object as first param.\n    * @param {object} target    Target Object\n    * @param {...object} objects    Objects to be combined (0...n objects).\n    * @return {object} Target Object.\n    */\n    function mixIn(target, objects){\n        var i = 0,\n            n = arguments.length,\n            obj;\n        while(++i < n){\n            obj = arguments[i];\n            if (obj != null) {\n                forOwn(obj, copyProp, target);\n            }\n        }\n        return target;\n    }\n\n    function copyProp(val, key){\n        this[key] = val;\n    }\n\n    module.exports = mixIn;\n\n","\n    /**\n     * Contains all Unicode white-spaces. Taken from\n     * http://en.wikipedia.org/wiki/Whitespace_character.\n     */\n    module.exports = [\n        ' ', '\\n', '\\r', '\\t', '\\f', '\\v', '\\u00A0', '\\u1680', '\\u180E',\n        '\\u2000', '\\u2001', '\\u2002', '\\u2003', '\\u2004', '\\u2005', '\\u2006',\n        '\\u2007', '\\u2008', '\\u2009', '\\u200A', '\\u2028', '\\u2029', '\\u202F',\n        '\\u205F', '\\u3000'\n    ];\n\n","var toString = require('../lang/toString');\nvar WHITE_SPACES = require('./WHITE_SPACES');\n    /**\n     * Remove chars from beginning of string.\n     */\n    function ltrim(str, chars) {\n        str = toString(str);\n        chars = chars || WHITE_SPACES;\n\n        var start = 0,\n            len = str.length,\n            charLen = chars.length,\n            found = true,\n            i, c;\n\n        while (found && start < len) {\n            found = false;\n            i = -1;\n            c = str.charAt(start);\n\n            while (++i < charLen) {\n                if (c === chars[i]) {\n                    found = true;\n                    start++;\n                    break;\n                }\n            }\n        }\n\n        return (start >= len) ? '' : str.substr(start, len);\n    }\n\n    module.exports = ltrim;\n\n","var toString = require('../lang/toString');\nvar WHITE_SPACES = require('./WHITE_SPACES');\n    /**\n     * Remove chars from end of string.\n     */\n    function rtrim(str, chars) {\n        str = toString(str);\n        chars = chars || WHITE_SPACES;\n\n        var end = str.length - 1,\n            charLen = chars.length,\n            found = true,\n            i, c;\n\n        while (found && end >= 0) {\n            found = false;\n            i = -1;\n            c = str.charAt(end);\n\n            while (++i < charLen) {\n                if (c === chars[i]) {\n                    found = true;\n                    end--;\n                    break;\n                }\n            }\n        }\n\n        return (end >= 0) ? str.substring(0, end + 1) : '';\n    }\n\n    module.exports = rtrim;\n\n","var toString = require('../lang/toString');\nvar WHITE_SPACES = require('./WHITE_SPACES');\nvar ltrim = require('./ltrim');\nvar rtrim = require('./rtrim');\n    /**\n     * Remove white-spaces from beginning and end of string.\n     */\n    function trim(str, chars) {\n        str = toString(str);\n        chars = chars || WHITE_SPACES;\n        return ltrim(rtrim(str, chars), chars);\n    }\n\n    module.exports = trim;\n\n","var toString = require('../lang/toString');\n    /**\n     * \"Safer\" String.toUpperCase()\n     */\n    function upperCase(str){\n        str = toString(str);\n        return str.toUpperCase();\n    }\n    module.exports = upperCase;\n\n","\n\n    /**\n     * Get current time in miliseconds\n     */\n    function now(){\n        // yes, we defer the work to another function to allow mocking it\n        // during the tests\n        return now.get();\n    }\n\n    now.get = (typeof Date.now === 'function')? Date.now : function(){\n        return +(new Date());\n    };\n\n    module.exports = now;\n\n\n","/*\ndefer\n*/\"use strict\"\n\nvar kindOf  = require(\"mout/lang/kindOf\"),\n    now     = require(\"mout/time/now\"),\n    forEach = require(\"mout/array/forEach\"),\n    indexOf = require(\"mout/array/indexOf\")\n\nvar callbacks = {\n    timeout: {},\n    frame: [],\n    immediate: []\n}\n\nvar push = function(collection, callback, context, defer){\n\n    var iterator = function(){\n        iterate(collection)\n    }\n\n    if (!collection.length) defer(iterator)\n\n    var entry = {\n        callback: callback,\n        context: context\n    }\n\n    collection.push(entry)\n\n    return function(){\n        var io = indexOf(collection, entry)\n        if (io > -1) collection.splice(io, 1)\n    }\n}\n\nvar iterate = function(collection){\n    var time = now()\n\n    forEach(collection.splice(0), function(entry) {\n        entry.callback.call(entry.context, time)\n    })\n}\n\nvar defer = function(callback, argument, context){\n    return (kindOf(argument) === \"Number\") ? defer.timeout(callback, argument, context) : defer.immediate(callback, argument)\n}\n\nif (global.process && process.nextTick){\n\n    defer.immediate = function(callback, context){\n        return push(callbacks.immediate, callback, context, process.nextTick)\n    }\n\n} else if (global.setImmediate){\n\n    defer.immediate = function(callback, context){\n        return push(callbacks.immediate, callback, context, setImmediate)\n    }\n\n} else if (global.postMessage && global.addEventListener){\n\n    addEventListener(\"message\", function(event){\n        if (event.source === global && event.data === \"@deferred\"){\n            event.stopPropagation()\n            iterate(callbacks.immediate)\n        }\n    }, true)\n\n    defer.immediate = function(callback, context){\n        return push(callbacks.immediate, callback, context, function(){\n            postMessage(\"@deferred\", \"*\")\n        })\n    }\n\n} else {\n\n    defer.immediate = function(callback, context){\n        return push(callbacks.immediate, callback, context, function(iterator){\n            setTimeout(iterator, 0)\n        })\n    }\n\n}\n\nvar requestAnimationFrame = global.requestAnimationFrame ||\n    global.webkitRequestAnimationFrame ||\n    global.mozRequestAnimationFrame ||\n    global.oRequestAnimationFrame ||\n    global.msRequestAnimationFrame ||\n    function(callback) {\n        setTimeout(callback, 1e3 / 60)\n    }\n\ndefer.frame = function(callback, context){\n    return push(callbacks.frame, callback, context, requestAnimationFrame)\n}\n\nvar clear\n\ndefer.timeout = function(callback, ms, context){\n    var ct = callbacks.timeout\n\n    if (!clear) clear = defer.immediate(function(){\n        clear = null\n        callbacks.timeout = {}\n    })\n\n    return push(ct[ms] || (ct[ms] = []), callback, context, function(iterator){\n        setTimeout(iterator, ms)\n    })\n}\n\nmodule.exports = defer\n","/*\nEmitter\n*/\"use strict\"\n\nvar indexOf = require(\"mout/array/indexOf\"),\n    forEach = require(\"mout/array/forEach\")\n\nvar prime = require(\"./index\"),\n    defer = require(\"./defer\")\n\nvar slice = Array.prototype.slice;\n\nvar Emitter = prime({\n\n    on: function(event, fn){\n        var listeners = this._listeners || (this._listeners = {}),\n            events = listeners[event] || (listeners[event] = [])\n\n        if (indexOf(events, fn) === -1) events.push(fn)\n\n        return this\n    },\n\n    off: function(event, fn){\n        var listeners = this._listeners, events, key, length = 0\n        if (listeners && (events = listeners[event])){\n\n            var io = indexOf(events, fn)\n            if (io > -1) events.splice(io, 1)\n            if (!events.length) delete listeners[event];\n            for (var l in listeners) return this\n            delete this._listeners\n        }\n        return this\n    },\n\n    emit: function(event){\n        var self = this,\n            args = slice.call(arguments, 1)\n\n        var emit = function(){\n            var listeners = self._listeners, events\n            if (listeners && (events = listeners[event])){\n                forEach(events.slice(0), function(event){\n                    return event.apply(self, args)\n                })\n            }\n        }\n\n        if (args[args.length - 1] === Emitter.EMIT_SYNC){\n            args.pop()\n            emit()\n        } else {\n            defer(emit)\n        }\n\n        return this\n    }\n\n})\n\nEmitter.EMIT_SYNC = {}\n\nmodule.exports = Emitter\n","/*\nprime\n - prototypal inheritance\n*/\"use strict\"\n\nvar hasOwn = require(\"mout/object/hasOwn\"),\n    mixIn  = require(\"mout/object/mixIn\"),\n    create = require(\"mout/lang/createObject\"),\n    kindOf = require(\"mout/lang/kindOf\")\n\nvar hasDescriptors = true\n\ntry {\n    Object.defineProperty({}, \"~\", {})\n    Object.getOwnPropertyDescriptor({}, \"~\")\n} catch (e){\n    hasDescriptors = false\n}\n\n// we only need to be able to implement \"toString\" and \"valueOf\" in IE < 9\nvar hasEnumBug = !({valueOf: 0}).propertyIsEnumerable(\"valueOf\"),\n    buggy      = [\"toString\", \"valueOf\"]\n\nvar verbs = /^constructor|inherits|mixin$/\n\nvar implement = function(proto){\n    var prototype = this.prototype\n\n    for (var key in proto){\n        if (key.match(verbs)) continue\n        if (hasDescriptors){\n            var descriptor = Object.getOwnPropertyDescriptor(proto, key)\n            if (descriptor){\n                Object.defineProperty(prototype, key, descriptor)\n                continue\n            }\n        }\n        prototype[key] = proto[key]\n    }\n\n    if (hasEnumBug) for (var i = 0; (key = buggy[i]); i++){\n        var value = proto[key]\n        if (value !== Object.prototype[key]) prototype[key] = value\n    }\n\n    return this\n}\n\nvar prime = function(proto){\n\n    if (kindOf(proto) === \"Function\") proto = {constructor: proto}\n\n    var superprime = proto.inherits\n\n    // if our nice proto object has no own constructor property\n    // then we proceed using a ghosting constructor that all it does is\n    // call the parent's constructor if it has a superprime, else an empty constructor\n    // proto.constructor becomes the effective constructor\n    var constructor = (hasOwn(proto, \"constructor\")) ? proto.constructor : (superprime) ? function(){\n        return superprime.apply(this, arguments)\n    } : function(){}\n\n    if (superprime){\n\n        mixIn(constructor, superprime)\n\n        var superproto = superprime.prototype\n        // inherit from superprime\n        var cproto = constructor.prototype = create(superproto)\n\n        // setting constructor.parent to superprime.prototype\n        // because it's the shortest possible absolute reference\n        constructor.parent = superproto\n        cproto.constructor = constructor\n    }\n\n    if (!constructor.implement) constructor.implement = implement\n\n    var mixins = proto.mixin\n    if (mixins){\n        if (kindOf(mixins) !== \"Array\") mixins = [mixins]\n        for (var i = 0; i < mixins.length; i++) constructor.implement(create(mixins[i].prototype))\n    }\n\n    // implement proto and return constructor\n    return constructor.implement(proto)\n\n}\n\nmodule.exports = prime\n","/*!\n * deep-diff.\n * Licensed under the MIT License.\n */\n;(function(root, factory) {\n  'use strict';\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([], function() {\n      return factory();\n    });\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like environments that support module.exports,\n    // like Node.\n    module.exports = factory();\n  } else {\n    // Browser globals (root is window)\n    root.DeepDiff = factory();\n  }\n}(this, function(undefined) {\n  'use strict';\n\n  var $scope, conflict, conflictResolution = [];\n  if (typeof global === 'object' && global) {\n    $scope = global;\n  } else if (typeof window !== 'undefined') {\n    $scope = window;\n  } else {\n    $scope = {};\n  }\n  conflict = $scope.DeepDiff;\n  if (conflict) {\n    conflictResolution.push(\n      function() {\n        if ('undefined' !== typeof conflict && $scope.DeepDiff === accumulateDiff) {\n          $scope.DeepDiff = conflict;\n          conflict = undefined;\n        }\n      });\n  }\n\n  // nodejs compatible on server side and in the browser.\n  function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor;\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  }\n\n  function Diff(kind, path) {\n    Object.defineProperty(this, 'kind', {\n      value: kind,\n      enumerable: true\n    });\n    if (path && path.length) {\n      Object.defineProperty(this, 'path', {\n        value: path,\n        enumerable: true\n      });\n    }\n  }\n\n  function DiffEdit(path, origin, value) {\n    DiffEdit.super_.call(this, 'E', path);\n    Object.defineProperty(this, 'lhs', {\n      value: origin,\n      enumerable: true\n    });\n    Object.defineProperty(this, 'rhs', {\n      value: value,\n      enumerable: true\n    });\n  }\n  inherits(DiffEdit, Diff);\n\n  function DiffNew(path, value) {\n    DiffNew.super_.call(this, 'N', path);\n    Object.defineProperty(this, 'rhs', {\n      value: value,\n      enumerable: true\n    });\n  }\n  inherits(DiffNew, Diff);\n\n  function DiffDeleted(path, value) {\n    DiffDeleted.super_.call(this, 'D', path);\n    Object.defineProperty(this, 'lhs', {\n      value: value,\n      enumerable: true\n    });\n  }\n  inherits(DiffDeleted, Diff);\n\n  function DiffArray(path, index, item) {\n    DiffArray.super_.call(this, 'A', path);\n    Object.defineProperty(this, 'index', {\n      value: index,\n      enumerable: true\n    });\n    Object.defineProperty(this, 'item', {\n      value: item,\n      enumerable: true\n    });\n  }\n  inherits(DiffArray, Diff);\n\n  function arrayRemove(arr, from, to) {\n    var rest = arr.slice((to || from) + 1 || arr.length);\n    arr.length = from < 0 ? arr.length + from : from;\n    arr.push.apply(arr, rest);\n    return arr;\n  }\n\n  function realTypeOf(subject) {\n    var type = typeof subject;\n    if (type !== 'object') {\n      return type;\n    }\n\n    if (subject === Math) {\n      return 'math';\n    } else if (subject === null) {\n      return 'null';\n    } else if (Array.isArray(subject)) {\n      return 'array';\n    } else if (Object.prototype.toString.call(subject) === '[object Date]') {\n      return 'date';\n    } else if (typeof subject.toString !== 'undefined' && /^\\/.*\\//.test(subject.toString())) {\n      return 'regexp';\n    }\n    return 'object';\n  }\n\n  function deepDiff(lhs, rhs, changes, prefilter, path, key, stack) {\n    path = path || [];\n    var currentPath = path.slice(0);\n    if (typeof key !== 'undefined') {\n      if (prefilter) {\n        if (typeof(prefilter) === 'function' && prefilter(currentPath, key)) { return; }\n        else if (typeof(prefilter) === 'object') {\n          if (prefilter.prefilter && prefilter.prefilter(currentPath, key)) { return; }\n          if (prefilter.normalize) {\n            var alt = prefilter.normalize(currentPath, key, lhs, rhs);\n            if (alt) {\n              lhs = alt[0];\n              rhs = alt[1];\n            }\n          }\n        }\n      }\n      currentPath.push(key);\n    }\n\n    // Use string comparison for regexes\n    if (realTypeOf(lhs) === 'regexp' && realTypeOf(rhs) === 'regexp') {\n      lhs = lhs.toString();\n      rhs = rhs.toString();\n    }\n\n    var ltype = typeof lhs;\n    var rtype = typeof rhs;\n    if (ltype === 'undefined') {\n      if (rtype !== 'undefined') {\n        changes(new DiffNew(currentPath, rhs));\n      }\n    } else if (rtype === 'undefined') {\n      changes(new DiffDeleted(currentPath, lhs));\n    } else if (realTypeOf(lhs) !== realTypeOf(rhs)) {\n      changes(new DiffEdit(currentPath, lhs, rhs));\n    } else if (Object.prototype.toString.call(lhs) === '[object Date]' && Object.prototype.toString.call(rhs) === '[object Date]' && ((lhs - rhs) !== 0)) {\n      changes(new DiffEdit(currentPath, lhs, rhs));\n    } else if (ltype === 'object' && lhs !== null && rhs !== null) {\n      stack = stack || [];\n      if (stack.indexOf(lhs) < 0) {\n        stack.push(lhs);\n        if (Array.isArray(lhs)) {\n          var i, len = lhs.length;\n          for (i = 0; i < lhs.length; i++) {\n            if (i >= rhs.length) {\n              changes(new DiffArray(currentPath, i, new DiffDeleted(undefined, lhs[i])));\n            } else {\n              deepDiff(lhs[i], rhs[i], changes, prefilter, currentPath, i, stack);\n            }\n          }\n          while (i < rhs.length) {\n            changes(new DiffArray(currentPath, i, new DiffNew(undefined, rhs[i++])));\n          }\n        } else {\n          var akeys = Object.keys(lhs);\n          var pkeys = Object.keys(rhs);\n          akeys.forEach(function(k, i) {\n            var other = pkeys.indexOf(k);\n            if (other >= 0) {\n              deepDiff(lhs[k], rhs[k], changes, prefilter, currentPath, k, stack);\n              pkeys = arrayRemove(pkeys, other);\n            } else {\n              deepDiff(lhs[k], undefined, changes, prefilter, currentPath, k, stack);\n            }\n          });\n          pkeys.forEach(function(k) {\n            deepDiff(undefined, rhs[k], changes, prefilter, currentPath, k, stack);\n          });\n        }\n        stack.length = stack.length - 1;\n      }\n    } else if (lhs !== rhs) {\n      if (!(ltype === 'number' && isNaN(lhs) && isNaN(rhs))) {\n        changes(new DiffEdit(currentPath, lhs, rhs));\n      }\n    }\n  }\n\n  function accumulateDiff(lhs, rhs, prefilter, accum) {\n    accum = accum || [];\n    deepDiff(lhs, rhs,\n      function(diff) {\n        if (diff) {\n          accum.push(diff);\n        }\n      },\n      prefilter);\n    return (accum.length) ? accum : undefined;\n  }\n\n  function applyArrayChange(arr, index, change) {\n    if (change.path && change.path.length) {\n      var it = arr[index],\n          i, u = change.path.length - 1;\n      for (i = 0; i < u; i++) {\n        it = it[change.path[i]];\n      }\n      switch (change.kind) {\n        case 'A':\n          applyArrayChange(it[change.path[i]], change.index, change.item);\n          break;\n        case 'D':\n          delete it[change.path[i]];\n          break;\n        case 'E':\n        case 'N':\n          it[change.path[i]] = change.rhs;\n          break;\n      }\n    } else {\n      switch (change.kind) {\n        case 'A':\n          applyArrayChange(arr[index], change.index, change.item);\n          break;\n        case 'D':\n          arr = arrayRemove(arr, index);\n          break;\n        case 'E':\n        case 'N':\n          arr[index] = change.rhs;\n          break;\n      }\n    }\n    return arr;\n  }\n\n  function applyChange(target, source, change) {\n    if (target && source && change && change.kind) {\n      var it = target,\n          i = -1,\n          last = change.path ? change.path.length - 1 : 0;\n      while (++i < last) {\n        if (typeof it[change.path[i]] === 'undefined') {\n          it[change.path[i]] = (typeof change.path[i] === 'number') ? [] : {};\n        }\n        it = it[change.path[i]];\n      }\n      switch (change.kind) {\n        case 'A':\n          applyArrayChange(change.path ? it[change.path[i]] : it, change.index, change.item);\n          break;\n        case 'D':\n          delete it[change.path[i]];\n          break;\n        case 'E':\n        case 'N':\n          it[change.path[i]] = change.rhs;\n          break;\n      }\n    }\n  }\n\n  function revertArrayChange(arr, index, change) {\n    if (change.path && change.path.length) {\n      // the structure of the object at the index has changed...\n      var it = arr[index],\n          i, u = change.path.length - 1;\n      for (i = 0; i < u; i++) {\n        it = it[change.path[i]];\n      }\n      switch (change.kind) {\n        case 'A':\n          revertArrayChange(it[change.path[i]], change.index, change.item);\n          break;\n        case 'D':\n          it[change.path[i]] = change.lhs;\n          break;\n        case 'E':\n          it[change.path[i]] = change.lhs;\n          break;\n        case 'N':\n          delete it[change.path[i]];\n          break;\n      }\n    } else {\n      // the array item is different...\n      switch (change.kind) {\n        case 'A':\n          revertArrayChange(arr[index], change.index, change.item);\n          break;\n        case 'D':\n          arr[index] = change.lhs;\n          break;\n        case 'E':\n          arr[index] = change.lhs;\n          break;\n        case 'N':\n          arr = arrayRemove(arr, index);\n          break;\n      }\n    }\n    return arr;\n  }\n\n  function revertChange(target, source, change) {\n    if (target && source && change && change.kind) {\n      var it = target,\n          i, u;\n      u = change.path.length - 1;\n      for (i = 0; i < u; i++) {\n        if (typeof it[change.path[i]] === 'undefined') {\n          it[change.path[i]] = {};\n        }\n        it = it[change.path[i]];\n      }\n      switch (change.kind) {\n        case 'A':\n          // Array was modified...\n          // it will be an array...\n          revertArrayChange(it[change.path[i]], change.index, change.item);\n          break;\n        case 'D':\n          // Item was deleted...\n          it[change.path[i]] = change.lhs;\n          break;\n        case 'E':\n          // Item was edited...\n          it[change.path[i]] = change.lhs;\n          break;\n        case 'N':\n          // Item is new...\n          delete it[change.path[i]];\n          break;\n      }\n    }\n  }\n\n  function applyDiff(target, source, filter) {\n    if (target && source) {\n      var onChange = function(change) {\n        if (!filter || filter(target, source, change)) {\n          applyChange(target, source, change);\n        }\n      };\n      deepDiff(target, source, onChange);\n    }\n  }\n\n  Object.defineProperties(accumulateDiff, {\n\n    diff: {\n      value: accumulateDiff,\n      enumerable: true\n    },\n    observableDiff: {\n      value: deepDiff,\n      enumerable: true\n    },\n    applyDiff: {\n      value: applyDiff,\n      enumerable: true\n    },\n    applyChange: {\n      value: applyChange,\n      enumerable: true\n    },\n    revertChange: {\n      value: revertChange,\n      enumerable: true\n    },\n    isConflict: {\n      value: function() {\n        return 'undefined' !== typeof conflict;\n      },\n      enumerable: true\n    },\n    noConflict: {\n      value: function() {\n        if (conflictResolution) {\n          conflictResolution.forEach(function(it) {\n            it();\n          });\n          conflictResolution = null;\n        }\n        return accumulateDiff;\n      },\n      enumerable: true\n    }\n  });\n\n  return accumulateDiff;\n}));\n","\n/*\n *\n * More info at [www.dropzonejs.com](http://www.dropzonejs.com)\n *\n * Copyright (c) 2012, Matias Meno\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n */\n\n(function() {\n  var Dropzone, Emitter, camelize, contentLoaded, detectVerticalSquash, drawImageIOSFix, noop, without,\n    __slice = [].slice,\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n  noop = function() {};\n\n  Emitter = (function() {\n    function Emitter() {}\n\n    Emitter.prototype.addEventListener = Emitter.prototype.on;\n\n    Emitter.prototype.on = function(event, fn) {\n      this._callbacks = this._callbacks || {};\n      if (!this._callbacks[event]) {\n        this._callbacks[event] = [];\n      }\n      this._callbacks[event].push(fn);\n      return this;\n    };\n\n    Emitter.prototype.emit = function() {\n      var args, callback, callbacks, event, _i, _len;\n      event = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      this._callbacks = this._callbacks || {};\n      callbacks = this._callbacks[event];\n      if (callbacks) {\n        for (_i = 0, _len = callbacks.length; _i < _len; _i++) {\n          callback = callbacks[_i];\n          callback.apply(this, args);\n        }\n      }\n      return this;\n    };\n\n    Emitter.prototype.removeListener = Emitter.prototype.off;\n\n    Emitter.prototype.removeAllListeners = Emitter.prototype.off;\n\n    Emitter.prototype.removeEventListener = Emitter.prototype.off;\n\n    Emitter.prototype.off = function(event, fn) {\n      var callback, callbacks, i, _i, _len;\n      if (!this._callbacks || arguments.length === 0) {\n        this._callbacks = {};\n        return this;\n      }\n      callbacks = this._callbacks[event];\n      if (!callbacks) {\n        return this;\n      }\n      if (arguments.length === 1) {\n        delete this._callbacks[event];\n        return this;\n      }\n      for (i = _i = 0, _len = callbacks.length; _i < _len; i = ++_i) {\n        callback = callbacks[i];\n        if (callback === fn) {\n          callbacks.splice(i, 1);\n          break;\n        }\n      }\n      return this;\n    };\n\n    return Emitter;\n\n  })();\n\n  Dropzone = (function(_super) {\n    var extend, resolveOption;\n\n    __extends(Dropzone, _super);\n\n    Dropzone.prototype.Emitter = Emitter;\n\n\n    /*\n    This is a list of all available events you can register on a dropzone object.\n    \n    You can register an event handler like this:\n    \n        dropzone.on(\"dragEnter\", function() { });\n     */\n\n    Dropzone.prototype.events = [\"drop\", \"dragstart\", \"dragend\", \"dragenter\", \"dragover\", \"dragleave\", \"addedfile\", \"addedfiles\", \"removedfile\", \"thumbnail\", \"error\", \"errormultiple\", \"processing\", \"processingmultiple\", \"uploadprogress\", \"totaluploadprogress\", \"sending\", \"sendingmultiple\", \"success\", \"successmultiple\", \"canceled\", \"canceledmultiple\", \"complete\", \"completemultiple\", \"reset\", \"maxfilesexceeded\", \"maxfilesreached\", \"queuecomplete\"];\n\n    Dropzone.prototype.defaultOptions = {\n      url: null,\n      method: \"post\",\n      withCredentials: false,\n      parallelUploads: 2,\n      uploadMultiple: false,\n      maxFilesize: 256,\n      paramName: \"file\",\n      createImageThumbnails: true,\n      maxThumbnailFilesize: 10,\n      thumbnailWidth: 120,\n      thumbnailHeight: 120,\n      filesizeBase: 1000,\n      maxFiles: null,\n      params: {},\n      clickable: true,\n      ignoreHiddenFiles: true,\n      acceptedFiles: null,\n      acceptedMimeTypes: null,\n      autoProcessQueue: true,\n      autoQueue: true,\n      addRemoveLinks: false,\n      previewsContainer: null,\n      hiddenInputContainer: \"body\",\n      capture: null,\n      renameFilename: null,\n      dictDefaultMessage: \"Drop files here to upload\",\n      dictFallbackMessage: \"Your browser does not support drag'n'drop file uploads.\",\n      dictFallbackText: \"Please use the fallback form below to upload your files like in the olden days.\",\n      dictFileTooBig: \"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.\",\n      dictInvalidFileType: \"You can't upload files of this type.\",\n      dictResponseError: \"Server responded with {{statusCode}} code.\",\n      dictCancelUpload: \"Cancel upload\",\n      dictCancelUploadConfirmation: \"Are you sure you want to cancel this upload?\",\n      dictRemoveFile: \"Remove file\",\n      dictRemoveFileConfirmation: null,\n      dictMaxFilesExceeded: \"You can not upload any more files.\",\n      accept: function(file, done) {\n        return done();\n      },\n      init: function() {\n        return noop;\n      },\n      forceFallback: false,\n      fallback: function() {\n        var child, messageElement, span, _i, _len, _ref;\n        this.element.className = \"\" + this.element.className + \" dz-browser-not-supported\";\n        _ref = this.element.getElementsByTagName(\"div\");\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          child = _ref[_i];\n          if (/(^| )dz-message($| )/.test(child.className)) {\n            messageElement = child;\n            child.className = \"dz-message\";\n            continue;\n          }\n        }\n        if (!messageElement) {\n          messageElement = Dropzone.createElement(\"<div class=\\\"dz-message\\\"><span></span></div>\");\n          this.element.appendChild(messageElement);\n        }\n        span = messageElement.getElementsByTagName(\"span\")[0];\n        if (span) {\n          if (span.textContent != null) {\n            span.textContent = this.options.dictFallbackMessage;\n          } else if (span.innerText != null) {\n            span.innerText = this.options.dictFallbackMessage;\n          }\n        }\n        return this.element.appendChild(this.getFallbackForm());\n      },\n      resize: function(file) {\n        var info, srcRatio, trgRatio;\n        info = {\n          srcX: 0,\n          srcY: 0,\n          srcWidth: file.width,\n          srcHeight: file.height\n        };\n        srcRatio = file.width / file.height;\n        info.optWidth = this.options.thumbnailWidth;\n        info.optHeight = this.options.thumbnailHeight;\n        if ((info.optWidth == null) && (info.optHeight == null)) {\n          info.optWidth = info.srcWidth;\n          info.optHeight = info.srcHeight;\n        } else if (info.optWidth == null) {\n          info.optWidth = srcRatio * info.optHeight;\n        } else if (info.optHeight == null) {\n          info.optHeight = (1 / srcRatio) * info.optWidth;\n        }\n        trgRatio = info.optWidth / info.optHeight;\n        if (file.height < info.optHeight || file.width < info.optWidth) {\n          info.trgHeight = info.srcHeight;\n          info.trgWidth = info.srcWidth;\n        } else {\n          if (srcRatio > trgRatio) {\n            info.srcHeight = file.height;\n            info.srcWidth = info.srcHeight * trgRatio;\n          } else {\n            info.srcWidth = file.width;\n            info.srcHeight = info.srcWidth / trgRatio;\n          }\n        }\n        info.srcX = (file.width - info.srcWidth) / 2;\n        info.srcY = (file.height - info.srcHeight) / 2;\n        return info;\n      },\n\n      /*\n      Those functions register themselves to the events on init and handle all\n      the user interface specific stuff. Overwriting them won't break the upload\n      but can break the way it's displayed.\n      You can overwrite them if you don't like the default behavior. If you just\n      want to add an additional event handler, register it on the dropzone object\n      and don't overwrite those options.\n       */\n      drop: function(e) {\n        return this.element.classList.remove(\"dz-drag-hover\");\n      },\n      dragstart: noop,\n      dragend: function(e) {\n        return this.element.classList.remove(\"dz-drag-hover\");\n      },\n      dragenter: function(e) {\n        return this.element.classList.add(\"dz-drag-hover\");\n      },\n      dragover: function(e) {\n        return this.element.classList.add(\"dz-drag-hover\");\n      },\n      dragleave: function(e) {\n        return this.element.classList.remove(\"dz-drag-hover\");\n      },\n      paste: noop,\n      reset: function() {\n        return this.element.classList.remove(\"dz-started\");\n      },\n      addedfile: function(file) {\n        var node, removeFileEvent, removeLink, _i, _j, _k, _len, _len1, _len2, _ref, _ref1, _ref2, _results;\n        if (this.element === this.previewsContainer) {\n          this.element.classList.add(\"dz-started\");\n        }\n        if (this.previewsContainer) {\n          file.previewElement = Dropzone.createElement(this.options.previewTemplate.trim());\n          file.previewTemplate = file.previewElement;\n          this.previewsContainer.appendChild(file.previewElement);\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-name]\");\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            node = _ref[_i];\n            node.textContent = this._renameFilename(file.name);\n          }\n          _ref1 = file.previewElement.querySelectorAll(\"[data-dz-size]\");\n          for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {\n            node = _ref1[_j];\n            node.innerHTML = this.filesize(file.size);\n          }\n          if (this.options.addRemoveLinks) {\n            file._removeLink = Dropzone.createElement(\"<a class=\\\"dz-remove\\\" href=\\\"javascript:undefined;\\\" data-dz-remove>\" + this.options.dictRemoveFile + \"</a>\");\n            file.previewElement.appendChild(file._removeLink);\n          }\n          removeFileEvent = (function(_this) {\n            return function(e) {\n              e.preventDefault();\n              e.stopPropagation();\n              if (file.status === Dropzone.UPLOADING) {\n                return Dropzone.confirm(_this.options.dictCancelUploadConfirmation, function() {\n                  return _this.removeFile(file);\n                });\n              } else {\n                if (_this.options.dictRemoveFileConfirmation) {\n                  return Dropzone.confirm(_this.options.dictRemoveFileConfirmation, function() {\n                    return _this.removeFile(file);\n                  });\n                } else {\n                  return _this.removeFile(file);\n                }\n              }\n            };\n          })(this);\n          _ref2 = file.previewElement.querySelectorAll(\"[data-dz-remove]\");\n          _results = [];\n          for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {\n            removeLink = _ref2[_k];\n            _results.push(removeLink.addEventListener(\"click\", removeFileEvent));\n          }\n          return _results;\n        }\n      },\n      removedfile: function(file) {\n        var _ref;\n        if (file.previewElement) {\n          if ((_ref = file.previewElement) != null) {\n            _ref.parentNode.removeChild(file.previewElement);\n          }\n        }\n        return this._updateMaxFilesReachedClass();\n      },\n      thumbnail: function(file, dataUrl) {\n        var thumbnailElement, _i, _len, _ref;\n        if (file.previewElement) {\n          file.previewElement.classList.remove(\"dz-file-preview\");\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-thumbnail]\");\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            thumbnailElement = _ref[_i];\n            thumbnailElement.alt = file.name;\n            thumbnailElement.src = dataUrl;\n          }\n          return setTimeout(((function(_this) {\n            return function() {\n              return file.previewElement.classList.add(\"dz-image-preview\");\n            };\n          })(this)), 1);\n        }\n      },\n      error: function(file, message) {\n        var node, _i, _len, _ref, _results;\n        if (file.previewElement) {\n          file.previewElement.classList.add(\"dz-error\");\n          if (typeof message !== \"String\" && message.error) {\n            message = message.error;\n          }\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-errormessage]\");\n          _results = [];\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            node = _ref[_i];\n            _results.push(node.textContent = message);\n          }\n          return _results;\n        }\n      },\n      errormultiple: noop,\n      processing: function(file) {\n        if (file.previewElement) {\n          file.previewElement.classList.add(\"dz-processing\");\n          if (file._removeLink) {\n            return file._removeLink.textContent = this.options.dictCancelUpload;\n          }\n        }\n      },\n      processingmultiple: noop,\n      uploadprogress: function(file, progress, bytesSent) {\n        var node, _i, _len, _ref, _results;\n        if (file.previewElement) {\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-uploadprogress]\");\n          _results = [];\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            node = _ref[_i];\n            if (node.nodeName === 'PROGRESS') {\n              _results.push(node.value = progress);\n            } else {\n              _results.push(node.style.width = \"\" + progress + \"%\");\n            }\n          }\n          return _results;\n        }\n      },\n      totaluploadprogress: noop,\n      sending: noop,\n      sendingmultiple: noop,\n      success: function(file) {\n        if (file.previewElement) {\n          return file.previewElement.classList.add(\"dz-success\");\n        }\n      },\n      successmultiple: noop,\n      canceled: function(file) {\n        return this.emit(\"error\", file, \"Upload canceled.\");\n      },\n      canceledmultiple: noop,\n      complete: function(file) {\n        if (file._removeLink) {\n          file._removeLink.textContent = this.options.dictRemoveFile;\n        }\n        if (file.previewElement) {\n          return file.previewElement.classList.add(\"dz-complete\");\n        }\n      },\n      completemultiple: noop,\n      maxfilesexceeded: noop,\n      maxfilesreached: noop,\n      queuecomplete: noop,\n      addedfiles: noop,\n      previewTemplate: \"<div class=\\\"dz-preview dz-file-preview\\\">\\n  <div class=\\\"dz-image\\\"><img data-dz-thumbnail /></div>\\n  <div class=\\\"dz-details\\\">\\n    <div class=\\\"dz-size\\\"><span data-dz-size></span></div>\\n    <div class=\\\"dz-filename\\\"><span data-dz-name></span></div>\\n  </div>\\n  <div class=\\\"dz-progress\\\"><span class=\\\"dz-upload\\\" data-dz-uploadprogress></span></div>\\n  <div class=\\\"dz-error-message\\\"><span data-dz-errormessage></span></div>\\n  <div class=\\\"dz-success-mark\\\">\\n    <svg width=\\\"54px\\\" height=\\\"54px\\\" viewBox=\\\"0 0 54 54\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xmlns:sketch=\\\"http://www.bohemiancoding.com/sketch/ns\\\">\\n      <title>Check</title>\\n      <defs></defs>\\n      <g id=\\\"Page-1\\\" stroke=\\\"none\\\" stroke-width=\\\"1\\\" fill=\\\"none\\\" fill-rule=\\\"evenodd\\\" sketch:type=\\\"MSPage\\\">\\n        <path d=\\\"M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\\\" id=\\\"Oval-2\\\" stroke-opacity=\\\"0.198794158\\\" stroke=\\\"#747474\\\" fill-opacity=\\\"0.816519475\\\" fill=\\\"#FFFFFF\\\" sketch:type=\\\"MSShapeGroup\\\"></path>\\n      </g>\\n    </svg>\\n  </div>\\n  <div class=\\\"dz-error-mark\\\">\\n    <svg width=\\\"54px\\\" height=\\\"54px\\\" viewBox=\\\"0 0 54 54\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xmlns:sketch=\\\"http://www.bohemiancoding.com/sketch/ns\\\">\\n      <title>Error</title>\\n      <defs></defs>\\n      <g id=\\\"Page-1\\\" stroke=\\\"none\\\" stroke-width=\\\"1\\\" fill=\\\"none\\\" fill-rule=\\\"evenodd\\\" sketch:type=\\\"MSPage\\\">\\n        <g id=\\\"Check-+-Oval-2\\\" sketch:type=\\\"MSLayerGroup\\\" stroke=\\\"#747474\\\" stroke-opacity=\\\"0.198794158\\\" fill=\\\"#FFFFFF\\\" fill-opacity=\\\"0.816519475\\\">\\n          <path d=\\\"M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\\\" id=\\\"Oval-2\\\" sketch:type=\\\"MSShapeGroup\\\"></path>\\n        </g>\\n      </g>\\n    </svg>\\n  </div>\\n</div>\"\n    };\n\n    extend = function() {\n      var key, object, objects, target, val, _i, _len;\n      target = arguments[0], objects = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      for (_i = 0, _len = objects.length; _i < _len; _i++) {\n        object = objects[_i];\n        for (key in object) {\n          val = object[key];\n          target[key] = val;\n        }\n      }\n      return target;\n    };\n\n    function Dropzone(element, options) {\n      var elementOptions, fallback, _ref;\n      this.element = element;\n      this.version = Dropzone.version;\n      this.defaultOptions.previewTemplate = this.defaultOptions.previewTemplate.replace(/\\n*/g, \"\");\n      this.clickableElements = [];\n      this.listeners = [];\n      this.files = [];\n      if (typeof this.element === \"string\") {\n        this.element = document.querySelector(this.element);\n      }\n      if (!(this.element && (this.element.nodeType != null))) {\n        throw new Error(\"Invalid dropzone element.\");\n      }\n      if (this.element.dropzone) {\n        throw new Error(\"Dropzone already attached.\");\n      }\n      Dropzone.instances.push(this);\n      this.element.dropzone = this;\n      elementOptions = (_ref = Dropzone.optionsForElement(this.element)) != null ? _ref : {};\n      this.options = extend({}, this.defaultOptions, elementOptions, options != null ? options : {});\n      if (this.options.forceFallback || !Dropzone.isBrowserSupported()) {\n        return this.options.fallback.call(this);\n      }\n      if (this.options.url == null) {\n        this.options.url = this.element.getAttribute(\"action\");\n      }\n      if (!this.options.url) {\n        throw new Error(\"No URL provided.\");\n      }\n      if (this.options.acceptedFiles && this.options.acceptedMimeTypes) {\n        throw new Error(\"You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.\");\n      }\n      if (this.options.acceptedMimeTypes) {\n        this.options.acceptedFiles = this.options.acceptedMimeTypes;\n        delete this.options.acceptedMimeTypes;\n      }\n      this.options.method = this.options.method.toUpperCase();\n      if ((fallback = this.getExistingFallback()) && fallback.parentNode) {\n        fallback.parentNode.removeChild(fallback);\n      }\n      if (this.options.previewsContainer !== false) {\n        if (this.options.previewsContainer) {\n          this.previewsContainer = Dropzone.getElement(this.options.previewsContainer, \"previewsContainer\");\n        } else {\n          this.previewsContainer = this.element;\n        }\n      }\n      if (this.options.clickable) {\n        if (this.options.clickable === true) {\n          this.clickableElements = [this.element];\n        } else {\n          this.clickableElements = Dropzone.getElements(this.options.clickable, \"clickable\");\n        }\n      }\n      this.init();\n    }\n\n    Dropzone.prototype.getAcceptedFiles = function() {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.accepted) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.getRejectedFiles = function() {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (!file.accepted) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.getFilesWithStatus = function(status) {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.status === status) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.getQueuedFiles = function() {\n      return this.getFilesWithStatus(Dropzone.QUEUED);\n    };\n\n    Dropzone.prototype.getUploadingFiles = function() {\n      return this.getFilesWithStatus(Dropzone.UPLOADING);\n    };\n\n    Dropzone.prototype.getAddedFiles = function() {\n      return this.getFilesWithStatus(Dropzone.ADDED);\n    };\n\n    Dropzone.prototype.getActiveFiles = function() {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.status === Dropzone.UPLOADING || file.status === Dropzone.QUEUED) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.init = function() {\n      var eventName, noPropagation, setupHiddenFileInput, _i, _len, _ref, _ref1;\n      if (this.element.tagName === \"form\") {\n        this.element.setAttribute(\"enctype\", \"multipart/form-data\");\n      }\n      if (this.element.classList.contains(\"dropzone\") && !this.element.querySelector(\".dz-message\")) {\n        this.element.appendChild(Dropzone.createElement(\"<div class=\\\"dz-default dz-message\\\"><span>\" + this.options.dictDefaultMessage + \"</span></div>\"));\n      }\n      if (this.clickableElements.length) {\n        setupHiddenFileInput = (function(_this) {\n          return function() {\n            if (_this.hiddenFileInput) {\n              _this.hiddenFileInput.parentNode.removeChild(_this.hiddenFileInput);\n            }\n            _this.hiddenFileInput = document.createElement(\"input\");\n            _this.hiddenFileInput.setAttribute(\"type\", \"file\");\n            if ((_this.options.maxFiles == null) || _this.options.maxFiles > 1) {\n              _this.hiddenFileInput.setAttribute(\"multiple\", \"multiple\");\n            }\n            _this.hiddenFileInput.className = \"dz-hidden-input\";\n            if (_this.options.acceptedFiles != null) {\n              _this.hiddenFileInput.setAttribute(\"accept\", _this.options.acceptedFiles);\n            }\n            if (_this.options.capture != null) {\n              _this.hiddenFileInput.setAttribute(\"capture\", _this.options.capture);\n            }\n            _this.hiddenFileInput.style.visibility = \"hidden\";\n            _this.hiddenFileInput.style.position = \"absolute\";\n            _this.hiddenFileInput.style.top = \"0\";\n            _this.hiddenFileInput.style.left = \"0\";\n            _this.hiddenFileInput.style.height = \"0\";\n            _this.hiddenFileInput.style.width = \"0\";\n            document.querySelector(_this.options.hiddenInputContainer).appendChild(_this.hiddenFileInput);\n            return _this.hiddenFileInput.addEventListener(\"change\", function() {\n              var file, files, _i, _len;\n              files = _this.hiddenFileInput.files;\n              if (files.length) {\n                for (_i = 0, _len = files.length; _i < _len; _i++) {\n                  file = files[_i];\n                  _this.addFile(file);\n                }\n              }\n              _this.emit(\"addedfiles\", files);\n              return setupHiddenFileInput();\n            });\n          };\n        })(this);\n        setupHiddenFileInput();\n      }\n      this.URL = (_ref = window.URL) != null ? _ref : window.webkitURL;\n      _ref1 = this.events;\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        eventName = _ref1[_i];\n        this.on(eventName, this.options[eventName]);\n      }\n      this.on(\"uploadprogress\", (function(_this) {\n        return function() {\n          return _this.updateTotalUploadProgress();\n        };\n      })(this));\n      this.on(\"removedfile\", (function(_this) {\n        return function() {\n          return _this.updateTotalUploadProgress();\n        };\n      })(this));\n      this.on(\"canceled\", (function(_this) {\n        return function(file) {\n          return _this.emit(\"complete\", file);\n        };\n      })(this));\n      this.on(\"complete\", (function(_this) {\n        return function(file) {\n          if (_this.getAddedFiles().length === 0 && _this.getUploadingFiles().length === 0 && _this.getQueuedFiles().length === 0) {\n            return setTimeout((function() {\n              return _this.emit(\"queuecomplete\");\n            }), 0);\n          }\n        };\n      })(this));\n      noPropagation = function(e) {\n        e.stopPropagation();\n        if (e.preventDefault) {\n          return e.preventDefault();\n        } else {\n          return e.returnValue = false;\n        }\n      };\n      this.listeners = [\n        {\n          element: this.element,\n          events: {\n            \"dragstart\": (function(_this) {\n              return function(e) {\n                return _this.emit(\"dragstart\", e);\n              };\n            })(this),\n            \"dragenter\": (function(_this) {\n              return function(e) {\n                noPropagation(e);\n                return _this.emit(\"dragenter\", e);\n              };\n            })(this),\n            \"dragover\": (function(_this) {\n              return function(e) {\n                var efct;\n                try {\n                  efct = e.dataTransfer.effectAllowed;\n                } catch (_error) {}\n                e.dataTransfer.dropEffect = 'move' === efct || 'linkMove' === efct ? 'move' : 'copy';\n                noPropagation(e);\n                return _this.emit(\"dragover\", e);\n              };\n            })(this),\n            \"dragleave\": (function(_this) {\n              return function(e) {\n                return _this.emit(\"dragleave\", e);\n              };\n            })(this),\n            \"drop\": (function(_this) {\n              return function(e) {\n                noPropagation(e);\n                return _this.drop(e);\n              };\n            })(this),\n            \"dragend\": (function(_this) {\n              return function(e) {\n                return _this.emit(\"dragend\", e);\n              };\n            })(this)\n          }\n        }\n      ];\n      this.clickableElements.forEach((function(_this) {\n        return function(clickableElement) {\n          return _this.listeners.push({\n            element: clickableElement,\n            events: {\n              \"click\": function(evt) {\n                if ((clickableElement !== _this.element) || (evt.target === _this.element || Dropzone.elementInside(evt.target, _this.element.querySelector(\".dz-message\")))) {\n                  _this.hiddenFileInput.click();\n                }\n                return true;\n              }\n            }\n          });\n        };\n      })(this));\n      this.enable();\n      return this.options.init.call(this);\n    };\n\n    Dropzone.prototype.destroy = function() {\n      var _ref;\n      this.disable();\n      this.removeAllFiles(true);\n      if ((_ref = this.hiddenFileInput) != null ? _ref.parentNode : void 0) {\n        this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput);\n        this.hiddenFileInput = null;\n      }\n      delete this.element.dropzone;\n      return Dropzone.instances.splice(Dropzone.instances.indexOf(this), 1);\n    };\n\n    Dropzone.prototype.updateTotalUploadProgress = function() {\n      var activeFiles, file, totalBytes, totalBytesSent, totalUploadProgress, _i, _len, _ref;\n      totalBytesSent = 0;\n      totalBytes = 0;\n      activeFiles = this.getActiveFiles();\n      if (activeFiles.length) {\n        _ref = this.getActiveFiles();\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          file = _ref[_i];\n          totalBytesSent += file.upload.bytesSent;\n          totalBytes += file.upload.total;\n        }\n        totalUploadProgress = 100 * totalBytesSent / totalBytes;\n      } else {\n        totalUploadProgress = 100;\n      }\n      return this.emit(\"totaluploadprogress\", totalUploadProgress, totalBytes, totalBytesSent);\n    };\n\n    Dropzone.prototype._getParamName = function(n) {\n      if (typeof this.options.paramName === \"function\") {\n        return this.options.paramName(n);\n      } else {\n        return \"\" + this.options.paramName + (this.options.uploadMultiple ? \"[\" + n + \"]\" : \"\");\n      }\n    };\n\n    Dropzone.prototype._renameFilename = function(name) {\n      if (typeof this.options.renameFilename !== \"function\") {\n        return name;\n      }\n      return this.options.renameFilename(name);\n    };\n\n    Dropzone.prototype.getFallbackForm = function() {\n      var existingFallback, fields, fieldsString, form;\n      if (existingFallback = this.getExistingFallback()) {\n        return existingFallback;\n      }\n      fieldsString = \"<div class=\\\"dz-fallback\\\">\";\n      if (this.options.dictFallbackText) {\n        fieldsString += \"<p>\" + this.options.dictFallbackText + \"</p>\";\n      }\n      fieldsString += \"<input type=\\\"file\\\" name=\\\"\" + (this._getParamName(0)) + \"\\\" \" + (this.options.uploadMultiple ? 'multiple=\"multiple\"' : void 0) + \" /><input type=\\\"submit\\\" value=\\\"Upload!\\\"></div>\";\n      fields = Dropzone.createElement(fieldsString);\n      if (this.element.tagName !== \"FORM\") {\n        form = Dropzone.createElement(\"<form action=\\\"\" + this.options.url + \"\\\" enctype=\\\"multipart/form-data\\\" method=\\\"\" + this.options.method + \"\\\"></form>\");\n        form.appendChild(fields);\n      } else {\n        this.element.setAttribute(\"enctype\", \"multipart/form-data\");\n        this.element.setAttribute(\"method\", this.options.method);\n      }\n      return form != null ? form : fields;\n    };\n\n    Dropzone.prototype.getExistingFallback = function() {\n      var fallback, getFallback, tagName, _i, _len, _ref;\n      getFallback = function(elements) {\n        var el, _i, _len;\n        for (_i = 0, _len = elements.length; _i < _len; _i++) {\n          el = elements[_i];\n          if (/(^| )fallback($| )/.test(el.className)) {\n            return el;\n          }\n        }\n      };\n      _ref = [\"div\", \"form\"];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        tagName = _ref[_i];\n        if (fallback = getFallback(this.element.getElementsByTagName(tagName))) {\n          return fallback;\n        }\n      }\n    };\n\n    Dropzone.prototype.setupEventListeners = function() {\n      var elementListeners, event, listener, _i, _len, _ref, _results;\n      _ref = this.listeners;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        elementListeners = _ref[_i];\n        _results.push((function() {\n          var _ref1, _results1;\n          _ref1 = elementListeners.events;\n          _results1 = [];\n          for (event in _ref1) {\n            listener = _ref1[event];\n            _results1.push(elementListeners.element.addEventListener(event, listener, false));\n          }\n          return _results1;\n        })());\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.removeEventListeners = function() {\n      var elementListeners, event, listener, _i, _len, _ref, _results;\n      _ref = this.listeners;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        elementListeners = _ref[_i];\n        _results.push((function() {\n          var _ref1, _results1;\n          _ref1 = elementListeners.events;\n          _results1 = [];\n          for (event in _ref1) {\n            listener = _ref1[event];\n            _results1.push(elementListeners.element.removeEventListener(event, listener, false));\n          }\n          return _results1;\n        })());\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.disable = function() {\n      var file, _i, _len, _ref, _results;\n      this.clickableElements.forEach(function(element) {\n        return element.classList.remove(\"dz-clickable\");\n      });\n      this.removeEventListeners();\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        _results.push(this.cancelUpload(file));\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.enable = function() {\n      this.clickableElements.forEach(function(element) {\n        return element.classList.add(\"dz-clickable\");\n      });\n      return this.setupEventListeners();\n    };\n\n    Dropzone.prototype.filesize = function(size) {\n      var cutoff, i, selectedSize, selectedUnit, unit, units, _i, _len;\n      selectedSize = 0;\n      selectedUnit = \"b\";\n      if (size > 0) {\n        units = ['TB', 'GB', 'MB', 'KB', 'b'];\n        for (i = _i = 0, _len = units.length; _i < _len; i = ++_i) {\n          unit = units[i];\n          cutoff = Math.pow(this.options.filesizeBase, 4 - i) / 10;\n          if (size >= cutoff) {\n            selectedSize = size / Math.pow(this.options.filesizeBase, 4 - i);\n            selectedUnit = unit;\n            break;\n          }\n        }\n        selectedSize = Math.round(10 * selectedSize) / 10;\n      }\n      return \"<strong>\" + selectedSize + \"</strong> \" + selectedUnit;\n    };\n\n    Dropzone.prototype._updateMaxFilesReachedClass = function() {\n      if ((this.options.maxFiles != null) && this.getAcceptedFiles().length >= this.options.maxFiles) {\n        if (this.getAcceptedFiles().length === this.options.maxFiles) {\n          this.emit('maxfilesreached', this.files);\n        }\n        return this.element.classList.add(\"dz-max-files-reached\");\n      } else {\n        return this.element.classList.remove(\"dz-max-files-reached\");\n      }\n    };\n\n    Dropzone.prototype.drop = function(e) {\n      var files, items;\n      if (!e.dataTransfer) {\n        return;\n      }\n      this.emit(\"drop\", e);\n      files = e.dataTransfer.files;\n      this.emit(\"addedfiles\", files);\n      if (files.length) {\n        items = e.dataTransfer.items;\n        if (items && items.length && (items[0].webkitGetAsEntry != null)) {\n          this._addFilesFromItems(items);\n        } else {\n          this.handleFiles(files);\n        }\n      }\n    };\n\n    Dropzone.prototype.paste = function(e) {\n      var items, _ref;\n      if ((e != null ? (_ref = e.clipboardData) != null ? _ref.items : void 0 : void 0) == null) {\n        return;\n      }\n      this.emit(\"paste\", e);\n      items = e.clipboardData.items;\n      if (items.length) {\n        return this._addFilesFromItems(items);\n      }\n    };\n\n    Dropzone.prototype.handleFiles = function(files) {\n      var file, _i, _len, _results;\n      _results = [];\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        _results.push(this.addFile(file));\n      }\n      return _results;\n    };\n\n    Dropzone.prototype._addFilesFromItems = function(items) {\n      var entry, item, _i, _len, _results;\n      _results = [];\n      for (_i = 0, _len = items.length; _i < _len; _i++) {\n        item = items[_i];\n        if ((item.webkitGetAsEntry != null) && (entry = item.webkitGetAsEntry())) {\n          if (entry.isFile) {\n            _results.push(this.addFile(item.getAsFile()));\n          } else if (entry.isDirectory) {\n            _results.push(this._addFilesFromDirectory(entry, entry.name));\n          } else {\n            _results.push(void 0);\n          }\n        } else if (item.getAsFile != null) {\n          if ((item.kind == null) || item.kind === \"file\") {\n            _results.push(this.addFile(item.getAsFile()));\n          } else {\n            _results.push(void 0);\n          }\n        } else {\n          _results.push(void 0);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype._addFilesFromDirectory = function(directory, path) {\n      var dirReader, errorHandler, readEntries;\n      dirReader = directory.createReader();\n      errorHandler = function(error) {\n        return typeof console !== \"undefined\" && console !== null ? typeof console.log === \"function\" ? console.log(error) : void 0 : void 0;\n      };\n      readEntries = (function(_this) {\n        return function() {\n          return dirReader.readEntries(function(entries) {\n            var entry, _i, _len;\n            if (entries.length > 0) {\n              for (_i = 0, _len = entries.length; _i < _len; _i++) {\n                entry = entries[_i];\n                if (entry.isFile) {\n                  entry.file(function(file) {\n                    if (_this.options.ignoreHiddenFiles && file.name.substring(0, 1) === '.') {\n                      return;\n                    }\n                    file.fullPath = \"\" + path + \"/\" + file.name;\n                    return _this.addFile(file);\n                  });\n                } else if (entry.isDirectory) {\n                  _this._addFilesFromDirectory(entry, \"\" + path + \"/\" + entry.name);\n                }\n              }\n              readEntries();\n            }\n            return null;\n          }, errorHandler);\n        };\n      })(this);\n      return readEntries();\n    };\n\n    Dropzone.prototype.accept = function(file, done) {\n      if (file.size > this.options.maxFilesize * 1024 * 1024) {\n        return done(this.options.dictFileTooBig.replace(\"{{filesize}}\", Math.round(file.size / 1024 / 10.24) / 100).replace(\"{{maxFilesize}}\", this.options.maxFilesize));\n      } else if (!Dropzone.isValidFile(file, this.options.acceptedFiles)) {\n        return done(this.options.dictInvalidFileType);\n      } else if ((this.options.maxFiles != null) && this.getAcceptedFiles().length >= this.options.maxFiles) {\n        done(this.options.dictMaxFilesExceeded.replace(\"{{maxFiles}}\", this.options.maxFiles));\n        return this.emit(\"maxfilesexceeded\", file);\n      } else {\n        return this.options.accept.call(this, file, done);\n      }\n    };\n\n    Dropzone.prototype.addFile = function(file) {\n      file.upload = {\n        progress: 0,\n        total: file.size,\n        bytesSent: 0\n      };\n      this.files.push(file);\n      file.status = Dropzone.ADDED;\n      this.emit(\"addedfile\", file);\n      this._enqueueThumbnail(file);\n      return this.accept(file, (function(_this) {\n        return function(error) {\n          if (error) {\n            file.accepted = false;\n            _this._errorProcessing([file], error);\n          } else {\n            file.accepted = true;\n            if (_this.options.autoQueue) {\n              _this.enqueueFile(file);\n            }\n          }\n          return _this._updateMaxFilesReachedClass();\n        };\n      })(this));\n    };\n\n    Dropzone.prototype.enqueueFiles = function(files) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        this.enqueueFile(file);\n      }\n      return null;\n    };\n\n    Dropzone.prototype.enqueueFile = function(file) {\n      if (file.status === Dropzone.ADDED && file.accepted === true) {\n        file.status = Dropzone.QUEUED;\n        if (this.options.autoProcessQueue) {\n          return setTimeout(((function(_this) {\n            return function() {\n              return _this.processQueue();\n            };\n          })(this)), 0);\n        }\n      } else {\n        throw new Error(\"This file can't be queued because it has already been processed or was rejected.\");\n      }\n    };\n\n    Dropzone.prototype._thumbnailQueue = [];\n\n    Dropzone.prototype._processingThumbnail = false;\n\n    Dropzone.prototype._enqueueThumbnail = function(file) {\n      if (this.options.createImageThumbnails && file.type.match(/image.*/) && file.size <= this.options.maxThumbnailFilesize * 1024 * 1024) {\n        this._thumbnailQueue.push(file);\n        return setTimeout(((function(_this) {\n          return function() {\n            return _this._processThumbnailQueue();\n          };\n        })(this)), 0);\n      }\n    };\n\n    Dropzone.prototype._processThumbnailQueue = function() {\n      if (this._processingThumbnail || this._thumbnailQueue.length === 0) {\n        return;\n      }\n      this._processingThumbnail = true;\n      return this.createThumbnail(this._thumbnailQueue.shift(), (function(_this) {\n        return function() {\n          _this._processingThumbnail = false;\n          return _this._processThumbnailQueue();\n        };\n      })(this));\n    };\n\n    Dropzone.prototype.removeFile = function(file) {\n      if (file.status === Dropzone.UPLOADING) {\n        this.cancelUpload(file);\n      }\n      this.files = without(this.files, file);\n      this.emit(\"removedfile\", file);\n      if (this.files.length === 0) {\n        return this.emit(\"reset\");\n      }\n    };\n\n    Dropzone.prototype.removeAllFiles = function(cancelIfNecessary) {\n      var file, _i, _len, _ref;\n      if (cancelIfNecessary == null) {\n        cancelIfNecessary = false;\n      }\n      _ref = this.files.slice();\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.status !== Dropzone.UPLOADING || cancelIfNecessary) {\n          this.removeFile(file);\n        }\n      }\n      return null;\n    };\n\n    Dropzone.prototype.createThumbnail = function(file, callback) {\n      var fileReader;\n      fileReader = new FileReader;\n      fileReader.onload = (function(_this) {\n        return function() {\n          if (file.type === \"image/svg+xml\") {\n            _this.emit(\"thumbnail\", file, fileReader.result);\n            if (callback != null) {\n              callback();\n            }\n            return;\n          }\n          return _this.createThumbnailFromUrl(file, fileReader.result, callback);\n        };\n      })(this);\n      return fileReader.readAsDataURL(file);\n    };\n\n    Dropzone.prototype.createThumbnailFromUrl = function(file, imageUrl, callback, crossOrigin) {\n      var img;\n      img = document.createElement(\"img\");\n      if (crossOrigin) {\n        img.crossOrigin = crossOrigin;\n      }\n      img.onload = (function(_this) {\n        return function() {\n          var canvas, ctx, resizeInfo, thumbnail, _ref, _ref1, _ref2, _ref3;\n          file.width = img.width;\n          file.height = img.height;\n          resizeInfo = _this.options.resize.call(_this, file);\n          if (resizeInfo.trgWidth == null) {\n            resizeInfo.trgWidth = resizeInfo.optWidth;\n          }\n          if (resizeInfo.trgHeight == null) {\n            resizeInfo.trgHeight = resizeInfo.optHeight;\n          }\n          canvas = document.createElement(\"canvas\");\n          ctx = canvas.getContext(\"2d\");\n          canvas.width = resizeInfo.trgWidth;\n          canvas.height = resizeInfo.trgHeight;\n          drawImageIOSFix(ctx, img, (_ref = resizeInfo.srcX) != null ? _ref : 0, (_ref1 = resizeInfo.srcY) != null ? _ref1 : 0, resizeInfo.srcWidth, resizeInfo.srcHeight, (_ref2 = resizeInfo.trgX) != null ? _ref2 : 0, (_ref3 = resizeInfo.trgY) != null ? _ref3 : 0, resizeInfo.trgWidth, resizeInfo.trgHeight);\n          thumbnail = canvas.toDataURL(\"image/png\");\n          _this.emit(\"thumbnail\", file, thumbnail);\n          if (callback != null) {\n            return callback();\n          }\n        };\n      })(this);\n      if (callback != null) {\n        img.onerror = callback;\n      }\n      return img.src = imageUrl;\n    };\n\n    Dropzone.prototype.processQueue = function() {\n      var i, parallelUploads, processingLength, queuedFiles;\n      parallelUploads = this.options.parallelUploads;\n      processingLength = this.getUploadingFiles().length;\n      i = processingLength;\n      if (processingLength >= parallelUploads) {\n        return;\n      }\n      queuedFiles = this.getQueuedFiles();\n      if (!(queuedFiles.length > 0)) {\n        return;\n      }\n      if (this.options.uploadMultiple) {\n        return this.processFiles(queuedFiles.slice(0, parallelUploads - processingLength));\n      } else {\n        while (i < parallelUploads) {\n          if (!queuedFiles.length) {\n            return;\n          }\n          this.processFile(queuedFiles.shift());\n          i++;\n        }\n      }\n    };\n\n    Dropzone.prototype.processFile = function(file) {\n      return this.processFiles([file]);\n    };\n\n    Dropzone.prototype.processFiles = function(files) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.processing = true;\n        file.status = Dropzone.UPLOADING;\n        this.emit(\"processing\", file);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"processingmultiple\", files);\n      }\n      return this.uploadFiles(files);\n    };\n\n    Dropzone.prototype._getFilesWithXhr = function(xhr) {\n      var file, files;\n      return files = (function() {\n        var _i, _len, _ref, _results;\n        _ref = this.files;\n        _results = [];\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          file = _ref[_i];\n          if (file.xhr === xhr) {\n            _results.push(file);\n          }\n        }\n        return _results;\n      }).call(this);\n    };\n\n    Dropzone.prototype.cancelUpload = function(file) {\n      var groupedFile, groupedFiles, _i, _j, _len, _len1, _ref;\n      if (file.status === Dropzone.UPLOADING) {\n        groupedFiles = this._getFilesWithXhr(file.xhr);\n        for (_i = 0, _len = groupedFiles.length; _i < _len; _i++) {\n          groupedFile = groupedFiles[_i];\n          groupedFile.status = Dropzone.CANCELED;\n        }\n        file.xhr.abort();\n        for (_j = 0, _len1 = groupedFiles.length; _j < _len1; _j++) {\n          groupedFile = groupedFiles[_j];\n          this.emit(\"canceled\", groupedFile);\n        }\n        if (this.options.uploadMultiple) {\n          this.emit(\"canceledmultiple\", groupedFiles);\n        }\n      } else if ((_ref = file.status) === Dropzone.ADDED || _ref === Dropzone.QUEUED) {\n        file.status = Dropzone.CANCELED;\n        this.emit(\"canceled\", file);\n        if (this.options.uploadMultiple) {\n          this.emit(\"canceledmultiple\", [file]);\n        }\n      }\n      if (this.options.autoProcessQueue) {\n        return this.processQueue();\n      }\n    };\n\n    resolveOption = function() {\n      var args, option;\n      option = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      if (typeof option === 'function') {\n        return option.apply(this, args);\n      }\n      return option;\n    };\n\n    Dropzone.prototype.uploadFile = function(file) {\n      return this.uploadFiles([file]);\n    };\n\n    Dropzone.prototype.uploadFiles = function(files) {\n      var file, formData, handleError, headerName, headerValue, headers, i, input, inputName, inputType, key, method, option, progressObj, response, updateProgress, url, value, xhr, _i, _j, _k, _l, _len, _len1, _len2, _len3, _m, _ref, _ref1, _ref2, _ref3, _ref4, _ref5;\n      xhr = new XMLHttpRequest();\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.xhr = xhr;\n      }\n      method = resolveOption(this.options.method, files);\n      url = resolveOption(this.options.url, files);\n      xhr.open(method, url, true);\n      xhr.withCredentials = !!this.options.withCredentials;\n      response = null;\n      handleError = (function(_this) {\n        return function() {\n          var _j, _len1, _results;\n          _results = [];\n          for (_j = 0, _len1 = files.length; _j < _len1; _j++) {\n            file = files[_j];\n            _results.push(_this._errorProcessing(files, response || _this.options.dictResponseError.replace(\"{{statusCode}}\", xhr.status), xhr));\n          }\n          return _results;\n        };\n      })(this);\n      updateProgress = (function(_this) {\n        return function(e) {\n          var allFilesFinished, progress, _j, _k, _l, _len1, _len2, _len3, _results;\n          if (e != null) {\n            progress = 100 * e.loaded / e.total;\n            for (_j = 0, _len1 = files.length; _j < _len1; _j++) {\n              file = files[_j];\n              file.upload = {\n                progress: progress,\n                total: e.total,\n                bytesSent: e.loaded\n              };\n            }\n          } else {\n            allFilesFinished = true;\n            progress = 100;\n            for (_k = 0, _len2 = files.length; _k < _len2; _k++) {\n              file = files[_k];\n              if (!(file.upload.progress === 100 && file.upload.bytesSent === file.upload.total)) {\n                allFilesFinished = false;\n              }\n              file.upload.progress = progress;\n              file.upload.bytesSent = file.upload.total;\n            }\n            if (allFilesFinished) {\n              return;\n            }\n          }\n          _results = [];\n          for (_l = 0, _len3 = files.length; _l < _len3; _l++) {\n            file = files[_l];\n            _results.push(_this.emit(\"uploadprogress\", file, progress, file.upload.bytesSent));\n          }\n          return _results;\n        };\n      })(this);\n      xhr.onload = (function(_this) {\n        return function(e) {\n          var _ref;\n          if (files[0].status === Dropzone.CANCELED) {\n            return;\n          }\n          if (xhr.readyState !== 4) {\n            return;\n          }\n          response = xhr.responseText;\n          if (xhr.getResponseHeader(\"content-type\") && ~xhr.getResponseHeader(\"content-type\").indexOf(\"application/json\")) {\n            try {\n              response = JSON.parse(response);\n            } catch (_error) {\n              e = _error;\n              response = \"Invalid JSON response from server.\";\n            }\n          }\n          updateProgress();\n          if (!((200 <= (_ref = xhr.status) && _ref < 300))) {\n            return handleError();\n          } else {\n            return _this._finished(files, response, e);\n          }\n        };\n      })(this);\n      xhr.onerror = (function(_this) {\n        return function() {\n          if (files[0].status === Dropzone.CANCELED) {\n            return;\n          }\n          return handleError();\n        };\n      })(this);\n      progressObj = (_ref = xhr.upload) != null ? _ref : xhr;\n      progressObj.onprogress = updateProgress;\n      headers = {\n        \"Accept\": \"application/json\",\n        \"Cache-Control\": \"no-cache\",\n        \"X-Requested-With\": \"XMLHttpRequest\"\n      };\n      if (this.options.headers) {\n        extend(headers, this.options.headers);\n      }\n      for (headerName in headers) {\n        headerValue = headers[headerName];\n        if (headerValue) {\n          xhr.setRequestHeader(headerName, headerValue);\n        }\n      }\n      formData = new FormData();\n      if (this.options.params) {\n        _ref1 = this.options.params;\n        for (key in _ref1) {\n          value = _ref1[key];\n          formData.append(key, value);\n        }\n      }\n      for (_j = 0, _len1 = files.length; _j < _len1; _j++) {\n        file = files[_j];\n        this.emit(\"sending\", file, xhr, formData);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"sendingmultiple\", files, xhr, formData);\n      }\n      if (this.element.tagName === \"FORM\") {\n        _ref2 = this.element.querySelectorAll(\"input, textarea, select, button\");\n        for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {\n          input = _ref2[_k];\n          inputName = input.getAttribute(\"name\");\n          inputType = input.getAttribute(\"type\");\n          if (input.tagName === \"SELECT\" && input.hasAttribute(\"multiple\")) {\n            _ref3 = input.options;\n            for (_l = 0, _len3 = _ref3.length; _l < _len3; _l++) {\n              option = _ref3[_l];\n              if (option.selected) {\n                formData.append(inputName, option.value);\n              }\n            }\n          } else if (!inputType || ((_ref4 = inputType.toLowerCase()) !== \"checkbox\" && _ref4 !== \"radio\") || input.checked) {\n            formData.append(inputName, input.value);\n          }\n        }\n      }\n      for (i = _m = 0, _ref5 = files.length - 1; 0 <= _ref5 ? _m <= _ref5 : _m >= _ref5; i = 0 <= _ref5 ? ++_m : --_m) {\n        formData.append(this._getParamName(i), files[i], this._renameFilename(files[i].name));\n      }\n      return this.submitRequest(xhr, formData, files);\n    };\n\n    Dropzone.prototype.submitRequest = function(xhr, formData, files) {\n      return xhr.send(formData);\n    };\n\n    Dropzone.prototype._finished = function(files, responseText, e) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.status = Dropzone.SUCCESS;\n        this.emit(\"success\", file, responseText, e);\n        this.emit(\"complete\", file);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"successmultiple\", files, responseText, e);\n        this.emit(\"completemultiple\", files);\n      }\n      if (this.options.autoProcessQueue) {\n        return this.processQueue();\n      }\n    };\n\n    Dropzone.prototype._errorProcessing = function(files, message, xhr) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.status = Dropzone.ERROR;\n        this.emit(\"error\", file, message, xhr);\n        this.emit(\"complete\", file);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"errormultiple\", files, message, xhr);\n        this.emit(\"completemultiple\", files);\n      }\n      if (this.options.autoProcessQueue) {\n        return this.processQueue();\n      }\n    };\n\n    return Dropzone;\n\n  })(Emitter);\n\n  Dropzone.version = \"4.3.0\";\n\n  Dropzone.options = {};\n\n  Dropzone.optionsForElement = function(element) {\n    if (element.getAttribute(\"id\")) {\n      return Dropzone.options[camelize(element.getAttribute(\"id\"))];\n    } else {\n      return void 0;\n    }\n  };\n\n  Dropzone.instances = [];\n\n  Dropzone.forElement = function(element) {\n    if (typeof element === \"string\") {\n      element = document.querySelector(element);\n    }\n    if ((element != null ? element.dropzone : void 0) == null) {\n      throw new Error(\"No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.\");\n    }\n    return element.dropzone;\n  };\n\n  Dropzone.autoDiscover = true;\n\n  Dropzone.discover = function() {\n    var checkElements, dropzone, dropzones, _i, _len, _results;\n    if (document.querySelectorAll) {\n      dropzones = document.querySelectorAll(\".dropzone\");\n    } else {\n      dropzones = [];\n      checkElements = function(elements) {\n        var el, _i, _len, _results;\n        _results = [];\n        for (_i = 0, _len = elements.length; _i < _len; _i++) {\n          el = elements[_i];\n          if (/(^| )dropzone($| )/.test(el.className)) {\n            _results.push(dropzones.push(el));\n          } else {\n            _results.push(void 0);\n          }\n        }\n        return _results;\n      };\n      checkElements(document.getElementsByTagName(\"div\"));\n      checkElements(document.getElementsByTagName(\"form\"));\n    }\n    _results = [];\n    for (_i = 0, _len = dropzones.length; _i < _len; _i++) {\n      dropzone = dropzones[_i];\n      if (Dropzone.optionsForElement(dropzone) !== false) {\n        _results.push(new Dropzone(dropzone));\n      } else {\n        _results.push(void 0);\n      }\n    }\n    return _results;\n  };\n\n  Dropzone.blacklistedBrowsers = [/opera.*Macintosh.*version\\/12/i];\n\n  Dropzone.isBrowserSupported = function() {\n    var capableBrowser, regex, _i, _len, _ref;\n    capableBrowser = true;\n    if (window.File && window.FileReader && window.FileList && window.Blob && window.FormData && document.querySelector) {\n      if (!(\"classList\" in document.createElement(\"a\"))) {\n        capableBrowser = false;\n      } else {\n        _ref = Dropzone.blacklistedBrowsers;\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          regex = _ref[_i];\n          if (regex.test(navigator.userAgent)) {\n            capableBrowser = false;\n            continue;\n          }\n        }\n      }\n    } else {\n      capableBrowser = false;\n    }\n    return capableBrowser;\n  };\n\n  without = function(list, rejectedItem) {\n    var item, _i, _len, _results;\n    _results = [];\n    for (_i = 0, _len = list.length; _i < _len; _i++) {\n      item = list[_i];\n      if (item !== rejectedItem) {\n        _results.push(item);\n      }\n    }\n    return _results;\n  };\n\n  camelize = function(str) {\n    return str.replace(/[\\-_](\\w)/g, function(match) {\n      return match.charAt(1).toUpperCase();\n    });\n  };\n\n  Dropzone.createElement = function(string) {\n    var div;\n    div = document.createElement(\"div\");\n    div.innerHTML = string;\n    return div.childNodes[0];\n  };\n\n  Dropzone.elementInside = function(element, container) {\n    if (element === container) {\n      return true;\n    }\n    while (element = element.parentNode) {\n      if (element === container) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  Dropzone.getElement = function(el, name) {\n    var element;\n    if (typeof el === \"string\") {\n      element = document.querySelector(el);\n    } else if (el.nodeType != null) {\n      element = el;\n    }\n    if (element == null) {\n      throw new Error(\"Invalid `\" + name + \"` option provided. Please provide a CSS selector or a plain HTML element.\");\n    }\n    return element;\n  };\n\n  Dropzone.getElements = function(els, name) {\n    var e, el, elements, _i, _j, _len, _len1, _ref;\n    if (els instanceof Array) {\n      elements = [];\n      try {\n        for (_i = 0, _len = els.length; _i < _len; _i++) {\n          el = els[_i];\n          elements.push(this.getElement(el, name));\n        }\n      } catch (_error) {\n        e = _error;\n        elements = null;\n      }\n    } else if (typeof els === \"string\") {\n      elements = [];\n      _ref = document.querySelectorAll(els);\n      for (_j = 0, _len1 = _ref.length; _j < _len1; _j++) {\n        el = _ref[_j];\n        elements.push(el);\n      }\n    } else if (els.nodeType != null) {\n      elements = [els];\n    }\n    if (!((elements != null) && elements.length)) {\n      throw new Error(\"Invalid `\" + name + \"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.\");\n    }\n    return elements;\n  };\n\n  Dropzone.confirm = function(question, accepted, rejected) {\n    if (window.confirm(question)) {\n      return accepted();\n    } else if (rejected != null) {\n      return rejected();\n    }\n  };\n\n  Dropzone.isValidFile = function(file, acceptedFiles) {\n    var baseMimeType, mimeType, validType, _i, _len;\n    if (!acceptedFiles) {\n      return true;\n    }\n    acceptedFiles = acceptedFiles.split(\",\");\n    mimeType = file.type;\n    baseMimeType = mimeType.replace(/\\/.*$/, \"\");\n    for (_i = 0, _len = acceptedFiles.length; _i < _len; _i++) {\n      validType = acceptedFiles[_i];\n      validType = validType.trim();\n      if (validType.charAt(0) === \".\") {\n        if (file.name.toLowerCase().indexOf(validType.toLowerCase(), file.name.length - validType.length) !== -1) {\n          return true;\n        }\n      } else if (/\\/\\*$/.test(validType)) {\n        if (baseMimeType === validType.replace(/\\/.*$/, \"\")) {\n          return true;\n        }\n      } else {\n        if (mimeType === validType) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n\n  if (typeof jQuery !== \"undefined\" && jQuery !== null) {\n    jQuery.fn.dropzone = function(options) {\n      return this.each(function() {\n        return new Dropzone(this, options);\n      });\n    };\n  }\n\n  if (typeof module !== \"undefined\" && module !== null) {\n    module.exports = Dropzone;\n  } else {\n    window.Dropzone = Dropzone;\n  }\n\n  Dropzone.ADDED = \"added\";\n\n  Dropzone.QUEUED = \"queued\";\n\n  Dropzone.ACCEPTED = Dropzone.QUEUED;\n\n  Dropzone.UPLOADING = \"uploading\";\n\n  Dropzone.PROCESSING = Dropzone.UPLOADING;\n\n  Dropzone.CANCELED = \"canceled\";\n\n  Dropzone.ERROR = \"error\";\n\n  Dropzone.SUCCESS = \"success\";\n\n\n  /*\n  \n  Bugfix for iOS 6 and 7\n  Source: http://stackoverflow.com/questions/11929099/html5-canvas-drawimage-ratio-bug-ios\n  based on the work of https://github.com/stomita/ios-imagefile-megapixel\n   */\n\n  detectVerticalSquash = function(img) {\n    var alpha, canvas, ctx, data, ey, ih, iw, py, ratio, sy;\n    iw = img.naturalWidth;\n    ih = img.naturalHeight;\n    canvas = document.createElement(\"canvas\");\n    canvas.width = 1;\n    canvas.height = ih;\n    ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(img, 0, 0);\n    data = ctx.getImageData(0, 0, 1, ih).data;\n    sy = 0;\n    ey = ih;\n    py = ih;\n    while (py > sy) {\n      alpha = data[(py - 1) * 4 + 3];\n      if (alpha === 0) {\n        ey = py;\n      } else {\n        sy = py;\n      }\n      py = (ey + sy) >> 1;\n    }\n    ratio = py / ih;\n    if (ratio === 0) {\n      return 1;\n    } else {\n      return ratio;\n    }\n  };\n\n  drawImageIOSFix = function(ctx, img, sx, sy, sw, sh, dx, dy, dw, dh) {\n    var vertSquashRatio;\n    vertSquashRatio = detectVerticalSquash(img);\n    return ctx.drawImage(img, sx, sy, sw, sh, dx, dy, dw, dh / vertSquashRatio);\n  };\n\n\n  /*\n   * contentloaded.js\n   *\n   * Author: Diego Perini (diego.perini at gmail.com)\n   * Summary: cross-browser wrapper for DOMContentLoaded\n   * Updated: 20101020\n   * License: MIT\n   * Version: 1.2\n   *\n   * URL:\n   * http://javascript.nwbox.com/ContentLoaded/\n   * http://javascript.nwbox.com/ContentLoaded/MIT-LICENSE\n   */\n\n  contentLoaded = function(win, fn) {\n    var add, doc, done, init, poll, pre, rem, root, top;\n    done = false;\n    top = true;\n    doc = win.document;\n    root = doc.documentElement;\n    add = (doc.addEventListener ? \"addEventListener\" : \"attachEvent\");\n    rem = (doc.addEventListener ? \"removeEventListener\" : \"detachEvent\");\n    pre = (doc.addEventListener ? \"\" : \"on\");\n    init = function(e) {\n      if (e.type === \"readystatechange\" && doc.readyState !== \"complete\") {\n        return;\n      }\n      (e.type === \"load\" ? win : doc)[rem](pre + e.type, init, false);\n      if (!done && (done = true)) {\n        return fn.call(win, e.type || e);\n      }\n    };\n    poll = function() {\n      var e;\n      try {\n        root.doScroll(\"left\");\n      } catch (_error) {\n        e = _error;\n        setTimeout(poll, 50);\n        return;\n      }\n      return init(\"poll\");\n    };\n    if (doc.readyState !== \"complete\") {\n      if (doc.createEventObject && root.doScroll) {\n        try {\n          top = !win.frameElement;\n        } catch (_error) {}\n        if (top) {\n          poll();\n        }\n      }\n      doc[add](pre + \"DOMContentLoaded\", init, false);\n      doc[add](pre + \"readystatechange\", init, false);\n      return win[add](pre + \"load\", init, false);\n    }\n  };\n\n  Dropzone._autoDiscoverFunction = function() {\n    if (Dropzone.autoDiscover) {\n      return Dropzone.discover();\n    }\n  };\n\n  contentLoaded(window, Dropzone._autoDiscoverFunction);\n\n}).call(this);\n","/*\nattributes\n*/\"use strict\"\n\nvar $       = require(\"./base\")\n\nvar trim    = require(\"mout/string/trim\"),\n    forEach = require(\"mout/array/forEach\"),\n    filter  = require(\"mout/array/filter\"),\n    indexOf = require(\"mout/array/indexOf\")\n\n// attributes\n\n$.implement({\n\n    setAttribute: function(name, value){\n        return this.forEach(function(node){\n            node.setAttribute(name, value)\n        })\n    },\n\n    getAttribute: function(name){\n        var attr = this[0].getAttributeNode(name)\n        return (attr && attr.specified) ? attr.value : null\n    },\n\n    hasAttribute: function(name){\n        var node = this[0]\n        if (node.hasAttribute) return node.hasAttribute(name)\n        var attr = node.getAttributeNode(name)\n        return !!(attr && attr.specified)\n    },\n\n    removeAttribute: function(name){\n        return this.forEach(function(node){\n            var attr = node.getAttributeNode(name)\n            if (attr) node.removeAttributeNode(attr)\n        })\n    }\n\n})\n\nvar accessors = {}\n\nforEach([\"type\", \"value\", \"name\", \"href\", \"title\", \"id\"], function(name){\n\n    accessors[name] = function(value){\n        return (value !== undefined) ? this.forEach(function(node){\n            node[name] = value\n        }) : this[0][name]\n    }\n\n})\n\n// booleans\n\nforEach([\"checked\", \"disabled\", \"selected\"], function(name){\n\n    accessors[name] = function(value){\n        return (value !== undefined) ? this.forEach(function(node){\n            node[name] = !!value\n        }) : !!this[0][name]\n    }\n\n})\n\n// className\n\nvar classes = function(className){\n    var classNames = trim(className).replace(/\\s+/g, \" \").split(\" \"),\n        uniques    = {}\n\n    return filter(classNames, function(className){\n        if (className !== \"\" && !uniques[className]) return uniques[className] = className\n    }).sort()\n}\n\naccessors.className = function(className){\n    return (className !== undefined) ? this.forEach(function(node){\n        node.className = classes(className).join(\" \")\n    }) : classes(this[0].className).join(\" \")\n}\n\n// attribute\n\n$.implement({\n\n    attribute: function(name, value){\n        var accessor = accessors[name]\n        if (accessor) return accessor.call(this, value)\n        if (value != null) return this.setAttribute(name, value)\n        if (value === null) return this.removeAttribute(name)\n        if (value === undefined) return this.getAttribute(name)\n    }\n\n})\n\n$.implement(accessors)\n\n// shortcuts\n\n$.implement({\n\n    check: function(){\n        return this.checked(true)\n    },\n\n    uncheck: function(){\n        return this.checked(false)\n    },\n\n    disable: function(){\n        return this.disabled(true)\n    },\n\n    enable: function(){\n        return this.disabled(false)\n    },\n\n    select: function(){\n        return this.selected(true)\n    },\n\n    deselect: function(){\n        return this.selected(false)\n    }\n\n})\n\n// classNames, has / add / remove Class\n\n$.implement({\n\n    classNames: function(){\n        return classes(this[0].className)\n    },\n\n    hasClass: function(className){\n        return indexOf(this.classNames(), className) > -1\n    },\n\n    addClass: function(className){\n        return this.forEach(function(node){\n            var nodeClassName = node.className\n            var classNames = classes(nodeClassName + \" \" + className).join(\" \")\n            if (nodeClassName !== classNames) node.className = classNames\n        })\n    },\n\n    removeClass: function(className){\n        return this.forEach(function(node){\n            var classNames = classes(node.className)\n            forEach(classes(className), function(className){\n                var index = indexOf(classNames, className)\n                if (index > -1) classNames.splice(index, 1)\n            })\n            node.className = classNames.join(\" \")\n        })\n    },\n\n    toggleClass: function(className, force){\n        var add = force !== undefined ? force : !this.hasClass(className)\n        if (add)\n            this.addClass(className)\n        else\n            this.removeClass(className)\n        return !!add\n    }\n\n})\n\n// toString\n\n$.prototype.toString = function(){\n    var tag     = this.tag(),\n        id      = this.id(),\n        classes = this.classNames()\n\n    var str = tag\n    if (id) str += '#' + id\n    if (classes.length) str += '.' + classes.join(\".\")\n    return str\n}\n\nvar textProperty = (document.createElement('div').textContent == null) ? 'innerText' : 'textContent'\n\n// tag, html, text, data\n\n$.implement({\n\n    tag: function(){\n        return this[0].tagName.toLowerCase()\n    },\n\n    html: function(html){\n        return (html !== undefined) ? this.forEach(function(node){\n            node.innerHTML = html\n        }) : this[0].innerHTML\n    },\n\n    text: function(text){\n        return (text !== undefined) ? this.forEach(function(node){\n            node[textProperty] = text\n        }) : this[0][textProperty]\n    },\n\n    data: function(key, value){\n        switch(value) {\n            case undefined: return this.getAttribute(\"data-\" + key)\n            case null: return this.removeAttribute(\"data-\" + key)\n            default: return this.setAttribute(\"data-\" + key, value)\n        }\n    }\n\n})\n\nmodule.exports = $\n","/*\nelements\n*/\"use strict\"\n\nvar prime   = require(\"prime\")\n\nvar forEach = require(\"mout/array/forEach\"),\n    map     = require(\"mout/array/map\"),\n    filter  = require(\"mout/array/filter\"),\n    every   = require(\"mout/array/every\"),\n    some    = require(\"mout/array/some\")\n\n// uniqueID\n\nvar index = 0,\n    __dc = document.__counter,\n    counter = document.__counter = (__dc ? parseInt(__dc, 36) + 1 : 0).toString(36),\n    key = \"uid:\" + counter\n\nvar uniqueID = function(n){\n    if (n === window) return \"window\"\n    if (n === document) return \"document\"\n    if (n === document.documentElement) return \"html\"\n    return n[key] || (n[key] = (index++).toString(36))\n}\n\nvar instances = {}\n\n// elements prime\n\nvar $ = prime({constructor: function $(n, context){\n\n    if (n == null) return (this && this.constructor === $) ? new Elements : null\n\n    var self, uid\n\n    if (n.constructor !== Elements){\n\n        self = new Elements\n\n        if (typeof n === \"string\"){\n            if (!self.search) return null\n            self[self.length++] = context || document\n            return self.search(n)\n        }\n\n        if (n.nodeType || n === window){\n\n            self[self.length++] = n\n\n        } else if (n.length){\n\n            // this could be an array, or any object with a length attribute,\n            // including another instance of elements from another interface.\n\n            var uniques = {}\n\n            for (var i = 0, l = n.length; i < l; i++){ // perform elements flattening\n                var nodes = $(n[i], context)\n                if (nodes && nodes.length) for (var j = 0, k = nodes.length; j < k; j++){\n                    var node = nodes[j]\n                    uid = uniqueID(node)\n                    if (!uniques[uid]){\n                        self[self.length++] = node\n                        uniques[uid] = true\n                    }\n                }\n            }\n\n        }\n\n    } else {\n      self = n\n    }\n\n    if (!self.length) return null\n\n    // when length is 1 always use the same elements instance\n\n    if (self.length === 1){\n        uid = uniqueID(self[0])\n        return instances[uid] || (instances[uid] = self)\n    }\n\n    return self\n\n}})\n\nvar Elements = prime({\n\n    inherits: $,\n\n    constructor: function Elements(){\n        this.length = 0\n    },\n\n    unlink: function(){\n        return this.map(function(node){\n            delete instances[uniqueID(node)]\n            return node\n        })\n    },\n\n    // methods\n\n    forEach: function(method, context){\n        forEach(this, method, context)\n        return this\n    },\n\n    map: function(method, context){\n        return map(this, method, context)\n    },\n\n    filter: function(method, context){\n        return filter(this, method, context)\n    },\n\n    every: function(method, context){\n        return every(this, method, context)\n    },\n\n    some: function(method, context){\n        return some(this, method, context)\n    }\n\n})\n\nmodule.exports = $\n","/*\ndelegation\n*/\"use strict\"\n\nvar Map = require(\"prime/map\")\n\nvar $ = require(\"./events\")\n        require('./traversal')\n\n$.implement({\n\n    delegate: function(event, selector, handle, useCapture){\n\n        return this.forEach(function(node){\n\n            var self = $(node)\n\n            var delegation = self._delegation || (self._delegation = {}),\n                events     = delegation[event] || (delegation[event] = {}),\n                map        = (events[selector] || (events[selector] = new Map))\n\n            if (map.get(handle)) return\n\n            var action = function(e){\n                var target = $(e.target || e.srcElement),\n                    match  = target.matches(selector) ? target : target.parent(selector)\n\n                var res\n\n                if (match) res = handle.call(self, e, match)\n\n                return res\n            }\n\n            map.set(handle, action)\n\n            self.on(event, action, useCapture)\n\n        })\n\n    },\n\n    undelegate: function(event, selector, handle, useCapture){\n\n        return this.forEach(function(node){\n\n            var self = $(node), delegation, events, map\n\n            if (!(delegation = self._delegation) || !(events = delegation[event]) || !(map = events[selector])) return;\n\n            var action = map.get(handle)\n\n            if (action){\n                self.off(event, action, useCapture)\n                map.remove(action)\n\n                // if there are no more handles in a given selector, delete it\n                if (!map.count()) delete events[selector]\n                // var evc = evd = 0, x\n                var e1 = true, e2 = true, x\n                for (x in events){\n                    e1 = false\n                    break\n                }\n                // if no more selectors in a given event type, delete it\n                if (e1) delete delegation[event]\n                for (x in delegation){\n                    e2 = false\n                    break\n                }\n                // if there are no more delegation events in the element, delete the _delegation object\n                if (e2) delete self._delegation\n            }\n\n        })\n\n    }\n\n})\n\nmodule.exports = $\n","/*\ndomready\n*/\"use strict\"\n\nvar $ = require(\"./events\")\n\nvar readystatechange = 'onreadystatechange' in document,\n    shouldPoll       = false,\n    loaded           = false,\n    readys           = [],\n    checks           = [],\n    ready            = null,\n    timer            = null,\n    test             = document.createElement('div'),\n    doc              = $(document),\n    win              = $(window)\n\nvar domready = function(){\n\n    if (timer) timer = clearTimeout(timer)\n\n    if (!loaded){\n\n        if (readystatechange) doc.off('readystatechange', check)\n        doc.off('DOMContentLoaded', domready)\n        win.off('load', domready)\n\n        loaded = true\n\n        for (var i = 0; ready = readys[i++];) ready()\n    }\n\n    return loaded\n\n}\n\nvar check = function(){\n    for (var i = checks.length; i--;) if (checks[i]()) return domready()\n    return false\n}\n\nvar poll = function(){\n    clearTimeout(timer)\n    if (!check()) timer = setTimeout(poll, 1e3 / 60)\n}\n\nif (document.readyState){ // use readyState if available\n\n    var complete = function(){\n        return !!(/loaded|complete/).test(document.readyState)\n    }\n\n    checks.push(complete)\n\n    if (!complete()){ // unless dom is already loaded\n        if (readystatechange) doc.on('readystatechange', check) // onreadystatechange event\n        else shouldPoll = true //or poll readyState check\n    } else { // dom is already loaded\n        domready()\n    }\n\n}\n\nif (test.doScroll){ // also use doScroll if available (doscroll comes before readyState \"complete\")\n\n    // LEGAL DEPT:\n    // doScroll technique discovered by, owned by, and copyrighted to Diego Perini http://javascript.nwbox.com/IEContentLoaded/\n\n    // testElement.doScroll() throws when the DOM is not ready, only in the top window\n\n    var scrolls = function(){\n        try {\n            test.doScroll()\n            return true\n        } catch (e){}\n        return false\n    }\n\n    // If doScroll works already, it can't be used to determine domready\n    // e.g. in an iframe\n\n    if (!scrolls()){\n        checks.push(scrolls)\n        shouldPoll = true\n    }\n\n}\n\nif (shouldPoll) poll()\n\n// make sure that domready fires before load, also if not onreadystatechange and doScroll and DOMContentLoaded load will fire\ndoc.on('DOMContentLoaded', domready)\nwin.on('load', domready)\n\nmodule.exports = function(ready){\n    (loaded) ? ready() : readys.push(ready)\n    return null\n}\n","/*\nevents\n*/\"use strict\"\n\nvar Emitter = require(\"prime/emitter\")\n\nvar $ = require(\"./base\")\n\nvar html = document.documentElement\n\nvar addEventListener = html.addEventListener ? function(node, event, handle, useCapture){\n    node.addEventListener(event, handle, useCapture || false)\n    return handle\n} : function(node, event, handle){\n    node.attachEvent('on' + event, handle)\n    return handle\n}\n\nvar removeEventListener = html.removeEventListener ? function(node, event, handle, useCapture){\n    node.removeEventListener(event, handle, useCapture || false)\n} : function(node, event, handle){\n    node.detachEvent(\"on\" + event, handle)\n}\n\n$.implement({\n\n    on: function(event, handle, useCapture){\n\n        return this.forEach(function(node){\n            var self = $(node)\n\n            var internalEvent = event + (useCapture ? \":capture\" : \"\")\n\n            Emitter.prototype.on.call(self, internalEvent, handle)\n\n            var domListeners = self._domListeners || (self._domListeners = {})\n            if (!domListeners[internalEvent]) domListeners[internalEvent] = addEventListener(node, event, function(e){\n                Emitter.prototype.emit.call(self, internalEvent, e || window.event, Emitter.EMIT_SYNC)\n            }, useCapture)\n        })\n    },\n\n    off: function(event, handle, useCapture){\n\n        return this.forEach(function(node){\n\n            var self = $(node)\n\n            var internalEvent = event + (useCapture ? \":capture\" : \"\")\n\n            var domListeners = self._domListeners, domEvent, listeners = self._listeners, events\n\n            if (domListeners && (domEvent = domListeners[internalEvent]) && listeners && (events = listeners[internalEvent])){\n\n                Emitter.prototype.off.call(self, internalEvent, handle)\n\n                if (!self._listeners || !self._listeners[event]){\n                    removeEventListener(node, event, domEvent)\n                    delete domListeners[event]\n\n                    for (var l in domListeners) return\n                    delete self._domListeners\n                }\n\n            }\n        })\n    },\n\n    emit: function(){\n        var args = arguments\n        return this.forEach(function(node){\n            Emitter.prototype.emit.apply($(node), args)\n        })\n    }\n\n})\n\nmodule.exports = $\n","/*\nelements\n*/\"use strict\"\n\nvar $ = require(\"./base\")\n        require(\"./attributes\")\n        require(\"./events\")\n        require(\"./insertion\")\n        require(\"./traversal\")\n        require(\"./delegation\")\n\nmodule.exports = $\n","/*\ninsertion\n*/\"use strict\"\n\nvar $ = require(\"./base\")\n\n// base insertion\n\n$.implement({\n\n    appendChild: function(child){\n        this[0].appendChild($(child)[0])\n        return this\n    },\n\n    insertBefore: function(child, ref){\n        this[0].insertBefore($(child)[0], $(ref)[0])\n        return this\n    },\n\n    removeChild: function(child){\n        this[0].removeChild($(child)[0])\n        return this\n    },\n\n    replaceChild: function(child, ref){\n        this[0].replaceChild($(child)[0], $(ref)[0])\n        return this\n    }\n\n})\n\n// before, after, bottom, top\n\n$.implement({\n\n    before: function(element){\n        element = $(element)[0]\n        var parent = element.parentNode\n        if (parent) this.forEach(function(node){\n            parent.insertBefore(node, element)\n        })\n        return this\n    },\n\n    after: function(element){\n        element = $(element)[0]\n        var parent = element.parentNode\n        if (parent) this.forEach(function(node){\n            parent.insertBefore(node, element.nextSibling)\n        })\n        return this\n    },\n\n    bottom: function(element){\n        element = $(element)[0]\n        return this.forEach(function(node){\n            element.appendChild(node)\n        })\n    },\n\n    top: function(element){\n        element = $(element)[0]\n        return this.forEach(function(node){\n            element.insertBefore(node, element.firstChild)\n        })\n    }\n\n})\n\n// insert, replace\n\n$.implement({\n\n    insert: $.prototype.bottom,\n\n    remove: function(){\n        return this.forEach(function(node){\n            var parent = node.parentNode\n            if (parent) parent.removeChild(node)\n        })\n    },\n\n    replace: function(element){\n        element = $(element)[0]\n        element.parentNode.replaceChild(this[0], element)\n        return this\n    }\n\n})\n\nmodule.exports = $\n","var makeIterator = require('../function/makeIterator_');\n\n    /**\n     * Array every\n     */\n    function every(arr, callback, thisObj) {\n        callback = makeIterator(callback, thisObj);\n        var result = true;\n        if (arr == null) {\n            return result;\n        }\n\n        var i = -1, len = arr.length;\n        while (++i < len) {\n            // we iterate over sparse items since there is no way to make it\n            // work properly on IE 7-8. see #64\n            if (!callback(arr[i], i, arr) ) {\n                result = false;\n                break;\n            }\n        }\n\n        return result;\n    }\n\n    module.exports = every;\n\n","var makeIterator = require('../function/makeIterator_');\n\n    /**\n     * Array filter\n     */\n    function filter(arr, callback, thisObj) {\n        callback = makeIterator(callback, thisObj);\n        var results = [];\n        if (arr == null) {\n            return results;\n        }\n\n        var i = -1, len = arr.length, value;\n        while (++i < len) {\n            value = arr[i];\n            if (callback(value, i, arr)) {\n                results.push(value);\n            }\n        }\n\n        return results;\n    }\n\n    module.exports = filter;\n\n\n","var makeIterator = require('../function/makeIterator_');\n\n    /**\n     * Array map\n     */\n    function map(arr, callback, thisObj) {\n        callback = makeIterator(callback, thisObj);\n        var results = [];\n        if (arr == null){\n            return results;\n        }\n\n        var i = -1, len = arr.length;\n        while (++i < len) {\n            results[i] = callback(arr[i], i, arr);\n        }\n\n        return results;\n    }\n\n     module.exports = map;\n\n","var makeIterator = require('../function/makeIterator_');\n\n    /**\n     * Array some\n     */\n    function some(arr, callback, thisObj) {\n        callback = makeIterator(callback, thisObj);\n        var result = false;\n        if (arr == null) {\n            return result;\n        }\n\n        var i = -1, len = arr.length;\n        while (++i < len) {\n            // we iterate over sparse items since there is no way to make it\n            // work properly on IE 7-8. see #64\n            if ( callback(arr[i], i, arr) ) {\n                result = true;\n                break;\n            }\n        }\n\n        return result;\n    }\n\n    module.exports = some;\n\n","\n\n    /**\n     * Returns the first argument provided to it.\n     */\n    function identity(val){\n        return val;\n    }\n\n    module.exports = identity;\n\n\n","var identity = require('./identity');\nvar prop = require('./prop');\nvar deepMatches = require('../object/deepMatches');\n\n    /**\n     * Converts argument into a valid iterator.\n     * Used internally on most array/object/collection methods that receives a\n     * callback/iterator providing a shortcut syntax.\n     */\n    function makeIterator(src, thisObj){\n        if (src == null) {\n            return identity;\n        }\n        switch(typeof src) {\n            case 'function':\n                // function is the first to improve perf (most common case)\n                // also avoid using `Function#call` if not needed, which boosts\n                // perf a lot in some cases\n                return (typeof thisObj !== 'undefined')? function(val, i, arr){\n                    return src.call(thisObj, val, i, arr);\n                } : src;\n            case 'object':\n                return function(val){\n                    return deepMatches(val, src);\n                };\n            case 'string':\n            case 'number':\n                return prop(src);\n        }\n    }\n\n    module.exports = makeIterator;\n\n\n","\n\n    /**\n     * Returns a function that gets a property of the passed object\n     */\n    function prop(name){\n        return function(obj){\n            return obj[name];\n        };\n    }\n\n    module.exports = prop;\n\n\n","var forOwn = require('./forOwn');\nvar isArray = require('../lang/isArray');\n\n    function containsMatch(array, pattern) {\n        var i = -1, length = array.length;\n        while (++i < length) {\n            if (deepMatches(array[i], pattern)) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    function matchArray(target, pattern) {\n        var i = -1, patternLength = pattern.length;\n        while (++i < patternLength) {\n            if (!containsMatch(target, pattern[i])) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    function matchObject(target, pattern) {\n        var result = true;\n        forOwn(pattern, function(val, key) {\n            if (!deepMatches(target[key], val)) {\n                // Return false to break out of forOwn early\n                return (result = false);\n            }\n        });\n\n        return result;\n    }\n\n    /**\n     * Recursively check if the objects match.\n     */\n    function deepMatches(target, pattern){\n        if (target && typeof target === 'object') {\n            if (isArray(target) && isArray(pattern)) {\n                return matchArray(target, pattern);\n            } else {\n                return matchObject(target, pattern);\n            }\n        } else {\n            return target === pattern;\n        }\n    }\n\n    module.exports = deepMatches;\n\n\n","/*\ntraversal\n*/\"use strict\"\n\nvar map = require(\"mout/array/map\")\n\nvar slick = require(\"slick\")\n\nvar $ = require(\"./base\")\n\nvar gen = function(combinator, expression){\n    return map(slick.parse(expression || \"*\"), function(part){\n        return combinator + \" \" + part\n    }).join(\", \")\n}\n\nvar push_ = Array.prototype.push\n\n$.implement({\n\n    search: function(expression){\n        if (this.length === 1) return $(slick.search(expression, this[0], new $))\n\n        var buffer = []\n        for (var i = 0, node; node = this[i]; i++) push_.apply(buffer, slick.search(expression, node))\n        buffer = $(buffer)\n        return buffer && buffer.sort()\n    },\n\n    find: function(expression){\n        if (this.length === 1) return $(slick.find(expression, this[0]))\n\n        for (var i = 0, node; node = this[i]; i++) {\n            var found = slick.find(expression, node)\n            if (found) return $(found)\n        }\n\n        return null\n    },\n\n    sort: function(){\n        return slick.sort(this)\n    },\n\n    matches: function(expression){\n        return slick.matches(this[0], expression)\n    },\n\n    contains: function(node){\n        return slick.contains(this[0], node)\n    },\n\n    nextSiblings: function(expression){\n        return this.search(gen('~', expression))\n    },\n\n    nextSibling: function(expression){\n        return this.find(gen('+', expression))\n    },\n\n    previousSiblings: function(expression){\n        return this.search(gen('!~', expression))\n    },\n\n    previousSibling: function(expression){\n        return this.find(gen('!+', expression))\n    },\n\n    children: function(expression){\n        return this.search(gen('>', expression))\n    },\n\n    firstChild: function(expression){\n        return this.find(gen('^', expression))\n    },\n\n    lastChild: function(expression){\n        return this.find(gen('!^', expression))\n    },\n\n    parent: function(expression){\n        var buffer = []\n        loop: for (var i = 0, node; node = this[i]; i++) while ((node = node.parentNode) && (node !== document)){\n            if (!expression || slick.matches(node, expression)){\n                buffer.push(node)\n                break loop\n                break\n            }\n        }\n        return $(buffer)\n    },\n\n    parents: function(expression){\n        var buffer = []\n        for (var i = 0, node; node = this[i]; i++) while ((node = node.parentNode) && (node !== document)){\n            if (!expression || slick.matches(node, expression)) buffer.push(node)\n        }\n        return $(buffer)\n    }\n\n})\n\nmodule.exports = $\n","/*\nzen\n*/\"use strict\"\n\nvar forEach = require(\"mout/array/forEach\"),\n    map     = require(\"mout/array/map\")\n\nvar parse = require(\"slick/parser\")\n\nvar $ = require(\"./base\")\n\nmodule.exports = function(expression, doc){\n\n    return $(map(parse(expression), function(expression){\n\n        var previous, result\n\n        forEach(expression, function(part, i){\n\n            var node = (doc || document).createElement(part.tag)\n\n            if (part.id) node.id = part.id\n\n            if (part.classList) node.className = part.classList.join(\" \")\n\n            if (part.attributes) forEach(part.attributes, function(attribute){\n                node.setAttribute(attribute.name, attribute.value || \"\")\n            })\n\n            if (part.pseudos) forEach(part.pseudos, function(pseudo){\n                var n = $(node), method = n[pseudo.name]\n                if (method) method.call(n, pseudo.value)\n            })\n\n            if (i === 0){\n\n                result = node\n\n            } else if (part.combinator === \" \"){\n\n                previous.appendChild(node)\n\n            } else if (part.combinator === \"+\"){\n                var parentNode = previous.parentNode\n                if (parentNode) parentNode.appendChild(node)\n            }\n\n            previous = node\n\n        })\n\n        return result\n\n    }))\n\n}\n","/*          .-   3\n.-.-..-..-.-|-._.\n' ' '`-'`-' ' ' '\n*/\"use strict\"\n\n// color and timer\nvar color = require(\"./lib/color\"),\n    frame = require(\"./lib/frame\")\n\n// if we're in a browser we need ./browser, otherwise ./fx\nvar moofx = (typeof document !== \"undefined\") ? require(\"./lib/browser\") : require(\"./lib/fx\")\n\nmoofx.requestFrame = function(callback){\n    frame.request(callback)\n    return this\n}\n\nmoofx.cancelFrame = function(callback){\n    frame.cancel(callback)\n    return this\n}\n\nmoofx.color = color\n\n// and export moofx\n\nmodule.exports = moofx\n","/*\nMooFx\n*/\"use strict\"\n\n// requires\n\nvar color  = require(\"./color\"),\n    frame  = require(\"./frame\")\n\nvar cancelFrame = frame.cancel,\n    requestFrame = frame.request\n\nvar prime  = require(\"prime\")\n\nvar camelize        = require(\"prime/string/camelize\"),\n    clean           = require(\"prime/string/clean\"),\n    capitalize      = require(\"prime/string/capitalize\"),\n    hyphenateString = require(\"prime/string/hyphenate\")\n\nvar map     = require(\"prime/array/map\"),\n    forEach = require(\"prime/array/forEach\"),\n    indexOf = require(\"prime/array/indexOf\")\n\nvar elements = require(\"elements\")\n\nvar fx = require(\"./fx\")\n\n// util\n\nvar matchString = function(s, r){\n    return String.prototype.match.call(s, r);\n}\n\nvar hyphenated = {}\nvar hyphenate = function(self){\n    return hyphenated[self] || (hyphenated[self] = hyphenateString(self))\n}\n\nvar round = function(n){\n    return Math.round(n * 1e3) / 1e3\n}\n\n// compute > node > property\n\nvar compute = global.getComputedStyle ? function(node){\n    var cts = getComputedStyle(node, null)\n    return function(property){\n        return cts ? cts.getPropertyValue(hyphenate(property)) : \"\"\n    }\n} : /*(css3)?*/function(node){\n    var cts = node.currentStyle\n    return function(property){\n        return cts ? cts[camelize(property)] : \"\"\n    }\n}/*:null*/\n\n// pixel ratio retriever\n\nvar test = document.createElement(\"div\")\n\nvar cssText = \"border:none;margin:none;padding:none;visibility:hidden;position:absolute;height:0;\";\n\n// returns the amount of pixels that takes to make one of the unit\n\nvar pixelRatio = function(element, u){\n    var parent = element.parentNode, ratio = 1\n    if (parent){\n        test.style.cssText = cssText + (\"width:100\" + u + \";\")\n        parent.appendChild(test)\n        ratio = test.offsetWidth / 100\n        parent.removeChild(test)\n    }\n    return ratio\n}\n\n// mirror 4 values\n\nvar mirror4 = function(values){\n    var length = values.length\n    if      (length === 1) values.push(values[0], values[0], values[0])\n    else if (length === 2) values.push(values[0], values[1])\n    else if (length === 3) values.push(values[1])\n    return values\n}\n\n// regular expressions strings\n\nvar sLength      = \"([-.\\\\d]+)(%|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vm)\",\n    sLengthNum   = sLength + \"?\",\n    sBorderStyle = \"none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset|inherit\"\n\n// regular expressions\n\nvar rgLength     = RegExp(sLength, \"g\"),\n    rLengthNum   = RegExp(sLengthNum),\n    rgLengthNum  = RegExp(sLengthNum, \"g\"),\n    rBorderStyle = RegExp(sBorderStyle)\n\n// normalize > css\n\nvar parseString = function(value){\n    return (value == null) ? \"\" : value + \"\"\n}\n\nvar parseOpacity = function(value, normalize){\n    if (value == null || value === \"\") return normalize ? \"1\" : \"\"\n    return (isFinite((value = +value))) ? (value < 0 ? \"0\" : value + \"\") : \"1\"\n}\n\ntry {test.style.color = \"rgba(0,0,0,0.5)\"} catch(e){}\nvar rgba = /^rgba/.test(test.style.color)\n\nvar parseColor = function(value, normalize){\n    var black = \"rgba(0,0,0,1)\", c\n    if (!value || !(c = color(value, true))) return normalize ? black : \"\"\n    if (normalize) return \"rgba(\" + c + \")\"\n\n    var alpha = c[3]\n    if (alpha === 0) return \"transparent\"\n    return (!rgba || alpha === 1) ? \"rgb(\" + c.slice(0, 3) + \")\" : \"rgba(\" + c + \")\"\n}\n\nvar parseLength = function(value, normalize){\n    if (value == null || value === \"\") return normalize ? \"0px\" : \"\"\n    var match = matchString(value, rLengthNum)\n    return match ? match[1] + (match[2] || \"px\") : value // cannot be parsed. probably \"auto\"\n}\n\nvar parseBorderStyle = function(value, normalize){\n    if (value == null || value === \"\") return normalize ? \"none\" : \"\"\n    var match = value.match(rBorderStyle)\n    return match ? value : normalize ? \"none\" : \"\"\n}\n\nvar parseBorder = function(value, normalize){\n    var normalized = \"0px none rgba(0,0,0,1)\"\n    if (value == null || value === \"\")     return normalize ? normalized : \"\"\n    if (value === 0   || value === \"none\") return normalize ? normalized : value + \"\"\n\n    var c\n    value = value.replace(color.x, function(match){\n        c = match\n        return \"\"\n    })\n\n    var s = value.match(rBorderStyle),\n        l = value.match(rgLengthNum)\n\n    return clean([\n        parseLength(l ? l[0] : \"\", normalize),\n        parseBorderStyle(s ? s[0] : \"\", normalize),\n        parseColor(c, normalize)\n    ].join(\" \"))\n}\n\nvar parseShort4 = function(value, normalize){\n    if (value == null || value === \"\") return normalize ? \"0px 0px 0px 0px\" : \"\"\n    return clean(mirror4(map(clean(value).split(\" \"), function(v){\n        return parseLength(v, normalize)\n    })).join(\" \"))\n}\n\nvar parseShadow = function(value, normalize, len){\n    var transparent = \"rgba(0,0,0,0)\",\n        normalized  = (len === 3) ? transparent + \" 0px 0px 0px\" : transparent + \" 0px 0px 0px 0px\"\n\n    if (value ==  null || value === \"\") return normalize ? normalized : \"\"\n    if (value === \"none\") return normalize ? normalized : value\n\n    var colors = [], value = clean(value).replace(color.x, function(match){\n        colors.push(match)\n        return \"\"\n    })\n\n    return map(value.split(\",\"), function(shadow, i){\n\n        var c       = parseColor(colors[i], normalize),\n            inset   = /inset/.test(shadow),\n            lengths = shadow.match(rgLengthNum) || [\"0px\"]\n\n        lengths = map(lengths, function(m){\n            return parseLength(m, normalize)\n        })\n\n        while (lengths.length < len) lengths.push(\"0px\")\n\n        var ret = inset ? [\"inset\", c] : [c]\n\n        return ret.concat(lengths).join(\" \")\n\n    }).join(\", \")\n}\n\nvar parse = function(value, normalize){\n    if (value == null || value === \"\") return \"\" // cant normalize \"\" || null\n    return value.replace(color.x, function(match){\n        return parseColor(match, normalize)\n    }).replace(rgLength, function(match){\n        return parseLength(match, normalize)\n    })\n}\n\n// get && set\n\nvar getters = {}, setters = {}, parsers = {}, aliases = {}\n\nvar getter = function(key){\n    return getters[key] || (getters[key] = (function(){\n        var alias  = aliases[key] || key,\n            parser = parsers[key] || parse\n\n        return function(){\n            return parser(compute(this)(alias), true)\n        }\n\n    }()))\n}\n\nvar setter = function(key){\n    return setters[key] || (setters[key] = (function(){\n\n        var alias  = aliases[key] || key,\n            parser = parsers[key] || parse\n\n        return function(value){\n            this.style[alias] = parser(value, false)\n        }\n\n    }()))\n}\n\n// parsers\n\nvar trbl = [\"Top\", \"Right\", \"Bottom\", \"Left\"], tlbl = [\"TopLeft\", \"TopRight\", \"BottomRight\", \"BottomLeft\"]\n\nforEach(trbl, function(d){\n    var bd = \"border\" + d\n    forEach([ \"margin\" + d, \"padding\" + d, bd + \"Width\", d.toLowerCase()], function(n){\n        parsers[n] = parseLength\n    })\n    parsers[bd + \"Color\"] = parseColor\n    parsers[bd + \"Style\"] = parseBorderStyle\n\n    // borderDIR\n    parsers[bd] = parseBorder\n    getters[bd] = function(){\n        return [\n            getter(bd + \"Width\").call(this),\n            getter(bd + \"Style\").call(this),\n            getter(bd + \"Color\").call(this)\n        ].join(\" \")\n    }\n})\n\nforEach(tlbl, function(d){\n    parsers[\"border\" + d + \"Radius\"] = parseLength\n})\n\nparsers.color = parsers.backgroundColor = parseColor\nparsers.width = parsers.height = parsers.minWidth = parsers.minHeight = parsers.maxWidth = parsers.maxHeight = parsers.fontSize = parsers.backgroundSize = parseLength\n\n// margin + padding\n\nforEach([\"margin\", \"padding\"], function(name){\n    parsers[name] = parseShort4\n    getters[name] = function(){\n        return map(trbl, function(d){\n            return getter(name + d).call(this)\n        }, this).join(\" \")\n    }\n})\n\n// borders\n\n// borderDIRWidth, borderDIRStyle, borderDIRColor\n\nparsers.borderWidth = parseShort4\n\nparsers.borderStyle = function(value, normalize){\n    if (value == null || value === \"\") return normalize ? mirror4([\"none\"]).join(\" \") : \"\"\n    value = clean(value).split(\" \")\n    return clean(mirror4(map(value, function(v){\n        parseBorderStyle(v, normalize)\n    })).join(\" \"))\n}\n\nparsers.borderColor = function(value, normalize){\n    if (!value || !(value = matchString(value, color.x))) return normalize ? mirror4([\"rgba(0,0,0,1)\"]).join(\" \") : \"\"\n    return clean(mirror4(map(value, function(v){\n        return parseColor(v, normalize)\n    })).join(\" \"))\n}\n\nforEach([\"Width\", \"Style\", \"Color\"], function(name){\n    getters[\"border\" + name] = function(){\n        return map(trbl, function(d){\n            return getter(\"border\" + d + name).call(this)\n        }, this).join(\" \")\n    }\n})\n\n// borderRadius\n\nparsers.borderRadius = parseShort4\n\ngetters.borderRadius = function(){\n    return map(tlbl, function(d){\n        return getter(\"border\" + d + \"Radius\").call(this)\n    }, this).join(\" \")\n}\n\n// border\n\nparsers.border = parseBorder\n\ngetters.border = function(){\n    var pvalue\n    for (var i = 0; i < trbl.length; i++){\n        var value = getter(\"border\" + trbl[i]).call(this)\n        if (pvalue && value !== pvalue) return null\n        pvalue = value\n    }\n    return pvalue\n}\n\n// zIndex\n\nparsers.zIndex = parseString\n\n// opacity\n\nparsers.opacity = parseOpacity\n\n/*(css3)?*/\n\nvar filterName = (test.style.MsFilter != null && \"MsFilter\") || (test.style.filter != null && \"filter\")\n\nif (filterName && test.style.opacity == null){\n\n    var matchOp = /alpha\\(opacity=([\\d.]+)\\)/i\n\n    setters.opacity = function(value){\n        value = ((value = parseOpacity(value)) === \"1\") ? \"\" : \"alpha(opacity=\" + Math.round(value * 100) + \")\"\n        var filter = compute(this)(filterName)\n        return this.style[filterName] = matchOp.test(filter) ? filter.replace(matchOp, value) : filter + \" \" + value\n    }\n\n    getters.opacity = function(){\n        var match = compute(this)(filterName).match(matchOp)\n        return (!match ? 1 : match[1] / 100) + \"\"\n    }\n\n}/*:*/\n\nvar parseBoxShadow = parsers.boxShadow = function(value, normalize){\n    return parseShadow(value, normalize, 4)\n}\n\nvar parseTextShadow = parsers.textShadow = function(value, normalize){\n    return parseShadow(value, normalize, 3)\n}\n\n// Aliases\n\nforEach(['Webkit', \"Moz\", \"ms\", \"O\", null], function(prefix){\n    forEach([\n        \"transition\", \"transform\", \"transformOrigin\", \"transformStyle\", \"perspective\", \"perspectiveOrigin\", \"backfaceVisibility\"\n    ], function(style){\n        var cc = prefix ? prefix + capitalize(style) : style\n        if (prefix === \"ms\") hyphenated[cc] = \"-ms-\" + hyphenate(style)\n        if (test.style[cc] != null) aliases[style] = cc\n    })\n})\n\nvar transitionName = aliases.transition,\n    transformName  = aliases.transform\n\n// manually disable css3 transitions in Opera, because they do not work properly.\n\nif (transitionName === \"OTransition\") transitionName = null\n\n\n// this takes care of matrix decomposition on browsers that support only 2d transforms but no CSS3 transitions.\n// basically, IE9 (and Opera as well, since we disabled CSS3 transitions manually)\n\nvar parseTransform2d, Transform2d\n\n/*(css3)?*/\n\nif (!transitionName && transformName) (function(){\n\n    var unmatrix = require(\"./unmatrix2d\")\n\n    var v = \"\\\\s*([-\\\\d\\\\w.]+)\\\\s*\"\n\n    var rMatrix = RegExp(\"matrix\\\\(\" + [v, v, v, v, v, v] + \"\\\\)\")\n\n    var decomposeMatrix = function(matrix){\n\n        var d = unmatrix.apply(null, matrix.match(rMatrix).slice(1)) || [[0, 0], 0, 0, [0, 0]]\n\n        return [\n\n            \"translate(\" + map(d[0], function(v){return round(v) + \"px\"}) + \")\",\n            \"rotate(\" + round(d[1] * 180 / Math.PI) + \"deg)\",\n            \"skewX(\" + round(d[2] * 180 / Math.PI) + \"deg)\",\n            \"scale(\" + map(d[3], round) + \")\"\n\n        ].join(\" \")\n\n    }\n\n    var def0px  = function(value){return value || \"0px\"},\n        def1    = function(value){return value || \"1\"},\n        def0deg = function(value){return value || \"0deg\"}\n\n    var transforms = {\n\n        translate: function(value){\n            if (!value) value = \"0px,0px\"\n            var values = value.split(\",\")\n            if (!values[1]) values[1] = \"0px\"\n            return map(values, clean) + \"\"\n        },\n        translateX: def0px,\n        translateY: def0px,\n        scale: function(value){\n            if (!value) value = \"1,1\"\n            var values = value.split(\",\")\n            if (!values[1]) values[1] = values[0]\n            return map(values, clean) + \"\"\n        },\n        scaleX: def1,\n        scaleY: def1,\n        rotate: def0deg,\n        skewX: def0deg,\n        skewY: def0deg\n\n    }\n\n    Transform2d = prime({\n\n        constructor: function(transform){\n\n            var names = this.names = []\n            var values = this.values = []\n\n            transform.replace(/(\\w+)\\(([-.\\d\\s\\w,]+)\\)/g, function(match, name, value){\n                names.push(name)\n                values.push(value)\n            })\n\n        },\n\n        identity: function(){\n            var functions = []\n            forEach(this.names, function(name){\n                var fn = transforms[name]\n                if (fn) functions.push(name + \"(\" + fn() + \")\")\n            })\n            return functions.join(\" \")\n        },\n\n        sameType: function(transformObject){\n            return this.names.toString() === transformObject.names.toString()\n        },\n\n        // this is, basically, cheating.\n        // retrieving the matrix value from the dom, rather than calculating it\n\n        decompose: function(){\n            var transform = this.toString()\n\n            test.style.cssText = cssText + hyphenate(transformName) + \":\" + transform + \";\"\n            document.body.appendChild(test)\n            var m = compute(test)(transformName)\n            if (!m || m === \"none\") m = \"matrix(1, 0, 0, 1, 0, 0)\"\n            document.body.removeChild(test)\n            return decomposeMatrix(m)\n        }\n\n    })\n\n    Transform2d.prototype.toString = function(clean){\n        var values = this.values, functions = []\n        forEach(this.names, function(name, i){\n            var fn = transforms[name]\n            if (!fn) return\n            var value = fn(values[i])\n            if (!clean || value !== fn()) functions.push(name + \"(\" + value + \")\")\n        })\n        return functions.length ? functions.join(\" \") : \"none\"\n    }\n\n    Transform2d.union = function(from, to){\n\n        if (from === to) return // nothing to do\n\n        var fromMap, toMap\n\n        if (from === \"none\"){\n\n            toMap   = new Transform2d(to)\n            to      = toMap.toString()\n            from    = toMap.identity()\n            fromMap = new Transform2d(from)\n\n        } else if (to === \"none\"){\n\n            fromMap = new Transform2d(from)\n            from    = fromMap.toString()\n            to      = fromMap.identity()\n            toMap   = new Transform2d(to)\n\n        } else {\n\n            fromMap = new Transform2d(from)\n            from    = fromMap.toString()\n            toMap   = new Transform2d(to)\n            to      = toMap.toString()\n\n        }\n\n        if (from === to) return // nothing to do\n\n        if (!fromMap.sameType(toMap)){\n\n            from = fromMap.decompose()\n            to   = toMap.decompose()\n\n        }\n\n        if (from === to) return // nothing to do\n\n        return [from, to]\n\n    }\n\n    // this parser makes sure it never gets \"matrix\"\n\n    parseTransform2d = parsers.transform = function(transform){\n        if (!transform || transform === \"none\") return \"none\"\n        return new Transform2d(rMatrix.test(transform) ? decomposeMatrix(transform) : transform).toString(true)\n    }\n\n    // this getter makes sure we read from the dom only the first time\n    // this way we save the actual transform and not \"matrix\"\n    // setting matrix() will use parseTransform2d as well, thus setting the decomposed matrix\n\n    getters.transform = function(){\n        var s = this.style\n        return s[transformName] || (s[transformName] = parseTransform2d(compute(this)(transformName)))\n    }\n\n\n})()/*:*/\n\n// tries to match from and to values\n\nvar prepare = function(node, property, to){\n\n    var parser = parsers[property] || parse,\n        from   = getter(property).call(node), // \"normalized\" by the getter\n        to     = parser(to, true) // normalize parsed property\n\n    if (from === to) return\n\n    if (parser === parseLength || parser === parseBorder || parser === parseShort4){\n\n        var toAll = to.match(rgLength), i = 0 // this should always match something\n\n        if (toAll) from = from.replace(rgLength, function(fromFull, fromValue, fromUnit){\n\n            var toFull    = toAll[i++],\n                toMatched = toFull.match(rLengthNum),\n                toUnit    = toMatched[2]\n\n            if (fromUnit !== toUnit){\n                var fromPixels = (fromUnit === \"px\") ? fromValue : pixelRatio(node, fromUnit) * fromValue\n                return round(fromPixels / pixelRatio(node, toUnit)) + toUnit\n            }\n\n            return fromFull\n\n        })\n\n        if (i > 0) setter(property).call(node, from)\n\n    }/*(css3)?*/else if (parser === parseTransform2d){ // IE9/Opera\n\n        return Transform2d.union(from, to)\n\n    }/*:*/\n\n    return (from !== to) ? [from, to] : null\n\n}\n\n// BrowserAnimation\n\nvar BrowserAnimation = prime({\n\n    inherits: fx,\n\n    constructor: function BrowserAnimation(node, property){\n\n        var _getter = getter(property),\n            _setter = setter(property)\n\n        this.get = function(){\n            return _getter.call(node)\n        }\n\n        this.set = function(value){\n            return _setter.call(node, value)\n        }\n\n        BrowserAnimation.parent.constructor.call(this, this.set)\n\n        this.node = node\n        this.property = property\n\n    }\n\n})\n\nvar JSAnimation\n\n/*(css3)?*/\n\nJSAnimation = prime({\n\n    inherits: BrowserAnimation,\n\n    constructor: function JSAnimation(){\n        return JSAnimation.parent.constructor.apply(this, arguments)\n    },\n\n    start: function(to){\n\n        this.stop()\n\n        if (this.duration === 0){\n            this.cancel(to)\n            return this\n        }\n\n        var fromTo = prepare(this.node, this.property, to)\n\n        if (!fromTo){\n            this.cancel(to)\n            return this\n        }\n\n        JSAnimation.parent.start.apply(this, fromTo)\n\n        if (!this.cancelStep) return this\n\n        // the animation would have started but we need additional checks\n\n        var parser = parsers[this.property] || parse\n\n        // complex interpolations JSAnimation can't handle\n        // even CSS3 animation gracefully fail with some of those edge cases\n        // other \"simple\" properties, such as `border` can have different templates\n        // because of string properties like \"solid\" and \"dashed\"\n\n        if ((parser === parseBoxShadow || parser === parseTextShadow || parser === parse) &&\n            (this.templateFrom !== this.templateTo)){\n                this.cancelStep()\n                delete this.cancelStep\n                this.cancel(to)\n        }\n\n        return this\n    },\n\n    parseEquation: function(equation){\n        if (typeof equation === \"string\") return JSAnimation.parent.parseEquation.call(this, equation)\n    }\n\n\n})/*:*/\n\n// CSSAnimation\n\nvar remove3 = function(value, a, b, c){\n    var index = indexOf(a, value)\n    if (index !== -1){\n        a.splice(index, 1)\n        b.splice(index, 1)\n        c.splice(index, 1)\n    }\n}\n\nvar CSSAnimation = prime({\n\n    inherits: BrowserAnimation,\n\n    constructor: function CSSAnimation(node, property){\n        CSSAnimation.parent.constructor.call(this, node, property)\n\n        this.hproperty = hyphenate(aliases[property] || property)\n\n        var self = this\n\n        this.bSetTransitionCSS = function(time){\n            self.setTransitionCSS(time)\n        }\n\n        this.bSetStyleCSS = function(time){\n            self.setStyleCSS(time)\n        }\n\n        this.bComplete = function(){\n            self.complete()\n        }\n    },\n\n    start: function(to){\n\n        this.stop()\n\n        if (this.duration === 0){\n            this.cancel(to)\n            return this\n        }\n\n        var fromTo = prepare(this.node, this.property, to)\n\n        if (!fromTo){\n            this.cancel(to)\n            return this\n        }\n\n        this.to = fromTo[1]\n        // setting transition styles immediately will make good browsers behave weirdly\n        // because DOM changes are always deferred, so we requestFrame\n        this.cancelSetTransitionCSS = requestFrame(this.bSetTransitionCSS)\n\n        return this\n    },\n\n    setTransitionCSS: function(time){\n        delete this.cancelSetTransitionCSS\n        this.resetCSS(true)\n        // firefox flickers if we set css for transition as well as styles at the same time\n        // so, other than deferring transition styles we defer actual styles as well on a requestFrame\n        this.cancelSetStyleCSS = requestFrame(this.bSetStyleCSS)\n    },\n\n    setStyleCSS: function(time){\n        delete this.cancelSetStyleCSS\n        var duration = this.duration\n        // we use setTimeout instead of transitionEnd because some browsers (looking at you foxy)\n        // incorrectly set event.propertyName, so we cannot check which animation we are canceling\n        this.cancelComplete = setTimeout(this.bComplete, duration)\n        this.endTime = time + duration\n        this.set(this.to)\n    },\n\n    complete: function(){\n        delete this.cancelComplete\n        this.resetCSS()\n        this.callback(this.endTime)\n    },\n\n    stop: function(hard){\n        if (this.cancelExit){\n            this.cancelExit()\n            delete this.cancelExit\n        } else if (this.cancelSetTransitionCSS){\n            // if cancelSetTransitionCSS is set, means nothing is set yet\n            this.cancelSetTransitionCSS() //so we cancel and we're good\n            delete this.cancelSetTransitionCSS\n        } else if (this.cancelSetStyleCSS){\n            // if cancelSetStyleCSS is set, means transition css has been set, but no actual styles.\n            this.cancelSetStyleCSS()\n            delete this.cancelSetStyleCSS\n            // if its a hard stop (and not another start on top of the current animation)\n            // we need to reset the transition CSS\n            if (hard) this.resetCSS()\n        } else if (this.cancelComplete){\n            // if cancelComplete is set, means style and transition css have been set, not yet completed.\n            clearTimeout(this.cancelComplete)\n            delete this.cancelComplete\n            // if its a hard stop (and not another start on top of the current animation)\n            // we need to reset the transition CSS set the current animation styles\n            if (hard){\n                this.resetCSS()\n                this.set(this.get())\n            }\n        }\n        return this\n    },\n\n    resetCSS: function(inclusive){\n        var rules      = compute(this.node),\n            properties = (rules(transitionName + \"Property\").replace(/\\s+/g, \"\") || \"all\").split(\",\"),\n            durations  = (rules(transitionName + \"Duration\").replace(/\\s+/g, \"\") || \"0s\").split(\",\"),\n            equations  = (rules(transitionName + \"TimingFunction\").replace(/\\s+/g, \"\") || \"ease\").match(/cubic-bezier\\([\\d-.,]+\\)|([a-z-]+)/g)\n\n        remove3(\"all\",          properties, durations, equations)\n        remove3(this.hproperty, properties, durations, equations)\n\n        if (inclusive){\n            properties.push(this.hproperty)\n            durations.push(this.duration + \"ms\")\n            equations.push(\"cubic-bezier(\" + this.equation + \")\")\n        }\n\n        var nodeStyle = this.node.style\n\n        nodeStyle[transitionName + \"Property\"]       = properties\n        nodeStyle[transitionName + \"Duration\"]       = durations\n        nodeStyle[transitionName + \"TimingFunction\"] = equations\n    },\n\n    parseEquation: function(equation){\n        if (typeof equation === \"string\") return CSSAnimation.parent.parseEquation.call(this, equation, true)\n    }\n\n})\n\n// elements methods\n\nvar BaseAnimation = transitionName ? CSSAnimation : JSAnimation\n\nvar moofx = function(x, y){\n    return (typeof x === \"function\") ? fx(x) : elements(x, y)\n}\n\nelements.implement({\n\n    // {properties}, options or\n    // property, value options\n    animate: function(A, B, C){\n\n        var styles = A, options = B\n\n        if (typeof A === \"string\"){\n            styles = {}\n            styles[A] = B\n            options = C\n        }\n\n        if (options == null) options = {}\n\n        var type = typeof options\n\n        options = type === \"function\" ? {\n            callback: options\n        } : (type === \"string\" || type === \"number\") ? {\n            duration: options\n        } : options\n\n        var callback  = options.callback || function(){},\n            completed = 0,\n            length    = 0\n\n        options.callback = function(t){\n            if (++completed === length) callback(t)\n        }\n\n        for (var property in styles){\n\n            var value    = styles[property],\n                property = camelize(property)\n\n            this.forEach(function(node){\n                length++\n                var self = elements(node), anims = self._animations || (self._animations = {})\n                var anim  = anims[property] || (anims[property] = new BaseAnimation(node, property))\n                anim.setOptions(options).start(value)\n            })\n        }\n\n        return this\n\n    },\n\n    // {properties} or\n    // property, value\n    style: function(A, B){\n\n        var styles = A\n\n        if (typeof A === \"string\"){\n            styles = {}\n            styles[A] = B\n        }\n\n        for (var property in styles){\n            var value = styles[property],\n                set   = setter(property = camelize(property))\n\n            this.forEach(function(node){\n                var self = elements(node), anims = self._animations, anim\n                if (anims && (anim = anims[property])) anim.stop(true)\n                set.call(node, value)\n            })\n        }\n\n        return this\n\n    },\n\n    compute: function(property){\n\n        property = camelize(property)\n        var node = this[0]\n\n        // return default matrix for transform, instead of parsed (for consistency)\n\n        if (property === \"transform\" && parseTransform2d) return compute(node)(transformName)\n\n        var value = getter(property).call(node)\n\n        // unit conversion to `px`\n\n        return (value != null) ? value.replace(rgLength, function(match, value, unit){\n            return (unit === \"px\") ? match : pixelRatio(node, unit) * value + \"px\"\n        }) : ''\n\n    }\n\n})\n\nmoofx.parse = function(property, value, normalize){\n    return (parsers[camelize(property)] || parse)(value, normalize)\n}\n\nmodule.exports = moofx\n","/*\ncolor\n*/\"use strict\"\n\nvar colors = {\n    maroon      : \"#800000\",\n    red         : \"#ff0000\",\n    orange      : \"#ffA500\",\n    yellow      : \"#ffff00\",\n    olive       : \"#808000\",\n    purple      : \"#800080\",\n    fuchsia     : \"#ff00ff\",\n    white       : \"#ffffff\",\n    lime        : \"#00ff00\",\n    green       : \"#008000\",\n    navy        : \"#000080\",\n    blue        : \"#0000ff\",\n    aqua        : \"#00ffff\",\n    teal        : \"#008080\",\n    black       : \"#000000\",\n    silver      : \"#c0c0c0\",\n    gray        : \"#808080\",\n    transparent : \"#0000\"\n}\n\nvar RGBtoRGB = function(r, g, b, a){\n    if (a == null || a === \"\") a = 1\n    r = parseFloat(r)\n    g = parseFloat(g)\n    b = parseFloat(b)\n    a = parseFloat(a)\n    if (!(r <= 255 && r >= 0 && g <= 255 && g >= 0 && b <= 255 && b >= 0 && a <= 1 && a >= 0)) return null\n\n    return [Math.round(r), Math.round(g), Math.round(b), a]\n}\n\nvar HEXtoRGB = function(hex){\n    if (hex.length === 3) hex += \"f\"\n    if (hex.length === 4){\n        var h0 = hex.charAt(0),\n            h1 = hex.charAt(1),\n            h2 = hex.charAt(2),\n            h3 = hex.charAt(3)\n\n        hex = h0 + h0 + h1 + h1 + h2 + h2 + h3 + h3\n    }\n    if (hex.length === 6) hex += \"ff\"\n    var rgb = []\n    for (var i = 0, l = hex.length; i < l; i += 2) rgb.push(parseInt(hex.substr(i, 2), 16) / (i === 6 ? 255 : 1))\n    return rgb\n}\n\n// HSL to RGB conversion from:\n// http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript\n// thank you!\n\nvar HUEtoRGB = function(p, q, t){\n    if (t < 0) t += 1\n    if (t > 1) t -= 1\n    if (t < 1 / 6) return p + (q - p) * 6 * t\n    if (t < 1 / 2) return q\n    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6\n    return p\n}\n\nvar HSLtoRGB = function(h, s, l, a){\n    var r, b, g\n    if (a == null || a === \"\") a = 1\n    h = parseFloat(h) / 360\n    s = parseFloat(s) / 100\n    l = parseFloat(l) / 100\n    a = parseFloat(a) / 1\n    if (h > 1 || h < 0 || s > 1 || s < 0 || l > 1 || l < 0 || a > 1 || a < 0) return null\n    if (s === 0){\n        r = b = g = l\n    } else {\n        var q = l < 0.5 ? l * (1 + s) : l + s - l * s\n        var p = 2 * l - q\n        r = HUEtoRGB(p, q, h + 1 / 3)\n        g = HUEtoRGB(p, q, h)\n        b = HUEtoRGB(p, q, h - 1 / 3)\n    }\n    return [r * 255, g * 255, b * 255, a]\n}\n\nvar keys = []\nfor (var c in colors) keys.push(c)\n\nvar shex  = \"(?:#([a-f0-9]{3,8}))\",\n    sval  = \"\\\\s*([.\\\\d%]+)\\\\s*\",\n    sop   = \"(?:,\\\\s*([.\\\\d]+)\\\\s*)?\",\n    slist = \"\\\\(\" + [sval, sval, sval] + sop + \"\\\\)\",\n    srgb  = \"(?:rgb)a?\",\n    shsl  = \"(?:hsl)a?\",\n    skeys = \"(\" + keys.join(\"|\") + \")\"\n\n\nvar xhex   = RegExp(shex, \"i\"),\n    xrgb   = RegExp(srgb + slist, \"i\"),\n    xhsl   = RegExp(shsl + slist, \"i\")\n\nvar color = function(input, array){\n    if (input == null) return null\n    input = (input + \"\").replace(/\\s+/, \"\")\n\n    var match = colors[input]\n    if (match){\n        return color(match, array)\n    } else if (match = input.match(xhex)){\n        input = HEXtoRGB(match[1])\n    } else if (match = input.match(xrgb)){\n        input = match.slice(1)\n    } else if (match = input.match(xhsl)){\n        input = HSLtoRGB.apply(null, match.slice(1))\n    } else return null\n\n    if (!(input && (input = RGBtoRGB.apply(null, input)))) return null\n    if (array) return input\n    if (input[3] === 1) input.splice(3, 1)\n    return \"rgb\" + (input.length === 4 ? \"a\" : \"\") + \"(\" + input + \")\"\n}\n\ncolor.x = RegExp([skeys, shex, srgb + slist, shsl + slist].join(\"|\"), \"gi\")\n\nmodule.exports = color\n","/*\nrequestFrame / cancelFrame\n*/\"use strict\"\n\nvar indexOf = require(\"prime/array/indexOf\")\n\nvar requestFrame = global.requestAnimationFrame ||\n                   global.webkitRequestAnimationFrame ||\n                   global.mozRequestAnimationFrame ||\n                   global.oRequestAnimationFrame ||\n                   global.msRequestAnimationFrame ||\n                   function(callback){\n                       return setTimeout(function(){\n                           callback()\n                       }, 1e3 / 60)\n                   }\n\nvar callbacks = []\n\nvar iterator = function(time){\n    var split = callbacks.splice(0, callbacks.length)\n    for (var i = 0, l = split.length; i < l; i++) split[i](time || (time = +(new Date)))\n}\n\nvar cancel = function(callback){\n    var io = indexOf(callbacks, callback)\n    if (io > -1) callbacks.splice(io, 1)\n}\n\nvar request = function(callback){\n    var i = callbacks.push(callback)\n    if (i === 1) requestFrame(iterator)\n    return function(){\n        cancel(callback)\n    }\n}\n\nexports.request = request\nexports.cancel = cancel\n","/*\nfx\n*/\"use strict\"\n\nvar prime        = require(\"prime\"),\n    requestFrame = require(\"./frame\").request,\n    bezier       = require(\"cubic-bezier\")\n\nvar map = require(\"prime/array/map\")\n\nvar sDuration    = \"([\\\\d.]+)(s|ms)?\",\n    sCubicBezier = \"cubic-bezier\\\\(([-.\\\\d]+),([-.\\\\d]+),([-.\\\\d]+),([-.\\\\d]+)\\\\)\"\n\nvar rDuration     = RegExp(sDuration),\n    rCubicBezier  = RegExp(sCubicBezier),\n    rgCubicBezier = RegExp(sCubicBezier, \"g\")\n\n    // equations collection\n\nvar equations = {\n    \"default\"     : \"cubic-bezier(0.25, 0.1, 0.25, 1.0)\",\n    \"linear\"      : \"cubic-bezier(0, 0, 1, 1)\",\n    \"ease-in\"     : \"cubic-bezier(0.42, 0, 1.0, 1.0)\",\n    \"ease-out\"    : \"cubic-bezier(0, 0, 0.58, 1.0)\",\n    \"ease-in-out\" : \"cubic-bezier(0.42, 0, 0.58, 1.0)\"\n}\n\nequations.ease = equations[\"default\"]\n\nvar compute = function(from, to, delta){\n    return (to - from) * delta + from\n}\n\nvar divide = function(string){\n    var numbers = []\n    var template = (string + \"\").replace(/[-.\\d]+/g, function(number){\n        numbers.push(+number)\n        return \"@\"\n    })\n    return [numbers, template]\n}\n\nvar Fx = prime({\n\n    constructor: function Fx(render, options){\n\n        // set options\n\n        this.setOptions(options)\n\n        // renderer\n\n        this.render = render || function(){}\n\n        // bound functions\n\n        var self = this\n\n        this.bStep = function(t){\n            return self.step(t)\n        }\n\n        this.bExit = function(time){\n            self.exit(time)\n        }\n\n    },\n\n    setOptions: function(options){\n        if (options == null) options = {}\n\n        if (!(this.duration = this.parseDuration(options.duration || \"500ms\"))) throw new Error(\"invalid duration\")\n        if (!(this.equation = this.parseEquation(options.equation || \"default\"))) throw new Error(\"invalid equation\")\n        this.callback = options.callback || function(){}\n\n        return this\n    },\n\n    parseDuration: function(duration){\n        if (duration = (duration + \"\").match(rDuration)){\n            var time = +duration[1],\n                unit = duration[2] || \"ms\"\n\n            if (unit === \"s\")  return time * 1e3\n            if (unit === \"ms\") return time\n        }\n    },\n\n    parseEquation: function(equation, array){\n        var type = typeof equation\n\n        if (type === \"function\"){ // function\n            return equation\n        } else if (type === \"string\"){ // cubic-bezier string\n            equation = equations[equation] || equation\n            var match = equation.replace(/\\s+/g, \"\").match(rCubicBezier)\n            if (match){\n                equation = map(match.slice(1), function(v){return +v})\n                if (array) return equation\n                if (equation.toString() === \"0,0,1,1\") return function(x){return x}\n                type = \"object\"\n            }\n        }\n\n        if (type === \"object\"){ // array\n            return bezier(equation[0], equation[1], equation[2], equation[3], 1e3 / 60 / this.duration / 4)\n        }\n    },\n\n    cancel: function(to){\n        this.to = to\n        this.cancelExit = requestFrame(this.bExit)\n    },\n\n    exit: function(time){\n        this.render(this.to)\n        delete this.cancelExit\n        this.callback(time)\n    },\n\n    start: function(from, to){\n\n        this.stop()\n\n        if (this.duration === 0){\n            this.cancel(to)\n            return this\n        }\n\n        this.isArray = false\n        this.isNumber = false\n\n        var fromType = typeof from,\n            toType   = typeof to\n\n        if (fromType === \"object\" && toType === \"object\"){\n            this.isArray = true\n        } else if (fromType === \"number\" && toType === \"number\"){\n            this.isNumber = true\n        }\n\n        var from_ = divide(from),\n            to_   = divide(to)\n\n        this.from = from_[0]\n        this.to = to_[0]\n        this.templateFrom = from_[1]\n        this.templateTo = to_[1]\n\n        if (this.from.length !== this.to.length || this.from.toString() === this.to.toString()){\n            this.cancel(to)\n            return this\n        }\n\n        delete this.time\n        this.length = this.from.length\n        this.cancelStep = requestFrame(this.bStep)\n\n        return this\n\n    },\n\n    stop: function(){\n\n        if (this.cancelExit){\n            this.cancelExit()\n            delete this.cancelExit\n        } else if (this.cancelStep){\n            this.cancelStep()\n            delete this.cancelStep\n        }\n\n        return this\n    },\n\n    step: function(now){\n\n        this.time || (this.time = now)\n\n        var factor = (now - this.time) / this.duration\n\n        if (factor > 1) factor = 1\n\n        var delta = this.equation(factor),\n            from  = this.from,\n            to    = this.to,\n            tpl   = this.templateTo\n\n        for (var i = 0, l = this.length; i < l; i++){\n            var f = from[i], t = to[i]\n            tpl = tpl.replace(\"@\", t !== f ? compute(f, t, delta) : t)\n        }\n\n        this.render(this.isArray ? tpl.split(\",\") : this.isNumber ? +tpl : tpl, factor)\n\n        if (factor !== 1){\n            this.cancelStep = requestFrame(this.bStep)\n        } else {\n            delete this.cancelStep\n            this.callback(now)\n        }\n\n    }\n\n})\n\nvar fx = function(render){\n\n    var ffx = new Fx(render)\n\n    return {\n\n        start: function(from, to, options){\n            var type = typeof options\n            ffx.setOptions((type === \"function\") ? {\n                callback: options\n            } : (type === \"string\" || type === \"number\") ? {\n                duration: options\n            } : options).start(from, to)\n            return this\n        },\n\n        stop: function(){\n            ffx.stop()\n            return this\n        }\n\n    }\n\n}\n\nfx.prototype = Fx.prototype\n\nmodule.exports = fx\n","/*\nUnmatrix 2d\n - a crude implementation of the slightly bugged pseudo code in http://www.w3.org/TR/css3-2d-transforms/#matrix-decomposition\n*/\"use strict\"\n\n// returns the length of the passed vector\n\nvar length = function(a){\n    return Math.sqrt(a[0] * a[0] + a[1] * a[1])\n}\n\n// normalizes the length of the passed point to 1\n\nvar normalize = function(a){\n    var l = length(a)\n    return l ? [a[0] / l, a[1] / l] : [0, 0]\n}\n\n// returns the dot product of the passed points\n\nvar dot = function(a, b){\n    return a[0] * b[0] + a[1] * b[1]\n}\n\n// returns the principal value of the arc tangent of\n// y/x, using the signs of both arguments to determine\n// the quadrant of the return value\n\nvar atan2 = Math.atan2\n\nvar combine = function(a, b, ascl, bscl){\n    return [\n        (ascl * a[0]) + (bscl * b[0]),\n        (ascl * a[1]) + (bscl * b[1])\n    ]\n}\n\nmodule.exports = function(a, b, c, d, tx, ty){\n\n    // Make sure the matrix is invertible\n\n    if ((a * d - b * c) === 0) return false\n\n    // Take care of translation\n\n    var translate = [tx, ty]\n\n    // Put the components into a 2x2 matrix\n\n    var m = [[a, b], [c, d]]\n\n    // Compute X scale factor and normalize first row.\n\n    var scale = [length(m[0])]\n    m[0] = normalize(m[0])\n\n    // Compute shear factor and make 2nd row orthogonal to 1st.\n\n    var skew = dot(m[0], m[1])\n    m[1] = combine(m[1], m[0], 1, -skew)\n\n    // Now, compute Y scale and normalize 2nd row.\n\n    scale[1] = length(m[1])\n    // m[1] = normalize(m[1]) //\n    skew /= scale[1]\n\n    // Now, get the rotation out\n\n    var rotate = atan2(m[0][1], m[0][0])\n\n    return [translate, rotate, skew, scale]\n\n}\n","\nmodule.exports = function(x1, y1, x2, y2, epsilon){\n\n\tvar curveX = function(t){\n\t\tvar v = 1 - t;\n\t\treturn 3 * v * v * t * x1 + 3 * v * t * t * x2 + t * t * t;\n\t};\n\n\tvar curveY = function(t){\n\t\tvar v = 1 - t;\n\t\treturn 3 * v * v * t * y1 + 3 * v * t * t * y2 + t * t * t;\n\t};\n\n\tvar derivativeCurveX = function(t){\n\t\tvar v = 1 - t;\n\t\treturn 3 * (2 * (t - 1) * t + v * v) * x1 + 3 * (- t * t * t + 2 * v * t) * x2;\n\t};\n\n\treturn function(t){\n\n\t\tvar x = t, t0, t1, t2, x2, d2, i;\n\n\t\t// First try a few iterations of Newton's method -- normally very fast.\n\t\tfor (t2 = x, i = 0; i < 8; i++){\n\t\t\tx2 = curveX(t2) - x;\n\t\t\tif (Math.abs(x2) < epsilon) return curveY(t2);\n\t\t\td2 = derivativeCurveX(t2);\n\t\t\tif (Math.abs(d2) < 1e-6) break;\n\t\t\tt2 = t2 - x2 / d2;\n\t\t}\n\n\t\tt0 = 0, t1 = 1, t2 = x;\n\n\t\tif (t2 < t0) return curveY(t0);\n\t\tif (t2 > t1) return curveY(t1);\n\n\t\t// Fallback to the bisection method for reliability.\n\t\twhile (t0 < t1){\n\t\t\tx2 = curveX(t2);\n\t\t\tif (Math.abs(x2 - x) < epsilon) return curveY(t2);\n\t\t\tif (x > x2) t0 = t2;\n\t\t\telse t1 = t2;\n\t\t\tt2 = (t1 - t0) * .5 + t0;\n\t\t}\n\n\t\t// Failure\n\t\treturn curveY(t2);\n\n\t};\n\n};\n","/*\nelements\n*/\"use strict\"\n\nvar prime   = require(\"prime\"),\n    forEach = require(\"prime/array/forEach\"),\n    map     = require(\"prime/array/map\"),\n    filter  = require(\"prime/array/filter\"),\n    every   = require(\"prime/array/every\"),\n    some    = require(\"prime/array/some\")\n\n// uniqueID\n\nvar uniqueIndex = 0\nvar uniqueID = function(n){\n    return (n === global) ? \"global\" : n.uniqueNumber || (n.uniqueNumber = \"n:\" + (uniqueIndex++).toString(36))\n}\n\nvar instances = {}\n\n// elements prime\n\nvar $ = prime({constructor: function $(n, context){\n\n    if (n == null) return (this && this.constructor === $) ? new elements : null\n\n    var self = n\n\n    if (n.constructor !== elements){\n\n        self = new elements\n\n        var uid\n\n        if (typeof n === \"string\"){\n            if (!self.search) return null\n            self[self.length++] = context || document\n            return self.search(n)\n        }\n\n        if (n.nodeType || n === global){\n\n            self[self.length++] = n\n\n        } else if (n.length){\n\n            // this could be an array, or any object with a length attribute,\n            // including another instance of elements from another interface.\n\n            var uniques = {}\n\n            for (var i = 0, l = n.length; i < l; i++){ // perform elements flattening\n                var nodes = $(n[i], context)\n                if (nodes && nodes.length) for (var j = 0, k = nodes.length; j < k; j++){\n                    var node = nodes[j]\n                    uid = uniqueID(node)\n                    if (!uniques[uid]){\n                        self[self.length++] = node\n                        uniques[uid] = true\n                    }\n                }\n            }\n\n        }\n\n    }\n\n    if (!self.length) return null\n\n    // when length is 1 always use the same elements instance\n\n    if (self.length === 1){\n        uid = uniqueID(self[0])\n        return instances[uid] || (instances[uid] = self)\n    }\n\n    return self\n\n}})\n\nvar elements = prime({\n\n    inherits: $,\n\n    constructor: function elements(){\n        this.length = 0\n    },\n\n    unlink: function(){\n        return this.map(function(node, i){\n            delete instances[uniqueID(node)]\n            return node\n        })\n    },\n\n    // straight es5 prototypes (or emulated methods)\n\n    forEach: function(method, context){\n        return forEach(this, method, context);\n    },\n\n    map: function(method, context){\n        return map(this, method, context);\n    },\n\n    filter: function(method, context){\n        return filter(this, method, context);\n    },\n\n    every: function(method, context){\n        return every(this, method, context);\n    },\n\n    some: function(method, context){\n        return some(this, method, context);\n    }\n\n})\n\nmodule.exports = $\n","/*\narray:every\n*/\"use strict\"\n\nvar every = function(self, method, context){\n    for (var i = 0, l = self.length >>> 0; i < l; i++){\n        if (!method.call(context, self[i], i, self)) return false\n    }\n    return true\n}\n\nmodule.exports = every\n","/*\narray:filter\n*/\"use strict\"\n\nvar filter = function(self, method, context){\n    var results = []\n    for (var i = 0, l = self.length >>> 0; i < l; i++) {\n        var value = self[i]\n        if (method.call(context, value, i, self)) results.push(value)\n    }\n    return results\n}\n\nmodule.exports = filter\n","/*\narray:forEach\n*/\"use strict\"\n\nvar forEach = function(self, method, context){\n    for (var i = 0, l = self.length >>> 0; i < l; i++){\n        if (method.call(context, self[i], i, self) === false) break\n    }\n    return self\n}\n\nmodule.exports = forEach\n","/*\narray:indexOf\n*/\"use strict\"\n\nvar indexOf = function(self, item, from){\n    for (var l = self.length >>> 0, i = (from < 0) ? Math.max(0, l + from) : from || 0; i < l; i++){\n        if (self[i] === item) return i\n    }\n    return -1\n}\n\nmodule.exports = indexOf\n","/*\narray:map\n*/\"use strict\"\n\nvar map = function(self, method, context){\n    var length = self.length >>> 0, results = Array(length)\n    for (var i = 0, l = length; i < l; i++){\n        results[i] = method.call(context, self[i], i, self)\n    }\n    return results\n}\n\nmodule.exports = map\n","/*\narray:some\n*/\"use strict\"\n\nvar some = function(self, method, context){\n    for (var i = 0, l = self.length >>> 0; i < l; i++){\n        if (method.call(context, self[i], i, self)) return true\n    }\n    return false\n}\n\nmodule.exports = some\n","/*\nprime\n - prototypal inheritance\n*/\"use strict\"\n\nvar hasOwn = require(\"./object/hasOwn\"),\n    forIn  = require(\"./object/forIn\"),\n    mixIn  = require(\"./object/mixIn\"),\n    filter = require(\"./object/filter\"),\n    create = require(\"./object/create\"),\n    type   = require(\"./type\")\n\nvar defineProperty           = Object.defineProperty,\n    getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor\n\ntry {\n    defineProperty({}, \"~\", {})\n    getOwnPropertyDescriptor({}, \"~\")\n} catch (e){\n    defineProperty = null\n    getOwnPropertyDescriptor = null\n}\n\nvar define = function(value, key, from){\n    defineProperty(this, key, getOwnPropertyDescriptor(from, key) || {\n        writable: true,\n        enumerable: true,\n        configurable: true,\n        value: value\n    })\n}\n\nvar copy = function(value, key){\n    this[key] = value\n}\n\nvar implement = function(proto){\n    forIn(proto, defineProperty ? define : copy, this.prototype)\n    return this\n}\n\nvar verbs = /^constructor|inherits|mixin$/\n\nvar prime = function(proto){\n\n    if (type(proto) === \"function\") proto = {constructor: proto}\n\n    var superprime = proto.inherits\n\n    // if our nice proto object has no own constructor property\n    // then we proceed using a ghosting constructor that all it does is\n    // call the parent's constructor if it has a superprime, else an empty constructor\n    // proto.constructor becomes the effective constructor\n    var constructor = (hasOwn(proto, \"constructor\")) ? proto.constructor : (superprime) ? function(){\n        return superprime.apply(this, arguments)\n    } : function(){}\n\n    if (superprime){\n\n        mixIn(constructor, superprime)\n\n        var superproto = superprime.prototype\n        // inherit from superprime\n        var cproto = constructor.prototype = create(superproto)\n\n        // setting constructor.parent to superprime.prototype\n        // because it's the shortest possible absolute reference\n        constructor.parent = superproto\n        cproto.constructor = constructor\n    }\n\n    if (!constructor.implement) constructor.implement = implement\n\n    var mixins = proto.mixin\n    if (mixins){\n        if (type(mixins) !== \"array\") mixins = [mixins]\n        for (var i = 0; i < mixins.length; i++) constructor.implement(create(mixins[i].prototype))\n    }\n\n    // implement proto and return constructor\n    return constructor.implement(filter(proto, function(value, key){\n        return !key.match(verbs)\n    }))\n\n}\n\nmodule.exports = prime\n","/*\nobject:create\n*/\"use strict\"\n\nvar create = function(self){\n    var constructor = function(){}\n    constructor.prototype = self\n    return new constructor\n}\n\nmodule.exports = create\n","/*\nobject:filter\n*/\"use strict\"\n\nvar forIn = require(\"./forIn\")\n\nvar filter = function(self, method, context){\n    var results = {}\n    forIn(self, function(value, key){\n        if (method.call(context, value, key, self)) results[key] = value\n    })\n    return results\n}\n\nmodule.exports = filter\n","/*\nobject:forIn\n*/\"use strict\"\n\nvar has = require(\"./hasOwn\")\n\nvar forIn = function(self, method, context){\n    for (var key in self) if (method.call(context, self[key], key, self) === false) break\n    return self\n}\n\nif (!({valueOf: 0}).propertyIsEnumerable(\"valueOf\")){ // fix for stupid IE enumeration bug\n\n    var buggy = \"constructor,toString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString\".split(\",\")\n    var proto = Object.prototype\n\n    forIn = function(self, method, context){\n        for (var key in self) if (method.call(context, self[key], key, self) === false) return self\n        for (var i = 0; key = buggy[i]; i++){\n            var value = self[key]\n            if ((value !== proto[key] || has(self, key)) && method.call(context, value, key, self) === false) break\n        }\n        return self\n    }\n\n}\n\nmodule.exports = forIn\n","/*\nobject:forOwn\n*/\"use strict\"\n\nvar forIn  = require(\"./forIn\"),\n    hasOwn = require(\"./hasOwn\")\n\nvar forOwn = function(self, method, context){\n    forIn(self, function(value, key){\n        if (hasOwn(self, key)) return method.call(context, value, key, self)\n    })\n    return self\n}\n\nmodule.exports = forOwn\n","/*\nobject:hasOwn\n*/\"use strict\"\n\nvar hasOwnProperty = Object.hasOwnProperty\n\nvar hasOwn = function(self, key){\n    return hasOwnProperty.call(self, key)\n}\n\nmodule.exports = hasOwn\n","/*\nobject:mixIn\n*/\"use strict\"\n\nvar forOwn = require(\"./forOwn\")\n\nvar copy = function(value, key){\n    this[key] = value\n}\n\nvar mixIn = function(self){\n    for (var i = 1, l = arguments.length; i < l; i++) forOwn(arguments[i], copy, self)\n    return self\n}\n\nmodule.exports = mixIn\n","/*\nstring:camelize\n*/\"use strict\"\n\nvar camelize = function(self){\n    return (self + \"\").replace(/-\\D/g, function(match){\n        return match.charAt(1).toUpperCase()\n    })\n}\n\nmodule.exports = camelize\n","/*\nstring:capitalize\n*/\"use strict\"\n\nvar capitalize = function(self){\n    return (self + \"\").replace(/\\b[a-z]/g, function(match){\n        return match.toUpperCase()\n    })\n}\n\nmodule.exports = capitalize\n","/*\nstring:clean\n*/\"use strict\"\n\nvar trim = require(\"./trim\")\n\nvar clean = function(self){\n    return trim((self + \"\").replace(/\\s+/g, \" \"))\n}\n\nmodule.exports = clean\n","/*\nstring:hyphenate\n*/\"use strict\"\n\nvar hyphenate = function(self){\n    return (self + \"\").replace(/[A-Z]/g, function(match){\n        return '-' + match.toLowerCase()\n    })\n}\n\nmodule.exports = hyphenate\n","/*\nstring:trim\n*/\"use strict\"\n\nvar trim = function(self){\n    return (self + \"\").replace(/^\\s+|\\s+$/g, \"\")\n}\n\nmodule.exports = trim\n","/*\ntype\n*/\"use strict\"\n\nvar toString = Object.prototype.toString,\n    types = /number|object|array|string|function|date|regexp|boolean/\n\nvar type = function(object){\n    if (object == null) return \"null\"\n    var string = toString.call(object).slice(8, -1).toLowerCase()\n    if (string === \"number\" && isNaN(object)) return \"null\"\n    if (types.test(string)) return string\n    return \"object\"\n}\n\nmodule.exports = type\n","\n\n    /**\n     * Appends an array to the end of another.\n     * The first array will be modified.\n     */\n    function append(arr1, arr2) {\n        if (arr2 == null) {\n            return arr1;\n        }\n\n        var pad = arr1.length,\n            i = -1,\n            len = arr2.length;\n        while (++i < len) {\n            arr1[pad + i] = arr2[i];\n        }\n        return arr1;\n    }\n    module.exports = append;\n\n","var indexOf = require('./indexOf');\n\n    /**\n     * Combines an array with all the items of another.\n     * Does not allow duplicates and is case and type sensitive.\n     */\n    function combine(arr1, arr2) {\n        if (arr2 == null) {\n            return arr1;\n        }\n\n        var i = -1, len = arr2.length;\n        while (++i < len) {\n            if (indexOf(arr1, arr2[i]) === -1) {\n                arr1.push(arr2[i]);\n            }\n        }\n\n        return arr1;\n    }\n    module.exports = combine;\n\n","var indexOf = require('./indexOf');\n\n    /**\n     * If array contains values.\n     */\n    function contains(arr, val) {\n        return indexOf(arr, val) !== -1;\n    }\n    module.exports = contains;\n\n","var unique = require('./unique');\nvar filter = require('./filter');\nvar some = require('./some');\nvar contains = require('./contains');\nvar slice = require('./slice');\n\n\n    /**\n     * Return a new Array with elements that aren't present in the other Arrays.\n     */\n    function difference(arr) {\n        var arrs = slice(arguments, 1),\n            result = filter(unique(arr), function(needle){\n                return !some(arrs, function(haystack){\n                    return contains(haystack, needle);\n                });\n            });\n        return result;\n    }\n\n    module.exports = difference;\n\n\n","var is = require('../lang/is');\nvar isArray = require('../lang/isArray');\nvar every = require('./every');\n\n    /**\n     * Compares if both arrays have the same elements\n     */\n    function equals(a, b, callback){\n        callback = callback || is;\n\n        if (!isArray(a) || !isArray(b)) {\n            return callback(a, b);\n        }\n\n        if (a.length !== b.length) {\n            return false;\n        }\n\n        return every(a, makeCompare(callback), b);\n    }\n\n    function makeCompare(callback) {\n        return function(value, i) {\n            return i in this && callback(value, this[i]);\n        };\n    }\n\n    module.exports = equals;\n\n\n","var findIndex = require('./findIndex');\n\n    /**\n     * Returns first item that matches criteria\n     */\n    function find(arr, iterator, thisObj){\n        var idx = findIndex(arr, iterator, thisObj);\n        return idx >= 0? arr[idx] : void(0);\n    }\n\n    module.exports = find;\n\n\n","var makeIterator = require('../function/makeIterator_');\n\n    /**\n     * Returns the index of the first item that matches criteria\n     */\n    function findIndex(arr, iterator, thisObj){\n        iterator = makeIterator(iterator, thisObj);\n        if (arr == null) {\n            return -1;\n        }\n\n        var i = -1, len = arr.length;\n        while (++i < len) {\n            if (iterator(arr[i], i, arr)) {\n                return i;\n            }\n        }\n\n        return -1;\n    }\n\n    module.exports = findIndex;\n\n","var isArray = require('../lang/isArray');\nvar append = require('./append');\n\n    /*\n     * Helper function to flatten to a destination array.\n     * Used to remove the need to create intermediate arrays while flattening.\n     */\n    function flattenTo(arr, result, level) {\n        if (level === 0) {\n            append(result, arr);\n            return result;\n        }\n\n        var value,\n            i = -1,\n            len = arr.length;\n        while (++i < len) {\n            value = arr[i];\n            if (isArray(value)) {\n                flattenTo(value, result, level - 1);\n            } else {\n                result.push(value);\n            }\n        }\n        return result;\n    }\n\n    /**\n     * Recursively flattens an array.\n     * A new array containing all the elements is returned.\n     * If level is specified, it will only flatten up to that level.\n     */\n    function flatten(arr, level) {\n        if (arr == null) {\n            return [];\n        }\n\n        level = level == null ? -1 : level;\n        return flattenTo(arr, [], level);\n    }\n\n    module.exports = flatten;\n\n\n\n","var difference = require('./difference');\nvar slice = require('./slice');\n\n    /**\n     * Insert item into array if not already present.\n     */\n    function insert(arr, rest_items) {\n        var diff = difference(slice(arguments, 1), arr);\n        if (diff.length) {\n            Array.prototype.push.apply(arr, diff);\n        }\n        return arr.length;\n    }\n    module.exports = insert;\n\n","var unique = require('./unique');\nvar filter = require('./filter');\nvar every = require('./every');\nvar contains = require('./contains');\nvar slice = require('./slice');\n\n\n    /**\n     * Return a new Array with elements common to all Arrays.\n     * - based on underscore.js implementation\n     */\n    function intersection(arr) {\n        var arrs = slice(arguments, 1),\n            result = filter(unique(arr), function(needle){\n                return every(arrs, function(haystack){\n                    return contains(haystack, needle);\n                });\n            });\n        return result;\n    }\n\n    module.exports = intersection;\n\n\n","var slice = require('./slice');\n\n    /**\n     * Call `methodName` on each item of the array passing custom arguments if\n     * needed.\n     */\n    function invoke(arr, methodName, var_args){\n        if (arr == null) {\n            return arr;\n        }\n\n        var args = slice(arguments, 2);\n        var i = -1, len = arr.length, value;\n        while (++i < len) {\n            value = arr[i];\n            value[methodName].apply(value, args);\n        }\n\n        return arr;\n    }\n\n    module.exports = invoke;\n\n","\n\n    /**\n     * Returns last element of array.\n     */\n    function last(arr){\n        if (arr == null || arr.length < 1) {\n            return undefined;\n        }\n\n        return arr[arr.length - 1];\n    }\n\n    module.exports = last;\n\n\n","var indexOf = require('./indexOf');\n\n    /**\n     * Remove all instances of an item from array.\n     */\n    function removeAll(arr, item){\n        var idx = indexOf(arr, item);\n        while (idx !== -1) {\n            arr.splice(idx, 1);\n            idx = indexOf(arr, item, idx);\n        }\n    }\n\n    module.exports = removeAll;\n\n","\n\n    /**\n     * Create slice of source array or array-like object\n     */\n    function slice(arr, start, end){\n        var len = arr.length;\n\n        if (start == null) {\n            start = 0;\n        } else if (start < 0) {\n            start = Math.max(len + start, 0);\n        } else {\n            start = Math.min(start, len);\n        }\n\n        if (end == null) {\n            end = len;\n        } else if (end < 0) {\n            end = Math.max(len + end, 0);\n        } else {\n            end = Math.min(end, len);\n        }\n\n        var result = [];\n        while (start < end) {\n            result.push(arr[start++]);\n        }\n\n        return result;\n    }\n\n    module.exports = slice;\n\n\n","\n\n    /**\n     * Split array into a fixed number of segments.\n     */\n    function split(array, segments) {\n        segments = segments || 2;\n        var results = [];\n        if (array == null) {\n            return results;\n        }\n\n        var minLength = Math.floor(array.length / segments),\n            remainder = array.length % segments,\n            i = 0,\n            len = array.length,\n            segmentIndex = 0,\n            segmentLength;\n\n        while (i < len) {\n            segmentLength = minLength;\n            if (segmentIndex < remainder) {\n                segmentLength++;\n            }\n\n            results.push(array.slice(i, i + segmentLength));\n\n            segmentIndex++;\n            i += segmentLength;\n        }\n\n        return results;\n    }\n    module.exports = split;\n\n","var filter = require('./filter');\n\n    /**\n     * @return {array} Array of unique items\n     */\n    function unique(arr, compare){\n        compare = compare || isEqual;\n        return filter(arr, function(item, i, arr){\n            var n = arr.length;\n            while (++i < n) {\n                if ( compare(item, arr[i]) ) {\n                    return false;\n                }\n            }\n            return true;\n        });\n    }\n\n    function isEqual(a, b){\n        return a === b;\n    }\n\n    module.exports = unique;\n\n\n","var make = require('./make_');\nvar arrContains = require('../array/contains');\nvar objContains = require('../object/contains');\n\n    /**\n     */\n    module.exports = make(arrContains, objContains);\n\n\n","var make = require('./make_');\nvar arrFind = require('../array/find');\nvar objFind = require('../object/find');\n\n    /**\n     * Find value that returns true on iterator check.\n     */\n    module.exports = make(arrFind, objFind);\n\n\n","var make = require('./make_');\nvar arrForEach = require('../array/forEach');\nvar objForEach = require('../object/forOwn');\n\n    /**\n     */\n    module.exports = make(arrForEach, objForEach);\n\n\n","var slice = require('../array/slice');\n\n    /**\n     * internal method used to create other collection modules.\n     */\n    function makeCollectionMethod(arrMethod, objMethod, defaultReturn) {\n        return function(){\n            var args = slice(arguments);\n            if (args[0] == null) {\n                return defaultReturn;\n            }\n            // array-like is treated as array\n            return (typeof args[0].length === 'number')? arrMethod.apply(null, args) : objMethod.apply(null, args);\n        };\n    }\n\n    module.exports = makeCollectionMethod;\n\n\n","var isArray = require('../lang/isArray');\nvar objSize = require('../object/size');\n\n    /**\n     * Get collection size\n     */\n    function size(list) {\n        if (!list) {\n            return 0;\n        }\n        if (isArray(list)) {\n            return list.length;\n        }\n        return objSize(list);\n    }\n\n    module.exports = size;\n\n\n","var slice = require('../array/slice');\n\n    /**\n     * Return a function that will execute in the given context, optionally adding any additional supplied parameters to the beginning of the arguments collection.\n     * @param {Function} fn  Function.\n     * @param {object} context   Execution context.\n     * @param {rest} args    Arguments (0...n arguments).\n     * @return {Function} Wrapped Function.\n     */\n    function bind(fn, context, args){\n        var argsArr = slice(arguments, 2); //curried args\n        return function(){\n            return fn.apply(context, argsArr.concat(slice(arguments)));\n        };\n    }\n\n    module.exports = bind;\n\n\n","\n\n    /**\n     * Debounce callback execution\n     */\n    function debounce(fn, threshold, isAsap){\n        var timeout, result;\n        function debounced(){\n            var args = arguments, context = this;\n            function delayed(){\n                if (! isAsap) {\n                    result = fn.apply(context, args);\n                }\n                timeout = null;\n            }\n            if (timeout) {\n                clearTimeout(timeout);\n            } else if (isAsap) {\n                result = fn.apply(context, args);\n            }\n            timeout = setTimeout(delayed, threshold);\n            return result;\n        }\n        debounced.cancel = function(){\n            clearTimeout(timeout);\n        };\n        return debounced;\n    }\n\n    module.exports = debounce;\n\n\n","\n\n    /**\n     * Returns a function that will execute a list of functions in sequence\n     * passing the same arguments to each one. (useful for batch processing\n     * items during a forEach loop)\n     */\n    function series(){\n        var fns = arguments;\n        return function(){\n            var i = 0,\n                n = fns.length;\n            while (i < n) {\n                fns[i].apply(this, arguments);\n                i += 1;\n            }\n        };\n    }\n\n    module.exports = series;\n\n\n","\n\n    // Reference to the global context (works on ES3 and ES5-strict mode)\n    //jshint -W061, -W064\n    module.exports = Function('return this')();\n\n\n","var kindOf = require('./kindOf');\nvar isPlainObject = require('./isPlainObject');\nvar mixIn = require('../object/mixIn');\n\n    /**\n     * Clone native types.\n     */\n    function clone(val){\n        switch (kindOf(val)) {\n            case 'Object':\n                return cloneObject(val);\n            case 'Array':\n                return cloneArray(val);\n            case 'RegExp':\n                return cloneRegExp(val);\n            case 'Date':\n                return cloneDate(val);\n            default:\n                return val;\n        }\n    }\n\n    function cloneObject(source) {\n        if (isPlainObject(source)) {\n            return mixIn({}, source);\n        } else {\n            return source;\n        }\n    }\n\n    function cloneRegExp(r) {\n        var flags = '';\n        flags += r.multiline ? 'm' : '';\n        flags += r.global ? 'g' : '';\n        flags += r.ignoreCase ? 'i' : '';\n        return new RegExp(r.source, flags);\n    }\n\n    function cloneDate(date) {\n        return new Date(+date);\n    }\n\n    function cloneArray(arr) {\n        return arr.slice();\n    }\n\n    module.exports = clone;\n\n\n","var clone = require('./clone');\nvar forOwn = require('../object/forOwn');\nvar kindOf = require('./kindOf');\nvar isPlainObject = require('./isPlainObject');\n\n    /**\n     * Recursively clone native types.\n     */\n    function deepClone(val, instanceClone) {\n        switch ( kindOf(val) ) {\n            case 'Object':\n                return cloneObject(val, instanceClone);\n            case 'Array':\n                return cloneArray(val, instanceClone);\n            default:\n                return clone(val);\n        }\n    }\n\n    function cloneObject(source, instanceClone) {\n        if (isPlainObject(source)) {\n            var out = {};\n            forOwn(source, function(val, key) {\n                this[key] = deepClone(val, instanceClone);\n            }, out);\n            return out;\n        } else if (instanceClone) {\n            return instanceClone(source);\n        } else {\n            return source;\n        }\n    }\n\n    function cloneArray(arr, instanceClone) {\n        var out = [],\n            i = -1,\n            n = arr.length,\n            val;\n        while (++i < n) {\n            out[i] = deepClone(arr[i], instanceClone);\n        }\n        return out;\n    }\n\n    module.exports = deepClone;\n\n\n\n","var is = require('./is');\nvar isObject = require('./isObject');\nvar isArray = require('./isArray');\nvar objEquals = require('../object/equals');\nvar arrEquals = require('../array/equals');\n\n    /**\n     * Recursively checks for same properties and values.\n     */\n    function deepEquals(a, b, callback){\n        callback = callback || is;\n\n        var bothObjects = isObject(a) && isObject(b);\n        var bothArrays = !bothObjects && isArray(a) && isArray(b);\n\n        if (!bothObjects && !bothArrays) {\n            return callback(a, b);\n        }\n\n        function compare(a, b){\n            return deepEquals(a, b, callback);\n        }\n\n        var method = bothObjects ? objEquals : arrEquals;\n        return method(a, b, compare);\n    }\n\n    module.exports = deepEquals;\n\n\n","\n\n    /**\n     * Check if both arguments are egal.\n     */\n    function is(x, y){\n        // implementation borrowed from harmony:egal spec\n        if (x === y) {\n          // 0 === -0, but they are not identical\n          return x !== 0 || 1 / x === 1 / y;\n        }\n\n        // NaN !== NaN, but they are identical.\n        // NaNs are the only non-reflexive value, i.e., if x !== x,\n        // then x is a NaN.\n        // isNaN is broken: it converts its argument to number, so\n        // isNaN(\"foo\") => true\n        return x !== x && y !== y;\n    }\n\n    module.exports = is;\n\n\n","var isKind = require('./isKind');\n    /**\n     */\n    function isBoolean(val) {\n        return isKind(val, 'Boolean');\n    }\n    module.exports = isBoolean;\n\n","var isKind = require('./isKind');\n    /**\n     */\n    function isNumber(val) {\n        return isKind(val, 'Number');\n    }\n    module.exports = isNumber;\n\n","\n\n    /**\n     * Checks if the value is created by the `Object` constructor.\n     */\n    function isPlainObject(value) {\n        return (!!value && typeof value === 'object' &&\n            value.constructor === Object);\n    }\n\n    module.exports = isPlainObject;\n\n\n","\n\n    /**\n     * Checks if the object is a primitive\n     */\n    function isPrimitive(value) {\n        // Using switch fallthrough because it's simple to read and is\n        // generally fast: http://jsperf.com/testing-value-is-primitive/5\n        switch (typeof value) {\n            case \"string\":\n            case \"number\":\n            case \"boolean\":\n                return true;\n        }\n\n        return value == null;\n    }\n\n    module.exports = isPrimitive;\n\n\n","var kindOf = require('./kindOf');\nvar GLOBAL = require('./GLOBAL');\n\n    /**\n     * Convert array-like object into array\n     */\n    function toArray(val){\n        var ret = [],\n            kind = kindOf(val),\n            n;\n\n        if (val != null) {\n            if ( val.length == null || kind === 'String' || kind === 'Function' || kind === 'RegExp' || val === GLOBAL ) {\n                //string, regexp, function have .length but user probably just want\n                //to wrap value into an array..\n                ret[ret.length] = val;\n            } else {\n                //window returns true on isObject in IE7 and may have length\n                //property. `typeof NodeList` returns `function` on Safari so\n                //we can't use it (#58)\n                n = val.length;\n                while (n--) {\n                    ret[n] = val[n];\n                }\n            }\n        }\n        return ret;\n    }\n    module.exports = toArray;\n\n","var isArray = require('./isArray');\n\n    /**\n     * covert value into number if numeric\n     */\n    function toNumber(val){\n        // numberic values should come first because of -0\n        if (typeof val === 'number') return val;\n        // we want all falsy values (besides -0) to return zero to avoid\n        // headaches\n        if (!val) return 0;\n        if (typeof val === 'string') return parseFloat(val);\n        // arrays are edge cases. `Number([4]) === 4`\n        if (isArray(val)) return NaN;\n        return Number(val);\n    }\n\n    module.exports = toNumber;\n\n\n","\n    /**\n     * Clamps value inside range.\n     */\n    function clamp(val, min, max){\n        return val < min? min : (val > max? max : val);\n    }\n    module.exports = clamp;\n\n","\n    /**\n    * Linear interpolation.\n    * IMPORTANT:will return `Infinity` if numbers overflow Number.MAX_VALUE\n    */\n    function lerp(ratio, start, end){\n        return start + (end - start) * ratio;\n    }\n\n    module.exports = lerp;\n\n","var lerp = require('./lerp');\nvar norm = require('./norm');\n    /**\n    * Maps a number from one scale to another.\n    * @example map(3, 0, 4, -1, 1) -> 0.5\n    */\n    function map(val, min1, max1, min2, max2){\n        return lerp( norm(val, min1, max1), min2, max2 );\n    }\n    module.exports = map;\n\n","\n    /**\n    * Gets normalized ratio of value inside range.\n    */\n    function norm(val, min, max){\n        if (val < min || val > max) {\n            throw new RangeError('value (' + val + ') must be between ' + min + ' and ' + max);\n        }\n\n        return val === max ? 1 : (val - min) / (max - min);\n    }\n    module.exports = norm;\n\n","/**\n * @constant Maximum 32-bit signed integer value. (2^31 - 1)\n */\n\n    module.exports = 2147483647;\n\n","/**\n * @constant Minimum 32-bit signed integer value (-2^31).\n */\n\n    module.exports = -2147483648;\n\n","var toNumber = require('../lang/toNumber');\n    /**\n     * Enforce a specific amount of decimal digits and also fix floating\n     * point rounding issues.\n     */\n    function enforcePrecision(val, nDecimalDigits){\n        val = toNumber(val);\n        var pow = Math.pow(10, nDecimalDigits);\n        return +(Math.round(val * pow) / pow).toFixed(nDecimalDigits);\n    }\n    module.exports = enforcePrecision;\n\n","\n\n    /**\n     * \"Convert\" value into an 32-bit integer.\n     * Works like `Math.floor` if val > 0 and `Math.ceil` if val < 0.\n     * IMPORTANT: val will wrap at 2^31 and -2^31.\n     * Perf tests: http://jsperf.com/vs-vs-parseint-bitwise-operators/7\n     */\n    function toInt(val){\n        // we do not use lang/toNumber because of perf and also because it\n        // doesn't break the functionality\n        return ~~val;\n    }\n\n    module.exports = toInt;\n\n\n","var some = require('./some');\n\n    /**\n     * Check if object contains value\n     */\n    function contains(obj, needle) {\n        return some(obj, function(val) {\n            return (val === needle);\n        });\n    }\n    module.exports = contains;\n\n\n","var forOwn = require('./forOwn');\nvar isPlainObject = require('../lang/isPlainObject');\n\n    /**\n     * Deeply copy missing properties in the target from the defaults.\n     */\n    function deepFillIn(target, defaults){\n        var i = 0,\n            n = arguments.length,\n            obj;\n\n        while(++i < n) {\n            obj = arguments[i];\n            if (obj) {\n                // jshint loopfunc: true\n                forOwn(obj, function(newValue, key) {\n                    var curValue = target[key];\n                    if (curValue == null) {\n                        target[key] = newValue;\n                    } else if (isPlainObject(curValue) &&\n                               isPlainObject(newValue)) {\n                        deepFillIn(curValue, newValue);\n                    }\n                });\n            }\n        }\n\n        return target;\n    }\n\n    module.exports = deepFillIn;\n\n\n","var forOwn = require('./forOwn');\nvar isArray = require('../lang/isArray');\n\n    function containsMatch(array, pattern) {\n        var i = -1, length = array.length;\n        while (++i < length) {\n            if (deepMatches(array[i], pattern)) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    function matchArray(target, pattern) {\n        var i = -1, patternLength = pattern.length;\n        while (++i < patternLength) {\n            if (!containsMatch(target, pattern[i])) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    function matchObject(target, pattern) {\n        var result = true;\n        forOwn(pattern, function(val, key) {\n            if (!deepMatches(target[key], val)) {\n                // Return false to break out of forOwn early\n                return (result = false);\n            }\n        });\n\n        return result;\n    }\n\n    /**\n     * Recursively check if the objects match.\n     */\n    function deepMatches(target, pattern){\n        if (target && typeof target === 'object' &&\n            pattern && typeof pattern === 'object') {\n            if (isArray(target) && isArray(pattern)) {\n                return matchArray(target, pattern);\n            } else {\n                return matchObject(target, pattern);\n            }\n        } else {\n            return target === pattern;\n        }\n    }\n\n    module.exports = deepMatches;\n\n\n","var hasOwn = require('./hasOwn');\nvar every = require('./every');\nvar isObject = require('../lang/isObject');\nvar is = require('../lang/is');\n\n    // Makes a function to compare the object values from the specified compare\n    // operation callback.\n    function makeCompare(callback) {\n        return function(value, key) {\n            return hasOwn(this, key) && callback(value, this[key]);\n        };\n    }\n\n    function checkProperties(value, key) {\n        return hasOwn(this, key);\n    }\n\n    /**\n     * Checks if two objects have the same keys and values.\n     */\n    function equals(a, b, callback) {\n        callback = callback || is;\n\n        if (!isObject(a) || !isObject(b)) {\n            return callback(a, b);\n        }\n\n        return (every(a, makeCompare(callback), b) &&\n                every(b, checkProperties, a));\n    }\n\n    module.exports = equals;\n\n","var forOwn = require('./forOwn');\nvar makeIterator = require('../function/makeIterator_');\n\n    /**\n     * Object every\n     */\n    function every(obj, callback, thisObj) {\n        callback = makeIterator(callback, thisObj);\n        var result = true;\n        forOwn(obj, function(val, key) {\n            // we consider any falsy values as \"false\" on purpose so shorthand\n            // syntax can be used to check property existence\n            if (!callback(val, key, obj)) {\n                result = false;\n                return false; // break\n            }\n        });\n        return result;\n    }\n\n    module.exports = every;\n\n\n","var forOwn = require('./forOwn');\nvar makeIterator = require('../function/makeIterator_');\n\n    /**\n     * Creates a new object with all the properties where the callback returns\n     * true.\n     */\n    function filterValues(obj, callback, thisObj) {\n        callback = makeIterator(callback, thisObj);\n        var output = {};\n        forOwn(obj, function(value, key, obj) {\n            if (callback(value, key, obj)) {\n                output[key] = value;\n            }\n        });\n\n        return output;\n    }\n    module.exports = filterValues;\n\n","var some = require('./some');\nvar makeIterator = require('../function/makeIterator_');\n\n    /**\n     * Returns first item that matches criteria\n     */\n    function find(obj, callback, thisObj) {\n        callback = makeIterator(callback, thisObj);\n        var result;\n        some(obj, function(value, key, obj) {\n            if (callback(value, key, obj)) {\n                result = value;\n                return true; //break\n            }\n        });\n        return result;\n    }\n\n    module.exports = find;\n\n\n","var isPrimitive = require('../lang/isPrimitive');\n\n    /**\n     * get \"nested\" object property\n     */\n    function get(obj, prop){\n        var parts = prop.split('.'),\n            last = parts.pop();\n\n        while (prop = parts.shift()) {\n            obj = obj[prop];\n            if (obj == null) return;\n        }\n\n        return obj[last];\n    }\n\n    module.exports = get;\n\n\n","var get = require('./get');\n\n    var UNDEF;\n\n    /**\n     * Check if object has nested property.\n     */\n    function has(obj, prop){\n        return get(obj, prop) !== UNDEF;\n    }\n\n    module.exports = has;\n\n\n\n","var forOwn = require('./forOwn');\n\n    /**\n     * Get object keys\n     */\n     var keys = Object.keys || function (obj) {\n            var keys = [];\n            forOwn(obj, function(val, key){\n                keys.push(key);\n            });\n            return keys;\n        };\n\n    module.exports = keys;\n\n\n","var hasOwn = require('./hasOwn');\nvar deepClone = require('../lang/deepClone');\nvar isObject = require('../lang/isObject');\n\n    /**\n     * Deep merge objects.\n     */\n    function merge() {\n        var i = 1,\n            key, val, obj, target;\n\n        // make sure we don't modify source element and it's properties\n        // objects are passed by reference\n        target = deepClone( arguments[0] );\n\n        while (obj = arguments[i++]) {\n            for (key in obj) {\n                if ( ! hasOwn(obj, key) ) {\n                    continue;\n                }\n\n                val = obj[key];\n\n                if ( isObject(val) && isObject(target[key]) ){\n                    // inception, deep merge objects\n                    target[key] = merge(target[key], val);\n                } else {\n                    // make sure arrays, regexp, date, objects are cloned\n                    target[key] = deepClone(val);\n                }\n\n            }\n        }\n\n        return target;\n    }\n\n    module.exports = merge;\n\n\n","var forEach = require('../array/forEach');\n\n    /**\n     * Create nested object if non-existent\n     */\n    function namespace(obj, path){\n        if (!path) return obj;\n        forEach(path.split('.'), function(key){\n            if (!obj[key]) {\n                obj[key] = {};\n            }\n            obj = obj[key];\n        });\n        return obj;\n    }\n\n    module.exports = namespace;\n\n\n","var slice = require('../array/slice');\nvar contains = require('../array/contains');\n\n    /**\n     * Return a copy of the object, filtered to only contain properties except the blacklisted keys.\n     */\n    function omit(obj, var_keys){\n        var keys = typeof arguments[1] !== 'string'? arguments[1] : slice(arguments, 1),\n            out = {};\n\n        for (var property in obj) {\n            if (obj.hasOwnProperty(property) && !contains(keys, property)) {\n                out[property] = obj[property];\n            }\n        }\n        return out;\n    }\n\n    module.exports = omit;\n\n\n","var namespace = require('./namespace');\n\n    /**\n     * set \"nested\" object property\n     */\n    function set(obj, prop, val){\n        var parts = (/^(.+)\\.(.+)$/).exec(prop);\n        if (parts){\n            namespace(obj, parts[1])[parts[2]] = val;\n        } else {\n            obj[prop] = val;\n        }\n    }\n\n    module.exports = set;\n\n\n","var forOwn = require('./forOwn');\n\n    /**\n     * Get object size\n     */\n    function size(obj) {\n        var count = 0;\n        forOwn(obj, function(){\n            count++;\n        });\n        return count;\n    }\n\n    module.exports = size;\n\n\n","var forOwn = require('./forOwn');\nvar makeIterator = require('../function/makeIterator_');\n\n    /**\n     * Object some\n     */\n    function some(obj, callback, thisObj) {\n        callback = makeIterator(callback, thisObj);\n        var result = false;\n        forOwn(obj, function(val, key) {\n            if (callback(val, key, obj)) {\n                result = true;\n                return false; // break\n            }\n        });\n        return result;\n    }\n\n    module.exports = some;\n\n\n","var has = require('./has');\n\n    /**\n     * Unset object property.\n     */\n    function unset(obj, prop){\n        if (has(obj, prop)) {\n            var parts = prop.split('.'),\n                last = parts.pop();\n            while (prop = parts.shift()) {\n                obj = obj[prop];\n            }\n            return (delete obj[last]);\n\n        } else {\n            // if property doesn't exist treat as deleted\n            return true;\n        }\n    }\n\n    module.exports = unset;\n\n\n","var forOwn = require('./forOwn');\n\n    /**\n     * Get object values\n     */\n    function values(obj) {\n        var vals = [];\n        forOwn(obj, function(val, key){\n            vals.push(val);\n        });\n        return vals;\n    }\n\n    module.exports = values;\n\n\n","var forOwn = require('../object/forOwn');\nvar isArray = require('../lang/isArray');\nvar forEach = require('../array/forEach');\n\n    /**\n     * Encode object into a query string.\n     */\n    function encode(obj){\n        var query = [],\n            arrValues, reg;\n        forOwn(obj, function (val, key) {\n            if (isArray(val)) {\n                arrValues = key + '=';\n                reg = new RegExp('&'+key+'+=$');\n                forEach(val, function (aValue) {\n                    arrValues += encodeURIComponent(aValue) + '&' + key + '=';\n                });\n                query.push(arrValues.replace(reg, ''));\n            } else {\n               query.push(key + '=' + encodeURIComponent(val));\n            }\n        });\n        return (query.length) ? '?' + query.join('&') : '';\n    }\n\n    module.exports = encode;\n\n","var typecast = require('../string/typecast');\nvar getQuery = require('./getQuery');\n\n    /**\n     * Get query parameter value.\n     */\n    function getParam(url, param, shouldTypecast){\n        var regexp = new RegExp('(\\\\?|&)'+ param + '=([^&]*)'), //matches `?param=value` or `&param=value`, value = $2\n            result = regexp.exec( getQuery(url) ),\n            val = (result && result[2])? result[2] : null;\n        return shouldTypecast === false? val : typecast(val);\n    }\n\n    module.exports = getParam;\n\n","\n\n    /**\n     * Gets full query as string with all special chars decoded.\n     */\n    function getQuery(url) {\n        // url = url.replace(/#.*\\?/, '?'); //removes hash (to avoid getting hash query)\n        var queryString = /\\?[a-zA-Z0-9\\=\\&\\%\\$\\-\\_\\.\\+\\!\\*\\'\\(\\)\\,]+/.exec(url); //valid chars according to: http://www.ietf.org/rfc/rfc1738.txt\n        return (queryString)? decodeURIComponent(queryString[0].replace(/\\+/g,' ')) : '';\n    }\n\n    module.exports = getQuery;\n\n","\n\n    /**\n     * Set query string parameter value\n     */\n    function setParam(url, paramName, value){\n        url = url || '';\n\n        var re = new RegExp('(\\\\?|&)'+ paramName +'=[^&]*' );\n        var param = paramName +'='+ encodeURIComponent( value );\n\n        if ( re.test(url) ) {\n            return url.replace(re, '$1'+ param);\n        } else {\n            if (url.indexOf('?') === -1) {\n                url += '?';\n            }\n            if (url.indexOf('=') !== -1) {\n                url += '&';\n            }\n            return url + param;\n        }\n\n    }\n\n    module.exports = setParam;\n\n\n","var randInt = require('./randInt');\nvar isArray = require('../lang/isArray');\n\n    /**\n     * Returns a random element from the supplied arguments\n     * or from the array (if single argument is an array).\n     */\n    function choice(items) {\n        var target = (arguments.length === 1 && isArray(items))? items : arguments;\n        return target[ randInt(0, target.length - 1) ];\n    }\n\n    module.exports = choice;\n\n\n","var randHex = require('./randHex');\nvar choice = require('./choice');\n\n  /**\n   * Returns pseudo-random guid (UUID v4)\n   * IMPORTANT: it's not totally \"safe\" since randHex/choice uses Math.random\n   * by default and sequences can be predicted in some cases. See the\n   * \"random/random\" documentation for more info about it and how to replace\n   * the default PRNG.\n   */\n  function guid() {\n    return (\n        randHex(8)+'-'+\n        randHex(4)+'-'+\n        // v4 UUID always contain \"4\" at this position to specify it was\n        // randomly generated\n        '4' + randHex(3) +'-'+\n        // v4 UUID always contain chars [a,b,8,9] at this position\n        choice(8, 9, 'a', 'b') + randHex(3)+'-'+\n        randHex(12)\n    );\n  }\n  module.exports = guid;\n\n","var random = require('./random');\nvar MIN_INT = require('../number/MIN_INT');\nvar MAX_INT = require('../number/MAX_INT');\n\n    /**\n     * Returns random number inside range\n     */\n    function rand(min, max){\n        min = min == null? MIN_INT : min;\n        max = max == null? MAX_INT : max;\n        return min + (max - min) * random();\n    }\n\n    module.exports = rand;\n\n","var choice = require('./choice');\n\n    var _chars = '0123456789abcdef'.split('');\n\n    /**\n     * Returns a random hexadecimal string\n     */\n    function randHex(size){\n        size = size && size > 0? size : 6;\n        var str = '';\n        while (size--) {\n            str += choice(_chars);\n        }\n        return str;\n    }\n\n    module.exports = randHex;\n\n\n","var MIN_INT = require('../number/MIN_INT');\nvar MAX_INT = require('../number/MAX_INT');\nvar rand = require('./rand');\n\n    /**\n     * Gets random integer inside range or snap to min/max values.\n     */\n    function randInt(min, max){\n        min = min == null? MIN_INT : ~~min;\n        max = max == null? MAX_INT : ~~max;\n        // can't be max + 0.5 otherwise it will round up if `rand`\n        // returns `max` causing it to overflow range.\n        // -0.5 and + 0.49 are required to avoid bias caused by rounding\n        return Math.round( rand(min - 0.5, max + 0.499999999999) );\n    }\n\n    module.exports = randInt;\n\n","\n\n    /**\n     * Just a wrapper to Math.random. No methods inside mout/random should call\n     * Math.random() directly so we can inject the pseudo-random number\n     * generator if needed (ie. in case we need a seeded random or a better\n     * algorithm than the native one)\n     */\n    function random(){\n        return random.get();\n    }\n\n    // we expose the method so it can be swapped if needed\n    random.get = Math.random;\n\n    module.exports = random;\n\n\n","var toString = require('../lang/toString');\n\n    /**\n     * Searches for a given substring\n     */\n    function contains(str, substring, fromIndex){\n        str = toString(str);\n        substring = toString(substring);\n        return str.indexOf(substring, fromIndex) !== -1;\n    }\n\n    module.exports = contains;\n\n\n","var toString = require('../lang/toString');\n    /**\n     * Checks if string ends with specified suffix.\n     */\n    function endsWith(str, suffix) {\n        str = toString(str);\n        suffix = toString(suffix);\n\n        return str.indexOf(suffix, str.length - suffix.length) !== -1;\n    }\n\n    module.exports = endsWith;\n\n","var toString = require('../lang/toString');\n\n    /**\n     * Escapes a string for insertion into HTML.\n     */\n    function escapeHtml(str){\n        str = toString(str)\n            .replace(/&/g, '&amp;')\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;')\n            .replace(/'/g, '&#39;')\n            .replace(/\"/g, '&quot;');\n        return str;\n    }\n\n    module.exports = escapeHtml;\n\n\n","var toString = require('../lang/toString');\n\n    /**\n     * Escape string into unicode sequences\n     */\n    function escapeUnicode(str, shouldEscapePrintable){\n        str = toString(str);\n        return str.replace(/[\\s\\S]/g, function(ch){\n            // skip printable ASCII chars if we should not escape them\n            if (!shouldEscapePrintable && (/[\\x20-\\x7E]/).test(ch)) {\n                return ch;\n            }\n            // we use \"000\" and slice(-4) for brevity, need to pad zeros,\n            // unicode escape always have 4 chars after \"\\u\"\n            return '\\\\u'+ ('000'+ ch.charCodeAt(0).toString(16)).slice(-4);\n        });\n    }\n\n    module.exports = escapeUnicode;\n\n\n","var toString = require('../lang/toString');\nvar get = require('../object/get');\n\n    var stache = /\\{\\{([^\\}]+)\\}\\}/g; //mustache-like\n\n    /**\n     * String interpolation\n     */\n    function interpolate(template, replacements, syntax){\n        template = toString(template);\n        var replaceFn = function(match, prop){\n            return toString( get(replacements, prop) );\n        };\n        return template.replace(syntax || stache, replaceFn);\n    }\n\n    module.exports = interpolate;\n\n\n","var toString = require('../lang/toString');\n    /**\n     * \"Safer\" String.toLowerCase()\n     */\n    function lowerCase(str){\n        str = toString(str);\n        return str.toLowerCase();\n    }\n\n    module.exports = lowerCase;\n\n","var toString = require('../lang/toString');\nvar lowerCase = require('./lowerCase');\nvar upperCase = require('./upperCase');\n    /**\n     * UPPERCASE first char of each word.\n     */\n    function properCase(str){\n        str = toString(str);\n        return lowerCase(str).replace(/^\\w|\\s\\w/g, upperCase);\n    }\n\n    module.exports = properCase;\n\n","var toString = require('../lang/toString');\n    // This pattern is generated by the _build/pattern-removeNonWord.js script\n    var PATTERN = /[^\\x20\\x2D0-9A-Z\\x5Fa-z\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF]/g;\n\n    /**\n     * Remove non-word chars.\n     */\n    function removeNonWord(str){\n        str = toString(str);\n        return str.replace(PATTERN, '');\n    }\n\n    module.exports = removeNonWord;\n\n","var toString = require('../lang/toString');\nvar toInt = require('../number/toInt');\n\n    /**\n     * Repeat string n times\n     */\n     function repeat(str, n){\n         var result = '';\n         str = toString(str);\n         n = toInt(n);\n        if (n < 1) {\n            return '';\n        }\n        while (n > 0) {\n            if (n % 2) {\n                result += str;\n            }\n            n = Math.floor(n / 2);\n            str += str;\n        }\n        return result;\n     }\n\n     module.exports = repeat;\n\n\n","var toString = require('../lang/toString');\nvar toArray = require('../lang/toArray');\n\n    /**\n     * Replace string(s) with the replacement(s) in the source.\n     */\n    function replace(str, search, replacements) {\n        str = toString(str);\n        search = toArray(search);\n        replacements = toArray(replacements);\n\n        var searchLength = search.length,\n            replacementsLength = replacements.length;\n\n        if (replacementsLength !== 1 && searchLength !== replacementsLength) {\n            throw new Error('Unequal number of searches and replacements');\n        }\n\n        var i = -1;\n        while (++i < searchLength) {\n            // Use the first replacement for all searches if only one\n            // replacement is provided\n            str = str.replace(\n                search[i],\n                replacements[(replacementsLength === 1) ? 0 : i]);\n        }\n\n        return str;\n    }\n\n    module.exports = replace;\n\n\n","var toString = require('../lang/toString');\n    /**\n    * Replaces all accented chars with regular ones\n    */\n    function replaceAccents(str){\n        str = toString(str);\n\n        // verifies if the String has accents and replace them\n        if (str.search(/[\\xC0-\\xFF]/g) > -1) {\n            str = str\n                    .replace(/[\\xC0-\\xC5]/g, \"A\")\n                    .replace(/[\\xC6]/g, \"AE\")\n                    .replace(/[\\xC7]/g, \"C\")\n                    .replace(/[\\xC8-\\xCB]/g, \"E\")\n                    .replace(/[\\xCC-\\xCF]/g, \"I\")\n                    .replace(/[\\xD0]/g, \"D\")\n                    .replace(/[\\xD1]/g, \"N\")\n                    .replace(/[\\xD2-\\xD6\\xD8]/g, \"O\")\n                    .replace(/[\\xD9-\\xDC]/g, \"U\")\n                    .replace(/[\\xDD]/g, \"Y\")\n                    .replace(/[\\xDE]/g, \"P\")\n                    .replace(/[\\xE0-\\xE5]/g, \"a\")\n                    .replace(/[\\xE6]/g, \"ae\")\n                    .replace(/[\\xE7]/g, \"c\")\n                    .replace(/[\\xE8-\\xEB]/g, \"e\")\n                    .replace(/[\\xEC-\\xEF]/g, \"i\")\n                    .replace(/[\\xF1]/g, \"n\")\n                    .replace(/[\\xF2-\\xF6\\xF8]/g, \"o\")\n                    .replace(/[\\xF9-\\xFC]/g, \"u\")\n                    .replace(/[\\xFE]/g, \"p\")\n                    .replace(/[\\xFD\\xFF]/g, \"y\");\n        }\n        return str;\n    }\n    module.exports = replaceAccents;\n\n","var toString = require('../lang/toString');\nvar repeat = require('./repeat');\n\n    /**\n     * Pad string with `char` if its' length is smaller than `minLen`\n     */\n    function rpad(str, minLen, ch) {\n        str = toString(str);\n        ch = ch || ' ';\n        return (str.length < minLen)? str + repeat(ch, minLen - str.length) : str;\n    }\n\n    module.exports = rpad;\n\n\n","var toString = require('../lang/toString');\nvar replaceAccents = require('./replaceAccents');\nvar removeNonWord = require('./removeNonWord');\nvar trim = require('./trim');\n    /**\n     * Convert to lower case, remove accents, remove non-word chars and\n     * replace spaces with the specified delimeter.\n     * Does not split camelCase text.\n     */\n    function slugify(str, delimeter){\n        str = toString(str);\n\n        if (delimeter == null) {\n            delimeter = \"-\";\n        }\n        str = replaceAccents(str);\n        str = removeNonWord(str);\n        str = trim(str) //should come after removeNonWord\n                .replace(/ +/g, delimeter) //replace spaces with delimeter\n                .toLowerCase();\n        return str;\n    }\n    module.exports = slugify;\n\n","\n\n    var UNDEF;\n\n    /**\n     * Parses string and convert it into a native value.\n     */\n    function typecast(val) {\n        var r;\n        if ( val === null || val === 'null' ) {\n            r = null;\n        } else if ( val === 'true' ) {\n            r = true;\n        } else if ( val === 'false' ) {\n            r = false;\n        } else if ( val === UNDEF || val === 'undefined' ) {\n            r = UNDEF;\n        } else if ( val === '' || isNaN(val) ) {\n            //isNaN('') returns false\n            r = val;\n        } else {\n            //parseFloat(null || '') returns NaN\n            r = parseFloat(val);\n        }\n        return r;\n    }\n\n    module.exports = typecast;\n\n","var toString = require('../lang/toString');\n\n    /**\n     * Unescapes HTML special chars\n     */\n    function unescapeHtml(str){\n        str = toString(str)\n            .replace(/&amp;/g , '&')\n            .replace(/&lt;/g  , '<')\n            .replace(/&gt;/g  , '>')\n            .replace(/&#0*39;/g , \"'\")\n            .replace(/&quot;/g, '\"');\n        return str;\n    }\n\n    module.exports = unescapeHtml;\n\n\n","var toString = require('../lang/toString');\n    /**\n     * Replaces hyphens with spaces. (only hyphens between word chars)\n     */\n    function unhyphenate(str){\n        str = toString(str);\n        return str.replace(/(\\w)(-)(\\w)/g, '$1 $3');\n    }\n    module.exports = unhyphenate;\n\n","var kindOf = require('./kindOf');\nvar isPlainObject = require('./isPlainObject');\nvar mixIn = require('../object/mixIn');\n\n    /**\n     * Clone native types.\n     */\n    function clone(val){\n        switch (kindOf(val)) {\n            case 'Object':\n                return cloneObject(val);\n            case 'Array':\n                return cloneArray(val);\n            case 'RegExp':\n                return cloneRegExp(val);\n            case 'Date':\n                return cloneDate(val);\n            default:\n                return val;\n        }\n    }\n\n    function cloneObject(source) {\n        if (isPlainObject(source)) {\n            return mixIn({}, source);\n        } else {\n            return source;\n        }\n    }\n\n    function cloneRegExp(r) {\n        var flags = '';\n        flags += r.multiline ? 'm' : '';\n        flags += r.global ? 'g' : '';\n        flags += r.ignorecase ? 'i' : '';\n        return new RegExp(r.source, flags);\n    }\n\n    function cloneDate(date) {\n        return new Date(+date);\n    }\n\n    function cloneArray(arr) {\n        return arr.slice();\n    }\n\n    module.exports = clone;\n\n\n","\"use strict\";\n\n// credits to @cpojer's Class.Binds, released under the MIT license\n// https://github.com/cpojer/mootools-class-extras/blob/master/Source/Class.Binds.js\n\nvar prime = require(\"prime\")\nvar bind = require(\"mout/function/bind\")\n\nvar bound = prime({\n\n    bound: function(name){\n        var bound = this._bound || (this._bound = {})\n        return bound[name] || (bound[name] = bind(this[name], this))\n    }\n\n})\n\nmodule.exports = bound\n","\"use strict\";\n\nvar prime = require(\"prime\")\nvar merge = require(\"mout/object/merge\")\n\nvar Options = prime({\n\n    setOptions: function(options){\n        var args = [{}, this.options]\n        args.push.apply(args, arguments)\n        this.options = merge.apply(null, args)\n        return this\n    }\n\n})\n\nmodule.exports = Options\n","/*\r\ndefer\r\n*/\"use strict\"\r\n\r\nvar kindOf  = require(\"mout/lang/kindOf\"),\r\n    now     = require(\"mout/time/now\"),\r\n    forEach = require(\"mout/array/forEach\"),\r\n    indexOf = require(\"mout/array/indexOf\")\r\n\r\nvar callbacks = {\r\n    timeout: {},\r\n    frame: [],\r\n    immediate: []\r\n}\r\n\r\nvar push = function(collection, callback, context, defer){\r\n\r\n    var iterator = function(){\r\n        iterate(collection)\r\n    }\r\n\r\n    if (!collection.length) defer(iterator)\r\n\r\n    var entry = {\r\n        callback: callback,\r\n        context: context\r\n    }\r\n\r\n    collection.push(entry)\r\n\r\n    return function(){\r\n        var io = indexOf(collection, entry)\r\n        if (io > -1) collection.splice(io, 1)\r\n    }\r\n}\r\n\r\nvar iterate = function(collection){\r\n    var time = now()\r\n\r\n    forEach(collection.splice(0), function(entry) {\r\n        entry.callback.call(entry.context, time)\r\n    })\r\n}\r\n\r\nvar defer = function(callback, argument, context){\r\n    return (kindOf(argument) === \"Number\") ? defer.timeout(callback, argument, context) : defer.immediate(callback, argument)\r\n}\r\n\r\nif (global.process && process.nextTick){\r\n\r\n    defer.immediate = function(callback, context){\r\n        return push(callbacks.immediate, callback, context, process.nextTick)\r\n    }\r\n\r\n} else if (global.setImmediate){\r\n\r\n    defer.immediate = function(callback, context){\r\n        return push(callbacks.immediate, callback, context, setImmediate)\r\n    }\r\n\r\n} else if (global.postMessage && global.addEventListener){\r\n\r\n    addEventListener(\"message\", function(event){\r\n        if (event.source === global && event.data === \"@deferred\"){\r\n            event.stopPropagation()\r\n            iterate(callbacks.immediate)\r\n        }\r\n    }, true)\r\n\r\n    defer.immediate = function(callback, context){\r\n        return push(callbacks.immediate, callback, context, function(){\r\n            postMessage(\"@deferred\", \"*\")\r\n        })\r\n    }\r\n\r\n} else {\r\n\r\n    defer.immediate = function(callback, context){\r\n        return push(callbacks.immediate, callback, context, function(iterator){\r\n            setTimeout(iterator, 0)\r\n        })\r\n    }\r\n\r\n}\r\n\r\nvar requestAnimationFrame = global.requestAnimationFrame ||\r\n    global.webkitRequestAnimationFrame ||\r\n    global.mozRequestAnimationFrame ||\r\n    global.oRequestAnimationFrame ||\r\n    global.msRequestAnimationFrame ||\r\n    function(callback) {\r\n        setTimeout(callback, 1e3 / 60)\r\n    }\r\n\r\ndefer.frame = function(callback, context){\r\n    return push(callbacks.frame, callback, context, requestAnimationFrame)\r\n}\r\n\r\nvar clear\r\n\r\ndefer.timeout = function(callback, ms, context){\r\n    var ct = callbacks.timeout\r\n\r\n    if (!clear) clear = defer.immediate(function(){\r\n        clear = null\r\n        callbacks.timeout = {}\r\n    })\r\n\r\n    return push(ct[ms] || (ct[ms] = []), callback, context, function(iterator){\r\n        setTimeout(iterator, ms)\r\n    })\r\n}\r\n\r\nmodule.exports = defer\r\n","/*\r\nEmitter\r\n*/\"use strict\"\r\n\r\nvar indexOf = require(\"mout/array/indexOf\"),\r\n    forEach = require(\"mout/array/forEach\")\r\n\r\nvar prime = require(\"./index\"),\r\n    defer = require(\"./defer\")\r\n\r\nvar slice = Array.prototype.slice;\r\n\r\nvar Emitter = prime({\r\n\r\n    constructor: function(stoppable){\r\n        this._stoppable = stoppable\r\n    },\r\n\r\n    on: function(event, fn){\r\n        var listeners = this._listeners || (this._listeners = {}),\r\n            events = listeners[event] || (listeners[event] = [])\r\n\r\n        if (indexOf(events, fn) === -1) events.push(fn)\r\n\r\n        return this\r\n    },\r\n\r\n    off: function(event, fn){\r\n        var listeners = this._listeners, events\r\n        if (listeners && (events = listeners[event])){\r\n\r\n            var io = indexOf(events, fn)\r\n            if (io > -1) events.splice(io, 1)\r\n            if (!events.length) delete listeners[event];\r\n            for (var l in listeners) return this\r\n            delete this._listeners\r\n        }\r\n        return this\r\n    },\r\n\r\n    emit: function(event){\r\n        var self = this,\r\n            args = slice.call(arguments, 1)\r\n\r\n        var emit = function(){\r\n            var listeners = self._listeners, events\r\n            if (listeners && (events = listeners[event])){\r\n                forEach(events.slice(0), function(event){\r\n                    var result = event.apply(self, args)\r\n                    if (self._stoppable) return result\r\n                })\r\n            }\r\n        }\r\n\r\n        if (args[args.length - 1] === Emitter.EMIT_SYNC){\r\n            args.pop()\r\n            emit()\r\n        } else {\r\n            defer(emit)\r\n        }\r\n\r\n        return this\r\n    }\r\n\r\n})\r\n\r\nEmitter.EMIT_SYNC = {}\r\n\r\nmodule.exports = Emitter\r\n","/*\r\nprime\r\n - prototypal inheritance\r\n*/\"use strict\"\r\n\r\nvar hasOwn = require(\"mout/object/hasOwn\"),\r\n    mixIn  = require(\"mout/object/mixIn\"),\r\n    create = require(\"mout/lang/createObject\"),\r\n    kindOf = require(\"mout/lang/kindOf\")\r\n\r\nvar hasDescriptors = true\r\n\r\ntry {\r\n    Object.defineProperty({}, \"~\", {})\r\n    Object.getOwnPropertyDescriptor({}, \"~\")\r\n} catch (e){\r\n    hasDescriptors = false\r\n}\r\n\r\n// we only need to be able to implement \"toString\" and \"valueOf\" in IE < 9\r\nvar hasEnumBug = !({valueOf: 0}).propertyIsEnumerable(\"valueOf\"),\r\n    buggy      = [\"toString\", \"valueOf\"]\r\n\r\nvar verbs = /^constructor|inherits|mixin$/\r\n\r\nvar implement = function(proto){\r\n    var prototype = this.prototype\r\n\r\n    for (var key in proto){\r\n        if (key.match(verbs)) continue\r\n        if (hasDescriptors){\r\n            var descriptor = Object.getOwnPropertyDescriptor(proto, key)\r\n            if (descriptor){\r\n                Object.defineProperty(prototype, key, descriptor)\r\n                continue\r\n            }\r\n        }\r\n        prototype[key] = proto[key]\r\n    }\r\n\r\n    if (hasEnumBug) for (var i = 0; (key = buggy[i]); i++){\r\n        var value = proto[key]\r\n        if (value !== Object.prototype[key]) prototype[key] = value\r\n    }\r\n\r\n    return this\r\n}\r\n\r\nvar prime = function(proto){\r\n\r\n    if (kindOf(proto) === \"Function\") proto = {constructor: proto}\r\n\r\n    var superprime = proto.inherits\r\n\r\n    // if our nice proto object has no own constructor property\r\n    // then we proceed using a ghosting constructor that all it does is\r\n    // call the parent's constructor if it has a superprime, else an empty constructor\r\n    // proto.constructor becomes the effective constructor\r\n    var constructor = (hasOwn(proto, \"constructor\")) ? proto.constructor : (superprime) ? function(){\r\n        return superprime.apply(this, arguments)\r\n    } : function(){}\r\n\r\n    if (superprime){\r\n\r\n        mixIn(constructor, superprime)\r\n\r\n        var superproto = superprime.prototype\r\n        // inherit from superprime\r\n        var cproto = constructor.prototype = create(superproto)\r\n\r\n        // setting constructor.parent to superprime.prototype\r\n        // because it's the shortest possible absolute reference\r\n        constructor.parent = superproto\r\n        cproto.constructor = constructor\r\n    }\r\n\r\n    if (!constructor.implement) constructor.implement = implement\r\n\r\n    var mixins = proto.mixin\r\n    if (mixins){\r\n        if (kindOf(mixins) !== \"Array\") mixins = [mixins]\r\n        for (var i = 0; i < mixins.length; i++) constructor.implement(create(mixins[i].prototype))\r\n    }\r\n\r\n    // implement proto and return constructor\r\n    return constructor.implement(proto)\r\n\r\n}\r\n\r\nmodule.exports = prime\r\n","/*\r\nMap\r\n*/\"use strict\"\r\n\r\nvar indexOf = require(\"mout/array/indexOf\")\r\n\r\nvar prime = require(\"./index\")\r\n\r\nvar Map = prime({\r\n\r\n    constructor: function Map(){\r\n        this.length = 0\r\n        this._values = []\r\n        this._keys = []\r\n    },\r\n\r\n    set: function(key, value){\r\n        var index = indexOf(this._keys, key)\r\n\r\n        if (index === -1){\r\n            this._keys.push(key)\r\n            this._values.push(value)\r\n            this.length++\r\n        } else {\r\n            this._values[index] = value\r\n        }\r\n\r\n        return this\r\n    },\r\n\r\n    get: function(key){\r\n        var index = indexOf(this._keys, key)\r\n        return (index === -1) ? null : this._values[index]\r\n    },\r\n\r\n    count: function(){\r\n        return this.length\r\n    },\r\n\r\n    forEach: function(method, context){\r\n        for (var i = 0, l = this.length; i < l; i++){\r\n            if (method.call(context, this._values[i], this._keys[i], this) === false) break\r\n        }\r\n        return this\r\n    },\r\n\r\n    map: function(method, context){\r\n        var results = new Map\r\n        this.forEach(function(value, key){\r\n            results.set(key, method.call(context, value, key, this))\r\n        }, this)\r\n        return results\r\n    },\r\n\r\n    filter: function(method, context){\r\n        var results = new Map\r\n        this.forEach(function(value, key){\r\n            if (method.call(context, value, key, this)) results.set(key, value)\r\n        }, this)\r\n        return results\r\n    },\r\n\r\n    every: function(method, context){\r\n        var every = true\r\n        this.forEach(function(value, key){\r\n            if (!method.call(context, value, key, this)) return (every = false)\r\n        }, this)\r\n        return every\r\n    },\r\n\r\n    some: function(method, context){\r\n        var some = false\r\n        this.forEach(function(value, key){\r\n            if (method.call(context, value, key, this)) return !(some = true)\r\n        }, this)\r\n        return some\r\n    },\r\n\r\n    indexOf: function(value){\r\n        var index = indexOf(this._values, value)\r\n        return (index > -1) ? this._keys[index] : null\r\n    },\r\n\r\n    remove: function(value){\r\n        var index = indexOf(this._values, value)\r\n\r\n        if (index !== -1){\r\n            this._values.splice(index, 1)\r\n            this.length--\r\n            return this._keys.splice(index, 1)[0]\r\n        }\r\n\r\n        return null\r\n    },\r\n\r\n    unset: function(key){\r\n        var index = indexOf(this._keys, key)\r\n\r\n        if (index !== -1){\r\n            this._keys.splice(index, 1)\r\n            this.length--\r\n            return this._values.splice(index, 1)[0]\r\n        }\r\n\r\n        return null\r\n    },\r\n\r\n    keys: function(){\r\n        return this._keys.slice()\r\n    },\r\n\r\n    values: function(){\r\n        return this._values.slice()\r\n    }\r\n\r\n})\r\n\r\nvar map = function(){\r\n    return new Map\r\n}\r\n\r\nmap.prototype = Map.prototype\r\n\r\nmodule.exports = map\r\n","/**\n * sifter.js\n * Copyright (c) 2013 Brian Reavis & contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\n * file except in compliance with the License. You may obtain a copy of the License at:\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\n * ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n *\n * @author Brian Reavis <brian@thirdroute.com>\n */\n\n(function(root, factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t} else {\n\t\troot.Sifter = factory();\n\t}\n}(this, function() {\n\n\t/**\n\t * Textually searches arrays and hashes of objects\n\t * by property (or multiple properties). Designed\n\t * specifically for autocomplete.\n\t *\n\t * @constructor\n\t * @param {array|object} items\n\t * @param {object} items\n\t */\n\tvar Sifter = function(items, settings) {\n\t\tthis.items = items;\n\t\tthis.settings = settings || {diacritics: true};\n\t};\n\n\t/**\n\t * Splits a search string into an array of individual\n\t * regexps to be used to match results.\n\t *\n\t * @param {string} query\n\t * @returns {array}\n\t */\n\tSifter.prototype.tokenize = function(query) {\n\t\tquery = trim(String(query || '').toLowerCase());\n\t\tif (!query || !query.length) return [];\n\n\t\tvar i, n, regex, letter;\n\t\tvar tokens = [];\n\t\tvar words = query.split(/ +/);\n\n\t\tfor (i = 0, n = words.length; i < n; i++) {\n\t\t\tregex = escape_regex(words[i]);\n\t\t\tif (this.settings.diacritics) {\n\t\t\t\tfor (letter in DIACRITICS) {\n\t\t\t\t\tif (DIACRITICS.hasOwnProperty(letter)) {\n\t\t\t\t\t\tregex = regex.replace(new RegExp(letter, 'g'), DIACRITICS[letter]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\ttokens.push({\n\t\t\t\tstring : words[i],\n\t\t\t\tregex  : new RegExp(regex, 'i')\n\t\t\t});\n\t\t}\n\n\t\treturn tokens;\n\t};\n\n\t/**\n\t * Iterates over arrays and hashes.\n\t *\n\t * ```\n\t * this.iterator(this.items, function(item, id) {\n\t *    // invoked for each item\n\t * });\n\t * ```\n\t *\n\t * @param {array|object} object\n\t */\n\tSifter.prototype.iterator = function(object, callback) {\n\t\tvar iterator;\n\t\tif (is_array(object)) {\n\t\t\titerator = Array.prototype.forEach || function(callback) {\n\t\t\t\tfor (var i = 0, n = this.length; i < n; i++) {\n\t\t\t\t\tcallback(this[i], i, this);\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\titerator = function(callback) {\n\t\t\t\tfor (var key in this) {\n\t\t\t\t\tif (this.hasOwnProperty(key)) {\n\t\t\t\t\t\tcallback(this[key], key, this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\titerator.apply(object, [callback]);\n\t};\n\n\t/**\n\t * Returns a function to be used to score individual results.\n\t *\n\t * Good matches will have a higher score than poor matches.\n\t * If an item is not a match, 0 will be returned by the function.\n\t *\n\t * @param {object|string} search\n\t * @param {object} options (optional)\n\t * @returns {function}\n\t */\n\tSifter.prototype.getScoreFunction = function(search, options) {\n\t\tvar self, fields, tokens, token_count, nesting;\n\n\t\tself        = this;\n\t\tsearch      = self.prepareSearch(search, options);\n\t\ttokens      = search.tokens;\n\t\tfields      = search.options.fields;\n\t\ttoken_count = tokens.length;\n\t\tnesting     = search.options.nesting;\n\n\t\t/**\n\t\t * Calculates how close of a match the\n\t\t * given value is against a search token.\n\t\t *\n\t\t * @param {mixed} value\n\t\t * @param {object} token\n\t\t * @return {number}\n\t\t */\n\t\tvar scoreValue = function(value, token) {\n\t\t\tvar score, pos;\n\n\t\t\tif (!value) return 0;\n\t\t\tvalue = String(value || '');\n\t\t\tpos = value.search(token.regex);\n\t\t\tif (pos === -1) return 0;\n\t\t\tscore = token.string.length / value.length;\n\t\t\tif (pos === 0) score += 0.5;\n\t\t\treturn score;\n\t\t};\n\n\t\t/**\n\t\t * Calculates the score of an object\n\t\t * against the search query.\n\t\t *\n\t\t * @param {object} token\n\t\t * @param {object} data\n\t\t * @return {number}\n\t\t */\n\t\tvar scoreObject = (function() {\n\t\t\tvar field_count = fields.length;\n\t\t\tif (!field_count) {\n\t\t\t\treturn function() { return 0; };\n\t\t\t}\n\t\t\tif (field_count === 1) {\n\t\t\t\treturn function(token, data) {\n\t\t\t\t\treturn scoreValue(getattr(data, fields[0], nesting), token);\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn function(token, data) {\n\t\t\t\tfor (var i = 0, sum = 0; i < field_count; i++) {\n\t\t\t\t\tsum += scoreValue(getattr(data, fields[i], nesting), token);\n\t\t\t\t}\n\t\t\t\treturn sum / field_count;\n\t\t\t};\n\t\t})();\n\n\t\tif (!token_count) {\n\t\t\treturn function() { return 0; };\n\t\t}\n\t\tif (token_count === 1) {\n\t\t\treturn function(data) {\n\t\t\t\treturn scoreObject(tokens[0], data);\n\t\t\t};\n\t\t}\n\n\t\tif (search.options.conjunction === 'and') {\n\t\t\treturn function(data) {\n\t\t\t\tvar score;\n\t\t\t\tfor (var i = 0, sum = 0; i < token_count; i++) {\n\t\t\t\t\tscore = scoreObject(tokens[i], data);\n\t\t\t\t\tif (score <= 0) return 0;\n\t\t\t\t\tsum += score;\n\t\t\t\t}\n\t\t\t\treturn sum / token_count;\n\t\t\t};\n\t\t} else {\n\t\t\treturn function(data) {\n\t\t\t\tfor (var i = 0, sum = 0; i < token_count; i++) {\n\t\t\t\t\tsum += scoreObject(tokens[i], data);\n\t\t\t\t}\n\t\t\t\treturn sum / token_count;\n\t\t\t};\n\t\t}\n\t};\n\n\t/**\n\t * Returns a function that can be used to compare two\n\t * results, for sorting purposes. If no sorting should\n\t * be performed, `null` will be returned.\n\t *\n\t * @param {string|object} search\n\t * @param {object} options\n\t * @return function(a,b)\n\t */\n\tSifter.prototype.getSortFunction = function(search, options) {\n\t\tvar i, n, self, field, fields, fields_count, multiplier, multipliers, get_field, implicit_score, sort;\n\n\t\tself   = this;\n\t\tsearch = self.prepareSearch(search, options);\n\t\tsort   = (!search.query && options.sort_empty) || options.sort;\n\n\t\t/**\n\t\t * Fetches the specified sort field value\n\t\t * from a search result item.\n\t\t *\n\t\t * @param  {string} name\n\t\t * @param  {object} result\n\t\t * @return {mixed}\n\t\t */\n\t\tget_field = function(name, result) {\n\t\t\tif (name === '$score') return result.score;\n\t\t\treturn getattr(self.items[result.id], name, options.nesting);\n\t\t};\n\n\t\t// parse options\n\t\tfields = [];\n\t\tif (sort) {\n\t\t\tfor (i = 0, n = sort.length; i < n; i++) {\n\t\t\t\tif (search.query || sort[i].field !== '$score') {\n\t\t\t\t\tfields.push(sort[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// the \"$score\" field is implied to be the primary\n\t\t// sort field, unless it's manually specified\n\t\tif (search.query) {\n\t\t\timplicit_score = true;\n\t\t\tfor (i = 0, n = fields.length; i < n; i++) {\n\t\t\t\tif (fields[i].field === '$score') {\n\t\t\t\t\timplicit_score = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (implicit_score) {\n\t\t\t\tfields.unshift({field: '$score', direction: 'desc'});\n\t\t\t}\n\t\t} else {\n\t\t\tfor (i = 0, n = fields.length; i < n; i++) {\n\t\t\t\tif (fields[i].field === '$score') {\n\t\t\t\t\tfields.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tmultipliers = [];\n\t\tfor (i = 0, n = fields.length; i < n; i++) {\n\t\t\tmultipliers.push(fields[i].direction === 'desc' ? -1 : 1);\n\t\t}\n\n\t\t// build function\n\t\tfields_count = fields.length;\n\t\tif (!fields_count) {\n\t\t\treturn null;\n\t\t} else if (fields_count === 1) {\n\t\t\tfield = fields[0].field;\n\t\t\tmultiplier = multipliers[0];\n\t\t\treturn function(a, b) {\n\t\t\t\treturn multiplier * cmp(\n\t\t\t\t\tget_field(field, a),\n\t\t\t\t\tget_field(field, b)\n\t\t\t\t);\n\t\t\t};\n\t\t} else {\n\t\t\treturn function(a, b) {\n\t\t\t\tvar i, result, a_value, b_value, field;\n\t\t\t\tfor (i = 0; i < fields_count; i++) {\n\t\t\t\t\tfield = fields[i].field;\n\t\t\t\t\tresult = multipliers[i] * cmp(\n\t\t\t\t\t\tget_field(field, a),\n\t\t\t\t\t\tget_field(field, b)\n\t\t\t\t\t);\n\t\t\t\t\tif (result) return result;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t}\n\t};\n\n\t/**\n\t * Parses a search query and returns an object\n\t * with tokens and fields ready to be populated\n\t * with results.\n\t *\n\t * @param {string} query\n\t * @param {object} options\n\t * @returns {object}\n\t */\n\tSifter.prototype.prepareSearch = function(query, options) {\n\t\tif (typeof query === 'object') return query;\n\n\t\toptions = extend({}, options);\n\n\t\tvar option_fields     = options.fields;\n\t\tvar option_sort       = options.sort;\n\t\tvar option_sort_empty = options.sort_empty;\n\n\t\tif (option_fields && !is_array(option_fields)) options.fields = [option_fields];\n\t\tif (option_sort && !is_array(option_sort)) options.sort = [option_sort];\n\t\tif (option_sort_empty && !is_array(option_sort_empty)) options.sort_empty = [option_sort_empty];\n\n\t\treturn {\n\t\t\toptions : options,\n\t\t\tquery   : String(query || '').toLowerCase(),\n\t\t\ttokens  : this.tokenize(query),\n\t\t\ttotal   : 0,\n\t\t\titems   : []\n\t\t};\n\t};\n\n\t/**\n\t * Searches through all items and returns a sorted array of matches.\n\t *\n\t * The `options` parameter can contain:\n\t *\n\t *   - fields {string|array}\n\t *   - sort {array}\n\t *   - score {function}\n\t *   - filter {bool}\n\t *   - limit {integer}\n\t *\n\t * Returns an object containing:\n\t *\n\t *   - options {object}\n\t *   - query {string}\n\t *   - tokens {array}\n\t *   - total {int}\n\t *   - items {array}\n\t *\n\t * @param {string} query\n\t * @param {object} options\n\t * @returns {object}\n\t */\n\tSifter.prototype.search = function(query, options) {\n\t\tvar self = this, value, score, search, calculateScore;\n\t\tvar fn_sort;\n\t\tvar fn_score;\n\n\t\tsearch  = this.prepareSearch(query, options);\n\t\toptions = search.options;\n\t\tquery   = search.query;\n\n\t\t// generate result scoring function\n\t\tfn_score = options.score || self.getScoreFunction(search);\n\n\t\t// perform search and sort\n\t\tif (query.length) {\n\t\t\tself.iterator(self.items, function(item, id) {\n\t\t\t\tscore = fn_score(item);\n\t\t\t\tif (options.filter === false || score > 0) {\n\t\t\t\t\tsearch.items.push({'score': score, 'id': id});\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tself.iterator(self.items, function(item, id) {\n\t\t\t\tsearch.items.push({'score': 1, 'id': id});\n\t\t\t});\n\t\t}\n\n\t\tfn_sort = self.getSortFunction(search, options);\n\t\tif (fn_sort) search.items.sort(fn_sort);\n\n\t\t// apply limits\n\t\tsearch.total = search.items.length;\n\t\tif (typeof options.limit === 'number') {\n\t\t\tsearch.items = search.items.slice(0, options.limit);\n\t\t}\n\n\t\treturn search;\n\t};\n\n\t// utilities\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n\tvar cmp = function(a, b) {\n\t\tif (typeof a === 'number' && typeof b === 'number') {\n\t\t\treturn a > b ? 1 : (a < b ? -1 : 0);\n\t\t}\n\t\ta = asciifold(String(a || ''));\n\t\tb = asciifold(String(b || ''));\n\t\tif (a > b) return 1;\n\t\tif (b > a) return -1;\n\t\treturn 0;\n\t};\n\n\tvar extend = function(a, b) {\n\t\tvar i, n, k, object;\n\t\tfor (i = 1, n = arguments.length; i < n; i++) {\n\t\t\tobject = arguments[i];\n\t\t\tif (!object) continue;\n\t\t\tfor (k in object) {\n\t\t\t\tif (object.hasOwnProperty(k)) {\n\t\t\t\t\ta[k] = object[k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn a;\n\t};\n\n\t/**\n\t * A property getter resolving dot-notation\n\t * @param  {Object}  obj     The root object to fetch property on\n\t * @param  {String}  name    The optionally dotted property name to fetch\n\t * @param  {Boolean} nesting Handle nesting or not\n\t * @return {Object}          The resolved property value\n\t */\n\tvar getattr = function(obj, name, nesting) {\n\t    if (!obj || !name) return;\n\t    if (!nesting) return obj[name];\n\t    var names = name.split(\".\");\n\t    while(names.length && (obj = obj[names.shift()]));\n\t    return obj;\n\t};\n\n\tvar trim = function(str) {\n\t\treturn (str + '').replace(/^\\s+|\\s+$|/g, '');\n\t};\n\n\tvar escape_regex = function(str) {\n\t\treturn (str + '').replace(/([.?*+^$[\\]\\\\(){}|-])/g, '\\\\$1');\n\t};\n\n\tvar is_array = Array.isArray || (typeof $ !== 'undefined' && $.isArray) || function(object) {\n\t\treturn Object.prototype.toString.call(object) === '[object Array]';\n\t};\n\n\tvar DIACRITICS = {\n\t\t'a': '[a]',\n\t\t'b': '[bB]',\n\t\t'c': '[cCc]',\n\t\t'd': '[dDd]',\n\t\t'e': '[e]',\n\t\t'f': '[f]',\n\t\t'g': '[g]',\n\t\t'h': '[h]',\n\t\t'i': '[iiI]',\n\t\t'j': '[j]',\n\t\t'k': '[k]',\n\t\t'l': '[l]',\n\t\t'n': '[nNn]',\n\t\t'o': '[o]',\n\t\t'p': '[p]',\n\t\t'q': '[qq]',\n\t\t'r': '[r]',\n\t\t's': '[sSs]',\n\t\t't': '[t]',\n\t\t'u': '[u]',\n\t\t'v': '[v]',\n\t\t'w': '[w]',\n\t\t'x': '[x]',\n\t\t'y': '[y]',\n\t\t'z': '[z]'\n\t};\n\n\tvar asciifold = (function() {\n\t\tvar i, n, k, chunk;\n\t\tvar foreignletters = '';\n\t\tvar lookup = {};\n\t\tfor (k in DIACRITICS) {\n\t\t\tif (DIACRITICS.hasOwnProperty(k)) {\n\t\t\t\tchunk = DIACRITICS[k].substring(2, DIACRITICS[k].length - 1);\n\t\t\t\tforeignletters += chunk;\n\t\t\t\tfor (i = 0, n = chunk.length; i < n; i++) {\n\t\t\t\t\tlookup[chunk.charAt(i)] = k;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvar regexp = new RegExp('[' +  foreignletters + ']', 'g');\n\t\treturn function(str) {\n\t\t\treturn str.replace(regexp, function(foreignletter) {\n\t\t\t\treturn lookup[foreignletter];\n\t\t\t}).toLowerCase();\n\t\t};\n\t})();\n\n\n\t// export\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n\treturn Sifter;\n}));\n\n","/*\r\nSlick Finder\r\n*/\"use strict\"\r\n\r\n// Notable changes from Slick.Finder 1.0.x\r\n\r\n// faster bottom -> up expression matching\r\n// prefers mental sanity over *obsessive compulsive* milliseconds savings\r\n// uses prototypes instead of objects\r\n// tries to use matchesSelector smartly, whenever available\r\n// can populate objects as well as arrays\r\n// lots of stuff is broken or not implemented\r\n\r\nvar parse = require(\"./parser\")\r\n\r\n// utilities\r\n\r\nvar index = 0,\r\n    counter = document.__counter = (parseInt(document.__counter || -1, 36) + 1).toString(36),\r\n    key = \"uid:\" + counter\r\n\r\nvar uniqueID = function(n, xml){\r\n    if (n === window) return \"window\"\r\n    if (n === document) return \"document\"\r\n    if (n === document.documentElement) return \"html\"\r\n\r\n    if (xml) {\r\n        var uid = n.getAttribute(key)\r\n        if (!uid) {\r\n            uid = (index++).toString(36)\r\n            n.setAttribute(key, uid)\r\n        }\r\n        return uid\r\n    } else {\r\n        return n[key] || (n[key] = (index++).toString(36))\r\n    }\r\n}\r\n\r\nvar uniqueIDXML = function(n) {\r\n    return uniqueID(n, true)\r\n}\r\n\r\nvar isArray = Array.isArray || function(object){\r\n    return Object.prototype.toString.call(object) === \"[object Array]\"\r\n}\r\n\r\n// tests\r\n\r\nvar uniqueIndex = 0;\r\n\r\nvar HAS = {\r\n\r\n    GET_ELEMENT_BY_ID: function(test, id){\r\n        id = \"slick_\" + (uniqueIndex++);\r\n        // checks if the document has getElementById, and it works\r\n        test.innerHTML = '<a id=\"' + id + '\"></a>'\r\n        return !!this.getElementById(id)\r\n    },\r\n\r\n    QUERY_SELECTOR: function(test){\r\n        // this supposedly fixes a webkit bug with matchesSelector / querySelector & nth-child\r\n        test.innerHTML = '_<style>:nth-child(2){}</style>'\r\n\r\n        // checks if the document has querySelectorAll, and it works\r\n        test.innerHTML = '<a class=\"MiX\"></a>'\r\n\r\n        return test.querySelectorAll('.MiX').length === 1\r\n    },\r\n\r\n    EXPANDOS: function(test, id){\r\n        id = \"slick_\" + (uniqueIndex++);\r\n        // checks if the document has elements that support expandos\r\n        test._custom_property_ = id\r\n        return test._custom_property_ === id\r\n    },\r\n\r\n    // TODO: use this ?\r\n\r\n    // CHECKED_QUERY_SELECTOR: function(test){\r\n    //\r\n    //     // checks if the document supports the checked query selector\r\n    //     test.innerHTML = '<select><option selected=\"selected\">a</option></select>'\r\n    //     return test.querySelectorAll(':checked').length === 1\r\n    // },\r\n\r\n    // TODO: use this ?\r\n\r\n    // EMPTY_ATTRIBUTE_QUERY_SELECTOR: function(test){\r\n    //\r\n    //     // checks if the document supports the empty attribute query selector\r\n    //     test.innerHTML = '<a class=\"\"></a>'\r\n    //     return test.querySelectorAll('[class*=\"\"]').length === 1\r\n    // },\r\n\r\n    MATCHES_SELECTOR: function(test){\r\n\r\n        test.className = \"MiX\"\r\n\r\n        // checks if the document has matchesSelector, and we can use it.\r\n\r\n        var matches = test.matchesSelector || test.mozMatchesSelector || test.webkitMatchesSelector\r\n\r\n        // if matchesSelector trows errors on incorrect syntax we can use it\r\n        if (matches) try {\r\n            matches.call(test, ':slick')\r\n        } catch(e){\r\n            // just as a safety precaution, also test if it works on mixedcase (like querySelectorAll)\r\n            return matches.call(test, \".MiX\") ? matches : false\r\n        }\r\n\r\n        return false\r\n    },\r\n\r\n    GET_ELEMENTS_BY_CLASS_NAME: function(test){\r\n        test.innerHTML = '<a class=\"f\"></a><a class=\"b\"></a>'\r\n        if (test.getElementsByClassName('b').length !== 1) return false\r\n\r\n        test.firstChild.className = 'b'\r\n        if (test.getElementsByClassName('b').length !== 2) return false\r\n\r\n        // Opera 9.6 getElementsByClassName doesnt detects the class if its not the first one\r\n        test.innerHTML = '<a class=\"a\"></a><a class=\"f b a\"></a>'\r\n        if (test.getElementsByClassName('a').length !== 2) return false\r\n\r\n        // tests passed\r\n        return true\r\n    },\r\n\r\n    // no need to know\r\n\r\n    // GET_ELEMENT_BY_ID_NOT_NAME: function(test, id){\r\n    //     test.innerHTML = '<a name=\"'+ id +'\"></a><b id=\"'+ id +'\"></b>'\r\n    //     return this.getElementById(id) !== test.firstChild\r\n    // },\r\n\r\n    // this is always checked for and fixed\r\n\r\n    // STAR_GET_ELEMENTS_BY_TAG_NAME: function(test){\r\n    //\r\n    //     // IE returns comment nodes for getElementsByTagName('*') for some documents\r\n    //     test.appendChild(this.createComment(''))\r\n    //     if (test.getElementsByTagName('*').length > 0) return false\r\n    //\r\n    //     // IE returns closed nodes (EG:\"</foo>\") for getElementsByTagName('*') for some documents\r\n    //     test.innerHTML = 'foo</foo>'\r\n    //     if (test.getElementsByTagName('*').length) return false\r\n    //\r\n    //     // tests passed\r\n    //     return true\r\n    // },\r\n\r\n    // this is always checked for and fixed\r\n\r\n    // STAR_QUERY_SELECTOR: function(test){\r\n    //\r\n    //     // returns closed nodes (EG:\"</foo>\") for querySelector('*') for some documents\r\n    //     test.innerHTML = 'foo</foo>'\r\n    //     return !!(test.querySelectorAll('*').length)\r\n    // },\r\n\r\n    GET_ATTRIBUTE: function(test){\r\n        // tests for working getAttribute implementation\r\n        var shout = \"fus ro dah\"\r\n        test.innerHTML = '<a class=\"' + shout + '\"></a>'\r\n        return test.firstChild.getAttribute('class') === shout\r\n    }\r\n\r\n}\r\n\r\n// Finder\r\n\r\nvar Finder = function Finder(document){\r\n\r\n    this.document        = document\r\n    var root = this.root = document.documentElement\r\n    this.tested          = {}\r\n\r\n    // uniqueID\r\n\r\n    this.uniqueID = this.has(\"EXPANDOS\") ? uniqueID : uniqueIDXML\r\n\r\n    // getAttribute\r\n\r\n    this.getAttribute = (this.has(\"GET_ATTRIBUTE\")) ? function(node, name){\r\n\r\n        return node.getAttribute(name)\r\n\r\n    } : function(node, name){\r\n\r\n        node = node.getAttributeNode(name)\r\n        return (node && node.specified) ? node.value : null\r\n\r\n    }\r\n\r\n    // hasAttribute\r\n\r\n    this.hasAttribute = (root.hasAttribute) ? function(node, attribute){\r\n\r\n        return node.hasAttribute(attribute)\r\n\r\n    } : function(node, attribute) {\r\n\r\n        node = node.getAttributeNode(attribute)\r\n        return !!(node && node.specified)\r\n\r\n    }\r\n\r\n    // contains\r\n\r\n    this.contains = (document.contains && root.contains) ? function(context, node){\r\n\r\n        return context.contains(node)\r\n\r\n    } : (root.compareDocumentPosition) ? function(context, node){\r\n\r\n        return context === node || !!(context.compareDocumentPosition(node) & 16)\r\n\r\n    } : function(context, node){\r\n\r\n        do {\r\n            if (node === context) return true\r\n        } while ((node = node.parentNode))\r\n\r\n        return false\r\n    }\r\n\r\n    // sort\r\n    // credits to Sizzle (http://sizzlejs.com/)\r\n\r\n    this.sorter = (root.compareDocumentPosition) ? function(a, b){\r\n\r\n        if (!a.compareDocumentPosition || !b.compareDocumentPosition) return 0\r\n        return a.compareDocumentPosition(b) & 4 ? -1 : a === b ? 0 : 1\r\n\r\n    } : ('sourceIndex' in root) ? function(a, b){\r\n\r\n        if (!a.sourceIndex || !b.sourceIndex) return 0\r\n        return a.sourceIndex - b.sourceIndex\r\n\r\n    } : (document.createRange) ? function(a, b){\r\n\r\n        if (!a.ownerDocument || !b.ownerDocument) return 0\r\n        var aRange = a.ownerDocument.createRange(),\r\n            bRange = b.ownerDocument.createRange()\r\n\r\n        aRange.setStart(a, 0)\r\n        aRange.setEnd(a, 0)\r\n        bRange.setStart(b, 0)\r\n        bRange.setEnd(b, 0)\r\n        return aRange.compareBoundaryPoints(Range.START_TO_END, bRange)\r\n\r\n    } : null\r\n\r\n    this.failed = {}\r\n\r\n    var nativeMatches = this.has(\"MATCHES_SELECTOR\")\r\n\r\n    if (nativeMatches) this.matchesSelector = function(node, expression){\r\n\r\n        if (this.failed[expression]) return null\r\n\r\n        try {\r\n            return nativeMatches.call(node, expression)\r\n        } catch(e){\r\n            if (slick.debug) console.warn(\"matchesSelector failed on \" + expression)\r\n            this.failed[expression] = true\r\n            return null\r\n        }\r\n\r\n    }\r\n\r\n    if (this.has(\"QUERY_SELECTOR\")){\r\n\r\n        this.querySelectorAll = function(node, expression){\r\n\r\n            if (this.failed[expression]) return true\r\n\r\n            var result, _id, _expression, _combinator, _node\r\n\r\n\r\n            // non-document rooted QSA\r\n            // credits to Andrew Dupont\r\n\r\n            if (node !== this.document){\r\n\r\n                _combinator = expression[0].combinator\r\n\r\n                _id         = node.getAttribute(\"id\")\r\n                _expression = expression\r\n\r\n                if (!_id){\r\n                    _node = node\r\n                    _id = \"__slick__\"\r\n                    _node.setAttribute(\"id\", _id)\r\n                }\r\n\r\n                expression = \"#\" + _id + \" \" + _expression\r\n\r\n\r\n                // these combinators need a parentNode due to how querySelectorAll works, which is:\r\n                // finding all the elements that match the given selector\r\n                // then filtering by the ones that have the specified element as an ancestor\r\n                if (_combinator.indexOf(\"~\") > -1 || _combinator.indexOf(\"+\") > -1){\r\n\r\n                    node = node.parentNode\r\n                    if (!node) result = true\r\n                    // if node has no parentNode, we return \"true\" as if it failed, without polluting the failed cache\r\n\r\n                }\r\n\r\n            }\r\n\r\n            if (!result) try {\r\n                result = node.querySelectorAll(expression.toString())\r\n            } catch(e){\r\n                if (slick.debug) console.warn(\"querySelectorAll failed on \" + (_expression || expression))\r\n                result = this.failed[_expression || expression] = true\r\n            }\r\n\r\n            if (_node) _node.removeAttribute(\"id\")\r\n\r\n            return result\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nFinder.prototype.has = function(FEATURE){\r\n\r\n    var tested        = this.tested,\r\n        testedFEATURE = tested[FEATURE]\r\n\r\n    if (testedFEATURE != null) return testedFEATURE\r\n\r\n    var root     = this.root,\r\n        document = this.document,\r\n        testNode = document.createElement(\"div\")\r\n\r\n    testNode.setAttribute(\"style\", \"display: none;\")\r\n\r\n    root.appendChild(testNode)\r\n\r\n    var TEST = HAS[FEATURE], result = false\r\n\r\n    if (TEST) try {\r\n        result = TEST.call(document, testNode)\r\n    } catch(e){}\r\n\r\n    if (slick.debug && !result) console.warn(\"document has no \" + FEATURE)\r\n\r\n    root.removeChild(testNode)\r\n\r\n    return tested[FEATURE] = result\r\n\r\n}\r\n\r\nvar combinators = {\r\n\r\n    \" \": function(node, part, push){\r\n\r\n        var item, items\r\n\r\n        var noId = !part.id, noTag = !part.tag, noClass = !part.classes\r\n\r\n        if (part.id && node.getElementById && this.has(\"GET_ELEMENT_BY_ID\")){\r\n            item = node.getElementById(part.id)\r\n\r\n            // return only if id is found, else keep checking\r\n            // might be a tad slower on non-existing ids, but less insane\r\n\r\n            if (item && item.getAttribute('id') === part.id){\r\n                items = [item]\r\n                noId = true\r\n                // if tag is star, no need to check it in match()\r\n                if (part.tag === \"*\") noTag = true\r\n            }\r\n        }\r\n\r\n        if (!items){\r\n\r\n            if (part.classes && node.getElementsByClassName && this.has(\"GET_ELEMENTS_BY_CLASS_NAME\")){\r\n                items = node.getElementsByClassName(part.classList)\r\n                noClass = true\r\n                // if tag is star, no need to check it in match()\r\n                if (part.tag === \"*\") noTag = true\r\n            } else {\r\n                items = node.getElementsByTagName(part.tag)\r\n                // if tag is star, need to check it in match because it could select junk, boho\r\n                if (part.tag !== \"*\") noTag = true\r\n            }\r\n\r\n            if (!items || !items.length) return false\r\n\r\n        }\r\n\r\n        for (var i = 0; item = items[i++];)\r\n            if ((noTag && noId && noClass && !part.attributes && !part.pseudos) || this.match(item, part, noTag, noId, noClass))\r\n                push(item)\r\n\r\n        return true\r\n\r\n    },\r\n\r\n    \">\": function(node, part, push){ // direct children\r\n        if ((node = node.firstChild)) do {\r\n            if (node.nodeType == 1 && this.match(node, part)) push(node)\r\n        } while ((node = node.nextSibling))\r\n    },\r\n\r\n    \"+\": function(node, part, push){ // next sibling\r\n        while ((node = node.nextSibling)) if (node.nodeType == 1){\r\n            if (this.match(node, part)) push(node)\r\n            break\r\n        }\r\n    },\r\n\r\n    \"^\": function(node, part, push){ // first child\r\n        node = node.firstChild\r\n        if (node){\r\n            if (node.nodeType === 1){\r\n                if (this.match(node, part)) push(node)\r\n            } else {\r\n                combinators['+'].call(this, node, part, push)\r\n            }\r\n        }\r\n    },\r\n\r\n    \"~\": function(node, part, push){ // next siblings\r\n        while ((node = node.nextSibling)){\r\n            if (node.nodeType === 1 && this.match(node, part)) push(node)\r\n        }\r\n    },\r\n\r\n    \"++\": function(node, part, push){ // next sibling and previous sibling\r\n        combinators['+'].call(this, node, part, push)\r\n        combinators['!+'].call(this, node, part, push)\r\n    },\r\n\r\n    \"~~\": function(node, part, push){ // next siblings and previous siblings\r\n        combinators['~'].call(this, node, part, push)\r\n        combinators['!~'].call(this, node, part, push)\r\n    },\r\n\r\n    \"!\": function(node, part, push){ // all parent nodes up to document\r\n        while ((node = node.parentNode)) if (node !== this.document && this.match(node, part)) push(node)\r\n    },\r\n\r\n    \"!>\": function(node, part, push){ // direct parent (one level)\r\n        node = node.parentNode\r\n        if (node !== this.document && this.match(node, part)) push(node)\r\n    },\r\n\r\n    \"!+\": function(node, part, push){ // previous sibling\r\n        while ((node = node.previousSibling)) if (node.nodeType == 1){\r\n            if (this.match(node, part)) push(node)\r\n            break\r\n        }\r\n    },\r\n\r\n    \"!^\": function(node, part, push){ // last child\r\n        node = node.lastChild\r\n        if (node){\r\n            if (node.nodeType == 1){\r\n                if (this.match(node, part)) push(node)\r\n            } else {\r\n                combinators['!+'].call(this, node, part, push)\r\n            }\r\n        }\r\n    },\r\n\r\n    \"!~\": function(node, part, push){ // previous siblings\r\n        while ((node = node.previousSibling)){\r\n            if (node.nodeType === 1 && this.match(node, part)) push(node)\r\n        }\r\n    }\r\n\r\n}\r\n\r\nFinder.prototype.search = function(context, expression, found){\r\n\r\n    if (!context) context = this.document\r\n    else if (!context.nodeType && context.document) context = context.document\r\n\r\n    var expressions = parse(expression)\r\n\r\n    // no expressions were parsed. todo: is this really necessary?\r\n    if (!expressions || !expressions.length) throw new Error(\"invalid expression\")\r\n\r\n    if (!found) found = []\r\n\r\n    var uniques, push = isArray(found) ? function(node){\r\n        found[found.length] = node\r\n    } : function(node){\r\n        found[found.length++] = node\r\n    }\r\n\r\n    // if there is more than one expression we need to check for duplicates when we push to found\r\n    // this simply saves the old push and wraps it around an uid dupe check.\r\n    if (expressions.length > 1){\r\n        uniques = {}\r\n        var plush = push\r\n        push = function(node){\r\n            var uid = uniqueID(node)\r\n            if (!uniques[uid]){\r\n                uniques[uid] = true\r\n                plush(node)\r\n            }\r\n        }\r\n    }\r\n\r\n    // walker\r\n\r\n    var node, nodes, part\r\n\r\n    main: for (var i = 0; expression = expressions[i++];){\r\n\r\n        // querySelector\r\n\r\n        // TODO: more functional tests\r\n\r\n        // if there is querySelectorAll (and the expression does not fail) use it.\r\n        if (!slick.noQSA && this.querySelectorAll){\r\n\r\n            nodes = this.querySelectorAll(context, expression)\r\n            if (nodes !== true){\r\n                if (nodes && nodes.length) for (var j = 0; node = nodes[j++];) if (node.nodeName > '@'){\r\n                    push(node)\r\n                }\r\n                continue main\r\n            }\r\n        }\r\n\r\n        // if there is only one part in the expression we don't need to check each part for duplicates.\r\n        // todo: this might be too naive. while solid, there can be expression sequences that do not\r\n        // produce duplicates. \"body div\" for instance, can never give you each div more than once.\r\n        // \"body div a\" on the other hand might.\r\n        if (expression.length === 1){\r\n\r\n            part = expression[0]\r\n            combinators[part.combinator].call(this, context, part, push)\r\n\r\n        } else {\r\n\r\n            var cs = [context], c, f, u, p = function(node){\r\n                var uid = uniqueID(node)\r\n                if (!u[uid]){\r\n                    u[uid] = true\r\n                    f[f.length] = node\r\n                }\r\n            }\r\n\r\n            // loop the expression parts\r\n            for (var j = 0; part = expression[j++];){\r\n                f = []; u = {}\r\n                // loop the contexts\r\n                for (var k = 0; c = cs[k++];) combinators[part.combinator].call(this, c, part, p)\r\n                // nothing was found, the expression failed, continue to the next expression.\r\n                if (!f.length) continue main\r\n                cs = f // set the contexts for future parts (if any)\r\n            }\r\n\r\n            if (i === 0) found = f // first expression. directly set found.\r\n            else for (var l = 0; l < f.length; l++) push(f[l]) // any other expression needs to push to found.\r\n        }\r\n\r\n    }\r\n\r\n    if (uniques && found && found.length > 1) this.sort(found)\r\n\r\n    return found\r\n\r\n}\r\n\r\nFinder.prototype.sort = function(nodes){\r\n    return this.sorter ? Array.prototype.sort.call(nodes, this.sorter) : nodes\r\n}\r\n\r\n// TODO: most of these pseudo selectors include <html> and qsa doesnt. fixme.\r\n\r\nvar pseudos = {\r\n\r\n\r\n    // TODO: returns different results than qsa empty.\r\n\r\n    'empty': function(){\r\n        return !(this && this.nodeType === 1) && !(this.innerText || this.textContent || '').length\r\n    },\r\n\r\n    'not': function(expression){\r\n        return !slick.matches(this, expression)\r\n    },\r\n\r\n    'contains': function(text){\r\n        return (this.innerText || this.textContent || '').indexOf(text) > -1\r\n    },\r\n\r\n    'first-child': function(){\r\n        var node = this\r\n        while ((node = node.previousSibling)) if (node.nodeType == 1) return false\r\n        return true\r\n    },\r\n\r\n    'last-child': function(){\r\n        var node = this\r\n        while ((node = node.nextSibling)) if (node.nodeType == 1) return false\r\n        return true\r\n    },\r\n\r\n    'only-child': function(){\r\n        var prev = this\r\n        while ((prev = prev.previousSibling)) if (prev.nodeType == 1) return false\r\n\r\n        var next = this\r\n        while ((next = next.nextSibling)) if (next.nodeType == 1) return false\r\n\r\n        return true\r\n    },\r\n\r\n    'first-of-type': function(){\r\n        var node = this, nodeName = node.nodeName\r\n        while ((node = node.previousSibling)) if (node.nodeName == nodeName) return false\r\n        return true\r\n    },\r\n\r\n    'last-of-type': function(){\r\n        var node = this, nodeName = node.nodeName\r\n        while ((node = node.nextSibling)) if (node.nodeName == nodeName) return false\r\n        return true\r\n    },\r\n\r\n    'only-of-type': function(){\r\n        var prev = this, nodeName = this.nodeName\r\n        while ((prev = prev.previousSibling)) if (prev.nodeName == nodeName) return false\r\n        var next = this\r\n        while ((next = next.nextSibling)) if (next.nodeName == nodeName) return false\r\n        return true\r\n    },\r\n\r\n    'enabled': function(){\r\n        return !this.disabled\r\n    },\r\n\r\n    'disabled': function(){\r\n        return this.disabled\r\n    },\r\n\r\n    'checked': function(){\r\n        return this.checked || this.selected\r\n    },\r\n\r\n    'selected': function(){\r\n        return this.selected\r\n    },\r\n\r\n    'focus': function(){\r\n        var doc = this.ownerDocument\r\n        return doc.activeElement === this && (this.href || this.type || slick.hasAttribute(this, 'tabindex'))\r\n    },\r\n\r\n    'root': function(){\r\n        return (this === this.ownerDocument.documentElement)\r\n    }\r\n\r\n}\r\n\r\nFinder.prototype.match = function(node, bit, noTag, noId, noClass){\r\n\r\n    // TODO: more functional tests ?\r\n\r\n    if (!slick.noQSA && this.matchesSelector){\r\n        var matches = this.matchesSelector(node, bit)\r\n        if (matches !== null) return matches\r\n    }\r\n\r\n    // normal matching\r\n\r\n    if (!noTag && bit.tag){\r\n\r\n        var nodeName = node.nodeName.toLowerCase()\r\n        if (bit.tag === \"*\"){\r\n            if (nodeName < \"@\") return false\r\n        } else if (nodeName != bit.tag){\r\n            return false\r\n        }\r\n\r\n    }\r\n\r\n    if (!noId && bit.id && node.getAttribute('id') !== bit.id) return false\r\n\r\n    var i, part\r\n\r\n    if (!noClass && bit.classes){\r\n\r\n        var className = this.getAttribute(node, \"class\")\r\n        if (!className) return false\r\n\r\n        for (part in bit.classes) if (!RegExp('(^|\\\\s)' + bit.classes[part] + '(\\\\s|$)').test(className)) return false\r\n    }\r\n\r\n    var name, value\r\n\r\n    if (bit.attributes) for (i = 0; part = bit.attributes[i++];){\r\n\r\n        var operator  = part.operator,\r\n            escaped   = part.escapedValue\r\n\r\n        name  = part.name\r\n        value = part.value\r\n\r\n        if (!operator){\r\n\r\n            if (!this.hasAttribute(node, name)) return false\r\n\r\n        } else {\r\n\r\n            var actual = this.getAttribute(node, name)\r\n            if (actual == null) return false\r\n\r\n            switch (operator){\r\n                case '^=' : if (!RegExp(      '^' + escaped            ).test(actual)) return false; break\r\n                case '$=' : if (!RegExp(            escaped + '$'      ).test(actual)) return false; break\r\n                case '~=' : if (!RegExp('(^|\\\\s)' + escaped + '(\\\\s|$)').test(actual)) return false; break\r\n                case '|=' : if (!RegExp(      '^' + escaped + '(-|$)'  ).test(actual)) return false; break\r\n\r\n                case '='  : if (actual !== value) return false; break\r\n                case '*=' : if (actual.indexOf(value) === -1) return false; break\r\n                default   : return false\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    if (bit.pseudos) for (i = 0; part = bit.pseudos[i++];){\r\n\r\n        name  = part.name\r\n        value = part.value\r\n\r\n        if (pseudos[name]) return pseudos[name].call(node, value)\r\n\r\n        if (value != null){\r\n            if (this.getAttribute(node, name) !== value) return false\r\n        } else {\r\n            if (!this.hasAttribute(node, name)) return false\r\n        }\r\n\r\n    }\r\n\r\n    return true\r\n\r\n}\r\n\r\nFinder.prototype.matches = function(node, expression){\r\n\r\n    var expressions = parse(expression)\r\n\r\n    if (expressions.length === 1 && expressions[0].length === 1){ // simplest match\r\n        return this.match(node, expressions[0][0])\r\n    }\r\n\r\n    // TODO: more functional tests ?\r\n\r\n    if (!slick.noQSA && this.matchesSelector){\r\n        var matches = this.matchesSelector(node, expressions)\r\n        if (matches !== null) return matches\r\n    }\r\n\r\n    var nodes = this.search(this.document, expression, {length: 0})\r\n\r\n    for (var i = 0, res; res = nodes[i++];) if (node === res) return true\r\n    return false\r\n\r\n}\r\n\r\nvar finders = {}\r\n\r\nvar finder = function(context){\r\n    var doc = context || document\r\n    if (doc.ownerDocument) doc = doc.ownerDocument\r\n    else if (doc.document) doc = doc.document\r\n\r\n    if (doc.nodeType !== 9) throw new TypeError(\"invalid document\")\r\n\r\n    var uid = uniqueID(doc)\r\n    return finders[uid] || (finders[uid] = new Finder(doc))\r\n}\r\n\r\n// ... API ...\r\n\r\nvar slick = function(expression, context){\r\n    return slick.search(expression, context)\r\n}\r\n\r\nslick.search = function(expression, context, found){\r\n    return finder(context).search(context, expression, found)\r\n}\r\n\r\nslick.find = function(expression, context){\r\n    return finder(context).search(context, expression)[0] || null\r\n}\r\n\r\nslick.getAttribute = function(node, name){\r\n    return finder(node).getAttribute(node, name)\r\n}\r\n\r\nslick.hasAttribute = function(node, name){\r\n    return finder(node).hasAttribute(node, name)\r\n}\r\n\r\nslick.contains = function(context, node){\r\n    return finder(context).contains(context, node)\r\n}\r\n\r\nslick.matches = function(node, expression){\r\n    return finder(node).matches(node, expression)\r\n}\r\n\r\nslick.sort = function(nodes){\r\n    if (nodes && nodes.length > 1) finder(nodes[0]).sort(nodes)\r\n    return nodes\r\n}\r\n\r\nslick.parse = parse;\r\n\r\n// slick.debug = true\r\n// slick.noQSA  = true\r\n\r\nmodule.exports = slick\r\n","/*\r\nslick\r\n*/\"use strict\"\r\n\r\nmodule.exports = \"document\" in global ? require(\"./finder\") : { parse: require(\"./parser\") }\r\n","/*\r\nSlick Parser\r\n - originally created by the almighty Thomas Aylott <@subtlegradient> (http://subtlegradient.com)\r\n*/\"use strict\"\r\n\r\n// Notable changes from Slick.Parser 1.0.x\r\n\r\n// The parser now uses 2 classes: Expressions and Expression\r\n// `new Expressions` produces an array-like object containing a list of Expression objects\r\n// - Expressions::toString() produces a cleaned up expressions string\r\n// `new Expression` produces an array-like object\r\n// - Expression::toString() produces a cleaned up expression string\r\n// The only exposed method is parse, which produces a (cached) `new Expressions` instance\r\n// parsed.raw is no longer present, use .toString()\r\n// parsed.expression is now useless, just use the indices\r\n// parsed.reverse() has been removed for now, due to its apparent uselessness\r\n// Other changes in the Expressions object:\r\n// - classNames are now unique, and save both escaped and unescaped values\r\n// - attributes now save both escaped and unescaped values\r\n// - pseudos now save both escaped and unescaped values\r\n\r\nvar escapeRe   = /([-.*+?^${}()|[\\]\\/\\\\])/g,\r\n    unescapeRe = /\\\\/g\r\n\r\nvar escape = function(string){\r\n    // XRegExp v2.0.0-beta-3\r\n    //  https://github.com/slevithan/XRegExp/blob/master/src/xregexp.js\r\n    return (string + \"\").replace(escapeRe, '\\\\$1')\r\n}\r\n\r\nvar unescape = function(string){\r\n    return (string + \"\").replace(unescapeRe, '')\r\n}\r\n\r\nvar slickRe = RegExp(\r\n/*\r\n#!/usr/bin/env ruby\r\nputs \"\\t\\t\" + DATA.read.gsub(/\\(\\?x\\)|\\s+#.*$|\\s+|\\\\$|\\\\n/,'')\r\n__END__\r\n    \"(?x)^(?:\\\r\n      \\\\s* ( , ) \\\\s*               # Separator          \\n\\\r\n    | \\\\s* ( <combinator>+ ) \\\\s*   # Combinator         \\n\\\r\n    |      ( \\\\s+ )                 # CombinatorChildren \\n\\\r\n    |      ( <unicode>+ | \\\\* )     # Tag                \\n\\\r\n    | \\\\#  ( <unicode>+       )     # ID                 \\n\\\r\n    | \\\\.  ( <unicode>+       )     # ClassName          \\n\\\r\n    |                               # Attribute          \\n\\\r\n    \\\\[  \\\r\n        \\\\s* (<unicode1>+)  (?:  \\\r\n            \\\\s* ([*^$!~|]?=)  (?:  \\\r\n                \\\\s* (?:\\\r\n                    ([\\\"']?)(.*?)\\\\9 \\\r\n                )\\\r\n            )  \\\r\n        )?  \\\\s*  \\\r\n    \\\\](?!\\\\]) \\n\\\r\n    |   :+ ( <unicode>+ )(?:\\\r\n    \\\\( (?:\\\r\n        (?:([\\\"'])([^\\\\12]*)\\\\12)|((?:\\\\([^)]+\\\\)|[^()]*)+)\\\r\n    ) \\\\)\\\r\n    )?\\\r\n    )\"\r\n*/\r\n\"^(?:\\\\s*(,)\\\\s*|\\\\s*(<combinator>+)\\\\s*|(\\\\s+)|(<unicode>+|\\\\*)|\\\\#(<unicode>+)|\\\\.(<unicode>+)|\\\\[\\\\s*(<unicode1>+)(?:\\\\s*([*^$!~|]?=)(?:\\\\s*(?:([\\\"']?)(.*?)\\\\9)))?\\\\s*\\\\](?!\\\\])|(:+)(<unicode>+)(?:\\\\((?:(?:([\\\"'])([^\\\\13]*)\\\\13)|((?:\\\\([^)]+\\\\)|[^()]*)+))\\\\))?)\"\r\n    .replace(/<combinator>/, '[' + escape(\">+~`!@$%^&={}\\\\;</\") + ']')\r\n    .replace(/<unicode>/g, '(?:[\\\\w\\\\u00a1-\\\\uFFFF-]|\\\\\\\\[^\\\\s0-9a-f])')\r\n    .replace(/<unicode1>/g, '(?:[:\\\\w\\\\u00a1-\\\\uFFFF-]|\\\\\\\\[^\\\\s0-9a-f])')\r\n)\r\n\r\n// Part\r\n\r\nvar Part = function Part(combinator){\r\n    this.combinator = combinator || \" \"\r\n    this.tag = \"*\"\r\n}\r\n\r\nPart.prototype.toString = function(){\r\n\r\n    if (!this.raw){\r\n\r\n        var xpr = \"\", k, part\r\n\r\n        xpr += this.tag || \"*\"\r\n        if (this.id) xpr += \"#\" + this.id\r\n        if (this.classes) xpr += \".\" + this.classList.join(\".\")\r\n        if (this.attributes) for (k = 0; part = this.attributes[k++];){\r\n            xpr += \"[\" + part.name + (part.operator ? part.operator + '\"' + part.value + '\"' : '') + \"]\"\r\n        }\r\n        if (this.pseudos) for (k = 0; part = this.pseudos[k++];){\r\n            xpr += \":\" + part.name\r\n            if (part.value) xpr += \"(\" + part.value + \")\"\r\n        }\r\n\r\n        this.raw = xpr\r\n\r\n    }\r\n\r\n    return this.raw\r\n}\r\n\r\n// Expression\r\n\r\nvar Expression = function Expression(){\r\n    this.length = 0\r\n}\r\n\r\nExpression.prototype.toString = function(){\r\n\r\n    if (!this.raw){\r\n\r\n        var xpr = \"\"\r\n\r\n        for (var j = 0, bit; bit = this[j++];){\r\n            if (j !== 1) xpr += \" \"\r\n            if (bit.combinator !== \" \") xpr += bit.combinator + \" \"\r\n            xpr += bit\r\n        }\r\n\r\n        this.raw = xpr\r\n\r\n    }\r\n\r\n    return this.raw\r\n}\r\n\r\nvar replacer = function(\r\n    rawMatch,\r\n\r\n    separator,\r\n    combinator,\r\n    combinatorChildren,\r\n\r\n    tagName,\r\n    id,\r\n    className,\r\n\r\n    attributeKey,\r\n    attributeOperator,\r\n    attributeQuote,\r\n    attributeValue,\r\n\r\n    pseudoMarker,\r\n    pseudoClass,\r\n    pseudoQuote,\r\n    pseudoClassQuotedValue,\r\n    pseudoClassValue\r\n){\r\n\r\n    var expression, current\r\n\r\n    if (separator || !this.length){\r\n        expression = this[this.length++] = new Expression\r\n        if (separator) return ''\r\n    }\r\n\r\n    if (!expression) expression = this[this.length - 1]\r\n\r\n    if (combinator || combinatorChildren || !expression.length){\r\n        current = expression[expression.length++] = new Part(combinator)\r\n    }\r\n\r\n    if (!current) current = expression[expression.length - 1]\r\n\r\n    if (tagName){\r\n\r\n        current.tag = unescape(tagName)\r\n\r\n    } else if (id){\r\n\r\n        current.id = unescape(id)\r\n\r\n    } else if (className){\r\n\r\n        var unescaped = unescape(className)\r\n\r\n        var classes = current.classes || (current.classes = {})\r\n        if (!classes[unescaped]){\r\n            classes[unescaped] = escape(className)\r\n            var classList = current.classList || (current.classList = [])\r\n            classList.push(unescaped)\r\n            classList.sort()\r\n        }\r\n\r\n    } else if (pseudoClass){\r\n\r\n        pseudoClassValue = pseudoClassValue || pseudoClassQuotedValue\r\n\r\n        ;(current.pseudos || (current.pseudos = [])).push({\r\n            type         : pseudoMarker.length == 1 ? 'class' : 'element',\r\n            name         : unescape(pseudoClass),\r\n            escapedName  : escape(pseudoClass),\r\n            value        : pseudoClassValue ? unescape(pseudoClassValue) : null,\r\n            escapedValue : pseudoClassValue ? escape(pseudoClassValue) : null\r\n        })\r\n\r\n    } else if (attributeKey){\r\n\r\n        attributeValue = attributeValue ? escape(attributeValue) : null\r\n\r\n        ;(current.attributes || (current.attributes = [])).push({\r\n            operator     : attributeOperator,\r\n            name         : unescape(attributeKey),\r\n            escapedName  : escape(attributeKey),\r\n            value        : attributeValue ? unescape(attributeValue) : null,\r\n            escapedValue : attributeValue ? escape(attributeValue) : null\r\n        })\r\n\r\n    }\r\n\r\n    return ''\r\n\r\n}\r\n\r\n// Expressions\r\n\r\nvar Expressions = function Expressions(expression){\r\n    this.length = 0\r\n\r\n    var self = this\r\n\r\n    var original = expression, replaced\r\n\r\n    while (expression){\r\n        replaced = expression.replace(slickRe, function(){\r\n            return replacer.apply(self, arguments)\r\n        })\r\n        if (replaced === expression) throw new Error(original + ' is an invalid expression')\r\n        expression = replaced\r\n    }\r\n}\r\n\r\nExpressions.prototype.toString = function(){\r\n    if (!this.raw){\r\n        var expressions = []\r\n        for (var i = 0, expression; expression = this[i++];) expressions.push(expression)\r\n        this.raw = expressions.join(\", \")\r\n    }\r\n\r\n    return this.raw\r\n}\r\n\r\nvar cache = {}\r\n\r\nvar parse = function(expression){\r\n    if (expression == null) return null\r\n    expression = ('' + expression).replace(/^\\s+|\\s+$/g, '')\r\n    return cache[expression] || (cache[expression] = new Expressions(expression))\r\n}\r\n\r\nmodule.exports = parse\r\n","/**!\n * Sortable\n * @author\tRubaXa   <trash@rubaxa.org>\n * @license MIT\n */\n\n\n(function (factory) {\n\t\"use strict\";\n\n\tif (typeof define === \"function\" && define.amd) {\n\t\tdefine(factory);\n\t}\n\telse if (typeof module != \"undefined\" && typeof module.exports != \"undefined\") {\n\t\tmodule.exports = factory();\n\t}\n\telse if (typeof Package !== \"undefined\") {\n\t\tSortable = factory();  // export for Meteor.js\n\t}\n\telse {\n\t\t/* jshint sub:true */\n\t\twindow[\"Sortable\"] = factory();\n\t}\n})(function () {\n\t\"use strict\";\n\n\tif (typeof window == \"undefined\" || typeof window.document == \"undefined\") {\n\t\treturn function() {\n\t\t\tthrow new Error( \"Sortable.js requires a window with a document\" );\n\t\t}\n\t}\n\n\tvar dragEl,\n\t\tparentEl,\n\t\tghostEl,\n\t\tcloneEl,\n\t\trootEl,\n\t\tnextEl,\n\n\t\tscrollEl,\n\t\tscrollParentEl,\n\n\t\tlastEl,\n\t\tlastCSS,\n\t\tlastParentCSS,\n\n\t\toldIndex,\n\t\tnewIndex,\n\n\t\tactiveGroup,\n\t\tautoScroll = {},\n\n\t\ttapEvt,\n\t\ttouchEvt,\n\n\t\tmoved,\n\n\t\t/** @const */\n\t\tRSPACE = /\\s+/g,\n\n\t\texpando = 'Sortable' + (new Date).getTime(),\n\n\t\twin = window,\n\t\tdocument = win.document,\n\t\tparseInt = win.parseInt,\n\n\t\tsupportDraggable = !!('draggable' in document.createElement('div')),\n\t\tsupportCssPointerEvents = (function (el) {\n\t\t\tel = document.createElement('x');\n\t\t\tel.style.cssText = 'pointer-events:auto';\n\t\t\treturn el.style.pointerEvents === 'auto';\n\t\t})(),\n\n\t\t_silent = false,\n\n\t\tabs = Math.abs,\n\t\tslice = [].slice,\n\n\t\ttouchDragOverListeners = [],\n\n\t\t_autoScroll = _throttle(function (/**Event*/evt, /**Object*/options, /**HTMLElement*/rootEl) {\n\t\t\t// Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=505521\n\t\t\tif (rootEl && options.scroll) {\n\t\t\t\tvar el,\n\t\t\t\t\trect,\n\t\t\t\t\tsens = options.scrollSensitivity,\n\t\t\t\t\tspeed = options.scrollSpeed,\n\n\t\t\t\t\tx = evt.clientX,\n\t\t\t\t\ty = evt.clientY,\n\n\t\t\t\t\twinWidth = window.innerWidth,\n\t\t\t\t\twinHeight = window.innerHeight,\n\n\t\t\t\t\tvx,\n\t\t\t\t\tvy\n\t\t\t\t;\n\n\t\t\t\t// Delect scrollEl\n\t\t\t\tif (scrollParentEl !== rootEl) {\n\t\t\t\t\tscrollEl = options.scroll;\n\t\t\t\t\tscrollParentEl = rootEl;\n\n\t\t\t\t\tif (scrollEl === true) {\n\t\t\t\t\t\tscrollEl = rootEl;\n\n\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\tif ((scrollEl.offsetWidth < scrollEl.scrollWidth) ||\n\t\t\t\t\t\t\t\t(scrollEl.offsetHeight < scrollEl.scrollHeight)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t\t\t} while (scrollEl = scrollEl.parentNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (scrollEl) {\n\t\t\t\t\tel = scrollEl;\n\t\t\t\t\trect = scrollEl.getBoundingClientRect();\n\t\t\t\t\tvx = (abs(rect.right - x) <= sens) - (abs(rect.left - x) <= sens);\n\t\t\t\t\tvy = (abs(rect.bottom - y) <= sens) - (abs(rect.top - y) <= sens);\n\t\t\t\t}\n\n\n\t\t\t\tif (!(vx || vy)) {\n\t\t\t\t\tvx = (winWidth - x <= sens) - (x <= sens);\n\t\t\t\t\tvy = (winHeight - y <= sens) - (y <= sens);\n\n\t\t\t\t\t/* jshint expr:true */\n\t\t\t\t\t(vx || vy) && (el = win);\n\t\t\t\t}\n\n\n\t\t\t\tif (autoScroll.vx !== vx || autoScroll.vy !== vy || autoScroll.el !== el) {\n\t\t\t\t\tautoScroll.el = el;\n\t\t\t\t\tautoScroll.vx = vx;\n\t\t\t\t\tautoScroll.vy = vy;\n\n\t\t\t\t\tclearInterval(autoScroll.pid);\n\n\t\t\t\t\tif (el) {\n\t\t\t\t\t\tautoScroll.pid = setInterval(function () {\n\t\t\t\t\t\t\tif (el === win) {\n\t\t\t\t\t\t\t\twin.scrollTo(win.pageXOffset + vx * speed, win.pageYOffset + vy * speed);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvy && (el.scrollTop += vy * speed);\n\t\t\t\t\t\t\t\tvx && (el.scrollLeft += vx * speed);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 24);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, 30),\n\n\t\t_prepareGroup = function (options) {\n\t\t\tvar group = options.group;\n\n\t\t\tif (!group || typeof group != 'object') {\n\t\t\t\tgroup = options.group = {name: group};\n\t\t\t}\n\n\t\t\t['pull', 'put'].forEach(function (key) {\n\t\t\t\tif (!(key in group)) {\n\t\t\t\t\tgroup[key] = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\toptions.groups = ' ' + group.name + (group.put.join ? ' ' + group.put.join(' ') : '') + ' ';\n\t\t}\n\t;\n\n\n\n\t/**\n\t * @class  Sortable\n\t * @param  {HTMLElement}  el\n\t * @param  {Object}       [options]\n\t */\n\tfunction Sortable(el, options) {\n\t\tif (!(el && el.nodeType && el.nodeType === 1)) {\n\t\t\tthrow 'Sortable: `el` must be HTMLElement, and not ' + {}.toString.call(el);\n\t\t}\n\n\t\tthis.el = el; // root element\n\t\tthis.options = options = _extend({}, options);\n\n\n\t\t// Export instance\n\t\tel[expando] = this;\n\n\n\t\t// Default options\n\t\tvar defaults = {\n\t\t\tgroup: Math.random(),\n\t\t\tsort: true,\n\t\t\tdisabled: false,\n\t\t\tstore: null,\n\t\t\thandle: null,\n\t\t\tscroll: true,\n\t\t\tscrollSensitivity: 30,\n\t\t\tscrollSpeed: 10,\n\t\t\tdraggable: /[uo]l/i.test(el.nodeName) ? 'li' : '>*',\n\t\t\tghostClass: 'sortable-ghost',\n\t\t\tchosenClass: 'sortable-chosen',\n\t\t\tignore: 'a, img',\n\t\t\tfilter: null,\n\t\t\tanimation: 0,\n\t\t\tsetData: function (dataTransfer, dragEl) {\n\t\t\t\tdataTransfer.setData('Text', dragEl.textContent);\n\t\t\t},\n\t\t\tdropBubble: false,\n\t\t\tdragoverBubble: false,\n\t\t\tdataIdAttr: 'data-id',\n\t\t\tdelay: 0,\n\t\t\tforceFallback: false,\n\t\t\tfallbackClass: 'sortable-fallback',\n\t\t\tfallbackOnBody: false\n\t\t};\n\n\n\t\t// Set default options\n\t\tfor (var name in defaults) {\n\t\t\t!(name in options) && (options[name] = defaults[name]);\n\t\t}\n\n\t\t_prepareGroup(options);\n\n\t\t// Bind all private methods\n\t\tfor (var fn in this) {\n\t\t\tif (fn.charAt(0) === '_') {\n\t\t\t\tthis[fn] = this[fn].bind(this);\n\t\t\t}\n\t\t}\n\n\t\t// Setup drag mode\n\t\tthis.nativeDraggable = options.forceFallback ? false : supportDraggable;\n\n\t\t// Bind events\n\t\t_on(el, 'mousedown', this._onTapStart);\n\t\t_on(el, 'touchstart', this._onTapStart);\n\n\t\tif (this.nativeDraggable) {\n\t\t\t_on(el, 'dragover', this);\n\t\t\t_on(el, 'dragenter', this);\n\t\t}\n\n\t\ttouchDragOverListeners.push(this._onDragOver);\n\n\t\t// Restore sorting\n\t\toptions.store && this.sort(options.store.get(this));\n\t}\n\n\n\tSortable.prototype = /** @lends Sortable.prototype */ {\n\t\tconstructor: Sortable,\n\n\t\t_onTapStart: function (/** Event|TouchEvent */evt) {\n\t\t\tvar _this = this,\n\t\t\t\tel = this.el,\n\t\t\t\toptions = this.options,\n\t\t\t\ttype = evt.type,\n\t\t\t\ttouch = evt.touches && evt.touches[0],\n\t\t\t\ttarget = (touch || evt).target,\n\t\t\t\toriginalTarget = target,\n\t\t\t\tfilter = options.filter;\n\n\n\t\t\tif (type === 'mousedown' && evt.button !== 0 || options.disabled) {\n\t\t\t\treturn; // only left button or enabled\n\t\t\t}\n\n\t\t\ttarget = _closest(target, options.draggable, el);\n\n\t\t\tif (!target) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// get the index of the dragged element within its parent\n\t\t\toldIndex = _index(target, options.draggable);\n\n\t\t\t// Check filter\n\t\t\tif (typeof filter === 'function') {\n\t\t\t\tif (filter.call(this, evt, target, this)) {\n\t\t\t\t\t_dispatchEvent(_this, originalTarget, 'filter', target, el, oldIndex);\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (filter) {\n\t\t\t\tfilter = filter.split(',').some(function (criteria) {\n\t\t\t\t\tcriteria = _closest(originalTarget, criteria.trim(), el);\n\n\t\t\t\t\tif (criteria) {\n\t\t\t\t\t\t_dispatchEvent(_this, criteria, 'filter', target, el, oldIndex);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (filter) {\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tif (options.handle && !_closest(originalTarget, options.handle, el)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\n\t\t\t// Prepare `dragstart`\n\t\t\tthis._prepareDragStart(evt, touch, target);\n\t\t},\n\n\t\t_prepareDragStart: function (/** Event */evt, /** Touch */touch, /** HTMLElement */target) {\n\t\t\tvar _this = this,\n\t\t\t\tel = _this.el,\n\t\t\t\toptions = _this.options,\n\t\t\t\townerDocument = el.ownerDocument,\n\t\t\t\tdragStartFn;\n\n\t\t\tif (target && !dragEl && (target.parentNode === el)) {\n\t\t\t\ttapEvt = evt;\n\n\t\t\t\trootEl = el;\n\t\t\t\tdragEl = target;\n\t\t\t\tparentEl = dragEl.parentNode;\n\t\t\t\tnextEl = dragEl.nextSibling;\n\t\t\t\tactiveGroup = options.group;\n\n\t\t\t\tdragStartFn = function () {\n\t\t\t\t\t// Delayed drag has been triggered\n\t\t\t\t\t// we can re-enable the events: touchmove/mousemove\n\t\t\t\t\t_this._disableDelayedDrag();\n\n\t\t\t\t\t// Make the element draggable\n\t\t\t\t\tdragEl.draggable = true;\n\n\t\t\t\t\t// Chosen item\n\t\t\t\t\t_toggleClass(dragEl, _this.options.chosenClass, true);\n\n\t\t\t\t\t// Bind the events: dragstart/dragend\n\t\t\t\t\t_this._triggerDragStart(touch);\n\t\t\t\t};\n\n\t\t\t\t// Disable \"draggable\"\n\t\t\t\toptions.ignore.split(',').forEach(function (criteria) {\n\t\t\t\t\t_find(dragEl, criteria.trim(), _disableDraggable);\n\t\t\t\t});\n\n\t\t\t\t_on(ownerDocument, 'mouseup', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'touchend', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'touchcancel', _this._onDrop);\n\n\t\t\t\tif (options.delay) {\n\t\t\t\t\t// If the user moves the pointer or let go the click or touch\n\t\t\t\t\t// before the delay has been reached:\n\t\t\t\t\t// disable the delayed drag\n\t\t\t\t\t_on(ownerDocument, 'mouseup', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchend', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchcancel', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'mousemove', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchmove', _this._disableDelayedDrag);\n\n\t\t\t\t\t_this._dragStartTimer = setTimeout(dragStartFn, options.delay);\n\t\t\t\t} else {\n\t\t\t\t\tdragStartFn();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_disableDelayedDrag: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\n\t\t\tclearTimeout(this._dragStartTimer);\n\t\t\t_off(ownerDocument, 'mouseup', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchend', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchcancel', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'mousemove', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchmove', this._disableDelayedDrag);\n\t\t},\n\n\t\t_triggerDragStart: function (/** Touch */touch) {\n\t\t\tif (touch) {\n\t\t\t\t// Touch device support\n\t\t\t\ttapEvt = {\n\t\t\t\t\ttarget: dragEl,\n\t\t\t\t\tclientX: touch.clientX,\n\t\t\t\t\tclientY: touch.clientY\n\t\t\t\t};\n\n\t\t\t\tthis._onDragStart(tapEvt, 'touch');\n\t\t\t}\n\t\t\telse if (!this.nativeDraggable) {\n\t\t\t\tthis._onDragStart(tapEvt, true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_on(dragEl, 'dragend', this);\n\t\t\t\t_on(rootEl, 'dragstart', this._onDragStart);\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tif (document.selection) {\n\t\t\t\t\tdocument.selection.empty();\n\t\t\t\t} else {\n\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t},\n\n\t\t_dragStarted: function () {\n\t\t\tif (rootEl && dragEl) {\n\t\t\t\t// Apply effect\n\t\t\t\t_toggleClass(dragEl, this.options.ghostClass, true);\n\n\t\t\t\tSortable.active = this;\n\n\t\t\t\t// Drag start event\n\t\t\t\t_dispatchEvent(this, rootEl, 'start', dragEl, rootEl, oldIndex);\n\t\t\t}\n\t\t},\n\n\t\t_emulateDragOver: function () {\n\t\t\tif (touchEvt) {\n\t\t\t\tif (this._lastX === touchEvt.clientX && this._lastY === touchEvt.clientY) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._lastX = touchEvt.clientX;\n\t\t\t\tthis._lastY = touchEvt.clientY;\n\n\t\t\t\tif (!supportCssPointerEvents) {\n\t\t\t\t\t_css(ghostEl, 'display', 'none');\n\t\t\t\t}\n\n\t\t\t\tvar target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY),\n\t\t\t\t\tparent = target,\n\t\t\t\t\tgroupName = ' ' + this.options.group.name + '',\n\t\t\t\t\ti = touchDragOverListeners.length;\n\n\t\t\t\tif (parent) {\n\t\t\t\t\tdo {\n\t\t\t\t\t\tif (parent[expando] && parent[expando].options.groups.indexOf(groupName) > -1) {\n\t\t\t\t\t\t\twhile (i--) {\n\t\t\t\t\t\t\t\ttouchDragOverListeners[i]({\n\t\t\t\t\t\t\t\t\tclientX: touchEvt.clientX,\n\t\t\t\t\t\t\t\t\tclientY: touchEvt.clientY,\n\t\t\t\t\t\t\t\t\ttarget: target,\n\t\t\t\t\t\t\t\t\trootEl: parent\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttarget = parent; // store last element\n\t\t\t\t\t}\n\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t\twhile (parent = parent.parentNode);\n\t\t\t\t}\n\n\t\t\t\tif (!supportCssPointerEvents) {\n\t\t\t\t\t_css(ghostEl, 'display', '');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t_onTouchMove: function (/**TouchEvent*/evt) {\n\t\t\tif (tapEvt) {\n\t\t\t\t// only set the status to dragging, when we are actually dragging\n\t\t\t\tif (!Sortable.active) {\n\t\t\t\t\tthis._dragStarted();\n\t\t\t\t}\n\n\t\t\t\t// as well as creating the ghost element on the document body\n\t\t\t\tthis._appendGhost();\n\n\t\t\t\tvar touch = evt.touches ? evt.touches[0] : evt,\n\t\t\t\t\tdx = touch.clientX - tapEvt.clientX,\n\t\t\t\t\tdy = touch.clientY - tapEvt.clientY,\n\t\t\t\t\ttranslate3d = evt.touches ? 'translate3d(' + dx + 'px,' + dy + 'px,0)' : 'translate(' + dx + 'px,' + dy + 'px)';\n\n\t\t\t\tmoved = true;\n\t\t\t\ttouchEvt = touch;\n\n\t\t\t\t_css(ghostEl, 'webkitTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'mozTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'msTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'transform', translate3d);\n\n\t\t\t\tevt.preventDefault();\n\t\t\t}\n\t\t},\n\n\t\t_appendGhost: function () {\n\t\t\tif (!ghostEl) {\n\t\t\t\tvar rect = dragEl.getBoundingClientRect(),\n\t\t\t\t\tcss = _css(dragEl),\n\t\t\t\t\toptions = this.options,\n\t\t\t\t\tghostRect;\n\n\t\t\t\tghostEl = dragEl.cloneNode(true);\n\n\t\t\t\t_toggleClass(ghostEl, options.ghostClass, false);\n\t\t\t\t_toggleClass(ghostEl, options.fallbackClass, true);\n\n\t\t\t\t_css(ghostEl, 'top', rect.top - parseInt(css.marginTop, 10));\n\t\t\t\t_css(ghostEl, 'left', rect.left - parseInt(css.marginLeft, 10));\n\t\t\t\t_css(ghostEl, 'width', rect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height);\n\t\t\t\t_css(ghostEl, 'opacity', '0.8');\n\t\t\t\t_css(ghostEl, 'position', 'fixed');\n\t\t\t\t_css(ghostEl, 'zIndex', '100000');\n\t\t\t\t_css(ghostEl, 'pointerEvents', 'none');\n\n\t\t\t\toptions.fallbackOnBody && document.body.appendChild(ghostEl) || rootEl.appendChild(ghostEl);\n\n\t\t\t\t// Fixing dimensions.\n\t\t\t\tghostRect = ghostEl.getBoundingClientRect();\n\t\t\t\t_css(ghostEl, 'width', rect.width * 2 - ghostRect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height * 2 - ghostRect.height);\n\t\t\t}\n\t\t},\n\n\t\t_onDragStart: function (/**Event*/evt, /**boolean*/useFallback) {\n\t\t\tvar dataTransfer = evt.dataTransfer,\n\t\t\t\toptions = this.options;\n\n\t\t\tthis._offUpEvents();\n\n\t\t\tif (activeGroup.pull == 'clone') {\n\t\t\t\tcloneEl = dragEl.cloneNode(true);\n\t\t\t\t_css(cloneEl, 'display', 'none');\n\t\t\t\trootEl.insertBefore(cloneEl, dragEl);\n\t\t\t}\n\n\t\t\tif (useFallback) {\n\n\t\t\t\tif (useFallback === 'touch') {\n\t\t\t\t\t// Bind touch events\n\t\t\t\t\t_on(document, 'touchmove', this._onTouchMove);\n\t\t\t\t\t_on(document, 'touchend', this._onDrop);\n\t\t\t\t\t_on(document, 'touchcancel', this._onDrop);\n\t\t\t\t} else {\n\t\t\t\t\t// Old brwoser\n\t\t\t\t\t_on(document, 'mousemove', this._onTouchMove);\n\t\t\t\t\t_on(document, 'mouseup', this._onDrop);\n\t\t\t\t}\n\n\t\t\t\tthis._loopId = setInterval(this._emulateDragOver, 50);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (dataTransfer) {\n\t\t\t\t\tdataTransfer.effectAllowed = 'move';\n\t\t\t\t\toptions.setData && options.setData.call(this, dataTransfer, dragEl);\n\t\t\t\t}\n\n\t\t\t\t_on(document, 'drop', this);\n\t\t\t\tsetTimeout(this._dragStarted, 0);\n\t\t\t}\n\t\t},\n\n\t\t_onDragOver: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\ttarget,\n\t\t\t\tdragRect,\n\t\t\t\trevert,\n\t\t\t\toptions = this.options,\n\t\t\t\tgroup = options.group,\n\t\t\t\tgroupPut = group.put,\n\t\t\t\tisOwner = (activeGroup === group),\n\t\t\t\tcanSort = options.sort;\n\n\t\t\tif (evt.preventDefault !== void 0) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\t!options.dragoverBubble && evt.stopPropagation();\n\t\t\t}\n\n\t\t\tmoved = true;\n\n\t\t\t_dispatchEvent(this, rootEl, 'over', dragEl, rootEl, evt, evt.target); // Gantry 5\n\t\t\tif (activeGroup && !options.disabled &&\n\t\t\t\t(isOwner\n\t\t\t\t\t? canSort || (revert = !rootEl.contains(dragEl)) // Reverting item into the original list\n\t\t\t\t\t: activeGroup.pull && groupPut && (\n\t\t\t\t\t\t(activeGroup.name === group.name) || // by Name\n\t\t\t\t\t\t(groupPut.indexOf && ~groupPut.indexOf(activeGroup.name)) // by Array\n\t\t\t\t\t)\n\t\t\t\t) &&\n\t\t\t\t(evt.rootEl === void 0 || evt.rootEl === this.el) // touch fallback\n\t\t\t) {\n\t\t\t\t// Smart auto-scrolling\n\t\t\t\t_autoScroll(evt, options, this.el);\n\n\t\t\t\tif (_silent) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttarget = _closest(evt.target, options.draggable, el);\n\t\t\t\tdragRect = dragEl.getBoundingClientRect();\n\n\t\t\t\tif (revert) {\n\t\t\t\t\t_cloneHide(true);\n\n\t\t\t\t\tif (cloneEl || nextEl) {\n\t\t\t\t\t\trootEl.insertBefore(dragEl, cloneEl || nextEl);\n\t\t\t\t\t}\n\t\t\t\t\telse if (!canSort) {\n\t\t\t\t\t\trootEl.appendChild(dragEl);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\n\t\t\t\tif ((el.children.length === 0) || (el.children[0] === ghostEl) ||\n\t\t\t\t\t(el === evt.target) && (target = _ghostIsLast(el, evt))\n\t\t\t\t) {\n\n\t\t\t\t\tif (target) {\n\t\t\t\t\t\tif (target.animated) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttargetRect = target.getBoundingClientRect();\n\t\t\t\t\t}\n\n\t\t\t\t\t_cloneHide(isOwner);\n\n\t\t\t\t\tif (_onMove(rootEl, el, dragEl, dragRect, target, targetRect) !== false) {\n\t\t\t\t\t\tif (!dragEl.contains(el)) {\n\t\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\t\tparentEl = el; // actualization\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis._animate(dragRect, dragEl);\n\t\t\t\t\t\ttarget && this._animate(targetRect, target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (target && !target.animated && target !== dragEl && (target.parentNode[expando] !== void 0)) {\n\t\t\t\t\tif (lastEl !== target) {\n\t\t\t\t\t\tlastEl = target;\n\t\t\t\t\t\tlastCSS = _css(target);\n\t\t\t\t\t\tlastParentCSS = _css(target.parentNode);\n\t\t\t\t\t}\n\n\n\t\t\t\t\tvar targetRect = target.getBoundingClientRect(),\n\t\t\t\t\t\twidth = targetRect.right - targetRect.left,\n\t\t\t\t\t\theight = targetRect.bottom - targetRect.top,\n\t\t\t\t\t\tfloating = /left|right|inline/.test(lastCSS.cssFloat + lastCSS.display)\n\t\t\t\t\t\t\t|| (lastParentCSS.display == 'flex' && lastParentCSS['flex-direction'].indexOf('row') === 0),\n\t\t\t\t\t\tisWide = (target.offsetWidth > dragEl.offsetWidth),\n\t\t\t\t\t\tisLong = (target.offsetHeight > dragEl.offsetHeight),\n\t\t\t\t\t\thalfway = (floating ? (evt.clientX - targetRect.left) / width : (evt.clientY - targetRect.top) / height) > 0.5,\n\t\t\t\t\t\tnextSibling = target.nextElementSibling,\n\t\t\t\t\t\tmoveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect),\n\t\t\t\t\t\tafter\n\t\t\t\t\t;\n\n\t\t\t\t\tif (moveVector !== false) {\n\t\t\t\t\t\t_silent = true;\n\t\t\t\t\t\tsetTimeout(_unsilent, 30);\n\n\t\t\t\t\t\t_cloneHide(isOwner);\n\n\t\t\t\t\t\tif (moveVector === 1 || moveVector === -1) {\n\t\t\t\t\t\t\tafter = (moveVector === 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (floating) {\n\t\t\t\t\t\t\tvar elTop = dragEl.offsetTop,\n\t\t\t\t\t\t\t\ttgTop = target.offsetTop;\n\n\t\t\t\t\t\t\tif (elTop === tgTop) {\n\t\t\t\t\t\t\t\tafter = (target.previousElementSibling === dragEl) && !isWide || halfway && isWide;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tafter = tgTop > elTop;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tafter = (nextSibling !== dragEl) && !isLong || halfway && isLong;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!dragEl.contains(el)) {\n\t\t\t\t\t\t\tif (after && !nextSibling) {\n\t\t\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttarget.parentNode.insertBefore(dragEl, after ? nextSibling : target);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparentEl = dragEl.parentNode; // actualization\n\n\t\t\t\t\t\tthis._animate(dragRect, dragEl);\n\t\t\t\t\t\tthis._animate(targetRect, target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_animate: function (prevRect, target) {\n\t\t\tvar ms = this.options.animation;\n\n\t\t\tif (ms) {\n\t\t\t\tvar currentRect = target.getBoundingClientRect();\n\n\t\t\t\t_css(target, 'transition', 'none');\n\t\t\t\t_css(target, 'transform', 'translate3d('\n\t\t\t\t\t+ (prevRect.left - currentRect.left) + 'px,'\n\t\t\t\t\t+ (prevRect.top - currentRect.top) + 'px,0)'\n\t\t\t\t);\n\n\t\t\t\ttarget.offsetWidth; // repaint\n\n\t\t\t\t_css(target, 'transition', 'all ' + ms + 'ms');\n\t\t\t\t_css(target, 'transform', 'translate3d(0,0,0)');\n\n\t\t\t\tclearTimeout(target.animated);\n\t\t\t\ttarget.animated = setTimeout(function () {\n\t\t\t\t\t_css(target, 'transition', '');\n\t\t\t\t\t_css(target, 'transform', '');\n\t\t\t\t\ttarget.animated = false;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t},\n\n\t\t_offUpEvents: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\n\t\t\t_off(document, 'touchmove', this._onTouchMove);\n\t\t\t_off(ownerDocument, 'mouseup', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchend', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchcancel', this._onDrop);\n\t\t},\n\n\t\t_onDrop: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\toptions = this.options;\n\n\t\t\tclearInterval(this._loopId);\n\t\t\tclearInterval(autoScroll.pid);\n\t\t\tclearTimeout(this._dragStartTimer);\n\n\t\t\t// Unbind events\n\t\t\t_off(document, 'mousemove', this._onTouchMove);\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(document, 'drop', this);\n\t\t\t\t_off(el, 'dragstart', this._onDragStart);\n\t\t\t}\n\n\t\t\tthis._offUpEvents();\n\n\t\t\tif (evt) {\n\t\t\t\tif (moved) {\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t!options.dropBubble && evt.stopPropagation();\n\t\t\t\t}\n\n\t\t\t\tghostEl && ghostEl.parentNode.removeChild(ghostEl);\n\n\t\t\t\tif (dragEl) {\n\t\t\t\t\tif (this.nativeDraggable) {\n\t\t\t\t\t\t_off(dragEl, 'dragend', this);\n\t\t\t\t\t}\n\n\t\t\t\t\t_disableDraggable(dragEl);\n\n\t\t\t\t\t// Remove class's\n\t\t\t\t\t_toggleClass(dragEl, this.options.ghostClass, false);\n\t\t\t\t\t_toggleClass(dragEl, this.options.chosenClass, false);\n\n\t\t\t\t\tif (rootEl !== parentEl) {\n\t\t\t\t\t\tnewIndex = _index(dragEl, options.draggable);\n\n\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t// drag from one list and drop into another\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t\t// Add event\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'add', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t\t// Remove event\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'remove', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Remove clone\n\t\t\t\t\t\tcloneEl && cloneEl.parentNode.removeChild(cloneEl);\n\n\t\t\t\t\t\tif (dragEl.nextSibling !== nextEl) {\n\t\t\t\t\t\t\t// Get the index of the dragged element within its parent\n\t\t\t\t\t\t\tnewIndex = _index(dragEl, options.draggable);\n\n\t\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t\t// drag & drop within the same list\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'update', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Sortable.active) {\n\t\t\t\t\t\tif (newIndex === null || newIndex === -1) {\n\t\t\t\t\t\t\tnewIndex = oldIndex;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.originalEvent = evt; // Gantry 5\n\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'end', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t// Save sorting\n\t\t\t\t\t\tthis.save();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis._nulling();\n\t\t},\n\n\t\t_nulling: function() {\n\t\t\t// Nulling\n\t\t\trootEl =\n\t\t\tdragEl =\n\t\t\tparentEl =\n\t\t\tghostEl =\n\t\t\tnextEl =\n\t\t\tcloneEl =\n\n\t\t\tscrollEl =\n\t\t\tscrollParentEl =\n\n\t\t\ttapEvt =\n\t\t\ttouchEvt =\n\n\t\t\tmoved =\n\t\t\tnewIndex =\n\n\t\t\tlastEl =\n\t\t\tlastCSS =\n\n\t\t\tactiveGroup =\n\t\t\tSortable.active = null;\n\t\t},\n\n\t\thandleEvent: function (/**Event*/evt) {\n\t\t\tvar type = evt.type;\n\n\t\t\tif (type === 'dragover' || type === 'dragenter') {\n\t\t\t\tif (dragEl) {\n\t\t\t\t\tthis._onDragOver(evt);\n\t\t\t\t\t_globalDragOver(evt);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (type === 'drop' || type === 'dragend') {\n\t\t\t\tthis._onDrop(evt);\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Serializes the item into an array of string.\n\t\t * @returns {String[]}\n\t\t */\n\t\ttoArray: function () {\n\t\t\tvar order = [],\n\t\t\t\tel,\n\t\t\t\tchildren = this.el.children,\n\t\t\t\ti = 0,\n\t\t\t\tn = children.length,\n\t\t\t\toptions = this.options;\n\n\t\t\tfor (; i < n; i++) {\n\t\t\t\tel = children[i];\n\t\t\t\tif (_closest(el, options.draggable, this.el)) {\n\t\t\t\t\torder.push(el.getAttribute(options.dataIdAttr) || _generateId(el));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn order;\n\t\t},\n\n\n\t\t/**\n\t\t * Sorts the elements according to the array.\n\t\t * @param  {String[]}  order  order of the items\n\t\t */\n\t\tsort: function (order) {\n\t\t\tvar items = {}, rootEl = this.el;\n\n\t\t\tthis.toArray().forEach(function (id, i) {\n\t\t\t\tvar el = rootEl.children[i];\n\n\t\t\t\tif (_closest(el, this.options.draggable, rootEl)) {\n\t\t\t\t\titems[id] = el;\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\torder.forEach(function (id) {\n\t\t\t\tif (items[id]) {\n\t\t\t\t\trootEl.removeChild(items[id]);\n\t\t\t\t\trootEl.appendChild(items[id]);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * Save the current sorting\n\t\t */\n\t\tsave: function () {\n\t\t\tvar store = this.options.store;\n\t\t\tstore && store.set(this);\n\t\t},\n\n\n\t\t/**\n\t\t * For each element in the set, get the first element that matches the selector by testing the element itself and traversing up through its ancestors in the DOM tree.\n\t\t * @param   {HTMLElement}  el\n\t\t * @param   {String}       [selector]  default: `options.draggable`\n\t\t * @returns {HTMLElement|null}\n\t\t */\n\t\tclosest: function (el, selector) {\n\t\t\treturn _closest(el, selector || this.options.draggable, this.el);\n\t\t},\n\n\n\t\t/**\n\t\t * Set/get option\n\t\t * @param   {string} name\n\t\t * @param   {*}      [value]\n\t\t * @returns {*}\n\t\t */\n\t\toption: function (name, value) {\n\t\t\tvar options = this.options;\n\n\t\t\tif (value === void 0) {\n\t\t\t\treturn options[name];\n\t\t\t} else {\n\t\t\t\toptions[name] = value;\n\n\t\t\t\tif (name === 'group') {\n\t\t\t\t\t_prepareGroup(options);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Destroy\n\t\t */\n\t\tdestroy: function () {\n\t\t\tvar el = this.el;\n\n\t\t\tel[expando] = null;\n\n\t\t\t_off(el, 'mousedown', this._onTapStart);\n\t\t\t_off(el, 'touchstart', this._onTapStart);\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(el, 'dragover', this);\n\t\t\t\t_off(el, 'dragenter', this);\n\t\t\t}\n\n\t\t\t// Remove draggable attributes\n\t\t\tArray.prototype.forEach.call(el.querySelectorAll('[draggable]'), function (el) {\n\t\t\t\tel.removeAttribute('draggable');\n\t\t\t});\n\n\t\t\ttouchDragOverListeners.splice(touchDragOverListeners.indexOf(this._onDragOver), 1);\n\n\t\t\tthis._onDrop();\n\n\t\t\tthis.el = el = null;\n\t\t}\n\t};\n\n\n\tfunction _cloneHide(state) {\n\t\tif (cloneEl && (cloneEl.state !== state)) {\n\t\t\t_css(cloneEl, 'display', state ? 'none' : '');\n\t\t\t!state && cloneEl.state && rootEl.insertBefore(cloneEl, dragEl);\n\t\t\tcloneEl.state = state;\n\t\t}\n\t}\n\n\n\tfunction _closest(/**HTMLElement*/el, /**String*/selector, /**HTMLElement*/ctx) {\n\t\tif (el) {\n\t\t\tctx = ctx || document;\n\n\t\t\tdo {\n\t\t\t\tif (\n\t\t\t\t\t(selector === '>*' && el.parentNode === ctx)\n\t\t\t\t\t|| _matches(el, selector)\n\t\t\t\t) {\n\t\t\t\t\treturn el;\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (el !== ctx && (el = el.parentNode));\n\t\t}\n\n\t\treturn null;\n\t}\n\n\n\tfunction _globalDragOver(/**Event*/evt) {\n\t\tif (evt.dataTransfer) {\n\t\t\tevt.dataTransfer.dropEffect = 'move';\n\t\t}\n\t\tevt.preventDefault();\n\t}\n\n\n\tfunction _on(el, event, fn) {\n\t\tel.addEventListener(event, fn, false);\n\t}\n\n\n\tfunction _off(el, event, fn) {\n\t\tel.removeEventListener(event, fn, false);\n\t}\n\n\n\tfunction _toggleClass(el, name, state) {\n\t\tif (el) {\n\t\t\tif (el.classList) {\n\t\t\t\tel.classList[state ? 'add' : 'remove'](name);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar className = (' ' + el.className + ' ').replace(RSPACE, ' ').replace(' ' + name + ' ', ' ');\n\t\t\t\tel.className = (className + (state ? ' ' + name : '')).replace(RSPACE, ' ');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _css(el, prop, val) {\n\t\tvar style = el && el.style;\n\n\t\tif (style) {\n\t\t\tif (val === void 0) {\n\t\t\t\tif (document.defaultView && document.defaultView.getComputedStyle) {\n\t\t\t\t\tval = document.defaultView.getComputedStyle(el, '');\n\t\t\t\t}\n\t\t\t\telse if (el.currentStyle) {\n\t\t\t\t\tval = el.currentStyle;\n\t\t\t\t}\n\n\t\t\t\treturn prop === void 0 ? val : val[prop];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!(prop in style)) {\n\t\t\t\t\tprop = '-webkit-' + prop;\n\t\t\t\t}\n\n\t\t\t\tstyle[prop] = val + (typeof val === 'string' ? '' : 'px');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _find(ctx, tagName, iterator) {\n\t\tif (ctx) {\n\t\t\tvar list = ctx.getElementsByTagName(tagName), i = 0, n = list.length;\n\n\t\t\tif (iterator) {\n\t\t\t\tfor (; i < n; i++) {\n\t\t\t\t\titerator(list[i], i);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn list;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\n\n\tfunction _dispatchEvent(sortable, rootEl, name, targetEl, fromEl, startIndex, newIndex) {\n\t\tvar evt = document.createEvent('Event'),\n\t\t\toptions = (sortable || rootEl[expando]).options,\n\t\t\tonName = 'on' + name.charAt(0).toUpperCase() + name.substr(1);\n\n\t\tevt.initEvent(name, true, true);\n\n\t\tevt.to = rootEl;\n\t\tevt.from = fromEl || rootEl;\n\t\tevt.item = targetEl || rootEl;\n\t\tevt.clone = cloneEl;\n\n\t\tevt.oldIndex = startIndex;\n\t\tevt.newIndex = newIndex;\n\n\t\trootEl.dispatchEvent(evt);\n\n\t\tif (options[onName]) {\n\t\t\toptions[onName].call(sortable, evt);\n\t\t}\n\t}\n\n\n\tfunction _onMove(fromEl, toEl, dragEl, dragRect, targetEl, targetRect) {\n\t\tvar evt,\n\t\t\tsortable = fromEl[expando],\n\t\t\tonMoveFn = sortable.options.onMove,\n\t\t\tretVal;\n\n\t\tevt = document.createEvent('Event');\n\t\tevt.initEvent('move', true, true);\n\n\t\tevt.to = toEl;\n\t\tevt.from = fromEl;\n\t\tevt.dragged = dragEl;\n\t\tevt.draggedRect = dragRect;\n\t\tevt.related = targetEl || toEl;\n\t\tevt.relatedRect = targetRect || toEl.getBoundingClientRect();\n\n\t\tfromEl.dispatchEvent(evt);\n\n\t\tif (onMoveFn) {\n\t\t\tretVal = onMoveFn.call(sortable, evt);\n\t\t}\n\n\t\treturn retVal;\n\t}\n\n\n\tfunction _disableDraggable(el) {\n\t\tel.draggable = false;\n\t}\n\n\n\tfunction _unsilent() {\n\t\t_silent = false;\n\t}\n\n\n\t/** @returns {HTMLElement|false} */\n\tfunction _ghostIsLast(el, evt) {\n\t\tvar lastEl = el.lastElementChild,\n\t\t\t\trect = lastEl.getBoundingClientRect();\n\n\t\t// return ((evt.clientY - (rect.top + rect.height) > 5) || (evt.clientX - rect.right > 5)) && lastEl; // min delta // Gantry 5\n\t\treturn ((evt.clientY - (rect.top + rect.height) > 5) || (evt.clientX - (rect.right + rect.width) > 5)) && lastEl; // min delta\n\t}\n\n\n\t/**\n\t * Generate id\n\t * @param   {HTMLElement} el\n\t * @returns {String}\n\t * @private\n\t */\n\tfunction _generateId(el) {\n\t\tvar str = el.tagName + el.className + el.src + el.href + el.textContent,\n\t\t\ti = str.length,\n\t\t\tsum = 0;\n\n\t\twhile (i--) {\n\t\t\tsum += str.charCodeAt(i);\n\t\t}\n\n\t\treturn sum.toString(36);\n\t}\n\n\t/**\n\t * Returns the index of an element within its parent for a selected set of\n\t * elements\n\t * @param  {HTMLElement} el\n\t * @param  {selector} selector\n\t * @return {number}\n\t */\n\tfunction _index(el, selector) {\n\t\tvar index = 0;\n\n\t\tif (!el || !el.parentNode) {\n\t\t\treturn -1;\n\t\t}\n\n\t\twhile (el && (el = el.previousElementSibling)) {\n\t\t\tif (el.nodeName.toUpperCase() !== 'TEMPLATE'\n\t\t\t\t\t&& _matches(el, selector)) {\n\t\t\t\tindex++;\n\t\t\t}\n\t\t}\n\n\t\treturn index;\n\t}\n\n\tfunction _matches(/**HTMLElement*/el, /**String*/selector) {\n\t\tif (el) {\n\t\t\tselector = selector.split('.');\n\n\t\t\tvar tag = selector.shift().toUpperCase(),\n\t\t\t\tre = new RegExp('\\\\s(' + selector.join('|') + ')(?=\\\\s)', 'g');\n\n\t\t\treturn (\n\t\t\t\t(tag === '' || el.nodeName.toUpperCase() == tag) &&\n\t\t\t\t(!selector.length || ((' ' + el.className + ' ').match(re) || []).length == selector.length)\n\t\t\t);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tfunction _throttle(callback, ms) {\n\t\tvar args, _this;\n\n\t\treturn function () {\n\t\t\tif (args === void 0) {\n\t\t\t\targs = arguments;\n\t\t\t\t_this = this;\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tif (args.length === 1) {\n\t\t\t\t\t\tcallback.call(_this, args[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallback.apply(_this, args);\n\t\t\t\t\t}\n\n\t\t\t\t\targs = void 0;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction _extend(dst, src) {\n\t\tif (dst && src) {\n\t\t\tfor (var key in src) {\n\t\t\t\tif (src.hasOwnProperty(key)) {\n\t\t\t\t\tdst[key] = src[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn dst;\n\t}\n\n\n\t// Export utils\n\tSortable.utils = {\n\t\ton: _on,\n\t\toff: _off,\n\t\tcss: _css,\n\t\tfind: _find,\n\t\tis: function (el, selector) {\n\t\t\treturn !!_closest(el, selector, el);\n\t\t},\n\t\textend: _extend,\n\t\tthrottle: _throttle,\n\t\tclosest: _closest,\n\t\ttoggleClass: _toggleClass,\n\t\tindex: _index\n\t};\n\n\n\t/**\n\t * Create sortable instance\n\t * @param {HTMLElement}  el\n\t * @param {Object}      [options]\n\t */\n\tSortable.create = function (el, options) {\n\t\treturn new Sortable(el, options);\n\t};\n\n\n\t// Export\n\tSortable.version = '1.4.2';\n\treturn Sortable;\n});\n","/* Web Font Loader v1.6.26 - (c) Adobe Systems, Google. License: Apache 2.0 */(function(){function aa(a,b,c){return a.call.apply(a.bind,arguments)}function ba(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function p(a,b,c){p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?aa:ba;return p.apply(null,arguments)}var q=Date.now||function(){return+new Date};function ca(a,b){this.a=a;this.m=b||a;this.c=this.m.document}var da=!!window.FontFace;function t(a,b,c,d){b=a.c.createElement(b);if(c)for(var e in c)c.hasOwnProperty(e)&&(\"style\"==e?b.style.cssText=c[e]:b.setAttribute(e,c[e]));d&&b.appendChild(a.c.createTextNode(d));return b}function u(a,b,c){a=a.c.getElementsByTagName(b)[0];a||(a=document.documentElement);a.insertBefore(c,a.lastChild)}function v(a){a.parentNode&&a.parentNode.removeChild(a)}\nfunction w(a,b,c){b=b||[];c=c||[];for(var d=a.className.split(/\\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}b=[];for(e=0;e<d.length;e+=1){f=!1;for(g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(\" \").replace(/\\s+/g,\" \").replace(/^\\s+|\\s+$/,\"\")}function y(a,b){for(var c=a.className.split(/\\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return!0;return!1}\nfunction z(a){if(\"string\"===typeof a.f)return a.f;var b=a.m.location.protocol;\"about:\"==b&&(b=a.a.location.protocol);return\"https:\"==b?\"https:\":\"http:\"}function ea(a){return a.m.location.hostname||a.a.location.hostname}\nfunction A(a,b,c){function d(){k&&e&&f&&(k(g),k=null)}b=t(a,\"link\",{rel:\"stylesheet\",href:b,media:\"all\"});var e=!1,f=!0,g=null,k=c||null;da?(b.onload=function(){e=!0;d()},b.onerror=function(){e=!0;g=Error(\"Stylesheet failed to load\");d()}):setTimeout(function(){e=!0;d()},0);u(a,\"head\",b)}\nfunction B(a,b,c,d){var e=a.c.getElementsByTagName(\"head\")[0];if(e){var f=t(a,\"script\",{src:b}),g=!1;f.onload=f.onreadystatechange=function(){g||this.readyState&&\"loaded\"!=this.readyState&&\"complete\"!=this.readyState||(g=!0,c&&c(null),f.onload=f.onreadystatechange=null,\"HEAD\"==f.parentNode.tagName&&e.removeChild(f))};e.appendChild(f);setTimeout(function(){g||(g=!0,c&&c(Error(\"Script load timeout\")))},d||5E3);return f}return null};function C(){this.a=0;this.c=null}function D(a){a.a++;return function(){a.a--;E(a)}}function F(a,b){a.c=b;E(a)}function E(a){0==a.a&&a.c&&(a.c(),a.c=null)};function G(a){this.a=a||\"-\"}G.prototype.c=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\\W_]+/g,\"\").toLowerCase());return b.join(this.a)};function H(a,b){this.c=a;this.f=4;this.a=\"n\";var c=(b||\"n4\").match(/^([nio])([1-9])$/i);c&&(this.a=c[1],this.f=parseInt(c[2],10))}function fa(a){return I(a)+\" \"+(a.f+\"00\")+\" 300px \"+J(a.c)}function J(a){var b=[];a=a.split(/,\\s*/);for(var c=0;c<a.length;c++){var d=a[c].replace(/['\"]/g,\"\");-1!=d.indexOf(\" \")||/^\\d/.test(d)?b.push(\"'\"+d+\"'\"):b.push(d)}return b.join(\",\")}function K(a){return a.a+a.f}function I(a){var b=\"normal\";\"o\"===a.a?b=\"oblique\":\"i\"===a.a&&(b=\"italic\");return b}\nfunction ga(a){var b=4,c=\"n\",d=null;a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10))));return c+b};function ha(a,b){this.c=a;this.f=a.m.document.documentElement;this.h=b;this.a=new G(\"-\");this.j=!1!==b.events;this.g=!1!==b.classes}function ia(a){a.g&&w(a.f,[a.a.c(\"wf\",\"loading\")]);L(a,\"loading\")}function M(a){if(a.g){var b=y(a.f,a.a.c(\"wf\",\"active\")),c=[],d=[a.a.c(\"wf\",\"loading\")];b||c.push(a.a.c(\"wf\",\"inactive\"));w(a.f,c,d)}L(a,\"inactive\")}function L(a,b,c){if(a.j&&a.h[b])if(c)a.h[b](c.c,K(c));else a.h[b]()};function ja(){this.c={}}function ka(a,b,c){var d=[],e;for(e in b)if(b.hasOwnProperty(e)){var f=a.c[e];f&&d.push(f(b[e],c))}return d};function N(a,b){this.c=a;this.f=b;this.a=t(this.c,\"span\",{\"aria-hidden\":\"true\"},this.f)}function O(a){u(a.c,\"body\",a.a)}function P(a){return\"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:\"+J(a.c)+\";\"+(\"font-style:\"+I(a)+\";font-weight:\"+(a.f+\"00\")+\";\")};function Q(a,b,c,d,e,f){this.g=a;this.j=b;this.a=d;this.c=c;this.f=e||3E3;this.h=f||void 0}Q.prototype.start=function(){var a=this.c.m.document,b=this,c=q(),d=new Promise(function(d,e){function k(){q()-c>=b.f?e():a.fonts.load(fa(b.a),b.h).then(function(a){1<=a.length?d():setTimeout(k,25)},function(){e()})}k()}),e=new Promise(function(a,d){setTimeout(d,b.f)});Promise.race([e,d]).then(function(){b.g(b.a)},function(){b.j(b.a)})};function R(a,b,c,d,e,f,g){this.v=a;this.B=b;this.c=c;this.a=d;this.s=g||\"BESbswy\";this.f={};this.w=e||3E3;this.u=f||null;this.o=this.j=this.h=this.g=null;this.g=new N(this.c,this.s);this.h=new N(this.c,this.s);this.j=new N(this.c,this.s);this.o=new N(this.c,this.s);a=new H(this.a.c+\",serif\",K(this.a));a=P(a);this.g.a.style.cssText=a;a=new H(this.a.c+\",sans-serif\",K(this.a));a=P(a);this.h.a.style.cssText=a;a=new H(\"serif\",K(this.a));a=P(a);this.j.a.style.cssText=a;a=new H(\"sans-serif\",K(this.a));a=\nP(a);this.o.a.style.cssText=a;O(this.g);O(this.h);O(this.j);O(this.o)}var S={D:\"serif\",C:\"sans-serif\"},T=null;function U(){if(null===T){var a=/AppleWebKit\\/([0-9]+)(?:\\.([0-9]+))/.exec(window.navigator.userAgent);T=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return T}R.prototype.start=function(){this.f.serif=this.j.a.offsetWidth;this.f[\"sans-serif\"]=this.o.a.offsetWidth;this.A=q();la(this)};\nfunction ma(a,b,c){for(var d in S)if(S.hasOwnProperty(d)&&b===a.f[S[d]]&&c===a.f[S[d]])return!0;return!1}function la(a){var b=a.g.a.offsetWidth,c=a.h.a.offsetWidth,d;(d=b===a.f.serif&&c===a.f[\"sans-serif\"])||(d=U()&&ma(a,b,c));d?q()-a.A>=a.w?U()&&ma(a,b,c)&&(null===a.u||a.u.hasOwnProperty(a.a.c))?V(a,a.v):V(a,a.B):na(a):V(a,a.v)}function na(a){setTimeout(p(function(){la(this)},a),50)}function V(a,b){setTimeout(p(function(){v(this.g.a);v(this.h.a);v(this.j.a);v(this.o.a);b(this.a)},a),0)};function W(a,b,c){this.c=a;this.a=b;this.f=0;this.o=this.j=!1;this.s=c}var X=null;W.prototype.g=function(a){var b=this.a;b.g&&w(b.f,[b.a.c(\"wf\",a.c,K(a).toString(),\"active\")],[b.a.c(\"wf\",a.c,K(a).toString(),\"loading\"),b.a.c(\"wf\",a.c,K(a).toString(),\"inactive\")]);L(b,\"fontactive\",a);this.o=!0;oa(this)};\nW.prototype.h=function(a){var b=this.a;if(b.g){var c=y(b.f,b.a.c(\"wf\",a.c,K(a).toString(),\"active\")),d=[],e=[b.a.c(\"wf\",a.c,K(a).toString(),\"loading\")];c||d.push(b.a.c(\"wf\",a.c,K(a).toString(),\"inactive\"));w(b.f,d,e)}L(b,\"fontinactive\",a);oa(this)};function oa(a){0==--a.f&&a.j&&(a.o?(a=a.a,a.g&&w(a.f,[a.a.c(\"wf\",\"active\")],[a.a.c(\"wf\",\"loading\"),a.a.c(\"wf\",\"inactive\")]),L(a,\"active\")):M(a.a))};function pa(a){this.j=a;this.a=new ja;this.h=0;this.f=this.g=!0}pa.prototype.load=function(a){this.c=new ca(this.j,a.context||this.j);this.g=!1!==a.events;this.f=!1!==a.classes;qa(this,new ha(this.c,a),a)};\nfunction ra(a,b,c,d,e){var f=0==--a.h;(a.f||a.g)&&setTimeout(function(){var a=e||null,k=d||null||{};if(0===c.length&&f)M(b.a);else{b.f+=c.length;f&&(b.j=f);var h,m=[];for(h=0;h<c.length;h++){var l=c[h],n=k[l.c],r=b.a,x=l;r.g&&w(r.f,[r.a.c(\"wf\",x.c,K(x).toString(),\"loading\")]);L(r,\"fontloading\",x);r=null;null===X&&(X=window.FontFace?(x=/Gecko.*Firefox\\/(\\d+)/.exec(window.navigator.userAgent))?42<parseInt(x[1],10):!0:!1);X?r=new Q(p(b.g,b),p(b.h,b),b.c,l,b.s,n):r=new R(p(b.g,b),p(b.h,b),b.c,l,b.s,a,\nn);m.push(r)}for(h=0;h<m.length;h++)m[h].start()}},0)}function qa(a,b,c){var d=[],e=c.timeout;ia(b);var d=ka(a.a,c,a.c),f=new W(a.c,b,e);a.h=d.length;b=0;for(c=d.length;b<c;b++)d[b].load(function(b,d,c){ra(a,f,b,d,c)})};function sa(a,b){this.c=a;this.a=b}function ta(a,b,c){var d=z(a.c);a=(a.a.api||\"fast.fonts.net/jsapi\").replace(/^.*http(s?):(\\/\\/)?/,\"\");return d+\"//\"+a+\"/\"+b+\".js\"+(c?\"?v=\"+c:\"\")}\nsa.prototype.load=function(a){function b(){if(f[\"__mti_fntLst\"+d]){var c=f[\"__mti_fntLst\"+d](),e=[],h;if(c)for(var m=0;m<c.length;m++){var l=c[m].fontfamily;void 0!=c[m].fontStyle&&void 0!=c[m].fontWeight?(h=c[m].fontStyle+c[m].fontWeight,e.push(new H(l,h))):e.push(new H(l))}a(e)}else setTimeout(function(){b()},50)}var c=this,d=c.a.projectId,e=c.a.version;if(d){var f=c.c.m;B(this.c,ta(c,d,e),function(e){e?a([]):(f[\"__MonotypeConfiguration__\"+d]=function(){return c.a},b())}).id=\"__MonotypeAPIScript__\"+\nd}else a([])};function ua(a,b){this.c=a;this.a=b}ua.prototype.load=function(a){var b,c,d=this.a.urls||[],e=this.a.families||[],f=this.a.testStrings||{},g=new C;b=0;for(c=d.length;b<c;b++)A(this.c,d[b],D(g));var k=[];b=0;for(c=e.length;b<c;b++)if(d=e[b].split(\":\"),d[1])for(var h=d[1].split(\",\"),m=0;m<h.length;m+=1)k.push(new H(d[0],h[m]));else k.push(new H(d[0]));F(g,function(){a(k,f)})};function va(a,b,c){a?this.c=a:this.c=b+wa;this.a=[];this.f=[];this.g=c||\"\"}var wa=\"//fonts.googleapis.com/css\";function xa(a,b){for(var c=b.length,d=0;d<c;d++){var e=b[d].split(\":\");3==e.length&&a.f.push(e.pop());var f=\"\";2==e.length&&\"\"!=e[1]&&(f=\":\");a.a.push(e.join(f))}}\nfunction ya(a){if(0==a.a.length)throw Error(\"No fonts to load!\");if(-1!=a.c.indexOf(\"kit=\"))return a.c;for(var b=a.a.length,c=[],d=0;d<b;d++)c.push(a.a[d].replace(/ /g,\"+\"));b=a.c+\"?family=\"+c.join(\"%7C\");0<a.f.length&&(b+=\"&subset=\"+a.f.join(\",\"));0<a.g.length&&(b+=\"&text=\"+encodeURIComponent(a.g));return b};function za(a){this.f=a;this.a=[];this.c={}}\nvar Aa={latin:\"BESbswy\",\"latin-ext\":\"\\u00e7\\u00f6\\u00fc\\u011f\\u015f\",cyrillic:\"\\u0439\\u044f\\u0416\",greek:\"\\u03b1\\u03b2\\u03a3\",khmer:\"\\u1780\\u1781\\u1782\",Hanuman:\"\\u1780\\u1781\\u1782\"},Ba={thin:\"1\",extralight:\"2\",\"extra-light\":\"2\",ultralight:\"2\",\"ultra-light\":\"2\",light:\"3\",regular:\"4\",book:\"4\",medium:\"5\",\"semi-bold\":\"6\",semibold:\"6\",\"demi-bold\":\"6\",demibold:\"6\",bold:\"7\",\"extra-bold\":\"8\",extrabold:\"8\",\"ultra-bold\":\"8\",ultrabold:\"8\",black:\"9\",heavy:\"9\",l:\"3\",r:\"4\",b:\"7\"},Ca={i:\"i\",italic:\"i\",n:\"n\",normal:\"n\"},\nDa=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;\nfunction Ea(a){for(var b=a.f.length,c=0;c<b;c++){var d=a.f[c].split(\":\"),e=d[0].replace(/\\+/g,\" \"),f=[\"n4\"];if(2<=d.length){var g;var k=d[1];g=[];if(k)for(var k=k.split(\",\"),h=k.length,m=0;m<h;m++){var l;l=k[m];if(l.match(/^[\\w-]+$/)){var n=Da.exec(l.toLowerCase());if(null==n)l=\"\";else{l=n[2];l=null==l||\"\"==l?\"n\":Ca[l];n=n[1];if(null==n||\"\"==n)n=\"4\";else var r=Ba[n],n=r?r:isNaN(n)?\"4\":n.substr(0,1);l=[l,n].join(\"\")}}else l=\"\";l&&g.push(l)}0<g.length&&(f=g);3==d.length&&(d=d[2],g=[],d=d?d.split(\",\"):\ng,0<d.length&&(d=Aa[d[0]])&&(a.c[e]=d))}a.c[e]||(d=Aa[e])&&(a.c[e]=d);for(d=0;d<f.length;d+=1)a.a.push(new H(e,f[d]))}};function Fa(a,b){this.c=a;this.a=b}var Ga={Arimo:!0,Cousine:!0,Tinos:!0};Fa.prototype.load=function(a){var b=new C,c=this.c,d=new va(this.a.api,z(c),this.a.text),e=this.a.families;xa(d,e);var f=new za(e);Ea(f);A(c,ya(d),D(b));F(b,function(){a(f.a,f.c,Ga)})};function Ha(a,b){this.c=a;this.a=b}Ha.prototype.load=function(a){var b=this.a.id,c=this.c.m;b?B(this.c,(this.a.api||\"https://use.typekit.net\")+\"/\"+b+\".js\",function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var e=[],f=0;f<b.length;f+=2)for(var g=b[f],k=b[f+1],h=0;h<k.length;h++)e.push(new H(g,k[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(m){}a(e)}},2E3):a([])};function Ia(a,b){this.c=a;this.f=b;this.a=[]}Ia.prototype.load=function(a){var b=this.f.id,c=this.c.m,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var g=0,k=c.fonts.length;g<k;++g){var h=c.fonts[g];d.a.push(new H(h.name,ga(\"font-weight:\"+h.weight+\";font-style:\"+h.style)))}a(d.a)},B(this.c,z(this.c)+(this.f.api||\"//f.fontdeck.com/s/css/js/\")+ea(this.c)+\"/\"+b+\".js\",function(b){b&&a([])})):a([])};var Y=new pa(window);Y.a.c.custom=function(a,b){return new ua(b,a)};Y.a.c.fontdeck=function(a,b){return new Ia(b,a)};Y.a.c.monotype=function(a,b){return new sa(b,a)};Y.a.c.typekit=function(a,b){return new Ha(b,a)};Y.a.c.google=function(a,b){return new Fa(b,a)};var Z={load:p(Y.load,Y)};\"function\"===typeof define&&define.amd?define(function(){return Z}):\"undefined\"!==typeof module&&module.exports?module.exports=Z:(window.WebFont=Z,window.WebFontConfig&&Y.load(window.WebFontConfig));}());\n","/*!\n * tooltips 0.1.0 - 20th Dec 2013\n * https://github.com/darsain/tooltip\n *\n * Licensed under the MIT license.\n * http://opensource.org/licenses/MIT\n *\n * @modified by Djamil Legato\n */\n;(function(){\n\n    /**\n     * Require the given path.\n     *\n     * @param {String} path\n     * @return {Object} exports\n     * @api public\n     */\n\n    function fakeRequire(path, parent, orig) {\n        var resolved = fakeRequire.resolve(path);\n\n        // lookup failed\n        if (null == resolved) {\n            orig = orig || path;\n            parent = parent || 'root';\n            var err = new Error('Failed to fakeRequire \"' + orig + '\" from \"' + parent + '\"');\n            err.path = orig;\n            err.parent = parent;\n            err.fakeRequire = true;\n            throw err;\n        }\n\n        var module = fakeRequire.modules[resolved];\n\n        // perform real fakeRequire()\n        // by invoking the module's\n        // registered function\n        if (!module._resolving && !module.exports) {\n            var mod = {};\n            mod.exports = {};\n            mod.client = mod.component = true;\n            module._resolving = true;\n            module.call(this, mod.exports, fakeRequire.relative(resolved), mod);\n            delete module._resolving;\n            module.exports = mod.exports;\n        }\n\n        return module.exports;\n    }\n\n    /**\n     * Registered modules.\n     */\n\n    fakeRequire.modules = {};\n\n    /**\n     * Registered aliases.\n     */\n\n    fakeRequire.aliases = {};\n\n    /**\n     * Resolve `path`.\n     *\n     * Lookup:\n     *\n     *   - PATH/index.js\n     *   - PATH.js\n     *   - PATH\n     *\n     * @param {String} path\n     * @return {String} path or null\n     * @api private\n     */\n\n    fakeRequire.resolve = function(path) {\n        if (path.charAt(0) === '/') path = path.slice(1);\n\n        var paths = [\n            path,\n            path + '.js',\n            path + '.json',\n            path + '/index.js',\n            path + '/index.json'\n        ];\n\n        for (var i = 0; i < paths.length; i++) {\n            var path = paths[i];\n            if (fakeRequire.modules.hasOwnProperty(path)) return path;\n            if (fakeRequire.aliases.hasOwnProperty(path)) return fakeRequire.aliases[path];\n        }\n    };\n\n    /**\n     * Normalize `path` relative to the current path.\n     *\n     * @param {String} curr\n     * @param {String} path\n     * @return {String}\n     * @api private\n     */\n\n    fakeRequire.normalize = function(curr, path) {\n        var segs = [];\n\n        if ('.' != path.charAt(0)) return path;\n\n        curr = curr.split('/');\n        path = path.split('/');\n\n        for (var i = 0; i < path.length; ++i) {\n            if ('..' == path[i]) {\n                curr.pop();\n            } else if ('.' != path[i] && '' != path[i]) {\n                segs.push(path[i]);\n            }\n        }\n\n        return curr.concat(segs).join('/');\n    };\n\n    /**\n     * Register module at `path` with callback `definition`.\n     *\n     * @param {String} path\n     * @param {Function} definition\n     * @api private\n     */\n\n    fakeRequire.register = function(path, definition) {\n        fakeRequire.modules[path] = definition;\n    };\n\n    /**\n     * Alias a module definition.\n     *\n     * @param {String} from\n     * @param {String} to\n     * @api private\n     */\n\n    fakeRequire.alias = function(from, to) {\n        if (!fakeRequire.modules.hasOwnProperty(from)) {\n            throw new Error('Failed to alias \"' + from + '\", it does not exist');\n        }\n        fakeRequire.aliases[to] = from;\n    };\n\n    /**\n     * Return a fakeRequire function relative to the `parent` path.\n     *\n     * @param {String} parent\n     * @return {Function}\n     * @api private\n     */\n\n    fakeRequire.relative = function(parent) {\n        var p = fakeRequire.normalize(parent, '..');\n\n        /**\n         * lastIndexOf helper.\n         */\n\n        function lastIndexOf(arr, obj) {\n            var i = arr.length;\n            while (i--) {\n                if (arr[i] === obj) return i;\n            }\n            return -1;\n        }\n\n        /**\n         * The relative fakeRequire() itself.\n         */\n\n        function localRequire(path) {\n            var resolved = localRequire.resolve(path);\n            return fakeRequire(resolved, parent, path);\n        }\n\n        /**\n         * Resolve relative to the parent.\n         */\n\n        localRequire.resolve = function(path) {\n            var c = path.charAt(0);\n            if ('/' == c) return path.slice(1);\n            if ('.' == c) return fakeRequire.normalize(p, path);\n\n            // resolve deps by returning\n            // the dep in the nearest \"deps\"\n            // directory\n            var segs = parent.split('/');\n            var i = lastIndexOf(segs, 'deps') + 1;\n            if (!i) i = 0;\n            path = segs.slice(0, i + 1).join('/') + '/deps/' + path;\n            return path;\n        };\n\n        /**\n         * Check if module is defined at `path`.\n         */\n\n        localRequire.exists = function(path) {\n            return fakeRequire.modules.hasOwnProperty(localRequire.resolve(path));\n        };\n\n        return localRequire;\n    };\n    fakeRequire.register(\"darsain-position/index.js\", Function(\"exports, fakeRequire, module\",\n        \"'use strict';\\n\\\n        \\n\\\n        /**\\n\\\n         * Transport.\\n\\\n         */\\n\\\n        module.exports = position;\\n\\\n        \\n\\\n        /**\\n\\\n         * Globals.\\n\\\n         */\\n\\\n        var win = window;\\n\\\n        var doc = win.document;\\n\\\n        var docEl = doc.documentElement;\\n\\\n        \\n\\\n        /**\\n\\\n         * Poor man's shallow object extend.\\n\\\n         *\\n\\\n         * @param {Object} a\\n\\\n         * @param {Object} b\\n\\\n         *\\n\\\n         * @return {Object}\\n\\\n         */\\n\\\n        function extend(a, b) {\\n\\\n        \\tfor (var key in b) {\\n\\\n        \\t\\ta[key] = b[key];\\n\\\n        \\t}\\n\\\n        \\treturn a;\\n\\\n        }\\n\\\n        \\n\\\n        /**\\n\\\n         * Checks whether object is window.\\n\\\n         *\\n\\\n         * @param {Object} obj\\n\\\n         *\\n\\\n         * @return {Boolean}\\n\\\n         */\\n\\\n        function isWin(obj) {\\n\\\n        \\treturn obj && obj.setInterval != null;\\n\\\n        }\\n\\\n        \\n\\\n        /**\\n\\\n         * Returns element's object with `left`, `top`, `bottom`, `right`, `width`, and `height`\\n\\\n         * properties indicating the position and dimensions of element on a page.\\n\\\n         *\\n\\\n         * @param {Element} element\\n\\\n         *\\n\\\n         * @return {Object}\\n\\\n         */\\n\\\n        function position(element) {\\n\\\n        \\tvar winTop = win.pageYOffset || docEl.scrollTop;\\n\\\n        \\tvar winLeft = win.pageXOffset || docEl.scrollLeft;\\n\\\n        \\tvar box = { left: 0, right: 0, top: 0, bottom: 0, width: 0, height: 0 };\\n\\\n        \\n\\\n        \\tif (isWin(element)) {\\n\\\n        \\t\\tbox.width = win.innerWidth || docEl.clientWidth;\\n\\\n        \\t\\tbox.height = win.innerHeight || docEl.clientHeight;\\n\\\n        \\t} else if (docEl.contains(element) && element.getBoundingClientRect != null) {\\n\\\n        \\t\\textend(box, element.getBoundingClientRect());\\n\\\n        \\t\\t// width & height don't exist in <IE9\\n\\\n        \\t\\tbox.width = box.right - box.left;\\n\\\n        \\t\\tbox.height = box.bottom - box.top;\\n\\\n        \\t} else {\\n\\\n        \\t\\treturn box;\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\tbox.top = box.top + winTop - docEl.clientTop;\\n\\\n        \\tbox.left = box.left + winLeft - docEl.clientLeft;\\n\\\n        \\tbox.right = box.left + box.width;\\n\\\n        \\tbox.bottom = box.top + box.height;\\n\\\n        \\n\\\n        \\treturn box;\\n\\\n        }//# sourceURL=darsain-position/index.js\"\n    ));\n    fakeRequire.register(\"component-classes/index.js\", Function(\"exports, fakeRequire, module\",\n        \"/**\\n\\\n         * Module dependencies.\\n\\\n         */\\n\\\n        \\n\\\n        var index = fakeRequire('indexof');\\n\\\n        \\n\\\n        /**\\n\\\n         * Whitespace regexp.\\n\\\n         */\\n\\\n        \\n\\\n        var re = /\\\\s+/;\\n\\\n        \\n\\\n        /**\\n\\\n         * toString reference.\\n\\\n         */\\n\\\n        \\n\\\n        var toString = Object.prototype.toString;\\n\\\n        \\n\\\n        /**\\n\\\n         * Wrap `el` in a `ClassList`.\\n\\\n         *\\n\\\n         * @param {Element} el\\n\\\n         * @return {ClassList}\\n\\\n         * @api public\\n\\\n         */\\n\\\n        \\n\\\n        module.exports = function(el){\\n\\\n          return new ClassList(el);\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Initialize a new ClassList for `el`.\\n\\\n         *\\n\\\n         * @param {Element} el\\n\\\n         * @api private\\n\\\n         */\\n\\\n        \\n\\\n        function ClassList(el) {\\n\\\n          if (!el) throw new Error('A DOM element reference is fakeRequired');\\n\\\n          this.el = el;\\n\\\n          this.list = el.classList;\\n\\\n        }\\n\\\n        \\n\\\n        /**\\n\\\n         * Add class `name` if not already present.\\n\\\n         *\\n\\\n         * @param {String} name\\n\\\n         * @return {ClassList}\\n\\\n         * @api public\\n\\\n         */\\n\\\n        \\n\\\n        ClassList.prototype.add = function(name){\\n\\\n          // classList\\n\\\n          if (this.list) {\\n\\\n            this.list.add(name);\\n\\\n            return this;\\n\\\n          }\\n\\\n        \\n\\\n          // fallback\\n\\\n          var arr = this.array();\\n\\\n          var i = index(arr, name);\\n\\\n          if (!~i) arr.push(name);\\n\\\n          this.el.className = arr.join(' ');\\n\\\n          return this;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Remove class `name` when present, or\\n\\\n         * pass a regular expression to remove\\n\\\n         * any which match.\\n\\\n         *\\n\\\n         * @param {String|RegExp} name\\n\\\n         * @return {ClassList}\\n\\\n         * @api public\\n\\\n         */\\n\\\n        \\n\\\n        ClassList.prototype.remove = function(name){\\n\\\n          if ('[object RegExp]' == toString.call(name)) {\\n\\\n            return this.removeMatching(name);\\n\\\n          }\\n\\\n        \\n\\\n          // classList\\n\\\n          if (this.list) {\\n\\\n            this.list.remove(name);\\n\\\n            return this;\\n\\\n          }\\n\\\n        \\n\\\n          // fallback\\n\\\n          var arr = this.array();\\n\\\n          var i = index(arr, name);\\n\\\n          if (~i) arr.splice(i, 1);\\n\\\n          this.el.className = arr.join(' ');\\n\\\n          return this;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Remove all classes matching `re`.\\n\\\n         *\\n\\\n         * @param {RegExp} re\\n\\\n         * @return {ClassList}\\n\\\n         * @api private\\n\\\n         */\\n\\\n        \\n\\\n        ClassList.prototype.removeMatching = function(re){\\n\\\n          var arr = this.array();\\n\\\n          for (var i = 0; i < arr.length; i++) {\\n\\\n            if (re.test(arr[i])) {\\n\\\n              this.remove(arr[i]);\\n\\\n            }\\n\\\n          }\\n\\\n          return this;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Toggle class `name`.\\n\\\n         *\\n\\\n         * @param {String} name\\n\\\n         * @return {ClassList}\\n\\\n         * @api public\\n\\\n         */\\n\\\n        \\n\\\n        ClassList.prototype.toggle = function(name){\\n\\\n          // classList\\n\\\n          if (this.list) {\\n\\\n            this.list.toggle(name);\\n\\\n            return this;\\n\\\n          }\\n\\\n        \\n\\\n          // fallback\\n\\\n          if (this.has(name)) {\\n\\\n            this.remove(name);\\n\\\n          } else {\\n\\\n            this.add(name);\\n\\\n          }\\n\\\n          return this;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Return an array of classes.\\n\\\n         *\\n\\\n         * @return {Array}\\n\\\n         * @api public\\n\\\n         */\\n\\\n        \\n\\\n        ClassList.prototype.array = function(){\\n\\\n          var str = this.el.className.replace(/^\\\\s+|\\\\s+$/g, '');\\n\\\n          var arr = str.split(re);\\n\\\n          if ('' === arr[0]) arr.shift();\\n\\\n          return arr;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Check if class `name` is present.\\n\\\n         *\\n\\\n         * @param {String} name\\n\\\n         * @return {ClassList}\\n\\\n         * @api public\\n\\\n         */\\n\\\n        \\n\\\n        ClassList.prototype.has =\\n\\\n        ClassList.prototype.contains = function(name){\\n\\\n          return this.list\\n\\\n            ? this.list.contains(name)\\n\\\n            : !! ~index(this.array(), name);\\n\\\n        };\\n\\\n        //# sourceURL=component-classes/index.js\"\n    ));\n    fakeRequire.register(\"darsain-tooltip/index.js\", Function(\"exports, fakeRequire, module\",\n        \"'use strict';\\n\\\n        \\n\\\n        /**\\n\\\n         * Dependencies.\\n\\\n         */\\n\\\n        var evt = fakeRequire('event');\\n\\\n        var classes = fakeRequire('classes');\\n\\\n        var indexOf = fakeRequire('indexof');\\n\\\n        var position = fakeRequire('position');\\n\\\n        \\n\\\n        /**\\n\\\n         * Globals.\\n\\\n         */\\n\\\n        var win = window;\\n\\\n        var doc = win.document;\\n\\\n        var body = doc.body;\\n\\\n        var verticalPlaces = ['top', 'bottom'];\\n\\\n        \\n\\\n        /**\\n\\\n         * Transport.\\n\\\n         */\\n\\\n        module.exports = Tooltip;\\n\\\n        \\n\\\n        /**\\n\\\n         * Prototypal inheritance.\\n\\\n         *\\n\\\n         * @param {Object} o\\n\\\n         *\\n\\\n         * @return {Object}\\n\\\n         */\\n\\\n        var objectCreate = Object.create || (function () {\\n\\\n        \\tfunction F() {}\\n\\\n        \\treturn function (o) {\\n\\\n        \\t\\tF.prototype = o;\\n\\\n        \\t\\treturn new F();\\n\\\n        \\t};\\n\\\n        })();\\n\\\n        \\n\\\n        /**\\n\\\n         * Poor man's shallow object extend.\\n\\\n         *\\n\\\n         * @param {Object} a\\n\\\n         * @param {Object} b\\n\\\n         *\\n\\\n         * @return {Object}\\n\\\n         */\\n\\\n        function extend(a, b) {\\n\\\n        \\tfor (var key in b) {\\n\\\n        \\t\\ta[key] = b[key];\\n\\\n        \\t}\\n\\\n        \\treturn a;\\n\\\n        }\\n\\\n        \\n\\\n        /**\\n\\\n         * Parse integer from strings like '-50px'.\\n\\\n         *\\n\\\n         * @param {Mixed} value\\n\\\n         *\\n\\\n         * @return {Integer}\\n\\\n         */\\n\\\n        function parsePx(value) {\\n\\\n        \\treturn 0 | Math.round(String(value).replace(/[^\\\\-0-9.]/g, ''));\\n\\\n        }\\n\\\n        \\n\\\n        /**\\n\\\n         * Get computed style of element.\\n\\\n         *\\n\\\n         * @param {Element} element\\n\\\n         *\\n\\\n         * @type {String}\\n\\\n         */\\n\\\n        var style = win.getComputedStyle ? function style(element, name) {\\n\\\n        \\treturn win.getComputedStyle(element, null)[name];\\n\\\n        } : function style(element, name) {\\n\\\n        \\treturn element.currentStyle[name];\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Returns transition duration of element in ms.\\n\\\n         *\\n\\\n         * @param {Element} element\\n\\\n         *\\n\\\n         * @return {Int}\\n\\\n         */\\n\\\n        function transitionDuration(element) {\\n\\\n        \\tvar duration = String(style(element, transitionDuration.propName));\\n\\\n        \\tvar match = duration.match(/([0-9.]+)([ms]{1,2})/);\\n\\\n        \\tif (match) {\\n\\\n        \\t\\tduration = Number(match[1]);\\n\\\n        \\t\\tif (match[2] === 's') {\\n\\\n        \\t\\t\\tduration *= 1000;\\n\\\n        \\t\\t}\\n\\\n        \\t}\\n\\\n        \\treturn 0|duration;\\n\\\n        }\\n\\\n        transitionDuration.propName = (function () {\\n\\\n        \\tvar element = doc.createElement('div');\\n\\\n        \\tvar names = ['transitionDuration', 'webkitTransitionDuration'];\\n\\\n        \\tvar value = '1s';\\n\\\n        \\tfor (var i = 0; i < names.length; i++) {\\n\\\n        \\t\\telement.style[names[i]] = value;\\n\\\n        \\t\\tif (element.style[names[i]] === value) {\\n\\\n        \\t\\t\\treturn names[i];\\n\\\n        \\t\\t}\\n\\\n        \\t}\\n\\\n        }());\\n\\\n        \\n\\\n        /**\\n\\\n         * Tooltip construnctor.\\n\\\n         *\\n\\\n         * @param {String|Element} content\\n\\\n         * @param {Object}         options\\n\\\n         *\\n\\\n         * @return {Tooltip}\\n\\\n         */\\n\\\n        function Tooltip(content, options) {\\n\\\n        \\tif (!(this instanceof Tooltip)) {\\n\\\n        \\t\\treturn new Tooltip(content, options);\\n\\\n        \\t}\\n\\\n        \\tthis.hidden = 1;\\n\\\n        \\tthis.options = extend(objectCreate(Tooltip.defaults), options);\\n\\\n        \\tthis._createElement();\\n\\\n        \\tthis.content(content);\\n\\\n        }\\n\\\n        \\n\\\n        /**\\n\\\n         * Creates a tooltip element.\\n\\\n         *\\n\\\n         * @return {Void}\\n\\\n         */\\n\\\n        Tooltip.prototype._createElement = function () {\\n\\\n        \\tthis.element = doc.createElement('div');\\n\\\n        \\tthis.classes = classes(this.element);\\n\\\n        \\tthis.classes.add(this.options.baseClass);\\n\\\n        \\tvar propName;\\n\\\n        \\tfor (var i = 0; i < Tooltip.classTypes.length; i++) {\\n\\\n        \\t\\tpropName = Tooltip.classTypes[i] + 'Class';\\n\\\n        \\t\\tif (this.options[propName]) {\\n\\\n        \\t\\t\\tthis.classes.add(this.options[propName]);\\n\\\n        \\t\\t}\\n\\\n        \\t}\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Changes tooltip's type class type.\\n\\\n         *\\n\\\n         * @param {String} name\\n\\\n         *\\n\\\n         * @return {Tooltip}\\n\\\n         */\\n\\\n        Tooltip.prototype.type = function (name) {\\n\\\n        \\treturn this.changeClassType('type', name);\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Changes tooltip's effect class type.\\n\\\n         *\\n\\\n         * @param {String} name\\n\\\n         *\\n\\\n         * @return {Tooltip}\\n\\\n         */\\n\\\n        Tooltip.prototype.effect = function (name) {\\n\\\n        \\treturn this.changeClassType('effect', name);\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Changes class type.\\n\\\n         *\\n\\\n         * @param {String} propName\\n\\\n         * @param {String} newClass\\n\\\n         *\\n\\\n         * @return {Tooltip}\\n\\\n         */\\n\\\n        Tooltip.prototype.changeClassType = function (propName, newClass) {\\n\\\n        \\tpropName += 'Class';\\n\\\n        \\tif (this.options[propName]) {\\n\\\n        \\t\\tthis.classes.remove(this.options[propName]);\\n\\\n        \\t}\\n\\\n        \\tthis.options[propName] = newClass;\\n\\\n        \\tif (newClass) {\\n\\\n        \\t\\tthis.classes.add(newClass);\\n\\\n        \\t}\\n\\\n        \\treturn this;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Updates tooltip's dimensions.\\n\\\n         *\\n\\\n         * @return {Tooltip}\\n\\\n         */\\n\\\n        Tooltip.prototype.updateSize = function () {\\n\\\n        \\tif (this.hidden) {\\n\\\n        \\t\\tthis.element.style.visibility = 'hidden';\\n\\\n        \\t\\twindow.document.body.appendChild(this.element);\\n\\\n        \\t}\\n\\\n        \\tthis.width = this.element.offsetWidth;\\n\\\n        \\tthis.height = this.element.offsetHeight;\\n\\\n        \\tif (this.spacing == null) {\\n\\\n        \\t\\tthis.spacing = this.options.spacing != null ? this.options.spacing : parsePx(style(this.element, 'top'));\\n\\\n        \\t}\\n\\\n        \\tif (this.offset == null) {\\n\\\n        \\t\\tthis.offset = this.options.offset != null ? this.options.offset : 0;\\n\\\n    \\t}\\n\\\n        \\tif (this.hidden) {\\n\\\n        \\t\\twindow.document.body.removeChild(this.element);\\n\\\n        \\t\\tthis.element.style.visibility = '';\\n\\\n        \\t} else {\\n\\\n        \\t\\tthis.position();\\n\\\n        \\t}\\n\\\n        \\treturn this;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Change tooltip content.\\n\\\n         *\\n\\\n         * When tooltip is visible, its size is automatically\\n\\\n         * synced and tooltip correctly repositioned.\\n\\\n         *\\n\\\n         * @param {String|Element} content\\n\\\n         *\\n\\\n         * @return {Tooltip}\\n\\\n         */\\n\\\n        Tooltip.prototype.content = function (content) {\\n\\\n        \\tif (typeof content === 'object') {\\n\\\n        \\t\\tthis.element.innerHTML = '';\\n\\\n        \\t\\tthis.element.appendChild(content);\\n\\\n        \\t} else {\\n\\\n        \\t\\tthis.element.innerHTML = content;\\n\\\n        \\t}\\n\\\n        \\tthis.updateSize();\\n\\\n        \\treturn this;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Pick new place tooltip should be displayed at.\\n\\\n         *\\n\\\n         * When the tooltip is visible, it is automatically positioned there.\\n\\\n         *\\n\\\n         * @param {String} place\\n\\\n         *\\n\\\n         * @return {Tooltip}\\n\\\n         */\\n\\\n        Tooltip.prototype.place = function (place) {\\n\\\n        \\tthis.options.place = place;\\n\\\n        \\tif (!this.hidden) {\\n\\\n        \\t\\tthis.position();\\n\\\n        \\t}\\n\\\n        \\treturn this;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Attach tooltip to an element.\\n\\\n         *\\n\\\n         * @param {Element} element\\n\\\n         *\\n\\\n         * @return {Tooltip}\\n\\\n         */\\n\\\n        Tooltip.prototype.attach = function (element) {\\n\\\n        \\tthis.attachedTo = element;\\n\\\n        \\tif (!this.hidden) {\\n\\\n        \\t\\tthis.position();\\n\\\n        \\t}\\n\\\n        \\treturn this;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Detach tooltip from element.\\n\\\n         *\\n\\\n         * @return {Tooltip}\\n\\\n         */\\n\\\n        Tooltip.prototype.detach = function () {\\n\\\n        \\tthis.hide();\\n\\\n        \\tthis.attachedTo = null;\\n\\\n        \\treturn this;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Pick the most reasonable place for target position.\\n\\\n         *\\n\\\n         * @param {Object} target\\n\\\n         *\\n\\\n         * @return {Tooltip}\\n\\\n         */\\n\\\n        Tooltip.prototype._pickPlace = function (target) {\\n\\\n        \\tif (!this.options.auto) {\\n\\\n        \\t\\treturn this.options.place;\\n\\\n        \\t}\\n\\\n        \\tvar winPos = position(win);\\n\\\n        \\tvar place = this.options.place.split('-');\\n\\\n        \\tvar spacing = this.spacing;\\n\\\n        \\n\\\n        \\tif (~indexOf(verticalPlaces, place[0])) {\\n\\\n        \\t\\tif (target.top - this.height - spacing <= winPos.top) {\\n\\\n        \\t\\t\\tplace[0] = 'bottom';\\n\\\n        \\t\\t} else if (target.bottom + this.height + spacing >= winPos.bottom) {\\n\\\n        \\t\\t\\tplace[0] = 'top';\\n\\\n        \\t\\t}\\n\\\n        \\t\\tswitch (place[1]) {\\n\\\n        \\t\\t\\tcase 'left':\\n\\\n        \\t\\t\\t\\tif (target.right - this.width <= winPos.left) {\\n\\\n        \\t\\t\\t\\t\\tplace[1] = 'right';\\n\\\n        \\t\\t\\t\\t}\\n\\\n        \\t\\t\\t\\tbreak;\\n\\\n        \\t\\t\\tcase 'right':\\n\\\n        \\t\\t\\t\\tif (target.left + this.width >= winPos.right) {\\n\\\n        \\t\\t\\t\\t\\tplace[1] = 'left';\\n\\\n        \\t\\t\\t\\t}\\n\\\n        \\t\\t\\t\\tbreak;\\n\\\n        \\t\\t\\tdefault:\\n\\\n        \\t\\t\\t\\tif (target.left + target.width / 2 + this.width / 2 >= winPos.right) {\\n\\\n        \\t\\t\\t\\t\\tplace[1] = 'left';\\n\\\n        \\t\\t\\t\\t} else if (target.right - target.width / 2 - this.width / 2 <= winPos.left) {\\n\\\n        \\t\\t\\t\\t\\tplace[1] = 'right';\\n\\\n        \\t\\t\\t\\t}\\n\\\n        \\t\\t}\\n\\\n        \\t} else {\\n\\\n        \\t\\tif (target.left - this.width - spacing <= winPos.left) {\\n\\\n        \\t\\t\\tplace[0] = 'right';\\n\\\n        \\t\\t} else if (target.right + this.width + spacing >= winPos.right) {\\n\\\n        \\t\\t\\tplace[0] = 'left';\\n\\\n        \\t\\t}\\n\\\n        \\t\\tswitch (place[1]) {\\n\\\n        \\t\\t\\tcase 'top':\\n\\\n        \\t\\t\\t\\tif (target.bottom - this.height <= winPos.top) {\\n\\\n        \\t\\t\\t\\t\\tplace[1] = 'bottom';\\n\\\n        \\t\\t\\t\\t}\\n\\\n        \\t\\t\\t\\tbreak;\\n\\\n        \\t\\t\\tcase 'bottom':\\n\\\n        \\t\\t\\t\\tif (target.top + this.height >= winPos.bottom) {\\n\\\n        \\t\\t\\t\\t\\tplace[1] = 'top';\\n\\\n        \\t\\t\\t\\t}\\n\\\n        \\t\\t\\t\\tbreak;\\n\\\n        \\t\\t\\tdefault:\\n\\\n        \\t\\t\\t\\tif (target.top + target.height / 2 + this.height / 2 >= winPos.bottom) {\\n\\\n        \\t\\t\\t\\t\\tplace[1] = 'top';\\n\\\n        \\t\\t\\t\\t} else if (target.bottom - target.height / 2 - this.height / 2 <= winPos.top) {\\n\\\n        \\t\\t\\t\\t\\tplace[1] = 'bottom';\\n\\\n        \\t\\t\\t\\t}\\n\\\n        \\t\\t}\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\treturn place.join('-');\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Position the element to an element or a specific coordinates.\\n\\\n         *\\n\\\n         * @param {Integer|Element} x\\n\\\n         * @param {Integer}         y\\n\\\n         *\\n\\\n         * @return {Tooltip}\\n\\\n         */\\n\\\n        Tooltip.prototype.position = function (x, y) {\\n\\\n        \\tif (this.attachedTo) {\\n\\\n        \\t\\tx = this.attachedTo;\\n\\\n        \\t}\\n\\\n        \\tif (x == null && this._p) {\\n\\\n        \\t\\tx = this._p[0];\\n\\\n        \\t\\ty = this._p[1];\\n\\\n        \\t} else {\\n\\\n        \\t\\tthis._p = arguments;\\n\\\n        \\t}\\n\\\n        \\tvar target = typeof x === 'number' ? {\\n\\\n        \\t\\tleft: 0|x,\\n\\\n        \\t\\tright: 0|x,\\n\\\n        \\t\\ttop: 0|y,\\n\\\n        \\t\\tbottom: 0|y,\\n\\\n        \\t\\twidth: 0,\\n\\\n        \\t\\theight: 0\\n\\\n        \\t} : position(x);\\n\\\n        \\tvar spacing = Number(this.spacing), offset = Number(this.offset);\\n\\\n        \\tvar newPlace = this._pickPlace(target);\\n\\\n        \\n\\\n        \\t// Add/Change place class when necessary\\n\\\n        \\tif (newPlace !== this.curPlace) {\\n\\\n        \\t\\tif (this.curPlace) {\\n\\\n        \\t\\t\\tthis.classes.remove(this.curPlace);\\n\\\n        \\t\\t}\\n\\\n        \\t\\tthis.classes.add(newPlace);\\n\\\n        \\t\\tthis.curPlace = newPlace;\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t// Position the tip\\n\\\n        \\tvar top, left;\\n\\\n        \\tswitch (this.curPlace) {\\n\\\n        \\t\\tcase 'top':\\n\\\n        \\t\\t\\ttop = target.top - this.height - spacing;\\n\\\n        \\t\\t\\tleft = target.left + target.width / 2 - this.width / 2;\\n\\\n        \\t\\t\\tbreak;\\n\\\n        \\t\\tcase 'top-left':\\n\\\n        \\t\\t\\ttop = target.top - this.height - spacing;\\n\\\n        \\t\\t\\tleft = target.right - this.width - offset;\\n\\\n        \\t\\t\\tbreak;\\n\\\n        \\t\\tcase 'top-right':\\n\\\n        \\t\\t\\ttop = target.top - this.height - spacing;\\n\\\n        \\t\\t\\tleft = target.left + offset;\\n\\\n        \\t\\t\\tbreak;\\n\\\n        \\n\\\n        \\t\\tcase 'bottom':\\n\\\n        \\t\\t\\ttop = target.bottom + spacing;\\n\\\n        \\t\\t\\tleft = target.left + target.width / 2 - this.width / 2;\\n\\\n        \\t\\t\\tbreak;\\n\\\n        \\t\\tcase 'bottom-left':\\n\\\n        \\t\\t\\ttop = target.bottom + spacing;\\n\\\n        \\t\\t\\tleft = target.right - this.width - offset;\\n\\\n        \\t\\t\\tbreak;\\n\\\n        \\t\\tcase 'bottom-right':\\n\\\n        \\t\\t\\ttop = target.bottom + spacing;\\n\\\n        \\t\\t\\tleft = target.left + offset;\\n\\\n        \\t\\t\\tbreak;\\n\\\n        \\n\\\n        \\t\\tcase 'left':\\n\\\n        \\t\\t\\ttop = target.top + target.height / 2 - this.height / 2;\\n\\\n        \\t\\t\\tleft = target.left - this.width - spacing;\\n\\\n        \\t\\t\\tbreak;\\n\\\n        \\t\\tcase 'left-top':\\n\\\n        \\t\\t\\ttop = target.bottom - this.height;\\n\\\n        \\t\\t\\tleft = target.left - this.width - spacing;\\n\\\n        \\t\\t\\tbreak;\\n\\\n        \\t\\tcase 'left-bottom':\\n\\\n        \\t\\t\\ttop = target.top;\\n\\\n        \\t\\t\\tleft = target.left - this.width - spacing;\\n\\\n        \\t\\t\\tbreak;\\n\\\n        \\n\\\n        \\t\\tcase 'right':\\n\\\n        \\t\\t\\ttop = target.top + target.height / 2 - this.height / 2;\\n\\\n        \\t\\t\\tleft = target.right + spacing;\\n\\\n        \\t\\t\\tbreak;\\n\\\n        \\t\\tcase 'right-top':\\n\\\n        \\t\\t\\ttop = target.bottom - this.height;\\n\\\n        \\t\\t\\tleft = target.right + spacing;\\n\\\n        \\t\\t\\tbreak;\\n\\\n        \\t\\tcase 'right-bottom':\\n\\\n        \\t\\t\\ttop = target.top;\\n\\\n        \\t\\t\\tleft = target.right + spacing;\\n\\\n        \\t\\t\\tbreak;\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t// Set tip position & class\\n\\\n        \\tthis.element.style.top = Math.round(top) + 'px';\\n\\\n        \\tthis.element.style.left = Math.round(left) + 'px';\\n\\\n        \\n\\\n        \\treturn this;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Show the tooltip.\\n\\\n         *\\n\\\n         * @param {Integer|Element} x\\n\\\n         * @param {Integer}         y\\n\\\n         *\\n\\\n         * @return {Tooltip}\\n\\\n         */\\n\\\n        Tooltip.prototype.show = function (x, y) {\\n\\\n        \\tx = this.attachedTo ? this.attachedTo : x;\\n\\\n        \\n\\\n        \\t// Clear potential ongoing animation\\n\\\n        \\tclearTimeout(this.aIndex);\\n\\\n        \\n\\\n        \\t// Position the element when requested\\n\\\n        \\tif (x != null) {\\n\\\n        \\t\\tthis.position(x, y);\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t// Stop here if tip is already visible\\n\\\n        \\tif (this.hidden) {\\n\\\n        \\t\\tthis.hidden = 0;\\n\\\n        \\t\\twindow.document.body.appendChild(this.element);\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t// Make tooltip aware of window resize\\n\\\n        \\tif (this.attachedTo) {\\n\\\n        \\t\\tthis._aware();\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t// Trigger layout and kick in the transition\\n\\\n        \\tif (this.options.inClass) {\\n\\\n        \\t\\tif (this.options.effectClass) {\\n\\\n        \\t\\t\\tvoid this.element.clientHeight;\\n\\\n        \\t\\t}\\n\\\n        \\t\\tthis.classes.add(this.options.inClass);\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\treturn this;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Hide the tooltip.\\n\\\n         *\\n\\\n         * @return {Tooltip}\\n\\\n         */\\n\\\n        Tooltip.prototype.hide = function () {\\n\\\n        \\tif (this.hidden) {\\n\\\n        \\t\\treturn;\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\tvar self = this;\\n\\\n        \\tvar duration = 0;\\n\\\n        \\n\\\n        \\t// Remove .in class and calculate transition duration if any\\n\\\n        \\tif (this.options.inClass) {\\n\\\n        \\t\\tthis.classes.remove(this.options.inClass);\\n\\\n        \\t\\tif (this.options.effectClass) {\\n\\\n        \\t\\t\\tduration = transitionDuration(this.element);\\n\\\n        \\t\\t}\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t// Remove tip from window resize awareness\\n\\\n        \\tif (this.attachedTo) {\\n\\\n        \\t\\tthis._unaware();\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t// Remove the tip from the DOM when transition is done\\n\\\n        \\tclearTimeout(this.aIndex);\\n\\\n        \\tthis.aIndex = setTimeout(function () {\\n\\\n        \\t\\tself.aIndex = 0;\\n\\\n        \\t\\twindow.document.body.removeChild(self.element);\\n\\\n        \\t\\tself.hidden = 1;\\n\\\n        \\t}, duration);\\n\\\n        \\n\\\n        \\treturn this;\\n\\\n        };\\n\\\n        \\n\\\n        Tooltip.prototype.toggle = function (x, y) {\\n\\\n        \\treturn this[this.hidden ? 'show' : 'hide'](x, y);\\n\\\n        };\\n\\\n        \\n\\\n        Tooltip.prototype.destroy = function () {\\n\\\n        \\tclearTimeout(this.aIndex);\\n\\\n        \\tthis._unaware();\\n\\\n        \\tif (!this.hidden) {\\n\\\n        \\t\\twindow.document.body.removeChild(this.element);\\n\\\n        \\t}\\n\\\n        \\tthis.element = this.options = null;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Make the tip window resize aware.\\n\\\n         *\\n\\\n         * @return {Void}\\n\\\n         */\\n\\\n        Tooltip.prototype._aware = function () {\\n\\\n        \\tvar index = indexOf(Tooltip.winAware, this);\\n\\\n        \\tif (!~index) {\\n\\\n        \\t\\tTooltip.winAware.push(this);\\n\\\n        \\t}\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Remove the window resize awareness.\\n\\\n         *\\n\\\n         * @return {Void}\\n\\\n         */\\n\\\n        Tooltip.prototype._unaware = function () {\\n\\\n        \\tvar index = indexOf(Tooltip.winAware, this);\\n\\\n        \\tif (~index) {\\n\\\n        \\t\\tTooltip.winAware.splice(index, 1);\\n\\\n        \\t}\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Handles repositioning of tooltips on window resize.\\n\\\n         *\\n\\\n         * @return {Void}\\n\\\n         */\\n\\\n        Tooltip.reposition = (function () {\\n\\\n        \\tvar rAF = window.requestAnimationFrame || window.webkitRequestAnimationFrame || function (fn) {\\n\\\n        \\t\\treturn setTimeout(fn, 17);\\n\\\n        \\t};\\n\\\n        \\tvar rIndex;\\n\\\n        \\n\\\n        \\tfunction requestReposition() {\\n\\\n        \\t\\tif (rIndex || !Tooltip.winAware.length) {\\n\\\n        \\t\\t\\treturn;\\n\\\n        \\t\\t}\\n\\\n        \\t\\trIndex = rAF(reposition, 17);\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\tfunction reposition() {\\n\\\n        \\t\\trIndex = 0;\\n\\\n        \\t\\tvar tip;\\n\\\n        \\t\\tfor (var i = 0, l = Tooltip.winAware.length; i < l; i++) {\\n\\\n        \\t\\t\\ttip = Tooltip.winAware[i];\\n\\\n        \\t\\t\\ttip.position();\\n\\\n        \\t\\t}\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\treturn requestReposition;\\n\\\n        }());\\n\\\n        Tooltip.winAware = [];\\n\\\n        \\n\\\n        // Bind winAware repositioning to window resize event\\n\\\n        evt.bind(window, 'resize', Tooltip.reposition);\\n\\\n        evt.bind(window, 'scroll', Tooltip.reposition);\\n\\\n        \\n\\\n        /**\\n\\\n         * Array with dynamic class types.\\n\\\n         *\\n\\\n         * @type {Array}\\n\\\n         */\\n\\\n        Tooltip.classTypes = ['type', 'effect'];\\n\\\n        \\n\\\n        /**\\n\\\n         * Default options for Tooltip constructor.\\n\\\n         *\\n\\\n         * @type {Object}\\n\\\n         */\\n\\\n        Tooltip.defaults = {\\n\\\n        \\tbaseClass:   'tooltip', // Base tooltip class name.\\n\\\n        \\ttypeClass:   null,      // Type tooltip class name.\\n\\\n        \\teffectClass: null,      // Effect tooltip class name.\\n\\\n        \\tinClass:     'in',      // Class used to transition stuff in.\\n\\\n        \\tplace:       'top',     // Default place.\\n\\\n        \\tspacing:     null,      // Gap between target and tooltip.\\n\\\n        \\toffset:      null,      // Horizontal offset to align arrow\\n\\\n        \\tauto:        0          // Whether to automatically adjust place to fit into window.\\n\\\n        };//# sourceURL=darsain-tooltip/index.js\"\n    ));\n    fakeRequire.register(\"darsain-event/index.js\", Function(\"exports, fakeRequire, module\",\n        \"'use strict';\\n\\\n        \\n\\\n        /**\\n\\\n         * Bind `el` event `type` to `fn`.\\n\\\n         *\\n\\\n         * @param {Element}  el\\n\\\n         * @param {String}   type\\n\\\n         * @param {Function} fn\\n\\\n         * @param {Boolean}  capture\\n\\\n         *\\n\\\n         * @return {Function}\\n\\\n         */\\n\\\n        exports.bind = window.addEventListener ? function (el, type, fn, capture) {\\n\\\n        \\tel.addEventListener(type, fn, capture || false);\\n\\\n        \\treturn fn;\\n\\\n        } : function (el, type, fn) {\\n\\\n        \\tvar fnid = type + fn;\\n\\\n        \\tel[fnid] = el[fnid] || function () {\\n\\\n        \\t\\tvar event = window.event;\\n\\\n        \\t\\tevent.target = event.srcElement;\\n\\\n        \\t\\tevent.preventDefault = function () {\\n\\\n        \\t\\t\\tevent.returnValue = false;\\n\\\n        \\t\\t};\\n\\\n        \\t\\tevent.stopPropagation = function () {\\n\\\n        \\t\\t\\tevent.cancelBubble = true;\\n\\\n        \\t\\t};\\n\\\n        \\t\\tfn.call(el, event);\\n\\\n        \\t};\\n\\\n        \\tel.attachEvent('on' + type, el[fnid]);\\n\\\n        \\treturn fn;\\n\\\n        };\\n\\\n        \\n\\\n        /**\\n\\\n         * Unbind `el` event `type`'s callback `fn`.\\n\\\n         *\\n\\\n         * @param {Element}  el\\n\\\n         * @param {String}   type\\n\\\n         * @param {Function} fn\\n\\\n         * @param {Boolean}  capture\\n\\\n         *\\n\\\n         * @return {Function}\\n\\\n         */\\n\\\n        exports.unbind = window.removeEventListener ? function (el, type, fn, capture) {\\n\\\n        \\tel.removeEventListener(type, fn, capture || false);\\n\\\n        \\treturn fn;\\n\\\n        } : function (el, type, fn) {\\n\\\n        \\tvar fnid = type + fn;\\n\\\n        \\tel.detachEvent('on' + type, el[fnid]);\\n\\\n        \\ttry {\\n\\\n        \\t\\tdelete el[fnid];\\n\\\n        \\t} catch (err) {\\n\\\n        \\t\\t// can't delete window object properties\\n\\\n        \\t\\tel[fnid] = undefined;\\n\\\n        \\t}\\n\\\n        \\treturn fn;\\n\\\n        };//# sourceURL=darsain-event/index.js\"\n    ));\n    fakeRequire.register(\"component-indexof/index.js\", Function(\"exports, fakeRequire, module\",\n        \"module.exports = function(arr, obj){\\n\\\n          if (arr.indexOf) return arr.indexOf(obj);\\n\\\n          for (var i = 0; i < arr.length; ++i) {\\n\\\n            if (arr[i] === obj) return i;\\n\\\n          }\\n\\\n          return -1;\\n\\\n        };//# sourceURL=component-indexof/index.js\"\n    ));\n    fakeRequire.register(\"code42day-dataset/index.js\", Function(\"exports, fakeRequire, module\",\n        \"module.exports=dataset;\\n\\\n        \\n\\\n        /*global document*/\\n\\\n        \\n\\\n        \\n\\\n        // replace namesLikeThis with names-like-this\\n\\\n        function toDashed(name) {\\n\\\n          return name.replace(/([A-Z])/g, function(u) {\\n\\\n            return \\\"-\\\" + u.toLowerCase();\\n\\\n          });\\n\\\n        }\\n\\\n        \\n\\\n        var fn;\\n\\\n        \\n\\\n        if (document.head.dataset) {\\n\\\n          fn = {\\n\\\n            set: function(node, attr, value) {\\n\\\n               if (!node.dataset) return;\\\n               node.dataset[attr] = value;\\n\\\n            },\\n\\\n            get: function(node, attr) {\\n\\\n              return node.dataset && node.dataset[attr];\\n\\\n            }\\n\\\n          };\\n\\\n        } else {\\n\\\n          fn = {\\n\\\n            set: function(node, attr, value) {\\n\\\n              node.setAttribute('data-' + toDashed(attr), value);\\n\\\n            },\\n\\\n            get: function(node, attr) {\\n\\\n              return node.getAttribute('data-' + toDashed(attr));\\n\\\n            }\\n\\\n          };\\n\\\n        }\\n\\\n        \\n\\\n        function dataset(node, attr, value) {\\n\\\n          var self = {\\n\\\n            set: set,\\n\\\n            get: get\\n\\\n          };\\n\\\n        \\n\\\n          function set(attr, value) {\\n\\\n            fn.set(node, attr, value);\\n\\\n            return self;\\n\\\n          }\\n\\\n        \\n\\\n          function get(attr) {\\n\\\n            return fn.get(node, attr);\\n\\\n          }\\n\\\n        \\n\\\n          if (arguments.length === 3) {\\n\\\n            return set(attr, value);\\n\\\n          }\\n\\\n          if (arguments.length == 2) {\\n\\\n            return get(attr);\\n\\\n          }\\n\\\n        \\n\\\n          return self;\\n\\\n        }//# sourceURL=code42day-dataset/index.js\"\n    ));\n    fakeRequire.register(\"tooltips/index.js\", Function(\"exports, fakeRequire, module\",\n        \"'use strict';\\n\\\n        \\n\\\n        /**\\n\\\n         * Dependencies.\\n\\\n         */\\n\\\n        var evt = fakeRequire('event');\\n\\\n        var indexOf = fakeRequire('indexof');\\n\\\n        var Tooltip = fakeRequire('tooltip');\\n\\\n        var dataset = fakeRequire('dataset');\\n\\\n        \\n\\\n        /**\\n\\\n         * Transport.\\n\\\n         */\\n\\\n        module.exports = Tooltips;\\n\\\n        \\n\\\n        /**\\n\\\n         * Globals.\\n\\\n         */\\n\\\n        var MObserver = window.MutationObserver || window.WebkitMutationObserver;\\n\\\n        \\n\\\n        /**\\n\\\n         * Prototypal inheritance.\\n\\\n         *\\n\\\n         * @param {Object} o\\n\\\n         *\\n\\\n         * @return {Object}\\n\\\n         */\\n\\\n        var objectCreate = Object.create || (function () {\\n\\\n        \\tfunction F() {}\\n\\\n        \\treturn function (o) {\\n\\\n        \\t\\tF.prototype = o;\\n\\\n        \\t\\treturn new F();\\n\\\n        \\t};\\n\\\n        })();\\n\\\n        \\n\\\n        /**\\n\\\n         * Poor man's shallow object extend.\\n\\\n         *\\n\\\n         * @param {Object} a\\n\\\n         * @param {Object} b\\n\\\n         *\\n\\\n         * @return {Object}\\n\\\n         */\\n\\\n        function extend(a, b) {\\n\\\n        \\tfor (var key in b) {\\n\\\n        \\t\\ta[key] = b[key];\\n\\\n        \\t}\\n\\\n        \\treturn a;\\n\\\n        }\\n\\\n        \\n\\\n        /**\\n\\\n         * Capitalize the first letter of a string.\\n\\\n         *\\n\\\n         * @param {String} string\\n\\\n         *\\n\\\n         * @return {String}\\n\\\n         */\\n\\\n        function ucFirst(string) {\\n\\\n        \\treturn string.charAt(0).toUpperCase() + string.slice(1);\\n\\\n        }\\n\\\n        \\n\\\n        /**\\n\\\n         * Tooltips constructor.\\n\\\n         *\\n\\\n         * @param {Element} container\\n\\\n         * @param {Object}  options\\n\\\n         *\\n\\\n         * @return {Tooltips}\\n\\\n         */\\n\\\n        function Tooltips(container, options) {\\n\\\n        \\tif (!(this instanceof Tooltips)) {\\n\\\n        \\t\\treturn new Tooltips(container, options);\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\tvar self = this;\\n\\\n        \\tvar observer, TID;\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Show tooltip attached to an element.\\n\\\n        \\t *\\n\\\n        \\t * @param {Element} element\\n\\\n        \\t *\\n\\\n        \\t * @return {Tooltips}\\n\\\n        \\t */\\n\\\n        \\tself.show = function (element) {\\n\\\n        \\t\\treturn callTooltipMethod(element, 'show');\\n\\\n        \\t};\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Hide tooltip attached to an element.\\n\\\n        \\t *\\n\\\n        \\t * @param {Element} element\\n\\\n        \\t *\\n\\\n        \\t * @return {Tooltips}\\n\\\n        \\t */\\n\\\n        \\tself.hide = function (element) {\\n\\\n        \\t\\treturn callTooltipMethod(element, 'hide');\\n\\\n        \\t};\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Toggle tooltip attached to an element.\\n\\\n        \\t *\\n\\\n        \\t * @param {Element} element\\n\\\n        \\t *\\n\\\n        \\t * @return {Tooltips}\\n\\\n        \\t */\\n\\\n        \\tself.toggle = function (element) {\\n\\\n        \\t\\treturn callTooltipMethod(element, 'toggle');\\n\\\n        \\t};\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Retrieve tooltip attached to an element and call it's method.\\n\\\n        \\t *\\n\\\n        \\t * @param {Element} element\\n\\\n        \\t * @param {String}  method\\n\\\n        \\t *\\n\\\n        \\t * @return {Tooltips}\\n\\\n        \\t */\\n\\\n        \\tfunction callTooltipMethod(element, method) {\\n\\\n        \\t\\tvar tip = self.get(element);\\n\\\n        \\t\\tif (tip) {\\n\\\n        \\t\\t\\ttip[method]();\\n\\\n        \\t\\t}\\n\\\n        \\t\\treturn self;\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Return a tooltip attached to an element. Tooltip is created if it doesn't exist yet.\\n\\\n        \\t *\\n\\\n        \\t * @param {Element} element\\n\\\n        \\t *\\n\\\n        \\t * @return {Tooltip}\\n\\\n        \\t */\\n\\\n        \\tself.get = function (element) {\\n\\\n        \\t\\tvar tip = !!element && (element[TID] || createTip(element));\\n\\\n        \\t\\tif (tip && !element[TID]) {\\n\\\n        \\t\\t\\telement[TID] = tip;\\n\\\n        \\t\\t}\\n\\\n        \\t\\treturn tip;\\n\\\n        \\t};\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Add element(s) to Tooltips instance.\\n\\\n        \\t *\\n\\\n        \\t * @param {[type]} element Can be element, or container containing elements to be added.\\n\\\n        \\t *\\n\\\n        \\t * @return {Tooltips}\\n\\\n        \\t */\\n\\\n        \\tself.add = function (element) {\\n\\\n        \\t\\tif (!element || element.nodeType !== 1) {\\n\\\n        \\t\\t\\treturn self;\\n\\\n        \\t\\t}\\n\\\n        \\t\\tif (dataset(element).get(options.key)) {\\n\\\n        \\t\\t\\tbindElement(element);\\n\\\n        \\t\\t} else if (element.children) {\\n\\\n        \\t\\t\\tbindElements(element.querySelectorAll(self.selector));\\n\\\n        \\t\\t}\\n\\\n        \\t\\treturn self;\\n\\\n        \\t};\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Remove element(s) from Tooltips instance.\\n\\\n        \\t *\\n\\\n        \\t * @param {Element} element Can be element, or container containing elements to be removed.\\n\\\n        \\t *\\n\\\n        \\t * @return {Tooltips}\\n\\\n        \\t */\\n\\\n        \\tself.remove = function (element) {\\n\\\n        \\t\\tif (!element || element.nodeType !== 1) {\\n\\\n        \\t\\t\\treturn self;\\n\\\n        \\t\\t}\\n\\\n        \\t\\tif (dataset(element).get(options.key)) {\\n\\\n        \\t\\t\\tunbindElement(element);\\n\\\n        \\t\\t} else if (element.children) {\\n\\\n        \\t\\t\\tunbindElements(element.querySelectorAll(self.selector));\\n\\\n        \\t\\t}\\n\\\n        \\t\\treturn self;\\n\\\n        \\t};\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Reload Tooltips instance.\\n\\\n        \\t *\\n\\\n        \\t * Unbinds current tooltipped elements, than selects the\\n\\\n        \\t * data-key elements from container and binds them again.\\n\\\n        \\t *\\n\\\n        \\t * @return {Tooltips}\\n\\\n        \\t */\\n\\\n        \\tself.reload = function () {\\n\\\n        \\t\\t// Unbind old elements\\n\\\n        \\t\\tunbindElements(self.elements);\\n\\\n        \\t\\t// Bind new elements\\n\\\n        \\t\\tbindElements(self.container.querySelectorAll(self.selector));\\n\\\n        \\t\\treturn self;\\n\\\n        \\t};\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Destroy Tooltips instance.\\n\\\n        \\t *\\n\\\n        \\t * @return {Void}\\n\\\n        \\t */\\n\\\n        \\tself.destroy = function () {\\n\\\n        \\t\\tunbindElements(this.elements);\\n\\\n        \\t\\tif (observer) {\\n\\\n        \\t\\t\\tobserver.disconnect();\\n\\\n        \\t\\t}\\n\\\n        \\t\\tthis.container = this.elements = this.options = observer = null;\\n\\\n        \\t};\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Create a tip from element data attributes.\\n\\\n        \\t *\\n\\\n        \\t * @param {Element} element\\n\\\n        \\t *\\n\\\n        \\t * @return {Tooltip}\\n\\\n        \\t */\\n\\\n        \\tfunction createTip(element) {\\n\\\n        \\t\\tvar data = dataset(element);\\n\\\n        \\t\\tvar content = data.get(options.key);\\n\\\n        \\t\\tif (!content) {\\n\\\n        \\t\\t\\treturn false;\\n\\\n        \\t\\t}\\n\\\n        \\t\\tvar tipOptions = objectCreate(options.tooltip);\\n\\\n        \\t\\tvar keyData;\\n\\\n        \\t\\tfor (var key in Tooltip.defaults) {\\n\\\n        \\t\\t\\tkeyData = data.get(options.key + ucFirst(key.replace(/Class$/, '')));\\n\\\n        \\t\\t\\tif (!keyData) {\\n\\\n        \\t\\t\\t\\tcontinue;\\n\\\n        \\t\\t\\t}\\n\\\n        \\t\\t\\ttipOptions[key] = keyData;\\n\\\n        \\t\\t}\\n\\\n        \\t\\treturn new Tooltip(content, tipOptions).attach(element);\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Bind Tooltips events to Array/NodeList of elements.\\n\\\n        \\t *\\n\\\n        \\t * @param {Array} elements\\n\\\n        \\t *\\n\\\n        \\t * @return {Void}\\n\\\n        \\t */\\n\\\n        \\tfunction bindElements(elements) {\\n\\\n        \\t\\tfor (var i = 0, l = elements.length; i < l; i++) {\\n\\\n        \\t\\t\\tbindElement(elements[i]);\\n\\\n        \\t\\t}\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Bind Tooltips events to element.\\n\\\n        \\t *\\n\\\n        \\t * @param {Element} element\\n\\\n        \\t *\\n\\\n        \\t * @return {Void}\\n\\\n        \\t */\\n\\\n        \\tfunction bindElement(element) {\\n\\\n        \\t\\tif (element[TID] || ~indexOf(self.elements, element)) {\\n\\\n        \\t\\t\\treturn;\\n\\\n        \\t\\t}\\n\\\n        \\t\\tevt.bind(element, options.showOn, eventHandler);\\n\\\n        \\t\\tevt.bind(element, options.hideOn, eventHandler);\\n\\\n        \\t\\tself.elements.push(element);\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Unbind Tooltips events from Array/NodeList of elements.\\n\\\n        \\t *\\n\\\n        \\t * @param {Array} elements\\n\\\n        \\t *\\n\\\n        \\t * @return {Void}\\n\\\n        \\t */\\n\\\n        \\tfunction unbindElements(elements) {\\n\\\n        \\t\\tif (self.elements === elements) {\\n\\\n        \\t\\t\\telements = elements.slice();\\n\\\n        \\t\\t}\\n\\\n        \\t\\tfor (var i = 0, l = elements.length; i < l; i++) {\\n\\\n        \\t\\t\\tunbindElement(elements[i]);\\n\\\n        \\t\\t}\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Unbind Tooltips events from element.\\n\\\n        \\t *\\n\\\n        \\t * @param {Element} element\\n\\\n        \\t *\\n\\\n        \\t * @return {Void}\\n\\\n        \\t */\\n\\\n        \\tfunction unbindElement(element) {\\n\\\n        \\t\\tvar index = indexOf(self.elements, element);\\n\\\n        \\t\\tif (!~index) {\\n\\\n        \\t\\t\\treturn;\\n\\\n        \\t\\t}\\n\\\n        \\t\\tif (element[TID]) {\\n\\\n        \\t\\t\\telement[TID].destroy();\\n\\\n        \\t\\t\\tdelete element[TID];\\n\\\n        \\t\\t}\\n\\\n        \\t\\tevt.unbind(element, options.showOn, eventHandler);\\n\\\n        \\t\\tevt.unbind(element, options.hideOn, eventHandler);\\n\\\n        \\t\\tself.elements.splice(index, 1);\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Tooltips events handler.\\n\\\n        \\t *\\n\\\n        \\t * @param {Event} event\\n\\\n        \\t *\\n\\\n        \\t * @return {Void}\\n\\\n        \\t */\\n\\\n        \\tfunction eventHandler(event) {\\n\\\n        \\t\\t/*jshint validthis:true */\\n\\\n        \\t\\tif (options.showOn === options.hideOn) {\\n\\\n        \\t\\t\\tself.toggle(this);\\n\\\n        \\t\\t} else {\\n\\\n        \\t\\t\\tself[event.type === options.showOn ? 'show' : 'hide'](this);\\n\\\n        \\t\\t}\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t/**\\n\\\n        \\t * Mutations handler.\\n\\\n        \\t *\\n\\\n        \\t * @param {Array} mutations\\n\\\n        \\t *\\n\\\n        \\t * @return {Void}\\n\\\n        \\t */\\n\\\n        \\tfunction mutationsHandler(mutations) {\\n\\\n        \\t\\tvar added, removed, i, l;\\n\\\n        \\t\\tfor (var m = 0, ml = mutations.length; m < ml; m++) {\\n\\\n        \\t\\t\\tadded = mutations[m].addedNodes;\\n\\\n        \\t\\t\\tremoved = mutations[m].removedNodes;\\n\\\n        \\t\\t\\tfor (i = 0, l = added.length; i < l; i++) {\\n\\\n        \\t\\t\\t\\tself.add(added[i]);\\n\\\n        \\t\\t\\t}\\n\\\n        \\t\\t\\tfor (i = 0, l = removed.length; i < l; i++) {\\n\\\n        \\t\\t\\t\\tself.remove(removed[i]);\\n\\\n        \\t\\t\\t}\\n\\\n        \\t\\t\\tif (mutations[m].type == 'attributes' && mutations[m].attributeName == 'data-title'){\\n\\\n        \\t\\t\\t\\tif (!self.get(mutations[m])) { self.add(mutations[m].target); }\\n\\\n        \\t\\t\\t\\tself.get(mutations[m].target).content(dataset(mutations[m].target).get('title'));\\n\\\n        \\t\\t\\t}\\n\\\n        \\t\\t}\\n\\\n        \\t}\\n\\\n        \\n\\\n        \\t// Construct\\n\\\n        \\t(function () {\\n\\\n        \\t\\tself.container = container;\\n\\\n        \\t\\tself.options = options = extend(objectCreate(Tooltips.defaults), options);\\n\\\n        \\t\\tself.ID = TID = options.key + Math.random().toString(36).slice(2);\\n\\\n        \\t\\tself.elements = [];\\n\\\n        \\n\\\n        \\t\\t// Create tips selector\\n\\\n        \\t\\tself.selector = '[data-' + options.key + ']';\\n\\\n        \\n\\\n        \\t\\t// Load tips\\n\\\n        \\t\\tself.reload();\\n\\\n        \\n\\\n        \\t\\t// Create mutations observer\\n\\\n        \\t\\tif (options.observe && MObserver) {\\n\\\n        \\t\\t\\tobserver = new MObserver(mutationsHandler);\\n\\\n        \\t\\t\\tobserver.observe(self.container, {\\n\\\n        \\t\\t\\t\\tchildList: true,\\n\\\n        \\t\\t\\t\\tsubtree: true,\\n\\\n        \\t\\t\\t\\tattributes: true\\n\\\n        \\t\\t\\t});\\n\\\n        \\t\\t}\\n\\\n        \\t}());\\n\\\n        }\\n\\\n        \\n\\\n        /**\\n\\\n         * Expose Tooltip.\\n\\\n         */\\n\\\n        Tooltips.Tooltip = Tooltip;\\n\\\n        \\n\\\n        /**\\n\\\n         * Default Tooltips options.\\n\\\n         *\\n\\\n         * @type {Object}\\n\\\n         */\\n\\\n        Tooltips.defaults = {\\n\\\n        \\ttooltip:    {},          // Options for individual Tooltip instances.\\n\\\n        \\tkey:       'tooltip',    // Tooltips data attribute key.\\n\\\n        \\tshowOn:    'mouseenter', // Show tooltip event.\\n\\\n        \\thideOn:    'mouseleave', // Hide tooltip event.\\n\\\n        \\tobserve:   0             // Enable mutation observer (used only when supported).\\n\\\n        };//# sourceURL=tooltips/index.js\"\n    ));\n\n\n\n\n\n\n\n\n\n\n    fakeRequire.alias(\"darsain-tooltip/index.js\", \"tooltips/deps/tooltip/index.js\");\n    fakeRequire.alias(\"darsain-tooltip/index.js\", \"tooltip/index.js\");\n    fakeRequire.alias(\"darsain-event/index.js\", \"darsain-tooltip/deps/event/index.js\");\n\n    fakeRequire.alias(\"darsain-position/index.js\", \"darsain-tooltip/deps/position/index.js\");\n\n    fakeRequire.alias(\"component-classes/index.js\", \"darsain-tooltip/deps/classes/index.js\");\n    fakeRequire.alias(\"component-indexof/index.js\", \"component-classes/deps/indexof/index.js\");\n\n    fakeRequire.alias(\"component-indexof/index.js\", \"darsain-tooltip/deps/indexof/index.js\");\n\n    fakeRequire.alias(\"darsain-event/index.js\", \"tooltips/deps/event/index.js\");\n    fakeRequire.alias(\"darsain-event/index.js\", \"event/index.js\");\n\n    fakeRequire.alias(\"component-indexof/index.js\", \"tooltips/deps/indexof/index.js\");\n    fakeRequire.alias(\"component-indexof/index.js\", \"indexof/index.js\");\n\n    fakeRequire.alias(\"code42day-dataset/index.js\", \"tooltips/deps/dataset/index.js\");\n    fakeRequire.alias(\"code42day-dataset/index.js\", \"dataset/index.js\");\n    if (typeof exports == \"object\") {\n        module.exports = fakeRequire(\"tooltips\");\n    } else if (typeof define == \"function\" && define.amd) {\n        define(function(){ return fakeRequire(\"tooltips\"); });\n    } else {\n        this[\"Tooltips\"] = fakeRequire(\"tooltips\");\n    }})();\n"]}